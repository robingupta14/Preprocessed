<?php





define('HTDOCDIR',sprintf('%s/',realpath(var_0.'../htdocs/')));
define('LANGDIR',sprintf('%s/',realpath(var_0.'../locale/')));
define('CONFDIR',sprintf('%s/',realpath(var_0.'../config')));
define('QUERYDIR',sprintf('%s/',realpath(var_0.'../queries/')));
define('TMPLDIR',sprintf('%s/',realpath(var_0.'../templates/')));
define('DOCDIR',sprintf('%s/',realpath(var_0.'../doc/')));
define('HOOKSDIR',sprintf('%s/',realpath(var_0.'../hooks/')));
define('JSDIR','js/');


$app['function_files'] = array(
	
	var_0.'session_functions.php',
	
	var_0.'schema_functions.php',
	
	var_0.'template_functions.php',
	
	var_0.'emuhash_functions.php',
	
	var_0.'createlm.php',
	
	var_0.'ds.php',
	
	var_0.'page.php'
);

if (file_exists(var_0.'functions.custom.php'))
	array_push($app['function_files'],var_0.'functions.custom.php');


function fn_0($var_1) {
	if (file_exists(var_2."classes/$var_1.php"))
	elseif (file_exists(var_0."$var_1.php"))
	var_3 (file_exists(var_0."ds_$var_1.php"))
	var_4
		var_5(array(
			'title'=>fn_2('Generic Error'),
			'body'=>sprintf('%s: %s [%s]',
				var_6,fn_2('Called to load a class that cant be found'),$var_1),
			'type'=>'error'));
}

if (version_compare(phpversion(), '7.0', '>=')) {
	spl_autoload_register('pla_autoload');
} else {
	eval('function __autoload($className) {pla_autoload($className);}');
}


function fn_1(&$var_7) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (is_array($var_7))
		while (list($var_12) = each($var_7))
			if (is_array($var_7[$var_12]) && $var_12 != $var_7)
				fn_1($var_7[$var_12]);
			else
				$var_7[$var_12] = stripslashes($var_7[$var_12]);
}




if (! function_exists('_')) {
	function fn_2($var_13) {
		return $var_13;
	}
}




function fn_3($var_14,$var_15,$var_16,$var_17) {
	if (defined('DEBUG_ENABLED') && var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	if (ini_get('error_reporting') == 0 || error_reporting() == 0)
		return;

	$var_16 = basename($var_16);
	$var_18 = basename($_SERVER['PHP_SELF']);
	$var_19 = '';

	switch ($var_14) {
		case var_20: $var_19 = 'E_STRICT'; break;
		case var_21: $var_19 = 'E_ERROR'; break;
		case var_22: $var_19 = 'E_WARNING'; break;
		case var_23: $var_19 = 'E_PARSE'; break;
		case var_24: $var_19 = 'E_NOTICE'; break;
		case var_25: $var_19 = 'E_CORE_ERROR'; break;
		case var_26: $var_19 = 'E_CORE_WARNING'; break;
		case var_27: $var_19 = 'E_COMPILE_ERROR'; break;
		case var_28: $var_19 = 'E_COMPILE_WARNING'; break;
		case var_29: $var_19 = 'E_USER_ERROR'; break;
		case var_30: $var_19 = 'E_USER_WARNING'; break;
		case var_31: $var_19 = 'E_USER_NOTICE'; break;
		case var_32: $var_19 = 'E_ALL'; break;

		default: $var_19 = sprintf('%s: %s',fn_2('Unrecognized error number'),$var_14);
	}

	
	$var_15 = preg_replace('/\s+/',' ',$var_15);

	if ($var_14 == var_24) {
		$var_33 = '<table class="notice">';
		$var_33 .= sprintf('<tr><td>%s:</td><td><b>%s</b> (<b>%s</b>)</td></tr>',fn_2('Error'),$var_15,$var_19);
		$var_33 .= sprintf('<tr><td>%s:</td><td><b>%s</b> %s <b>%s</b>, %s <b>%s</b></td></tr>',
			fn_2('File'),$var_16,fn_2('line'),$var_17,fn_2('caller'),$var_18);
		$var_33 .= sprintf('<tr><td>Versions:</td><td>PLA: <b>%s</b>, PHP: <b>%s</b>, SAPI: <b>%s</b></td></tr>',
			fn_5(),phpversion(),php_sapi_name());
		$var_33 .= sprintf('<tr><td>Web server:</td><td><b>%s</b></td></tr>',isset($_SERVER['SERVER_SOFTWARE']) ? $_SERVER['SERVER_SOFTWARE'] : 'SCRIPT');

		if (function_exists('get_href'))
			$var_33 .= sprintf('<tr><td colspan="2"><a href="%s" onclick="target=\'_blank\';"><center>%s.</center></a></td></tr>',
				fn_50('search_bug',"&summary_keyword=".rawurlencode($var_15)),
				fn_2('Please check and see if this bug has been reported'));
		$var_33 .= '</table>';

		system_message(array(
			'title'=>fn_2('You found a non-fatal phpLDAPadmin bug!'),
			'body'=>$var_33,
			'type'=>'error'));

		return;
	}

	
	fn_7(sprintf('%s: %s',$var_19,$var_15),'error',null,true,true);
}


function fn_4() {
	return 'phpLDAPadmin';
}


function fn_5() {
	static $var_34 = null;

	if ($var_34)
		return $var_34;

	$var_35 = realpath(var_0.'../VERSION');
	if (! file_exists($var_35))
		$var_34 = 'UNKNOWN';

	else {
		$var_36 = rtrim(file_get_contents($var_35));

		$var_34 = preg_replace('/^RELEASE-([0-9\.]+(-.*)*)$/','$1',$var_36);

		
		if (preg_match('/^(DEVEL)?$/',$var_34))
			$var_34 = 'DEVEL';

		
		elseif (preg_match('/^DEVEL-([0-9\.]+)+$/',$var_34)) {}

		
		elseif ($var_34 == $var_36)
			$var_34 = 'UNKNOWN';
	}

	return $var_34;
}


function fn_6($var_37) {
	switch ($var_37) {
		case 'ja': return 'ja_JP';
		case 'cs': return 'cs_CZ';
		default: return sprintf('%s_%s',$var_37,strtoupper($var_37));
	}
}


function var_38($var_39) {
	

	
	if (strcmp(phpversion(),var_40) < 0)
		system_message(array(
			'title'=>fn_2('Incorrect version of PHP'),
			'body'=>sprintf('phpLDAPadmin requires PHP version %s or greater.<br /><small>(You are using %s)</small>',
				var_40,phpversion()),
			'type'=>'error'));

	$var_41 = new class_0;

	if (file_exists(var_0.'config_custom.php') && is_readable(var_0.'config_custom.php'))

	ob_start();
	$var_42 = '';
	if (ob_get_level()) {
		$var_42 = ob_get_contents();
		ob_end_clean();
	}

	if ($var_42) {
		$var_42 = strip_tags($var_42);
		$var_43 = array();
		preg_match('/(.*):\s+(.*):.*\s+on line (\d+)/',$var_42,$var_43);

		if (isset($var_43[1]) && isset($var_43[2]) && isset($var_43[3])) {
			$var_44 = $var_43[1];
			$var_45 = $var_43[2];
			$var_46 = $var_43[3];

			$var_16 = file($var_39);

			$var_33 = '<h3 class="title">Config file ERROR</h3>';
			$var_33 .= sprintf('<h3 class="subtitle">%s (%s) on line %s</h3>',$var_44,$var_45,$var_46);

			$var_33 .= '<center>';
			$var_33 .= sprintf('Looks like your config file has an ERROR on line %s.<br />',$var_46);
			$var_33 .= 'Here is a snippet around that line <br />';
			$var_33 .= '<br />'."\n";

			$var_33 .= '<div style="text-align: left; font-family: monospace; margin-left: 80px; margin-right: 80px; border: 1px solid black; padding: 10px;">';

			for ($var_47 = $var_46-9; $var_47<$var_46+5; $var_47++) {
				if ($var_47+1 == $var_46)
					$var_33 .= '<div style="color:red;background:

				if ($i < 0)
					continue;

				$body .= sprintf('<var_48>%var_49</var_48>: %var_49<var_50 />',$i+1,$file[$i]);

				if ($i+1 == $line_num)
					$body .= '</var_51>';
			}

			$body .= '</var_51>';
			$body .= '<var_50 />';
			$body .= 'var_52: var_53 var_54 var_55 var_56 var_57 var_58 var_59 <var_48>var_60</var_48> var_61 var_62 var_63.';
			$body .= '</var_64>';

			$block = new block();
			$block->SetBody($body);
			$www['var_65'] = new var_65();
			$var_92['page']->block_add('body',$var_67);
			$var_92['page']->display();

			die();
		}
	}

	
	if (! isset($var_69) || count($var_69->GetServerList()) == 0)
		fn_7(fn_2('Your config.php is missing Server Definitions. Please see the sample file config/config.php.example.'),'error','index.php',true);

	$var_41->setServers($var_69);

	
	if ((ini_get('memory_limit') > -1) && ini_get('memory_limit') < $var_41->getValue('session','memorylimit'))
		system_message(array(
			'title'=>fn_2('Memory Limit low.'),
			'body'=>sprintf('Your php memory limit is low - currently %s, you should increase it to atleast %s. This is normally controlled in /etc/php.ini.',
				ini_get('memory_limit'),$var_41->getValue('session','memorylimit')),
			'type'=>'error'));

	return $var_41;
}


function fn_8($var_73) {
	if (defined('DEBUG_ENABLED') && var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	switch ($var_73) {
		case 'main' :
			return array(
				'home'=>array(
					'title'=>fn_2('Home'),
					'enable'=>true,
					'link'=>sprintf('href="index.php" title="%s"',fn_2('Home')),
					'image'=>sprintf('<img src="%s/home-big.png" alt="%s" />',var_74,fn_2('Home'))),

				'purge'=>array(
					'title'=>fn_2('Purge caches'),
					'enable'=>isset($_SESSION[var_75]) ? $_SESSION[var_75]->isCommandAvailable('script','purge_cache') : false,
					'link'=>sprintf('href="cmd.php?cmd=purge_cache" onclick="return ajDISPLAY(\'BODY\',\'cmd=purge_cache\',\'%s\');" title="%s"',
						fn_2('Clearing cache'),fn_2('Purge caches')),
					'image'=>sprintf('<img src="%s/trash-big.png" alt="%s" />',var_74,fn_2('Purge caches'))),

				'hide_debug_info'=>array(
					'title'=>fn_2('Show Cache'),
					'enable'=>isset($_SESSION[var_75]) ? ($_SESSION[var_75]->isCommandAvailable('script','show_cache')) && (! $_SESSION[var_75]->getValue('appearance','hide_debug_info')) : false,
					'link'=>sprintf('href="cmd.php?cmd=show_cache" onclick="return ajDISPLAY(\'BODY\',\'cmd=show_cache\',\'%s\');" title="%s"',
						fn_2('Loading'),fn_2('Show Cache'),fn_2('Show Cache')),
					'image'=>sprintf('<img src="%s/debug-cache.png" alt="%s" />',var_74,fn_2('Show Cache'))),
			);

			break;

		case 'top' :
			return array(
				'forum'=>array(
					'title'=>fn_2('Forum'),
					'enable'=>isset($_SESSION[var_75]) ? $_SESSION[var_75]->isCommandAvailable('cmd','oslinks') : true,
					'link'=>sprintf('href="%s" title="%s" onclick="target=\'_blank\';"',fn_50('forum'),fn_2('Forum')),
					'image'=>sprintf('<img src="%s/forum-big.png" alt="%s" />',var_74,fn_2('Forum'))),

				'feature'=>array(
					'title'=>fn_2('Request feature'),
					'enable'=>isset($_SESSION[var_75]) ? $_SESSION[var_75]->isCommandAvailable('cmd','oslinks') : true,
					'link'=>sprintf('href="%s" title="%s" onclick="target=\'_blank\';"',fn_50('add_rfe'),fn_2('Request feature')),
					'image'=>sprintf('<img src="%s/request-feature-big.png" alt="%s" />',var_74,fn_2('Request feature'))),

				'bug'=>array(
					'title'=>fn_2('Report a bug'),
					'enable'=>isset($_SESSION[var_75]) ? $_SESSION[var_75]->isCommandAvailable('cmd','oslinks') : true,
					'link'=>sprintf('href="%s" title="%s" onclick="target=\'_blank\';"',fn_50('add_bug'),fn_2('Report a bug')),
					'image'=>sprintf('<img src="%s/bug-big.png" alt="%s" />',var_74,fn_2('Report a bug'))),

				'donation'=>array(
					'title'=>fn_2('Donate'),
					'enable'=>isset($_SESSION[var_75]) ? $_SESSION[var_75]->isCommandAvailable('cmd','oslinks') : true,
					'link'=>sprintf('href="%s" title="%s" onclick="target=\'_blank\';"',fn_50('donate'),fn_2('Donate')),
					'image'=>sprintf('<img src="%s/smile-big.png" alt="%s" />',var_74,fn_2('Donate'))),

				'help'=>array(
					'title'=>fn_2('Help'),
					'enable'=>isset($_SESSION[var_75]) ? $_SESSION[var_75]->isCommandAvailable('cmd','oslinks') : true,
					'link'=>sprintf('href="%s" title="%s" onclick="target=\'_blank\';"',fn_50('documentation'),fn_2('Help')),
					'image'=>sprintf('<img src="%s/help-big.png" alt="%s" />',var_74,fn_2('Help')))
			);

			break;
	}
}


function fn_9($var_77,$var_78=false,$var_79=false) {
	if ($var_79 &&
		isset($_SESSION[var_75]) && $_SESSION[var_75]->getValue('debug','addr') &&
		$_SERVER['HTTP_X_FORWARDED_FOR'] != $_SESSION[var_75]->getValue('debug','addr') &&
		$_SERVER['REMOTE_ADDR'] != $_SESSION[var_75]->getValue('debug','addr'))
		return;

	$var_80 = debug_backtrace();
	$var_18['class'] = isset($var_80[0]['class']) ? $var_80[0]['class'] : 'N/A';
	$var_18['function'] = isset($var_80[0]['function']) ? $var_80[0]['function'] : 'N/A';
	$var_18['file'] = isset($var_80[0]['file']) ? $var_80[0]['file'] : 'N/A';
	$var_18['line'] = isset($var_80[0]['line']) ? $var_80[0]['line'] : 'N/A';
	$var_18['debug'] = $var_77;

	
	print_r($var_18);
	

	if ($var_78)
		die();
}


function fn_10($var_13='Calling BackTrace',$var_78=false) {
	fn_7($var_13,'note',null,$var_78,true);
}


function fn_11($var_13) {
	system_message(array('title'=>fn_2('Debug'),'body'=>$var_13,'type'=>'debug'));
}


function fn_12($var_13,$var_81,$var_82) {
	static $var_83;

	
	if (! isset($_SESSION[var_75])
		|| ! ($_SESSION[var_75]->getValue('debug','file') || $_SESSION[var_75]->getValue('debug','syslog')))
		return;

	$var_84 = $_SESSION[var_75]->getValue('debug','level');
	if (! $var_84 || (! ($var_81 & $var_84)))
		return;

	if ($_SESSION[var_75]->getValue('debug','addr'))
		if (isset($_SERVER['HTTP_X_FORWARDED_FOR']) && $_SERVER['HTTP_X_FORWARDED_FOR'] == $_SESSION[var_75]->getValue('debug','addr'))
			$var_85 = true;
		elseif ($_SERVER['REMOTE_ADDR'] == $_SESSION[var_75]->getValue('debug','addr'))
			$var_85 = true;
		else
			$var_85 = false;

	else
		$var_85 = true;

	if (! $var_85)
		return;

	
	$var_18 = basename($_SERVER['PHP_SELF']);

	$var_86 = func_get_args();
	
	array_shift($var_86);
	array_shift($var_86);
	array_shift($var_86);

	
	if (is_string($var_86[0]) && preg_match('/.php$/',$var_86[0])) {
		$var_16 = preg_replace('/.php$/','',array_shift($var_86));
		$var_62 = array_shift($var_86);
		$var_87 = array_shift($var_86);

	} else {
		$var_16 = 'UNKNOWN';
		$var_62 = 'UNKNOWN';
		$var_87 = 'UNKNOWN';
	}

	
	if (preg_match('/%%/',$var_13) && $var_86[0] != 'NOARGS')
		$var_86 = array_shift($var_86);

	$var_9 = array();
	foreach ($var_86 as $var_12) {
		if (is_array($var_12))
			array_push($var_9,serialize($var_12));
		elseif (is_object($var_12))
			array_push($var_9,sprintf('OBJECT:%s',get_class($var_12)));
		else
			array_push($var_9,$var_12);
	}

	if (preg_match('/%%/',$var_13))
		$var_13 = preg_replace('/%%/',join('|',$var_9),$var_13);
	else
		$var_13 = vsprintf($var_13,array_values($var_9));

	if (function_exists('stopwatch'))
		$var_88 = stopwatch();
	else
		$var_88 = null;

	$var_89 = sprintf('[%2.3f] %15s(%04s-%03s): %s%s: %s',$var_88,basename($var_16),$var_62,$var_81,str_repeat('.',$var_82),$var_87,substr($var_13,0,200));

	if ($var_83 || $_SESSION[var_75]->getValue('debug','file')) {
		if (! $var_83)
			$var_83 = fopen($_SESSION[var_75]->getValue('debug','file'),
				$_SESSION[var_75]->getValue('debug','append') ? 'a' : 'w');

		fwrite($var_83,$var_89."\n");
	}

	if ($_SESSION[var_75]->getValue('debug','syslog') && function_exists('syslog_notice'))
		syslog_notice($var_89);
}


function fn_7($var_13,$var_73='note',$var_90=null,$var_91=false,$var_80=false) {
	global $var_92;
	static $var_93;

	
	if (! isset($var_92['page']) && ! $var_91)
		die("Function error called incorrectly [$var_13]");

	
	if (! isset($var_92['page']))
		$var_92['page'] = new class_1();

	if ($var_91)
		$var_92['page']->setsysmsg(array('title'=>fn_2('Error'),'body'=>$var_13,'type'=>$var_73));
	else
		system_message(array('title'=>fn_2('Error'),'body'=>$var_13,'type'=>$var_73),$var_90);

	
	if ($var_93++ > 20) {
		fn_9('Spin loop detection.');
		fn_9(array('msg'=>$var_13,'session'=>$_SESSION['sysmsg'],'www'=>$var_92),1);
	}

	
	if ($var_80) {
		$var_95 = new class_2();
		$var_95->SetTitle('PHP Debug Backtrace');

		$var_33 = '<table class="result_table">';
		$var_33 .= "\n";

		foreach (debug_backtrace() as $var_45 => $var_62) {
			$_SESSION['backtrace'][$var_45]['file'] = isset($var_62['file']) ? $var_62['file'] : 'unknown';
			$_SESSION['backtrace'][$var_45]['line'] = isset($var_62['line']) ? $var_62['line'] : 'unknown';
			$var_33 .= sprintf('<tr class="hightlight"><td colspan="2"><b><small>%s</small></b></td><td>%s (%s)</td></tr>',
				fn_2('File'),isset($var_62['file']) ? $var_62['file'] : $last['file'],isset($var_62['line']) ? $var_62['line'] : '');

			$_SESSION['backtrace'][$var_45]['function'] = $var_62['function'];
			$var_33 .= sprintf('<tr><td>&nbsp;</td><td><b><small>%s</small></b></td><td><small>%s',
				fn_2('Function'),$var_62['function']);

			if (isset($var_62['args'])) {
				$var_68 = strlen(serialize($var_62['args'])) < 50 ? htmlspecialchars(serialize($var_62['args'])) : htmlspecialchars(substr(serialize($var_62['args']),0,50)).'...<TRUNCATED>';
				$_SESSION['backtrace'][$var_45]['args'] = $var_62['args'];
				if (file_exists(var_0.'../tools/unserialize.php'))
					$var_33 .= sprintf('&nbsp;(<a href="%s?index=%s" onclick="target=\'backtrace\';">%s</a>)',
						'../tools/unserialize.php',$var_45,$var_68);
				else
					$var_33 .= sprintf('&nbsp;(%s)',$var_68);
			}
			$var_33 .= '</small></td></tr>';
			$var_33 .= "\n";

			if (isset($var_62['file']))
				$last['file'] = $var_62['file'];
		}

		$var_33 .= '</table>';
		$var_33 .= "\n";
		$var_95->SetBody($var_33);

		$var_92['page']->block_add('body',$var_95);
	}

	if ($var_91) {
		$var_92['page']->display(array('tree'=>false));
		die();
	}
}


function fn_13($var_98,$var_73='POST',$var_78=false,$var_99=null,$var_100=false) {
	switch($var_73) {
		case 'GET':
			$var_101 = isset($_GET[$var_98]) ? (is_array($_GET[$var_98]) ? $_GET[$var_98] : (empty($_GET['nodecode'][$var_98]) ? rawurldecode($_GET[$var_98]) : $_GET[$var_98])) : $var_99;
			break;

		case 'REQUEST':
			$var_101 = isset($_REQUEST[$var_98]) ? (is_array($_REQUEST[$var_98]) ? $_REQUEST[$var_98] : (empty($_REQUEST['nodecode'][$var_98]) ? rawurldecode($_REQUEST[$var_98]) : $_REQUEST[$var_98])) : $var_99;
			break;

		case 'SESSION':
			$var_101 = isset($_SESSION[$var_98]) ? (is_array($_SESSION[$var_98]) ? $_SESSION[$var_98] : (empty($_SESSION['nodecode'][$var_98]) ? rawurldecode($_SESSION[$var_98]) : $_SESSION[$var_98])) : $var_99;
			break;

		case 'POST':
		default:
			$var_101 = isset($_POST[$var_98]) ? (is_array($_POST[$var_98]) ? $_POST[$var_98] : (empty($_POST['nodecode'][$var_98]) ? rawurldecode($_POST[$var_98]) : $_POST[$var_98])) : $var_99;
			break;
	}
	
	if ($var_78 && is_null($var_101))
		system_message(array(
			'title'=>fn_2('Generic Error'),
			'body'=>sprintf('%s: Called "%s" without "%s" using "%s"',
				basename($_SERVER['PHP_SELF']),fn_13('cmd','REQUEST',false,null,true),fn_14($var_98),fn_14($var_73)),
			'type'=>'error'),
			'index.php');
	if($var_100 && !is_null($var_101))
		$var_101 = fn_14($var_101);
	return $var_101;
}

function fn_14($var_101){
	return htmlspecialchars(addslashes($var_101), var_102, 'UTF-8');
}

 * var_103 var_104 var_105 var_106.
 * var_107 var_108 var_109 var_110 var_111 as var_112 var_113 var_114 var_115 var_104 var_105 var_106, if var_65 var_116 var_117 var_118 var_119.
 */
function var_5($var_13,$var_90=null) {
	if (! is_array($var_13))
		return null;

	if (! isset($var_13['title']) && ! isset($var_13['body']))
		return null;

	if (! isset($var_13['type']))
		$var_13['type'] = 'info';

	if (! isset($_SESSION['sysmsg']) || ! is_array($_SESSION['sysmsg']))
		$_SESSION['sysmsg'] = array();

	
	if (fn_13('redirect','GET') && $var_13['type'] != 'debug') {
		foreach ($_SESSION['sysmsg'] as $var_120) {
			if ($var_13 == $var_120 && ! isset($var_120['special'])) {
				fn_9(array('Incoming MSG'=>$var_13,'existing'=>$_SESSION['sysmsg']));
				fn_10('Redirect Loop Detected',true);
			}
		}
	}

	array_push($_SESSION['sysmsg'],$var_13);

	if ($var_90) {
		if (preg_match('/\?/',$var_90))
			$var_90 .= '&';
		else
			$var_90 .= '?';
		$var_90 .= 'redirect=true';

		
		if (fn_13('meth','REQUEST') == 'ajax')
			$var_90 .= '&meth=ajax';

		header("Location: $var_90");
		die();
	}
}




function fn_15($var_121,$var_122=null) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	if ($var_122 === null || ! trim($var_122))
		$var_122 = $_SESSION[var_75]->getValue('session','blowfish') ? $_SESSION[var_75]->getValue('session','blowfish') : session_id();

	
	if (! trim($var_122))
		return $var_121;

	if (! empty($var_121) && function_exists('openssl_encrypt') && in_array('bf-ecb', openssl_get_cipher_methods())) {
		$var_123 = openssl_cipher_iv_length('bf-ecb') * 2;
		return openssl_encrypt($var_121, 'bf-ecb', substr($var_122,0,$var_123));
	}

	if (function_exists('mcrypt_module_open') && ! empty($var_121)) {
		$var_124 = mcrypt_module_open(var_125,'',var_126,'');
		$var_127 = mcrypt_create_iv(mcrypt_enc_get_iv_size($var_124),var_128);
		mcrypt_generic_init($var_124,substr($var_122,0,mcrypt_enc_get_key_size($var_124)),$var_127);
		$var_129 = base64_encode(mcrypt_generic($var_124,$var_121));
		mcrypt_generic_deinit($var_124);

		return $var_129;
	}

	if (file_exists(var_0.'blowfish.php'))
	var_4
		return $var_121;

	$var_130 = new class_3;
	$var_131 = '';

	for ($var_47=0; $var_47<strlen($var_121); $var_47+=8) {
		$var_67 = substr($var_121, $var_47, 8);

		if (strlen($var_67) < 8)
			$var_67 = fn_17($var_67,8,"\0", 1);

		$var_131 .= $var_130->encryptBlock($var_67, $var_122);
	}

	return base64_encode($var_131);
}


function fn_16($var_133,$var_122=null) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	static $var_34 = array();

	if (isset($var_34[$var_133]))
		return $var_34[$var_133];

	
	if ($var_122 === null || ! trim($var_122))
		$var_122 = $_SESSION[var_75]->getValue('session','blowfish') ? $_SESSION[var_75]->getValue('session','blowfish') : session_id();

	
	if (! trim($var_122))
		return $var_133;

	if (! empty($var_133) && function_exists('openssl_encrypt') && in_array('bf-ecb', openssl_get_cipher_methods())) {
		$var_123 = openssl_cipher_iv_length('bf-ecb') * 2;
		return trim(openssl_decrypt($var_133, 'bf-ecb', substr($var_122,0,$var_123)));
	}

	if (function_exists('mcrypt_module_open') && ! empty($var_133)) {
		$var_124 = mcrypt_module_open(var_125,'',var_126,'');
		$var_127 = mcrypt_create_iv(mcrypt_enc_get_iv_size($var_124),var_128);
		mcrypt_generic_init($var_124,substr($var_122,0,mcrypt_enc_get_key_size($var_124)),$var_127);
		$var_134 = trim(mdecrypt_generic($var_124,base64_decode($var_133)));
		mcrypt_generic_deinit($var_124);

		return $var_134;
	}

	if (file_exists(var_0.'blowfish.php'))
	var_4
		return $var_133;

	$var_130 = new class_3;
	$var_135 = '';
	$var_121 = base64_decode($var_133);

	for ($var_47=0; $var_47<strlen($var_121); $var_47+=8)
		$var_135 .= $var_130->decryptBlock(substr($var_121, $var_47, 8), $var_122);

	
	$var_137 = preg_replace("/\\0*$/",'',$var_135);
	$var_34[$var_133] = $var_137;
	return $var_137;
}


function fn_17($var_138,$var_139,$var_140='',$var_141=0) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_42 = '';
	$var_142 = $var_139 - strlen($var_138);

	if ($var_142 > 0) { 
		if ($var_141 == var_143) { 
			$var_42 = $var_138.str_repeat($var_140, $var_142);
		} elseif ($var_141 == var_144) { 
			$var_42 = str_repeat($var_140, floor($var_142/2));
			$var_42 .= $var_138;
			$var_42 .= str_repeat($var_140, ceil($var_142/2));
		} else { 
			$var_42 = str_repeat($var_140, $var_142).$var_138;
		}

	} else { 
		$var_42 = $var_138;
	}
	return $var_42;
}


function fn_18($var_145,$var_146,$var_147='null') {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	$var_137 = null;

	
	if ($_SESSION[var_75]->getValue('cache',$var_146) && isset($_SESSION['cache'][$var_145][$var_146][$var_147]))
		$var_137 = $_SESSION['cache'][$var_145][$var_146][$var_147];

	if (var_8)
		fn_12('Returning (%s)',1,0,var_10,var_11,var_6,$var_137);

	return $var_137;
}


function fn_19($var_145,$var_146,$var_147='null',$var_121) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	if ($_SESSION[var_75]->getValue('cache',$var_146)) {
		global $var_34;

		$var_34[$var_145][$var_146][$var_147] = $var_121;
		$_SESSION['cache'][$var_145][$var_146][$var_147] = $var_121;

		return true;

	} else
		return false;
}


function fn_20($var_145,$var_146,$var_147='null') {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	global $var_34;

	
	if (isset($_SESSION['cache'][$var_145][$var_146][$var_147]))
		unset($_SESSION['cache'][$var_145][$var_146][$var_147]);

	if (isset($var_34[$var_145][$var_146][$var_147]))
		unset($var_34[$var_145][$var_146][$var_147]);
}


function fn_21($var_148,$var_149,$var_150=null,$var_151=null) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	$var_137 = false;

	if ($var_150 == null) {
		$var_152 = $_SESSION[var_75]->getValue('session','cookie_time');
		$var_150 = $var_152 == 0 ? null : time() + $var_152;
	}

	if ($var_151 == null)
		$var_151 = dirname($_SERVER['PHP_SELF']);

	if (@setcookie($var_148,$var_149,$var_150,$var_151)) {
		$_COOKIE[$var_148] = $var_149;
		$var_137 = true;
	}

	if (var_8)
		fn_12('Returning (%s)',1,0,var_10,var_11,var_6,$var_137);

	return $var_137;
}


function fn_22($var_145,$var_153,$var_154) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	$var_137 = $var_154.$var_153;
	$var_155 = $_SESSION[var_75]->getServer($var_145);

	$var_157 = $var_155->getValue('custom','pages_prefix');
	if (! is_null($var_157) && is_file(realpath($var_154.$var_157.$var_153)))
		$var_137 = $var_154.$var_157.$var_153;

	if (var_8)
		fn_12('Returning (%s)',1,0,var_10,var_11,var_6,$var_137);

	return $var_137;
}


function fn_23($var_86, $var_158) {
	if (version_compare(phpversion(),'7.0','>=')) {
		
		return eval("return function(".$var_86."){".$var_158."};");

	} else {
		
		return create_function($var_86, $var_158);
	}
}


function fn_24(&$var_121,$var_159,$var_160=0) {
	if (defined('DEBUG_ENABLED') && var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	if (! preg_match('/^[a-zA-Z0-9_]+(\([a-zA-Z0-9_,]*\))?$/',$var_159) || ! $var_121)
		return;

	static $var_34 = array();

	if (empty($var_34[$var_159])) {
		$var_158 = "\$c=0;\n";

		foreach (explode(',',$var_159) as $var_12) {
			$var_158 .= "if (is_object(\$a) || is_object(\$b)) {\n";

			$var_158 .= "	if (is_array(\$a->$var_12)) {\n";
			$var_158 .= "		asort(\$a->$var_12);\n";
			$var_158 .= "		\$aa = array_shift(\$a->$var_12);\n";
			$var_158 .= "	} else\n";
			$var_158 .= "		\$aa = \$a->$var_12;\n";

			$var_158 .= "	if (is_array(\$b->$var_12)) {\n";
			$var_158 .= "		asort(\$b->$var_12);\n";
			$var_158 .= "		\$bb = array_shift(\$b->$var_12);\n";
			$var_158 .= "	} else\n";
			$var_158 .= "		\$bb = \$b->$var_12;\n";

			$var_158 .= "	if (\$aa != \$bb)";
			if ($var_160)
				$var_158 .= "	return (\$aa < \$bb ? 1 : -1);\n";
			else
				$var_158 .= "	return (\$aa > \$bb ? 1 : -1);\n";

			$var_158 .= "} else {\n";

			$var_158 .= "	\$a = array_change_key_case(\$a);\n";
			$var_158 .= "	\$b = array_change_key_case(\$b);\n";

			$var_12 = strtolower($var_12);

			$var_158 .= "	if ((! isset(\$a['$var_12'])) && isset(\$b['$var_12'])) return 1;\n";
			$var_158 .= "	if (isset(\$a['$var_12']) && (! isset(\$b['$var_12']))) return -1;\n";

			$var_158 .= "	if ((isset(\$a['$var_12'])) && (isset(\$b['$var_12']))) {\n";
			$var_158 .= "		if (is_array(\$a['$var_12'])) {\n";
			$var_158 .= "			asort(\$a['$var_12']);\n";
			$var_158 .= "			\$aa = array_shift(\$a['$var_12']);\n";
			$var_158 .= "		} else\n";
			$var_158 .= "			\$aa = \$a['$var_12'];\n";

			$var_158 .= "		if (is_array(\$b['$var_12'])) {\n";
			$var_158 .= "			asort(\$b['$var_12']);\n";
			$var_158 .= "			\$bb = array_shift(\$b['$var_12']);\n";
			$var_158 .= "		} else\n";
			$var_158 .= "			\$bb = \$b['$var_12'];\n";

			$var_158 .= "		if (\$aa != \$bb)\n";
			$var_158 .= "			if (is_numeric(\$aa) && is_numeric(\$bb)) {\n";

			if ($var_160)
				$var_158 .= "				return (\$aa < \$bb ? 1 : -1);\n";
			else
				$var_158 .= "				return (\$aa > \$bb ? 1 : -1);\n";

			$var_158 .= "			} else {\n";

			if ($var_160)
				$var_158 .= "				if ( (\$c = strcasecmp(\$bb,\$aa)) != 0 ) return \$c;\n";
			else
				$var_158 .= "				if ( (\$c = strcasecmp(\$aa,\$bb)) != 0 ) return \$c;\n";

			$var_158 .= "		}\n";
			$var_158 .= "	}\n";
			$var_158 .= "}\n";
		}

		$var_158 .= 'return $c;';

		$var_34[$var_159] = fn_23('$a, $b',$var_158);
	}

	uasort($var_121,$var_34[$var_159]);
}


function fn_25() {
	return (isset($_SESSION[var_75]) && $_SESSION[var_75]->getValue('appearance','compress')
		&& ! ini_get('zlib.output_compression')
		&& preg_match('/gzip/',$_SERVER['HTTP_ACCEPT_ENCODING']));
}




function fn_26($var_161=null) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if ($_SESSION[var_75]->getValue('appearance','obfuscate_password_display'))
		$var_137 = true;

	elseif (! $_SESSION[var_75]->getValue('appearance','show_clear_password') && (is_null($var_161) || $var_161 == 'clear'))
		$var_137 = true;

	else
		$var_137 = false;

	if (var_8)
		fn_12('Returning (%s)',1,0,var_10,var_11,var_6,$var_137);

	return $var_137;
}


function fn_27($var_162) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_163 = $var_162;
	$var_162 = fn_47($var_162);

	if (! $var_162)
		return $var_163;

	foreach ($var_162 as $var_47 => $var_164) {
		$var_164 = htmlspecialchars($var_164);
		$var_164 = explode('=',$var_164,2);
		$var_164 = implode('<span style="color: blue; font-family: courier; font-weight: bold">=</span>',$var_164);
		$var_162[$var_47] = $var_164;
	}

	$var_162 = implode('<span style="color:red; font-family:courier; font-weight: bold;">,</span>',$var_162);

	return $var_162;
}


function fn_28($var_42) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	$var_165 = fn_47($var_42);
	if (! is_array($var_165) || ! count($var_165))
		return false;

	
	foreach ($var_165 as $var_166) {
		if (! strpos($var_166,"="))
			return false;

		$var_167 = explode('=',$var_166,2);
		$var_168 = $var_167[0];
		$var_169 = $var_167[1];

		if ( ! strlen(trim($var_168)) || ! strlen(trim($var_169)))
			return false;

		if (strpos($var_168,'
			return false;
	}

	
	return true;
}


function is_mail_string($str) {
	if (DEBUG_ENABLED && (($fargs=func_get_args())||$fargs='var_170'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_171 = "/^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9-]+)*$/";

	if (preg_match($var_171,$var_42))
		return true;
	else
		return false;
}


function fn_29($var_42) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_172 = '/^(ftp|https?):\/\/+[\w\.\-\/\?\=\&]*\w+/';

	if (preg_match($var_172,$var_42))
		return true;
	else
		return false;
}


function fn_30($var_173,$var_174) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	if (is_array($var_173))
		if (isset($var_173['dn']))
			$var_173 = $var_173['dn'];
		else
			$var_173 = implode('+',$var_173);
	if (is_array($var_174))
		if (isset($var_174['dn']))
			$var_174 = $var_174['dn'];
		else
			$var_174 = implode('+',$var_174);

	
	if (! strcasecmp($var_173,$var_174))
		return 0;

	$var_175 = fn_47(fn_53($var_173));
	$var_176 = fn_47(fn_53($var_174));
	assert(is_array($var_175));
	assert(is_array($var_176));

	
	for ($var_47=0; $var_47 < count($var_175) && $var_47 < count($var_176); $var_47++) {
		
		$var_177 = $var_175[$var_47];
		$var_178 = $var_176[$var_47];

		
		$var_179 = explode('=',$var_177,2);
		$var_180 = explode('=',$var_178,2);

		$var_181 = trim($var_179[0]);
		$var_182 = trim($var_180[0]);

		if (0 != ($var_183 = strcasecmp($var_181,$var_182)))
			return $var_183;

		$var_184 = trim($var_179[1]);
		$var_185 = trim($var_180[1]);
		if (0 != ($var_183 = strcasecmp($var_184,$var_185)))
			return $var_183;
	}

	
	if (count($var_175) > count($var_176)) {
		return 1;

	} elseif (count($var_176) > count($var_175)) {
		return -1;

	} else {
		return 0;
	}
}


function fn_31($var_186,$var_98,$var_187=false,$var_188=false,$var_189=null) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_155 = $_SESSION[var_75]->getServer(fn_13('server_id','REQUEST'));
	$var_98 = strtolower($var_98);
	$var_190 = array();

	if (! $var_155->getValue('auto_number','enable')) {
		system_message(array(
			'title'=>fn_2('AUTO_NUMBER is disabled for this server'),
			'body'=>sprintf('%s (<b>%s</b>)',fn_2('A call was made to get_next_number(), however, it is disabled for this server'),$var_98),
			'type'=>'warn'));

		return false;
	}

	
	if (! $var_155->login($var_155->getValue('auto_number','dn'),$var_155->getValue('auto_number','pass'),'auto_number')) {
		system_message(array(
			'title'=>fn_2('AUTO_NUMBER invalid login/password'),
			'body'=>sprintf('%s (<b>%s</b>)',fn_2('Unable to connect to LDAP server with the auto_number login/password, please check your configuration.'),
				$var_155->getName()),
			'type'=>'warn'));

		return false;
	}

	
	if (! $var_186) {
		$var_190['base'] = $var_155->getValue('auto_number','search_base');

		if (! trim($var_190['base'])) {
			system_message(array(
				'title'=>fn_2('No AUTO_NUMBER search_base configured for this server'),
				'body'=>fn_2('A call was made to get_next_number(), however, the base to search is empty.'),
				'type'=>'warn'));

			return false;
		}

	} else
		$var_190['base'] = $var_186;

	if (! $var_155->dnExists($var_190['base'])) {
		system_message(array(
			'title'=>fn_2('No AUTO_NUMBER search_base exists for this server'),
			'body'=>sprintf('%s (<b>%s</b>)',fn_2('A call was made to get_next_number(), however, the base to search does not exist for this server.'),$var_190['base']),
			'type'=>'warn'));

		return false;
	}

	if (! is_string($var_98) || ! $var_155->getSchemaAttribute($var_98)) {
		system_message(array(
			'title'=>fn_2('AUTO_NUMBER search attribute invalid'),
			'body'=>sprintf('%s (<b>%s</b>)',fn_2('The search attribute for AUTO_NUMBER is invalid, expecting a single valid attribute.'),$var_98),
			'type'=>'warn'));

		return false;
	}

	$var_190['attrs'] = array($var_98);

	
	switch ($var_155->getValue('auto_number','mechanism')) {
		case 'search':
			$var_190['filter'] = sprintf('(%s=*)',$var_98);
			$var_195 = $var_155->query($var_190,'auto_number');

			
			$var_196 = array(0);

			foreach ($var_195 as $var_162 => $var_197) {
				$var_197 = array_change_key_case($var_197);
				foreach ($var_197[$var_98] as $var_101)
					array_push($var_196,$var_101);
			}

			$var_196 = array_unique($var_196);
			sort($var_196);

			
			$var_198 = is_null($var_189) ? intval($var_196[0])+1 : $var_189;

			
			if (count($var_155->getValue('auto_number','min'))) {
				$var_199 = array_change_key_case($var_155->getValue('auto_number','min'));

				if (isset($var_199[$var_98]))
					$var_198 = $var_199[$var_98] > $var_198 ? $var_199[$var_98] : $var_198;
			}

			for ($var_47=0;$var_47<count($var_196);$var_47++) {
				$var_200 = $var_196[$var_47] < $var_198 ? $var_198 : $var_196[$var_47];

				
				if ($var_47+1 == count($var_196) || $var_196[$var_47+1] > $var_200+1)
					return $var_196[$var_47] >= $var_200 ? $var_200+1 : $var_200;
			}

			
			return $var_198;

			break;

		case 'pool':
			switch ($var_98) {
				case 'gidnumber':
					$var_190['filter'] = '(objectClass=gidPool)';

					break;

				case 'uidnumber':
					$var_190['filter'] = '(objectClass=uidPool)';

					break;
			}

			
			if (! empty($var_188))
				$var_190['filter'] = $var_188;

			$var_195 = $var_155->query($var_190,'auto_number');

			switch (count($var_195)) {
				case '1':
					break;

				case '0':
					system_message(array(
						'title'=>fn_2('AUTO_NUMBER pool filter didnt return any DNs'),
						'body'=>sprintf('%s (<b>%s</b>)',fn_2('Please change your filter parameter, or check your auto_number,search_base configuration'),$var_190['filter']),
						'type'=>'warn'));

					return false;

				default:
					system_message(array(
					'title'=>fn_2('AUTO_NUMBER pool filter returned too many DNs'),
						'body'=>sprintf('%s (<b>%s</b>)',fn_2('Please change your filter parameter, or check your auto_number,search_base configuration'),$var_190['filter']),
						'type'=>'warn'));

					return false;
			}

			
			foreach ($var_195 as $var_162 => $var_197) {
				$var_197 = array_change_key_case($var_197);

				$var_196 = $var_197[$var_98][0];
				$var_201 = $var_197['dn'];
			}

			if ($var_187) {
				$var_202 = array($var_98=>$var_196+1);
				$var_155->modify($var_201,$var_202);
			}

			return $var_196;

		
		default:
			system_message(array(
				'title'=>fn_2('Invalid AUTO_NUMBER mechanism'),
				'body'=>sprintf('%s (<b>%s</b>)',fn_2('Your config file specifies an unknown AUTO_NUMBER search mechanism.'),$var_155->getValue('auto_number','mechanism')),
				'type'=>'warn'));

			return false;
	}
}


function fn_32($var_204,$var_162,$var_205=array()) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_155 = $_SESSION[var_75]->getServer($var_204);

	
	if (! count($var_205))
		$var_205 = $var_155->getDNAttrValue($var_162,'objectClass');

	foreach ($var_205 as $var_145 => $var_101)
		$var_205[$var_145] = strtolower($var_101);

	$var_207 = fn_35($var_162);
	$var_208 = explode('=',$var_207,2);
	$var_209 = isset($var_208[0]) ? $var_208[0] : null;
	$var_210 = isset($var_208[1]) ? $var_208[1] : null;
	unset($var_208);

	
	if (in_array('sambaaccount',$var_205) &&
		'$' == $var_207{ strlen($var_207) - 1 })
		return 'nt_machine.png';

	if (in_array('sambaaccount',$var_205))
		return 'nt_user.png';

	elseif (in_array('person',$var_205) ||
		in_array('organizationalperson',$var_205) ||
		in_array('inetorgperson',$var_205) ||
		in_array('account',$var_205) ||
		in_array('posixaccount',$var_205))

		return 'ldap-user.png';

	elseif (in_array('organization',$var_205))
		return 'ldap-o.png';

	elseif (in_array('organizationalunit',$var_205))
		return 'ldap-ou.png';

	elseif (in_array('organizationalrole',$var_205))
		return 'ldap-uid.png';

	elseif (in_array('dcobject',$var_205) ||
		in_array('domainrelatedobject',$var_205) ||
		in_array('domain',$var_205) ||
		in_array('builtindomain',$var_205))

		return 'ldap-dc.png';

	elseif (in_array('alias',$var_205))
		return 'ldap-alias.png';

	elseif (in_array('room',$var_205))
		return 'door.png';

	elseif (in_array('iphost',$var_205))
		return 'host.png';

	elseif (in_array('device',$var_205))
		return 'device.png';

	elseif (in_array('document',$var_205))
		return 'document.png';

	elseif (in_array('country',$var_205)) {
		$var_211 = fn_47($var_162);
		$var_212 = explode('=',$var_211[0],2);
		$var_212 = isset($var_212[1]) ? $var_212[1] : false;
		if ($var_212 && false === strpos($var_212,'..') &&
			file_exists(realpath(sprintf('%s/../countries/%s.png',var_74,strtolower($var_212)))))

			return sprintf('../countries/%s.png',strtolower($var_212));

		else
			return 'country.png';
	}

	elseif (in_array('jammvirtualdomain',$var_205))
		return 'mail.png';

	elseif (in_array('locality',$var_205))
		return 'locality.png';

	elseif (in_array('posixgroup',$var_205) ||
		in_array('groupofnames',$var_205) ||
		in_array('group',$var_205))

		return 'ldap-ou.png';

	elseif (in_array('applicationprocess',$var_205))
		return 'process.png';

	elseif (in_array('groupofuniquenames',$var_205))
		return 'ldap-uniquegroup.png';

	elseif (in_array('nlsproductcontainer',$var_205))
		return 'n.png';

	elseif (in_array('ndspkikeymaterial',$var_205))
		return 'lock.png';

	elseif (in_array('server',$var_205))
		return 'server-small.png';

	elseif (in_array('volume',$var_205))
		return 'hard-drive.png';

	elseif (in_array('ndscatcatalog',$var_205))
		return 'catalog.png';

	elseif (in_array('resource',$var_205))
		return 'n.png';

	elseif (in_array('ldapgroup',$var_205))
		return 'ldap-server.png';

	elseif (in_array('ldapserver',$var_205))
		return 'ldap-server.png';

	elseif (in_array('nisserver',$var_205))
		return 'ldap-server.png';

	elseif (in_array('rbscollection',$var_205))
		return 'ldap-ou.png';

	elseif (in_array('dfsconfiguration',$var_205))
		return 'nt_machine.png';

	elseif (in_array('applicationsettings',$var_205))
		return 'server-settings.png';

	elseif (in_array('aspenalias',$var_205))
		return 'mail.png';

	elseif (in_array('container',$var_205))
		return 'folder.png';

	elseif (in_array('ipnetwork',$var_205))
		return 'network.png';

	elseif (in_array('samserver',$var_205))
		return 'server-small.png';

	elseif (in_array('lostandfound',$var_205))
		return 'find.png';

	elseif (in_array('infrastructureupdate',$var_205))
		return 'server-small.png';

	elseif (in_array('filelinktracking',$var_205))
		return 'files.png';

	elseif (in_array('automountmap',$var_205) ||
		in_array('automount',$var_205))

		return 'hard-drive.png';

	elseif (strpos($var_209,'ipsec') === 0 ||
		strcasecmp($var_209,'IP Security') == 0||
		strcasecmp($var_209,'MSRADIUSPRIVKEY Secret') == 0 ||
		strpos($var_209,'BCKUPKEY_') === 0)

		return 'lock.png';

	elseif (strcasecmp($var_209,'MicrosoftDNS') == 0)
		return 'ldap-dc.png';

	
	else
		return 'ldap-default.png';
}


function fn_33($var_186,$var_213) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_214 = (is_null($var_213) || (($var_215=strlen(trim($var_213))) == 0));

	if ($var_214)
		return $var_186;

	
	elseif ($var_213[$var_215-1] != ',')
		return $var_213;

	else
		return sprintf('%s%s',$var_213,$var_186);
}


function fn_34($var_142) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_216 = '0123456789'.
		'abcdefghijklmnopqrstuvwxyz'.
		'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
		'./';
	$var_42 = '';
	mt_srand((double)microtime() * 1000000);

	while (strlen($var_42) < $var_142)
		$var_42 .= substr($var_216,(rand()%strlen($var_216)),1);

	return $var_42;
}


function fn_35($var_162,$var_217=0,$var_218=false) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (is_null($var_162))
		return null;

	$var_207 = fn_47($var_162,$var_217);
	if (! count($var_207) || ! isset($var_207[0]))
		return $var_162;

	if ($var_218)
		$var_207 = fn_49($var_207[0]);
	else
		$var_207 = $var_207[0];

	return $var_207;
}


function fn_36($var_207) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	$var_219 = explode('\+',$var_207);

	
	foreach ($var_219 as $var_145 => $var_149) {
		if (preg_match('/=/',$var_149))
			$var_220 = $var_145;

		if (! preg_match('/=/',$var_149)) {
			$var_219[$var_220] .= '+'.$var_149;
			unset($var_219[$var_145]);
		}
	}

	return $var_219;
}


function fn_37($var_12) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	static $var_34 = array();

	if (! count($var_34)) {
		$var_221 = var_0.'ldap_error_codes.txt';

		if (! file_exists($var_221) || ! is_readable($var_221) || ! ($var_222 = fopen($var_221,'r')))
			return false;

		$var_223 = fread($var_222,filesize($var_221));
		fclose($var_222);
		$var_224 = array();
		preg_match_all("/0x[A-Fa-f0-9][A-Za-z0-9]\s+[0-9A-Za-z_]+\s+\"[^\"]*\"\n/",
				$var_223,$var_224);

		foreach ($var_224[0] as $var_197) {
			$var_225 = array();
			preg_match("/(0x[A-Za-z0-9][A-Za-z0-9])\s+([0-9A-Za-z_]+)\s+\"([^\"]*)\"/",$var_197,$var_225);

			$var_226 = isset($var_225[1]) ? $var_225[1] : null;
			$var_227 = isset($var_225[2]) ? $var_225[2] : null;
			$var_228 = isset($var_225[3]) ? $var_225[3] : null;
			$var_228 = preg_replace('/\s+/',' ',$var_228);
			$var_34[$var_226] = array('title'=>$var_227,'desc'=>$var_228);
		}
	}

	if (isset($var_34[$var_12]))
		return $var_34[$var_12];
	else
		return array('title' => null,'desc' => null);
}


function fn_38($var_12) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	static $var_34 = array();

	$var_229 = array();
	$var_229['desc'] = 'We have no description for this OID, if you know what this OID provides, please let us know. Please also include an RFC reference if it is available.';
	$var_229['title'] = 'Can you help with this OID info?';

	if (! count($var_34)) {
		$var_221 = var_0.'ldap_supported_oids.txt';

		if (! file_exists($var_221) || ! is_readable($var_221) || ! ($var_222 = fopen($var_221,'r')))
			return false;

		$var_223 = fread($var_222,filesize($var_221));
		fclose($var_222);
		$var_224 = array();
		preg_match_all("/[0-9]\..+\s+\"[^\"]*\"\n/",$var_223,$var_224);

		foreach ($var_224[0] as $var_197) {
			$var_225 = array();
			preg_match("/([0-9]\.([0-9]+\.)*[0-9]+)(\s+\"([^\"]*)\")?(\s+\"([^\"]*)\")?(\s+\"([^\"]*)\")?/",$var_197,$var_225);
			$var_230 = isset($var_225[1]) ? $var_225[1] : null;

			if ($var_230) {
				$var_34[$var_230]['title'] = isset($var_225[4]) ? $var_225[4] : null;
				$var_34[$var_230]['ref'] = isset($var_225[6]) ? $var_225[6] : null;
				$var_228 = isset($var_225[8]) ? $var_225[8] : sprintf('<acronym title="%s">%s</acronym>',$var_229['desc'],$var_229['title']);
				$var_34[$var_230]['desc'] = preg_replace('/\s+/',' ',$var_228);
			}
		}
	}

	if (isset($var_34[$var_12]))
		return $var_34[$var_12];
	else
		return array(
			'title'=>$var_12,
			'ref'=>null,
			'desc'=>sprintf('<acronym title="%s">%s</acronym>',$var_229['desc'],$var_229['title']));
}


function fn_39($var_13,$var_231) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_33 = '<table border="0">';

	$var_231 = ('0x'.str_pad(dechex($var_231),2,0,var_232));
	$var_233 = fn_37($var_231);

	$var_33 .= sprintf('<tr><td><b>%s</b>:</td><td>%s</td></tr>',fn_2('LDAP said'),$var_13);

	if ($var_233) {
		$var_33 .= sprintf('<tr><td><b>%s</b>:</td><td>%s (%s)</td></tr>',fn_2('Error number'),$var_231,$var_233['title']);
		$var_33 .= sprintf('<tr><td><b>%s</b>:</td><td>%s</td></tr>',fn_2('Description'),$var_233['desc']);

	} else {
		$var_33 .= sprintf('<tr><td><b>%s</b>:</td><td>%s</td></tr>',fn_2('Error number'),$var_231);
		$var_33 .= sprintf('<tr><td><b>%s</b>:</td><td>(%s)</td></tr>',fn_2('Description'),fn_2('no description available'));
	}

	$var_33 .= '</table>';

	return $var_33;
}


function fn_40($var_155,$var_162,$var_234='jpegphoto',$var_145,$var_235=false,$var_236=array()) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_237 = array();
	$var_237['width'] = isset($var_236['fixed_width']) ? $var_236['fixed_width'] : false;
	$var_237['height'] = isset($var_236['fixed_height']) ? $var_236['fixed_height'] : false;

	if (is_null($var_155))
		$var_238 = $_SESSION['tmp'];
	else
		$var_238 = $var_155->getDNAttrValues($var_162,null,var_240,array($var_234));

	if (! isset($var_238[$var_234][$var_145]) || ! $var_238[$var_234][$var_145]) {
		system_message(array(
			'title'=>fn_2('Unable to retrieve image'),
			'body'=>sprintf('%s %s',
				fn_2('Could not fetch jpeg data for attribute'),$var_234),
			'type'=>'warn'));

		
		printf('<img src="view_jpeg_photo.php?location=session&attr=%s" alt="Photo" />',$var_234);

		return;
	}

	$var_241 = 0;
	$var_242 = 0;

	if (function_exists('getimagesize')) {
		$var_243 = realpath($_SESSION[var_75]->getValue('jpeg','tmpdir').'/');
		if (! is_writable($var_243))
			system_message(array(
				'title'=>fn_2('Unable to write to jpeg tmp directory'),
				'body'=>fn_2('Please set jpeg,tmpdir to a writable directory in the phpLDAPadmin config.php'),
				'type'=>'warn'));

		else {
			
			$var_244 = tempnam($var_243.'/','pla');
			$var_245 = @file_put_contents($var_244,$var_238[$var_234][$var_145]);

			if (! $var_245) {
				system_message(array(
					'title'=>fn_2('Error writing to jpeg tmp directory'),
					'body'=>sprintf(fn_2('Please check jpeg,tmpdir is a writable directory in the phpLDAPadmin config.php'),$var_243),
					'type'=>'warn'));

			} elseif ($var_245 < 6) {
				system_message(array(
					'title'=>sprintf('%s %s',$var_234,fn_2('contains errors')),
					'body'=>fn_2('It appears that the jpeg image may not be a jpeg image'),
					'type'=>'warn'));

			} else {
				$var_246 = getimagesize($var_244);
				$var_241 = $var_246[0];
				$var_242 = $var_246[1];
			}

			unlink($var_244);
		}
	}

	if ($var_241 > 300) {
		$var_247 = 300 / $var_241;
		$var_248 = 300;
		$var_249 = intval($var_242 * $var_247);

	} else {
		$var_248 = $var_241;
		$var_249 = $var_242;
	}

	$var_250 = sprintf('view_jpeg_photo.php?dn=%s&index=%s&attr=%s',rawurlencode($var_162),$var_145,$var_234);

	printf('<acronym title="%s %s. %s x %s %s.">',number_format($var_245),fn_2('bytes'),$var_241,$var_242,fn_2('pixels'));

	printf('<img src="%s&amp;%s" alt="Photo" %s%s%s />',
		htmlspecialchars($var_250),
		is_null($var_155) ? 'location=session' : sprintf('server_id=%s',$var_155->getIndex()),
		(! $var_248 || $var_237['width'] ? '' : sprintf('width="%s"',$var_248)),
		(! $var_249 || $var_237['height'] ? '' : sprintf('height="%s"',$var_249)),
		(isset($var_236['img_opts']) ? $var_236['img_opts'] : ''));

	

	if ($var_235)
		
		printf('<br/><a href="javascript:deleteAttribute(\'%s\');" style="color:red; font-size: 75%%">%s</a>',
			$var_234,fn_2('Delete photo'));
}


function fn_41() {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	return array(
		''=>'clear',
		'blowfish'=>'blowfish',
		'crypt'=>'crypt',
		'ext_des'=>'ext_des',
		'md5'=>'md5',
		'k5key'=>'k5key',
		'md5crypt'=>'md5crypt',
		'sha'=>'sha',
		'smd5'=>'smd5',
		'ssha'=>'ssha',
		'sha512'=>'sha512',
		'sha256crypt'=>'sha256crypt',
		'sha512crypt'=>'sha512crypt',
	);
}


function fn_42($var_252,$var_253) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_253 = strtolower($var_253);

	switch($var_253) {
		case 'blowfish':
			if (! defined('CRYPT_BLOWFISH') || var_254 == 0)
				fn_7(fn_2('Your system crypt library does not support blowfish encryption.'),'error','index.php');

			
			$var_255 = sprintf('{CRYPT}%s',crypt($var_252,'$2a$12$'.fn_34(13)));

			break;

		case 'crypt':
			if ($_SESSION[var_75]->getValue('password', 'no_random_crypt_salt'))
				$var_255 = sprintf('{CRYPT}%s',crypt($var_252,substr($var_252,0,2)));
			else
				$var_255 = sprintf('{CRYPT}%s',crypt($var_252,fn_34(2)));

			break;

		case 'ext_des':
			
			if (! defined('CRYPT_EXT_DES') || var_256 == 0)
				fn_7(fn_2('Your system crypt library does not support extended DES encryption.'),'error','index.php');

			$var_255 = sprintf('{CRYPT}%s',crypt($var_252,'_'.fn_34(8)));

			break;

		case 'k5key':
			$var_255 = sprintf('{K5KEY}%s',$var_252);

			system_message(array(
				'title'=>fn_2('Unable to Encrypt Password'),
				'body'=>'phpLDAPadmin cannot encrypt K5KEY passwords',
				'type'=>'warn'));

			break;

		case 'md5':
			$var_255 = sprintf('{MD5}%s',base64_encode(pack('H*',md5($var_252))));
			break;

		case 'md5crypt':
			if (! defined('CRYPT_MD5') || var_257 == 0)
				fn_7(fn_2('Your system crypt library does not support md5crypt encryption.'),'error','index.php');

			$var_255 = sprintf('{CRYPT}%s',crypt($var_252,'$1$'.fn_34(9)));

			break;

		case 'sha':
			
			if (function_exists('sha1'))
				$var_255 = sprintf('{SHA}%s',base64_encode(pack('H*',sha1($var_252))));
			elseif (function_exists('mhash'))
				$var_255 = sprintf('{SHA}%s',base64_encode(mhash(var_258,$var_252)));
			else
				fn_7(fn_2('Your PHP install does not have the mhash() function. Cannot do SHA hashes.'),'error','index.php');

			break;

		case 'ssha':
			if (function_exists('mhash') && function_exists('mhash_keygen_s2k')) {
				mt_srand((double)microtime()*1000000);
				$var_259 = mhash_keygen_s2k(var_258,$var_252,substr(pack('h*',md5(mt_rand())),0,8),4);
				$var_255 = sprintf('{SSHA}%s',base64_encode(mhash(var_258,$var_252.$var_259).$var_259));

			} else {
				fn_7(fn_2('Your PHP install does not have the mhash() or mhash_keygen_s2k() function. Cannot do S2K hashes.'),'error','index.php');
			}

			break;

		case 'smd5':
			if (function_exists('mhash') && function_exists('mhash_keygen_s2k')) {
				mt_srand((double)microtime()*1000000);
				$var_259 = mhash_keygen_s2k(var_260,$var_252,substr(pack('h*',md5(mt_rand())),0,8),4);
				$var_255 = sprintf('{SMD5}%s',base64_encode(mhash(var_260,$var_252.$var_259).$var_259));

			} else {
				fn_7(fn_2('Your PHP install does not have the mhash() or mhash_keygen_s2k() function. Cannot do S2K hashes.'),'error','index.php');
			}

			break;

		case 'sha512':
			if (function_exists('openssl_digest') && function_exists('base64_encode')) {
				$var_255 = sprintf('{SHA512}%s', base64_encode(openssl_digest($var_252, 'sha512', true)));

			} else {
				fn_7(fn_2('Your PHP install doest not have the openssl_digest() or base64_encode() function. Cannot do SHA512 hashes. '),'error','index.php');
			}

			break;

		case 'sha256crypt':
			if (! defined('CRYPT_SHA256') || var_261 == 0)
				fn_7(fn_2('Your system crypt library does not support sha256crypt encryption.'),'error','index.php');
			$var_255 = sprintf('{CRYPT}%s',crypt($var_252,'$5$'.fn_34(8)));

			break;

		case 'sha512crypt':
			if (! defined('CRYPT_SHA512') || var_262 == 0)
				fn_7(fn_2('Your system crypt library does not support sha512crypt encryption.'),'error','index.php');
			$var_255 = sprintf('{CRYPT}%s',crypt($var_252,'$6$'.fn_34(8)));

			break;

		case 'clear':
		default:
			$var_255 = $var_252;
	}

	return $var_255;
}


function fn_43($var_263,$var_264,$var_265='userpassword') {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (in_array($var_265,array('sambalmpassword','sambantpassword'))) {
		$var_266 = new class_4;

		switch($var_265) {
			case 'sambalmpassword':
				if (strcmp($var_266->lmhash($var_264),strtoupper($var_263)) == 0)
					return true;
				else
					return false;

			case 'sambantpassword':
				if (strcmp($var_266->nthash($var_264),strtoupper($var_263)) == 0)
					return true;
				else
					return false;
		}

		return false;
	}

	if (preg_match('/{([^}]+)}(.*)/',$var_263,$var_43)) {
		$var_263 = $var_43[2];
		$var_269 = strtolower($var_43[1]);

	} else {
		$var_269 = null;
	}

	switch($var_269) {
		
		case 'ssha':
			
			if (function_exists('mhash')) {
				$var_270 = base64_decode($var_263);

				
				$var_259 = substr($var_270,20);
				$var_271 = base64_encode(mhash(var_258,$var_264.$var_259).$var_259);

				if (strcmp($var_263,$var_271) == 0)
					return true;
				else
					return false;

			} else {
				fn_7(fn_2('Your PHP install does not have the mhash() function. Cannot do SHA hashes.'),'error','index.php');
			}

			break;

		
		case 'smd5':
			
			if (function_exists('mhash')) {
				$var_270 = base64_decode($var_263);
				$var_259 = substr($var_270,16);
				$var_271 = base64_encode(mhash(var_260,$var_264.$var_259).$var_259);

				if (strcmp($var_263,$var_271) == 0)
					return true;
				else
					return false;

			} else {
				fn_7(fn_2('Your PHP install does not have the mhash() function. Cannot do SHA hashes.'),'error','index.php');
			}

			break;

		
		case 'sha':
			if (strcasecmp(fn_42($var_264,'sha'),'{SHA}'.$var_263) == 0)
				return true;
			else
				return false;

			break;

		
		case 'md5':
			if( strcasecmp(fn_42($var_264,'md5'),'{MD5}'.$var_263) == 0)
				return true;
			else
				return false;

			break;

		
		case 'crypt':
			
			if (preg_match('/^\\$2+/',$var_263)) {

				
				if (! defined('CRYPT_BLOWFISH') || var_254 == 0)
					fn_7(fn_2('Your system crypt library does not support blowfish encryption.'),'error','index.php');

				list($var_36,$var_272,$var_273) = explode('$',$var_263);

				if (crypt($var_264,'$'.$var_36.'$'.$var_272.'$'.$var_273) == $var_263)
					return true;
				else
					return false;
			}

			
			elseif (strstr($var_263,'$1$')) {

				
				if (! defined('CRYPT_MD5') || var_257 == 0)
					fn_7(fn_2('Your system crypt library does not support md5crypt encryption.'),'error','index.php');

				list($var_274,$var_73,$var_259,$var_270) = explode('$',$var_263);

				if (crypt($var_264,'$1$'.$var_259) == $var_263)
					return true;
				else
					return false;
			}

			
			elseif (strstr($var_263,'_')) {

				
				if (! defined('CRYPT_EXT_DES') || var_256 == 0)
					fn_7(fn_2('Your system crypt library does not support extended DES encryption.'),'error','index.php');

				if (crypt($var_264,$var_263) == $var_263)
					return true;
				else
					return false;
			}

			
			else {

				if (crypt($var_264,$var_263) == $var_263)
					return true;
				else
					return false;
			}

			break;

		
		case 'sha512':
			if (strcasecmp(fn_42($var_264,'sha512'),'{SHA512}'.$var_263) == 0)
				return true;
			else
				return false;

			break;

		
		default:
			if ($var_264 == $var_263)
				return true;
			else
				return false;
	}
}


function fn_44($var_275) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	$var_253 = null;

	if (preg_match('/{([^}]+)}/',$var_275,$var_253))
		$var_253 = strtolower($var_253[1]);
	else
		return null;

	
	if (strcasecmp($var_253,'crypt') == 0) {

		
		if (preg_match('/{[^}]+}\\$1\\$+/',$var_275))
			$var_253 = 'md5crypt';

		elseif (preg_match('/{[^}]+}\\$2+/',$var_275))
			$var_253 = 'blowfish';

		elseif (preg_match('/{[^}]+}_+/',$var_275))
			$var_253 = 'ext_des';
	}

	return $var_253;
}


function fn_45($var_276,$var_164,$var_277=true,$var_207='none') {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_250 = sprintf("javascript:dnChooserPopup('%s','%s','%s');",$var_276,$var_164,$var_207 == 'none' ? '' : rawurlencode($var_207));
	$var_227 = fn_2('Click to popup a dialog to select an entry (DN) graphically');

	printf('<a href="%s" title="%s"><img class="chooser" src="%s/find.png" alt="Find" /></a>',$var_250,$var_227,var_74);

	if ($var_277)
		printf('<span class="x-small"><a href="%s" title="%s">%s</a></span>',$var_250,$var_227,fn_2('browse'));
}


function fn_46($var_162,$var_278) {
	$var_279 = ldap_explode_dn($var_162,$var_278);
	if (! $var_279)
		return null;

	
	foreach ($var_279 as $var_12 => $var_101) {
		$var_279[$var_12] = preg_replace_callback(
			"/\\\([0-9A-Fa-f]{2})/",
			function ($var_43) {
				return chr(hexdec($var_43[1]));
			},
			$var_101
		);
	}

	return $var_279;
}


function fn_47($var_162,$var_280=0) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	global $var_34;

	if (isset($var_34['explode'][$var_162][$var_280])) {
		if (var_8)
			fn_12('Return CACHED result (%s) for (%s)',1,0,var_10,var_11,var_6,
				$var_34['explode'][$var_162][$var_280],$var_162);

		return $var_34['explode'][$var_162][$var_280];
	}

	$var_162 = addcslashes($var_162,'<>+";');

	
	$var_279[0] = fn_46(fn_48($var_162),0);
	$var_279[1] = fn_46(fn_48($var_162),1);
	if (! $var_279[$var_280]) {
		if (var_8)
			fn_12('Returning NULL - NO result.',1,0,var_10,var_11,var_6);

		return array();
	}

	
	unset($var_279[0]['count']);
	unset($var_279[1]['count']);

	
	foreach ($var_279 as $var_12 => $var_101) {
		
		$var_279[$var_12] = fn_49($var_101);

		$var_34['explode'][implode(',',$var_279[0])][$var_12] = $var_279[$var_12];
		$var_34['explode'][implode(',',array_reverse($var_279[0]))][$var_12] = array_reverse($var_279[$var_12]);
	}

	if (var_8)
		fn_12('Returning (%s)',1,0,var_10,var_11,var_6,$var_279[$var_280]);

	return $var_279[$var_280];
}


function fn_48($var_162) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_281 = $var_162;

	
	while (preg_match('/([^\\\\]),(\s*[^=]*\s*),/',$var_162))
		$var_162 = preg_replace('/([^\\\\]),(\s*[^=]*\s*),/','$1\\\\2C$2,',$var_162);

	$var_162 = preg_replace('/([^\\\\]),(\s*[^=]*\s*)([^,])$/','$1\\\\2C$2$3',$var_162);

	if (var_8)
		fn_12('Returning (%s)',1,0,var_10,var_11,var_6,$var_162);

	return $var_162;
}


function fn_49($var_162) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (is_array($var_162)) {
		$var_104 = array();

		foreach ($var_162 as $var_12 => $var_207)
			$var_104[$var_12] = preg_replace_callback('/\\\([0-9A-Fa-f]{2})/',
				function ($var_282) {
					return chr(hexdec($var_282[1]));
				},
				$var_207
			);

		return $var_104;

	} else {
		return preg_replace_callback('/\\\([0-9A-Fa-f]{2})/',
			function ($var_282) {
				return chr(hexdec($var_282[1]));
			},
			$var_162
		);
	}
}


function fn_50($var_73,$var_283='') {
	$var_284 = 'http:

	switch($type) {
		case 'var_285':
			return 'https:
		case 'var_286':
			return 'https:
		case 'var_287':
			return sprintf('%s/Credits',$var_284);
		var_288 'documentation':
			return sprintf('%s/Documentation',$var_284);
		var_288 'donate':
			return 'https:
		case 'var_289':
			return 'https:
		case 'var_290':
			return sprintf('%s',$var_284);
		var_99:
			return null;
	}
}


function fn_51() {
	$var_291 = explode(' ',microtime());
	$var_292 = (double)$var_291[0];
	$var_293 = (double)$var_291[1];
	return $var_293 + $var_292;
}


function fn_52($var_7,$var_294=array()) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (! is_array($var_7) || ! count($var_7))
		return '';

	$var_42 = '';
	$var_47 = 0;
	foreach ($var_7 as $var_148 => $var_149)
		if (! in_array($var_148,$var_294))
			if (is_array($var_149))
				foreach ($var_149 as $var_295) {
					if ($var_47++ > 0)
						$var_42 .= '&';

					$var_42 .= sprintf('%s[]=%s',rawurlencode($var_148),rawurlencode($var_295));
				}

			else {
				if ($var_47++ > 0)
					$var_42 .= '&';

				$var_42 .= sprintf('%s=%s',rawurlencode($var_148),rawurlencode($var_149));
			}

	return $var_42;
}


function fn_53($var_162) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	return (implode(',',array_reverse(fn_47($var_162))));
}


function fn_54($var_104,$var_48) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if ($var_104 == $var_48)
		return 0;

	$var_155 = $_SESSION[var_75]->getServer(fn_13('server_id','REQUEST'));
	$var_296 = fn_55($_SESSION[var_75]->getValue('appearance','attr_display_order'));

	
	$var_297 = array_search($var_104->getName(),$var_296);
	$var_298 = array_search($var_48->getName(),$var_296);

	if ((! $var_297) && ($var_297 !== 0))
		if ((! $var_297 = array_search(strtolower($var_104->getFriendlyName()),$var_296)) && ($var_297 !== 0))
			$var_297 = count($var_296)+1;

	if ((! $var_298) && ($var_298 !== 0))
		if ((! $var_298 = array_search(strtolower($var_48->getFriendlyName()),$var_296)) && ($var_298 !== 0))
			$var_298 = count($var_296)+1;

	
	
	if ($var_297 === $var_298)
		return strcasecmp($var_104->getFriendlyName(),$var_48->getFriendlyName());

	
	
	return ($var_297 < $var_298) ? -1 : 1;
}


function fn_55($var_7) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (! is_array($var_7))
		return $var_7;

	$var_300 = array();
	foreach ($var_7 as $var_12 => $var_101)
		$var_300[$var_12] = strtolower($var_101);

	return $var_300;
}


function fn_56($var_301,$var_302) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (! is_array($var_302))
		return false;

	if (! is_string($var_301))
		return false;

	$var_137 = false;

	foreach ($var_302 as $var_164) {
		if (is_string($var_164) && (strcasecmp($var_301,$var_164) == 0)) {
			$var_137 = true;
			break;
		}
	}

	if (var_8)
		fn_12('Returning (%s)',1,0,var_10,var_11,var_6,$var_137);

	return $var_137;
}


function fn_57($var_155,$var_225) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_162 = $var_225->getDn();

	$var_304 = $_SESSION[var_75]->getValue('appearance','tree_display_format');

	foreach ($var_304 as $var_305) {
		$var_306 = false;
		preg_match_all('/%[a-zA-Z_0-9]+/',$var_305,$var_307);
		$var_307 = $var_307[0];

		if (var_8)
			fn_12('The tokens are (%s)',1,0,var_10,var_11,var_6,$var_307);

		foreach ($var_307 as $var_308) {
			if (strcasecmp($var_308,'%dn') == 0)
				$var_305 = str_replace($var_308,fn_27($var_162),$var_305);

			elseif (strcasecmp($var_308,'%rdn') == 0)
				$var_305 = str_replace($var_308,fn_27($var_225->getRDN()),$var_305);

			elseif (strcasecmp($var_308,'%rdnvalue') == 0) {
				$var_207 = fn_35($var_162,0,true);
				$var_209 = explode('=',$var_207,2);
				$var_209 = $var_209[1];
				$var_305 = str_replace($var_308,$var_209,$var_305);

			} else {
				$var_234 = str_replace('%','',$var_308);
				$var_310 = $var_155->getDNAttrValue($var_162,$var_234);

				if (is_null($var_310) || (count($var_310) <= 0)) {
					$var_68 = '&lt;'.fn_2('none').'&gt;';
					$var_306 = true;

				} elseif (is_array($var_310))
					$var_68 = implode(', ',$var_310);

				else
					$var_68 = $var_310;

				$var_305 = str_replace($var_308,$var_68,$var_305);
			}
		}

		
		if (!$var_306)
			return $var_305;
	}

	return $var_305;
}


function fn_58($var_311=null,$var_312=false,$var_148='index',$var_313=true,$var_314=null) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_315 = 0;
	$var_316 = sprintf('<select name="%s" id="%s" %s>',$var_148,$var_148,$var_314);

	foreach ($_SESSION[var_75]->getServerList($var_313) as $var_145 => $var_155) {
		if ($var_155->isVisible()) {

			if ($var_312 && ! $var_155->isLoggedIn())
				continue;

			$var_315++;
			$var_316 .= sprintf('<option value="%s" %s>%s</option>',
				$var_155->getIndex(),($var_155->getIndex() == $var_311 ? 'selected="selected"' : ''),$var_155->getName());

			
			$var_319 = $var_155;
		}
	}

	$var_316 .= '</select>';

	if ($var_315 > 1)
		return $var_316;

	elseif ($var_315)
		return sprintf('%s <input type="hidden" name="%s" value="%s" />',
			$var_319->getName(),$var_148,$var_319->getIndex());

	else
		return '';
}


function fn_59($var_320) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_279 = '';

	for ($var_321=strlen($var_320)-2;$var_321>= 0;$var_321=$var_321-2)
		$var_279 .= substr($var_320,$var_321,2);

	return $var_279;
}

function fn_60($var_322) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_323 = bin2hex($var_322);
	$var_160 = hexdec(substr($var_323,0,2)); 
	$var_324 = hexdec(substr($var_323,2,2)); 
	$var_325 = hexdec(substr($var_323,4,12)); 

	$var_279 = "$var_160-$var_325";

	for ($var_321=0;$var_321<$var_324;$var_321++) {
		$subauth[$var_321] = hexdec(fn_59(substr($var_323,16+($var_321*8),8))); 
		$var_279 .= sprintf('-%s',$subauth[$var_321]);
	}

	return $var_279;
}


function fn_61($var_186,$var_188,$var_12,$var_326,$var_327=true) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_155 = $_SESSION[var_75]->getServer(fn_13('server_id','REQUEST'));
	$var_12 = strtolower($var_12);

	$var_190 = array();
	$var_190['base'] = $var_186;
	$var_190['filter'] = $var_188;
	$var_190['attrs'] = $var_326;
	$var_195 = $var_155->query($var_190,null);

	$var_328 = array();

	foreach ($var_195 as $var_162 => $var_197)
		if (isset($var_197[$var_12]))
			if (is_array($var_197[$var_12]))
				foreach ($var_197[$var_12] as $var_47 => $var_329)
					foreach ($var_326 as $var_98) {
						$var_330 = strtolower($var_98);
						if (isset($var_197[$var_330])) {
							$var_295 = '';

							if (is_array($var_197[$var_330]) && isset($var_197[$var_330][$var_47]))
								$var_295 = $var_197[$var_330][$var_47];

							if (is_string($var_295) && (strlen($var_295) > 0))
								$var_328[$var_329][$var_98] = $var_295;
						}
					}

			else
				foreach ($var_326 as $var_98) {
					$var_330 = strtolower($var_98);
					if (isset($var_197[$var_330]))
						$var_328[$var_197[$var_12]][$var_98] = $var_197[$var_330];
				}

	if ($var_327)
		fn_24($var_328,is_array($var_327) ? implode(',',$var_327) : 'dn');

	return $var_328;
}


function var_331() {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_332 = ! $_SESSION[var_75]->getValue('password','use_similar');
	$var_333 = $_SESSION[var_75]->getValue('password','lowercase');
	$var_334 = $_SESSION[var_75]->getValue('password','uppercase');
	$var_335 = $_SESSION[var_75]->getValue('password','numbers');
	$var_336 = $_SESSION[var_75]->getValue('password','punctuation');
	$var_142 = $_SESSION[var_75]->getValue('password','length');

	$var_337 = array();

	if ($var_332) {
		$var_338 = 'a b c d e f g h k m n p q r s t u v w x y z';
		$var_339 = '2 3 4 5 6 7 8 9';
		$var_340 = '

	} else {
		$raw_lower = 'var_104 var_48 var_341 var_342 var_343 var_222 var_344 var_345 var_47 var_346 var_329 var_347 var_348 var_349 var_350 var_351 var_352 var_282 var_49 var_353 var_354 var_295 var_355 var_321 var_356 var_357';
		$var_339 = '1 2 3 4 5 6 7 8 9 0';
		$var_340 = '
	}

	$llower = explode(' ',$var_338);
	shuffle($var_358);
	$var_359 = explode(' ',strtoupper($var_338));
	shuffle($var_359);
	$var_360 = explode(' ',$var_339);
	shuffle($var_360);
	$var_361 = explode(' ',$var_340);
	shuffle($var_361);

	if ($var_333 > 0)
		$var_337 = array_merge($var_337,fn_62($var_358,$var_333));

	if ($var_334 > 0)
		$var_337 = array_merge($var_337,fn_62($var_359,$var_334));

	if ($var_335 > 0)
		$var_337 = array_merge($var_337,fn_62($var_360,$var_335));

	if ($var_336 > 0)
		$var_337 = array_merge($var_337,fn_62($var_361,$var_336));

	$var_362 = $var_333 + $var_334 + $var_335 + $var_336;

	if ($var_362 < $var_142) {
		$var_363 = array();
		if ($var_333 > 0)
			$var_363 = array_merge($var_363,$var_358);
		if ($var_334 > 0)
			$var_363 = array_merge($var_363,$var_359);
		if ($var_335 > 0)
			$var_363 = array_merge($var_363,$var_360);
		if ($var_336 > 0)
			$var_363 = array_merge($var_363,$var_361);

		if (count($var_363) == 0)
			$var_363 = array_merge($var_363,$var_358,$var_359,$var_360,$var_361);

		shuffle($var_363);
		$var_337 = array_merge($var_337,fn_62($var_363,$var_142-$var_362));
	}

	shuffle($var_337);
	$var_137 = implode('',$var_337);

	if (var_8)
		fn_12('Returning (%s)',1,0,var_10,var_11,var_6,$var_137);

	return $var_137;
}


function fn_62($var_138,$var_364) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (count($var_138) == 0)
		return array();

	if ($var_364 < 1)
		return array();

	$var_137 = array();
	if ($var_364 > count($var_138)) {
		for($var_47 = 0; $var_47 < $var_364; $var_47++) {
			$var_365 = array_rand($var_138,1);
			$var_137[] = $var_138[$var_365];
		}

	} else {
		$var_366 = array_rand($var_138,$var_364);
		if ($var_364 == 1)
			$var_366 = array($var_366);

		for($var_47 = 0; $var_47 < count($var_366); $var_47++)
			$var_137[] = $var_138[$var_366[$var_47]];
	}

	if (var_8)
		fn_12('Returning (%s)',1,0,var_10,var_11,var_6,$var_137);

	return $var_137;
}


function fn_63() {
	$var_291 = gettimeofday();
	return md5(strtotime('now').$var_291['usec']);
}


function fn_64($var_367,$var_162) {
	return sprintf('SID%s:%s',$var_367,preg_replace('/[\ =,]/','_',$var_162));
}


function fn_65() {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_12('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (isset($_SESSION[var_75]))
		return ($_SESSION[var_75]->getValue('appearance','tree') == 'AJAXTree');
	else
		return false;
}
?>
