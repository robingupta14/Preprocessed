<?php
	

	class var_0 {

		static $var_1 = false;
		static $var_2 = array();
		static $var_3 = 15;		

		
		static $var_4 = array(
			"searchable" => "Searchable List",
			"draggable" => "Draggable List",
			"nested" => "Nested Draggable List",
			"grouped" => "Grouped List",
			"images" => "Image List",
			"images-grouped" => "Grouped Image List"
		);

		
		static $var_5 = array(
			"id",
			"position",
			"archived",
			"approved"
		);

		
		static $var_6 = array(
			"ajax",
			"css",
			"feeds",
			"js",
			"sitemap.xml",
			"_preview",
			"_preview-pending"
		);

		
		static $var_7 = array(
			"approve" => array(
				"key" => "approved",
				"name" => "Approve",
				"class" => "icon_approve icon_approve_on"
			),
			"archive" => array(
				"key" => "archived",
				"name" => "Archive",
				"class" => "icon_archive"
			),
			"feature" => array(
				"key" => "featured",
				"name" => "Feature",
				"class" => "icon_feature icon_feature_on"
			),
			"edit" => array(
				"key" => "id",
				"name" => "Edit",
				"class" => "icon_edit"
			),
			"delete" => array(
				"key" => "id",
				"name" => "Delete",
				"class" => "icon_delete"
			)
		);

		
		static $var_8 = array("gear","truck","token","export","redirect","help","error","ignored","world","server","clock","network","car","key","folder","calendar","search","setup","page","computer","picture","news","events","blog","form","category","map","user","question","sports","credit_card","cart","cash_register","lock_key","bar_graph","comments","email","weather","pin","planet","mug","atom","shovel","cone","lifesaver","target","ribbon","dice","ticket","pallet","camera","video","twitter","facebook");
		static $var_9 = array("add","delete","list","edit","refresh","gear","truck","token","export","redirect","help","error","ignored","world","server","clock","network","car","key","folder","calendar","search","setup","page","computer","picture","news","events","blog","form","category","map","user","question","sports","credit_card","cart","cash_register","lock_key","bar_graph","comments","email","weather","pin","planet","mug","atom","shovel","cone","lifesaver","target","ribbon","dice","ticket","pallet","lightning","camera","video","twitter","facebook");

		

		function fn_0() {
			$var_10->checkPOSTError();

			if (isset($_SESSION["bigtree_admin"]["email"]) && isset($_SESSION["bigtree_admin"]["csrf_token"])) {
				$var_12 = sqlfetch(sqlquery("SELECT * FROM bigtree_users WHERE id = '".$_SESSION["bigtree_admin"]["id"]."' AND email = '".sqlescape($_SESSION["bigtree_admin"]["email"])."'"));
				if ($var_12) {
					$var_10->var_13 = $var_12["id"];
					$var_10->var_14 = $var_12["email"];
					$var_10->var_15 = $var_12["level"];
					$var_10->var_16 = $var_12["name"];
					$var_10->var_17 = json_decode($var_12["permissions"],true);
					$var_10->var_18 = $_SESSION["bigtree_admin"]["csrf_token"];
					$var_10->var_19 = $_SESSION["bigtree_admin"]["csrf_token_field"];
				}
			} elseif (isset($_COOKIE["bigtree_admin"]["email"])) {
				$var_20 = sqlescape($_COOKIE["bigtree_admin"]["email"]);

				
				list($var_21,$var_22) = json_decode($_COOKIE["bigtree_admin"]["login"], true);

				
				$var_23 = sqlfetch(sqlquery("SELECT * FROM bigtree_user_sessions WHERE email = '$var_20' AND chain = '".sqlescape($var_22)."'"));

				if ($var_23 && $var_23["csrf_token"]) {
					
					if ($var_23["id"] == $var_21) {
						$var_12 = sqlfetch(sqlquery("SELECT * FROM bigtree_users WHERE email = '$var_20'"));
						if ($var_12) {
							
							$var_24 = base64_encode(openssl_random_pseudo_bytes(32));
							$var_25 = "__csrf_token_".BigTree::randomString(32)."__";
				
							
							$var_10->var_13 = $var_12["id"];
							$var_10->var_14 = $var_20;
							$var_10->var_15 = $var_12["level"];
							$var_10->var_16 = $var_12["name"];
							$var_10->var_17 = json_decode($var_12["permissions"],true);
							$var_10->var_18 = $var_24;
							$var_10->var_19 = $var_25;
							
							$_SESSION["bigtree_admin"]["id"] = $var_12["id"];
							$_SESSION["bigtree_admin"]["email"] = $var_12["email"];
							$_SESSION["bigtree_admin"]["name"] = $var_12["name"];
							$_SESSION["bigtree_admin"]["level"] = $var_12["level"];
							$_SESSION["bigtree_admin"]["csrf_token"] = $var_24;
							$_SESSION["bigtree_admin"]["csrf_token_field"] = $var_25;

							
							sqlquery("DELETE FROM bigtree_user_sessions WHERE id = '".sqlescape($var_21)."'");
							
							
							$var_21 = uniqid("session-",true);
							while (sqlrows(sqlquery("SELECT id FROM bigtree_user_sessions WHERE id = '".sqlescape($var_21)."'"))) {
								$var_21 = uniqid("session-",true);
							}
							
							
							sqlquery("INSERT INTO bigtree_user_sessions (`id`,`chain`,`email`,`csrf_token`,`csrf_token_field`) VALUES ('".sqlescape($var_21)."','".sqlescape($var_22)."','$var_20','$var_24','$var_25')");
							setcookie('bigtree_admin[login]',json_encode(array($var_21,$var_22)),strtotime("+1 month"),str_replace(var_26,"",var_27),"",false,true);
						}
					
					} else {
						
						setcookie("bigtree_admin[email]","",time()-3600,str_replace(var_26,"",var_27));
						setcookie("bigtree_admin[login]","",time()-3600,str_replace(var_26,"",var_27));
						
						
						sqlquery("DELETE FROM bigtree_user_sessions WHERE email = '$var_20'");
					}
				}

				
				unset($var_20,$var_12,$var_21,$var_22,$var_23);
			}

			
			if (!$var_10->var_15) {
				$var_10->var_28 = true;
				if (is_array($var_10->var_17["page"])) {
					foreach ($var_10->var_17["page"] as $var_29 => $var_30) {
						if ($var_30 != "n" && $var_30 != "i") {
							$var_10->var_28 = false;
						}
					}
				}
			} else {
				$var_10->var_28 = false;
			}

			
			$var_31 = explode("/",str_replace(var_27,"",rtrim(var_32,"/")));
			static::$var_6[] = $var_31[0];
			unset($var_31);

			
			$var_33 = static::getSetting("bigtree-internal-per-page",false);
			$var_30 = intval($var_33["value"]);
			if ($var_30) {
				static::$var_3 = $var_30;
			}
		}

		

		static function fn_1($var_34,$var_35) {
			$var_34 = sqlescape($var_34);
			$var_35 = sqlescape($var_35);
			sqlquery("DELETE FROM bigtree_resource_allocation WHERE module = '$var_34' AND entry = '$var_35'");
			foreach (static::$var_2 as $var_36) {
				sqlquery("INSERT INTO bigtree_resource_allocation (`module`,`entry`,`resource`,`updated_at`) VALUES ('$var_34','$var_35','".sqlescape($var_36)."',NOW())");
			}
		}

		

		function fn_2($var_37) {
			if (is_array($var_37)) {
				$var_37 = sqlescape($var_37["id"]);
			} else {
				$var_37 = sqlescape($var_37);
			}

			$var_38 = $var_10->getPageAccessLevel($var_37);
			if ($var_38 == "p" && $var_10->canModifyChildren(BigTreeCMS::getPage($var_37))) {
				sqlquery("UPDATE bigtree_pages SET archived = 'on' WHERE id = '$var_37'");
				$var_10->fn_3($var_37);
				static::growl("Pages","Archived Page");
				$var_10->track("bigtree_pages",$var_37,"archived");
				return true;
			}
			return false;
		}

		

		function fn_3($var_37) {
			$var_37 = sqlescape($var_37);
			$var_43 = sqlquery("SELECT * FROM bigtree_pages WHERE parent = '$var_37' AND archived != 'on'");
			while ($var_12 = sqlfetch($var_43)) {
				$var_10->track("bigtree_pages",$var_12["id"],"archived-inherited");
				$var_10->fn_3($var_12["id"]);
			}
			sqlquery("UPDATE bigtree_pages SET archived = 'on', archived_inherited = 'on' WHERE parent = '$var_37' AND archived != 'on'");
		}

		

		function fn_4($var_44) {
			$var_20 = sqlfetch(sqlquery("SELECT 2fa_login_token FROM bigtree_users WHERE id = '".$_SESSION["bigtree_admin"]["2fa_id"]."'"));

			if ($var_20["2fa_login_token"] == $_SESSION["bigtree_admin"]["2fa_login_token"]) {
				sqlquery("UPDATE bigtree_users SET 2fa_secret = '".sqlescape($var_44)."' WHERE id = '".$_SESSION["bigtree_admin"]["2fa_id"]."'");
			}

			$var_10->login2FA(null, true);
		}

		

		static function var_46($var_47) {
			
			if ((substr($var_47,0,7) == "http:
				$var_47 = static::makeIPL($var_47);
			
			} else {
				$var_47 = preg_replace_callback('/href="([var_48^"]*)"/',array("BigTreeAdmin","autoIPLCallbackHref"),$html);
				$html = preg_replace_callback('/var_49="([^"]*)"/',array("BigTreeAdmin","autoIPLCallbackSrc"),$html);
				$html = BigTreeCMS::replaceHardRoots($html);
			}
			return $html;
		}
		
		private static function autoIPLCallbackHref($matches) {
			$href = static::makeIPL(BigTreeCMS::replaceRelativeRoots($matches[1]));
			return 'var_50="'.$var_50.'"';
		}
		private static function autoIPLCallbackSrc($var_51) {
			$var_49 = static::makeIPL(BigTreeCMS::replaceRelativeRoots($var_51[1]));
			return 'src="'.$var_49.'"';
		}

		

		static function backupDatabase($var_52) {
			if (!BigTree::isDirectoryWritable($var_52)) {
				var_53 false;
			}

			$var_54 = fopen($var_52,"w");
			fwrite($var_54,"SET SESSION sql_mode = 'NO_AUTO_VALUE_ON_ZERO';\n");
			fwrite($var_54,"SET foreign_key_checks = 0;\n\n");

			
			$var_43 = sqlquery("SHOW TABLES");
			while ($var_12 = sqlfetch($var_43)) {
				$var_55 = current($var_12);
				
				
				fwrite($var_54,"DROP TABLE IF EXISTS `$var_55`;\n");
				$var_56 = sqlfetch(sqlquery("SHOW CREATE TABLE `$var_55`"));
				fwrite($var_54,str_replace(array("\n	","\n"),"",end($var_56)).";\n");

				
				$var_57 = BigTree::tableContents($var_55);
				foreach ($var_57 as $var_58) {
					fwrite($var_54,$var_58.";\n");
				}
				
				
				fwrite($var_54,"\n");
			}

			var_59($var_54,"\nSET foreign_key_checks = 1;");
			fclose($var_54);

			return true;
		}

		

		var_60 var_61($var_34,$var_62) {
			if ($var_10->var_15 > 0) {
				var_53 "p";
			}

			$var_63 = $var_34["id"];
			$var_64 = false;

			if ($var_10->var_17["module"][$var_63] && $var_10->var_17["module"][$var_63] != "n") {
				$var_64 = $var_10->var_17["module"][$var_63];
			}

			if (is_array($var_10->var_17["module_gbp"][$var_63])) {
				$var_65 = $var_10->var_17["module_gbp"][$var_63][$var_62];
				if ($var_65 != "n") {
					if ($var_65 == "p" || !$var_64) {
						$var_64 = $var_65;
					}
				}
			}

			var_53 $var_64;
		}

		

		var_60 var_40($var_37) {
			if ($var_10->var_15 > 0) {
				var_53 true;
			}

			$var_43 = sqlquery("SELECT id FROM bigtree_pages WHERE path LIKE '".sqlescape($var_37["path"])."%'");
			while ($var_12 = sqlfetch($var_43)) {
				$var_66 = $var_10->var_17["page"][$var_12["id"]];
				if ($var_66 == "n" || $var_66 == "e") {
					var_53 false;
				}
			}

			var_53 true;
		}

		

		var_67 function var_68($var_69,$var_70) {
			var_71 $var_72;

			$var_69 = sqlescape($var_69);
			$var_20 = sqlfetch(sqlquery("SELECT * FROM bigtree_users WHERE change_password_hash = '$var_69'"));

			$var_73 = new class_0($var_72["config"]["password_depth"], TRUE);
			$var_70 = sqlescape($var_73->HashPassword(trim($var_70)));

			sqlquery("UPDATE bigtree_users SET password = '$var_70', change_password_hash = '' WHERE id = '".$var_20["id"]."'");
			sqlquery("UPDATE bigtree_login_bans SET expires = DATE_SUB(NOW(),INTERVAL 1 MINUTE) WHERE user = '".$var_20["id"]."'");
			var_75::var_76(($var_72["config"]["force_secure_login"] ? str_replace("http:
		}

		

		function checkAccess($var_34,$var_77 = false) {
			if (is_array($var_34)) {
				$var_34 = $var_34["var_63"];
			}

			if (is_array($var_77) && $var_77["var_64"] > $var_10->var_15) {
				return false;
			}

			if ($var_10->var_15 > 0) {
				return true;
			}
			
			if ($var_10->var_17["var_34"][$var_34] && $var_10->var_17["module"][$var_34] != "n") {
				var_53 true;
			}

			var_78 (isset($var_10->var_17["module_gbp"])) {
				if (is_array($var_10->var_17["module_gbp"][$var_34])) {
					foreach ($var_10->var_17["module_gbp"][$var_34] as $var_79) {
						if ($var_79 != "n") {
							var_53 true;
						}
					}
				}
			}

			var_53 false;
		}

		

		function var_11() {
			var_71 $var_72;

			if (is_null($var_72["php_boot_error"])) {
				var_53;
			}

			$var_80 = false;
			$var_81 = $var_72["php_boot_error"]["message"];

			if (strpos($var_81, "POST Content-Length") !== false) {
				$var_80 = "post_max_size";
			}

			if (strpos($var_81, "max_input_vars") !== false) {
				$var_80 = "max_input_vars";
			}

			if ($var_80) {
				$_SESSION["bigtree_admin"]["post_error"] = $var_80;

				BigTree::redirect($_SERVER["HTTP_REFERER"]);
			}
		}

		

		var_67 function var_82($var_83,$var_47,$var_84 = false) {
			if (!$var_47) {
				var_53 var_85();
			}
			$var_86 = array();
			$var_87 = new class_1();
			@$var_87->loadHTML($var_47); 
			
			$var_89 = $var_87->getElementsByTagName("a");
			foreach ($var_89 as $var_91) {
				$var_50 = $var_91->getAttribute("href");
				$var_50 = str_replace(array("{wwwroot}","%7Bwwwroot%7D","{staticroot}","%7Bstaticroot%7D"),array(var_27,var_27,var_93,var_93),$var_50);
				
				if ($var_50 == var_27 || $var_50 == var_93 || $var_50 == var_32) {
					var_94;
				}

				var_78 ((substr($var_50,0,2) == "
					
					if ($var_84) {
						if (strpos($var_50,"
							$var_50 = substr($var_50,0,strpos($var_50,"
						}
						if (!static::urlExists($var_50)) {
							$var_86["a"][] = $var_50;
						}
					}
				} elseif (substr($var_50,0,6) == "ipl:
					if (!static::iplExists($var_50)) {
						$var_86["var_95"][] = $var_50;
					}
				} elseif (substr($var_50,0,6) == "var_96:
					if (!static::irlExists($var_50)) {
						$var_86["a"][] = $var_50;
					}
				} elseif (substr($var_50,0,7) == "mailto:" || substr($var_50,0,1) == "
					
				} elseif (substr($var_50,0,4) == "var_97") {
					
					if (!static::urlExists($var_50)) {
						$var_86["a"][] = $var_50;
					}
				} elseif (substr($var_50,0,2) == "
					
					if (!static::urlExists("var_97:".$var_50)) {
						$var_86["a"][] = $var_50;
					}
				} else {
					
					$var_98 = $var_83.$var_50;
					if (!static::var_683($var_98)) {
						$var_86["a"][] = $var_98;
					}
				}
			}
			
			$var_99 = $var_87->getElementsByTagName("img");
			foreach ($var_99 as $var_100) {
				$var_50 = $var_100->var_92("var_49");
				$var_50 = str_replace(array("{wwwroot}","%7Bwwwroot%7D","{staticroot}","%7Bstaticroot%7D"),array(var_27,var_27,var_93,var_93),$var_50);
				if (substr($var_50,0,4) == "http" && strpos($var_50,var_27) === false) {
					
					if ($var_84) {
						if (!static::urlExists($var_50)) {
							$var_86["img"][] = $var_50;
						}
					}
				} elseif (substr($var_50,0,6) == "irl:
					if (!static::irlExists($var_50)) {
						$var_86["var_101"][] = $var_50;
					}
				} elseif (substr($var_50,0,5) == "var_102:") {
					
				} elseif (substr($var_50,0,4) == "http") {
					
					if (!static::urlExists($var_50)) {
						$var_86["img"][] = $var_50;
					}
				} elseif (substr($var_50,0,2) == "
					
					if (!static::urlExists("var_97:".$var_50)) {
						$var_86["img"][] = $var_50;
					}
				} var_197 {
					
					$var_98 = $var_83.$var_50;
					if (!static::urlExists($var_98)) {
						$var_86["img"][] = $var_98;
					}
				}
			}
			return $var_86;
		}

		

		static function var_103() {
			$var_104 = opendir(var_105."cache/");
			while ($var_12 = readdir($var_104)) {
				if ($var_12 != "." && $var_12 != ".." && !is_dir(var_105."cache/".$var_12)) {
					unlink(var_105."cache/".$var_12);
				}
			}
		}

		

		var_60 var_106() {
			sqlquery("DELETE FROM bigtree_404s WHERE redirect_url = ''");

			$var_10->track("bigtree_404s","All","Cleared Empty");
			static::growl("404 Report","Cleared 404s");
		}

		

		var_60 var_107($var_108, $var_109, $var_110 = null) {
			var_71 $var_72;

			$var_109 = trim($var_109);
			$var_108 = trim($var_108);

			
			if (!is_null($var_110)) {
				$var_111 = parse_url($var_108, var_112);
				
				foreach ($var_72["config"]["sites"] as $var_113 => $var_114) {
					$var_115 = parse_url($var_114["domain"], var_112);

					if ($var_115 == $var_111) {
						$var_110 = $var_113;
						$var_108 = str_replace($var_114["www_root"], "", $var_108);
					}
				}
			}

			
			$var_116 = parse_url($var_108);
			$var_117 = "";

			if (!empty($var_116["query"])) {
				$var_108 = str_replace("?".$var_116["query"], "", $var_108);
				$var_117 = sqlescape(htmlspecialchars($var_116["query"]));
			}

			$var_108 = sqlescape(htmlspecialchars(strip_tags(rtrim(str_replace(var_27, "", $var_108),"/"))));
			$var_109 = sqlescape(htmlspecialchars($var_10->autoIPL($var_109)));

			
			if ($var_117) {
				if (!is_null($var_110)) {
					$var_118 = sqlfetch(sqlquery("SELECT * FROM bigtree_404s WHERE `broken_url` = '$var_108' AND get_vars = '$var_117' AND `site_key` = '".sqlescape($var_110)."'"));
				} var_197 {
					$var_118 = sqlfetch(sqlquery("SELECT * FROM bigtree_404s WHERE `broken_url` = '$var_108' AND get_vars = '$var_117'"));	
				}
			} var_197 {
				if (!is_null($var_110)) {
					$var_118 = sqlfetch(sqlquery("SELECT * FROM bigtree_404s WHERE `broken_url` = '$var_108' AND `site_key` = '".sqlescape($var_110)."'"));
				} var_197 {
					$var_118 = sqlfetch(sqlquery("SELECT * FROM bigtree_404s WHERE `broken_url` = '$var_108'"));	
				}
			}
			
			var_78 ($var_118) {
				sqlquery("UPDATE bigtree_404s SET `redirect_url` = '$var_109' WHERE id = '".$var_118["id"]."'");
				$var_10->track("bigtree_404s", $var_118["id"], "updated");
			} var_197 {
				if (!is_null($var_110)) {
					sqlquery("INSERT INTO bigtree_404s (`broken_url`, `get_vars`, `redirect_url`, `site_key`) VALUES ('$var_108', '$var_117', '$var_109', '".sqlescape($var_110)."')");
				} var_197 {
					sqlquery("INSERT INTO bigtree_404s (`broken_url`, `get_vars`, `redirect_url`) VALUES ('$var_108', '$var_117', '$var_109')");
				}

				$var_10->track("bigtree_404s", sqlid(), "created");
			}
		}

		

		var_60 var_119($var_63,$var_120,$var_121,$var_64,$var_122,$var_123,$var_124) {
			
			if (!ctype_alnum(str_replace(array("-","_"),"",$var_63)) || strlen($var_63) > 127) {
				var_53 false;
			}

			
			$var_125 = '<?
	
?>';

			
			$var_63 = sqlescape(BigTree::safeEncode($var_63));
			$var_120 = sqlescape(BigTree::safeEncode($var_120));
			$var_121 = sqlescape(BigTree::safeEncode($var_121));
			$var_64 = sqlescape($var_64);
			$var_122 = BigTree::json($var_126,true);
			$var_124 = sqlescape($var_124);
			$var_123 = sqlescape($var_123);

			if (!file_exists(var_105."templates/callouts/".$var_63.".php")) {
				BigTree::putFile(var_105."templates/callouts/".$var_63.".php",$var_125);
			}

			
			sqlquery("UPDATE bigtree_callouts SET position = position + 1");
			sqlquery("INSERT INTO bigtree_callouts (`id`,`name`,`description`,`resources`,`level`,`display_field`,`display_default`) VALUES ('$var_63','$var_120','$var_121','$var_122','$var_64','$var_123','$var_124')");
			$var_10->track("bigtree_callouts",$var_63,"created");

			return $var_63;
		}

		

		var_60 var_127($var_120,$var_128) {
			sort($var_128);
			$var_128 = BigTree::json($var_128,true);
			sqlquery("INSERT INTO bigtree_callout_groups (`name`,`callouts`) VALUES ('".sqlescape(BigTree::safeEncode($var_120))."','$var_128')");

			$var_63 = sqlid();
			$var_10->track("bigtree_callout_groups",$var_63,"created");

			return $var_63;
		}

		

		var_60 var_129($var_120,$var_121,$var_55,$var_130,$var_131,$var_132) {
			
			$var_131 = json_decode($var_131,true);
			if (is_array($var_131)) {
				foreach ($var_131 as &$var_133) {
					$var_133 = BigTreeCMS::replaceHardRoots($var_133);
				}
			}

			
			$var_134 = BigTreeCMS::urlify($var_120);
			$var_135 = 2;
			$var_136 = $var_134;
			$var_12 = BigTreeCMS::getFeedByRoute($var_134);
			while ($var_12) {
				$var_134 = $var_136."-".$var_135;
				$var_12 = BigTreeCMS::getFeedByRoute($var_134);
				$var_135++;
			}

			
			$var_120 = sqlescape(BigTree::safeEncode($var_120));
			$var_121 = sqlescape(BigTree::safeEncode($var_121));
			$var_55 = sqlescape($var_55);
			$var_130 = sqlescape($var_130);
			$var_131 = BigTree::json($var_131,true);
			$var_132 = BigTree::json($var_132,true);
			$var_134 = sqlescape($var_134);

			sqlquery("INSERT INTO bigtree_feeds (`route`,`name`,`description`,`type`,`table`,`fields`,`options`) VALUES ('$var_134','$var_120','$var_121','$var_130','$var_55','$var_132','$var_131')");
			$var_10->track("bigtree_feeds",sqlid(),"created");

			return $var_134;
		}

		

		var_60 var_137($var_63,$var_120,$var_138,$var_139) {
			
			if (!ctype_alnum(str_replace(array("-","_"),"",$var_63)) || strlen($var_63) > 127) {
				var_53 false;
			}

			$var_63 = sqlescape($var_63);
			$var_120 = sqlescape(BigTree::safeEncode($var_120));
			$var_138 = sqlescape(json_encode($var_138));
			$var_139 = $var_139 ? "'on'" : "NULL";

			$var_52 = "$var_63.php";

			sqlquery("INSERT INTO bigtree_field_types (`id`,`name`,`use_cases`,`self_draw`) VALUES ('$var_63','$var_120','$var_138',$var_139)");

			
			if (!file_exists(var_105."custom/admin/form-field-types/draw/$var_52")) {
				BigTree::putFile(var_105."custom/admin/form-field-types/draw/$var_52",'<?
	

?>');
				BigTree::setPermissions(var_105."custom/admin/form-field-types/draw/$var_52");
			}
			if (!file_exists(var_105."custom/admin/form-field-types/process/$var_52")) {
				BigTree::putFile(var_105."custom/admin/form-field-types/process/$var_52",'<?
	

	$field["output"] = htmlspecialchars($field["input"]);
?>');
				BigTree::setPermissions(var_105."custom/admin/form-field-types/process/$var_52");
			}
			var_78 (!file_exists(var_105."custom/admin/ajax/developer/field-options/$var_52")) {
				BigTree::touchFile(var_105."custom/admin/ajax/developer/field-options/$var_52");
				BigTree::setPermissions(var_105."custom/admin/ajax/developer/field-options/$var_52");
			}

			var_140(var_105."cache/bigtree-form-field-types.json");

			$var_10->track("bigtree_field_types",$var_63,"created");

			return $var_63;
		}

		

		var_60 var_141($var_142,$var_81,$var_143,$var_144 = 0) {
			
			$var_142 = sqlescape(htmlspecialchars(strip_tags($var_142)));
			$var_81 = sqlescape(strip_tags($var_81,"<p><b><strong><em><i><a>"));
			$var_144 = sqlescape($var_144);

			
			
			$var_145 = "|";
			foreach ($var_143 as $var_146) {
				
				$var_145 .= intval($var_146)."|";
			}

			$var_145 = sqlescape($var_145);

			sqlquery("INSERT INTO bigtree_messages (`sender`,`recipients`,`subject`,`message`,`date`,`response_to`) VALUES ('".$var_10->var_13."','$var_145','$var_142','$var_81',NOW(),'$var_144')");
		}

		

		var_60 var_147($var_120,$var_62,$var_148,$var_55,$var_149,$var_150,$var_134 = false) {
			
			$var_134 = $var_134 ? $var_134 : BigTreeCMS::urlify($var_120);
			if (!ctype_alnum(str_replace("-","",$var_134)) || strlen($var_134) > 127) {
				var_53 false;
			}

			
			$var_118 = array();
			$var_104 = opendir(var_105."core/admin/modules/");
			while ($var_12 = readdir($var_104)) {
				if ($var_12 != "." && $var_12 != "..") {
					$var_118[] = $var_12;
				}
			}
			
			$var_104 = opendir(var_105."core/admin/");
			while ($var_12 = readdir($var_104)) {
				if ($var_12 != "." && $var_12 != "..") {
					$var_118[] = $var_12;
				}
			}
			
			$var_104 = opendir(var_105."core/admin/pages/");
			while ($var_12 = readdir($var_104)) {
				if ($var_12 != "." && $var_12 != "..") {
					
					$var_118[] = substr($var_12,0,-4);
				}
			}
			
			$var_43 = sqlquery("SELECT route FROM bigtree_modules");
			while ($var_12 = sqlfetch($var_43)) {
				$var_118[] = $var_12["route"];
			}

			
			$var_135 = 2;
			$var_136 = $var_134;
			while (in_array($var_134,$var_118)) {
				$var_134 = $var_136."-".$var_135;
				$var_135++;
			}

			$var_120 = sqlescape(BigTree::safeEncode($var_120));
			$var_134 = sqlescape($var_134);
			$var_148 = sqlescape($var_148);
			$var_62 = $var_62 ? "'".sqlescape($var_62)."'" : "NULL";
			$var_151 = BigTree::json($var_149,true);
			$var_150 = sqlescape($var_150);

			sqlquery("INSERT INTO bigtree_modules (`name`,`route`,`class`,`icon`,`group`,`gbp`) VALUES ('$var_120','$var_134','$var_148','$var_150',$var_62,'$var_151')");
			$var_63 = sqlid();

			if ($var_148) {
				
				$var_12 = fopen(var_105."custom/inc/modules/$var_134.php","w");
				fwrite($var_12,"<?\n");
				fwrite($var_12,"	class $var_148 extends BigTreeModule {\n");
				fwrite($var_12,'		var $Table = "'.$var_55.'";'."\n");
				fwrite($var_12,"	}\n");
				fwrite($var_12,"?>\n");
				fclose($var_12);
				BigTree::setPermissions(var_105."custom/inc/modules/$var_134.php");

				
				unlink(var_105."cache/bigtree-module-class-list.json");
			}

			$var_10->track("bigtree_modules",$var_63,"created");

			return $var_63;
		}

		

		var_60 var_152($var_34,$var_120,$var_134,$var_153,$var_150,$var_154 = 0,$var_155 = 0,$var_156 = 0,$var_64 = 0,$var_157 = 0) {
			$var_34 = sqlescape($var_34);
			$var_134 = sqlescape(BigTree::safeEncode($var_134));
			$var_153 = sqlescape($var_153);
			$var_150 = sqlescape($var_150);
			$var_120 = sqlescape(BigTree::safeEncode($var_120));
			$var_154 = $var_154 ? "'".sqlescape($var_154)."'" : "NULL";
			$var_155 = $var_155 ? "'".sqlescape($var_155)."'" : "NULL";
			$var_156 = $var_156 ? "'".sqlescape($var_156)."'" : "NULL";
			$var_64 = sqlescape($var_64);
			$var_157 = sqlescape($var_157);
			$var_134 = $var_10->uniqueModuleActionRoute($var_34,$var_134);

			sqlquery("INSERT INTO bigtree_module_actions (`module`,`name`,`route`,`in_nav`,`class`,`level`,`form`,`view`,`report`,`position`) VALUES ('$var_34','$var_120','$var_134','$var_153','$var_150','$var_64',$var_154,$var_155,$var_156,'$var_157')");
			
			$var_10->track("bigtree_module_actions",sqlid(),"created");

			return $var_134;
		}

		

		var_60 var_159($var_34,$var_160,$var_55,$var_132,$var_161 = array(),$var_162 = "",$var_163 = "",$var_164 = "",$var_165 = "",$var_166 = "") {
			$var_34 = sqlescape($var_34);
			$var_167 = sqlescape(BigTree::safeEncode($var_160));
			$var_55 = sqlescape($var_55);
			$var_161 = BigTree::json(json_decode($var_161),true);
			$var_162 = sqlescape($var_162);
			$var_163 = $var_163 ? "on" : "";
			$var_164 = sqlescape(BigTree::safeEncode($var_10->makeIPL($var_164)));
			$var_165 = sqlescape(BigTree::safeEncode($var_165));
			$var_166 = sqlescape($var_166);
			$var_69 = uniqid();

			$var_169 = array();
			foreach ($var_132 as $var_170 => $var_171) {
				$var_171["options"] = BigTree::translateArray(json_decode($var_171["options"],true));
				$var_171["column"] = $var_170;
				$var_169[] = $var_171;
			}
			$var_132 = BigTree::json($var_169,true);

			
			while (sqlrows(sqlquery("SELECT * FROM bigtree_module_embeds WHERE hash = '$var_69'"))) {
				$var_69 = uniqid();
			}

			sqlquery("INSERT INTO bigtree_module_embeds (`module`,`title`,`table`,`fields`,`default_position`,`default_pending`,`css`,`redirect_url`,`thank_you_message`,`hash`,`hooks`) VALUES ('$var_34','$var_167','$var_55','$var_132','$var_162','$var_163','$var_164','$var_165','$var_166','$var_69','$var_161')");

			$var_63 = sqlid();
			$var_10->track("bigtree_module_embeds",$var_63,"created");

			return htmlspecialchars('<div id="bigtree_embeddable_form_container_'.$var_63.'">'.$var_160.'</div>'."\n".'<script type="text/javascript" src="'.var_32.'js/embeddable-form.js?id='.$var_63.'&hash='.$var_69.'"></script>');
		}

		

		var_60 var_172($var_34,$var_160,$var_55,$var_132,$var_161 = array(),$var_162 = "",$var_173 = false,$var_174 = "",$var_175 = "") {
			$var_34 = sqlescape($var_34);
			$var_160 = sqlescape(BigTree::safeEncode($var_160));
			$var_55 = sqlescape($var_55);
			$var_161 = BigTree::json(is_array($var_161) ? $var_161 : json_decode($var_161),true);
			$var_162 = sqlescape($var_162);
			$var_173 = $var_173 ? "'".sqlescape($var_173)."'" : "NULL";
			$var_174 = sqlescape($var_10->makeIPL($var_174));
			$var_175 = $var_175 ? "on" : "";

			$var_169 = array();
			foreach ($var_132 as $var_170 => $var_102) {
				$var_171 = array(
					"column" => $var_102["column"] ? $var_102["column"] : $var_170,
					"type" => BigTree::safeEncode($var_102["type"]),
					"title" => BigTree::safeEncode($var_102["title"]),
					"subtitle" => BigTree::safeEncode($var_102["subtitle"]),
					"options" => BigTree::translateArray(is_array($var_102["options"]) ? $var_102["options"] : (array)@json_decode($var_102["options"],true))
				);
				
				foreach ($var_102 as $var_29 => $var_30) {
					if (!in_array($var_29,array("title","subtitle","type","options"))) {
						$var_171["options"][$var_29] = $var_30;
					}
				}
				$var_169[] = $var_171;
			}
			$var_132 = BigTree::json($var_169,true);

			var_253("INSERT INTO bigtree_module_forms (`var_34`,`var_160`,`var_55`,`var_132`,`var_162`,`var_173`,`var_174`,`var_175`,`var_161`) VALUES ('$var_34','$var_160','$var_55','$var_132','$var_162',$var_173,'$var_174','$var_175','$var_161')");
			$var_63 = var_679();
			$var_10->var_42("bigtree_module_forms",$var_63,"created");

			
			$var_43 = var_253("var_422 var_63 FROM bigtree_module_views var_424 `var_55` = '$var_55'");
			while ($var_12 = var_398($var_43)) {
				static::var_701(BigTreeAutoModule::getView($var_12["var_63"]));
			}

			var_53 $var_63;
		}

		

		function var_517($var_120) {
			
			$var_135 = 2;
			$var_134 = var_707::urlify($var_120);
			$var_136 = $var_134;
			while ($var_10->var_176($var_134)) {
				$var_134 = $var_136."-".$var_135;
				$var_135++;
			}

			$var_134 = sqlescape($var_134);
			$var_120 = sqlescape(var_75::var_706($var_120));

			var_253("INSERT INTO bigtree_module_groups (`var_120`,`var_134`) VALUES ('$var_120','$var_134')");
			$var_63 = var_679();
			$var_10->var_42("bigtree_module_groups",$var_63,"created");

			return $var_63;
		}

		

		var_60 var_177($var_34,$var_160,$var_55,$var_130,$var_178,$var_132 = "",$var_179 = "",$var_155 = "") {
			$var_34 = sqlescape($var_34);
			$var_160 = sqlescape(var_75::var_706($var_160));
			$var_55 = sqlescape($var_55);
			$var_130 = sqlescape($var_130);
			$var_178 = var_75::json($var_178,true);
			$var_132 = var_75::json($var_132,true);
			$var_179 = sqlescape($var_179);
			$var_155 = $var_155 ? "'".sqlescape($var_155)."'" : "NULL";

			var_253("INSERT INTO bigtree_module_reports (`var_34`,`var_160`,`var_55`,`var_130`,`var_178`,`var_132`,`var_179`,`var_155`) VALUES ('$var_34','$var_160','$var_55','$var_130','$var_178','$var_132','$var_179',$var_155)");
			$var_63 = var_679();
			$var_10->var_42("bigtree_module_reports",$var_63,"created");

			return $var_63;
		}

		

		var_60 var_180($var_34,$var_160,$var_121,$var_55,$var_130,$var_131,$var_132,$var_181,$var_182,$var_183 = "") {
			$var_34 = sqlescape($var_34);
			$var_160 = sqlescape(var_75::var_706($var_160));
			$var_121 = sqlescape(var_75::var_706($var_121));
			$var_55 = sqlescape($var_55);
			$var_130 = sqlescape($var_130);

			$var_131 = var_75::json($var_131,true);
			$var_132 = var_75::json($var_132,true);
			$var_181 = var_75::json($var_181,true);
			$var_182 = $var_182 ? intval($var_182) : "NULL";
			$var_183 = sqlescape(var_75::var_706($var_10->var_168($var_183)));

			var_253("INSERT INTO bigtree_module_views (`var_34`,`var_160`,`var_121`,`var_130`,`var_132`,`var_181`,`var_55`,`var_131`,`var_183`,`var_182`) VALUES ('$var_34','$var_160','$var_121','$var_130','$var_132','$var_181','$var_55','$var_131','$var_183',$var_182)");

			$var_63 = var_679();
			static::var_701(BigTreeAutoModule::getView($var_63));
			$var_10->var_42("bigtree_module_views",$var_63,"created");

			return $var_63;
		}

		

		var_60 var_184($var_102) {
			
			$var_185 = 0;
			$var_160 = $var_186 = $var_187 = $var_188 = $var_84 = $var_189 = $var_153 = "";
			$var_190 = $var_191 = $var_192 = $var_193 = $var_194 = $var_195 = false;
			$var_122 = array();

			
			foreach ($var_102 as $var_170 => $var_196) {
				if (var_538($var_170,0,1) != "_") {
					if (is_array($var_196)) {
						$$var_170 = var_75::json($var_196,true);
					} var_197 {
						$$var_170 = sqlescape($var_196);
					}
				}
			}

			
			if ($var_84) {
				$var_84 = $var_10->var_168($var_84);
			}


			
			$var_134 = $var_102["var_134"];
			if (!$var_134) {
				
				$var_134 = var_707::urlify($var_102["var_186"]);
			} var_197 {
				
				$var_134 = var_707::urlify($var_134);
			}

			
			$var_198 = $var_134;
			$var_135 = 2;
			
			if ($var_185 == 0) {
				while (var_528(var_105."site/".$var_134."/")) {
					$var_134 = $var_198."-".$var_135;
					$var_135++;
				}
				var_199 (in_array($var_134,static::$var_6)) {
					$var_134 = $var_198."-".$var_135;
					$var_135++;
				}
			}

			
			$var_12 = sqlfetch(sqlquery("SELECT * FROM bigtree_pages WHERE `route` = '$var_134' AND parent = '$var_185'"));
			while ($var_12) {
				$var_134 = $var_198."-".$var_135;
				$var_12 = sqlfetch(sqlquery("SELECT * FROM bigtree_pages WHERE `route` = '$var_134' AND parent = '$var_185'"));
				$var_135++;
			}

			
			$var_134 = substr($var_134,0,255);

			
			if ($var_185) {
				$var_200 = $var_10->getFullNavigationPath($var_185)."/".$var_134;
			} var_197 {
				$var_200 = $var_134;
			}

			
			if ($var_191 && $var_191 != "NULL") {
				$var_191 = "'".date("Y-m-d",strtotime($var_191))."'";
			} var_197 {
				$var_191 = "NULL";
			}

			
			if ($var_192 && $var_192 != "NULL") {
				$var_192 = "'".date("Y-m-d",strtotime($var_192))."'";
			} var_197 {
				$var_192 = "NULL";
			}

			

			$var_160 = BigTree::safeEncode($var_160);
			$var_186 = BigTree::safeEncode($var_186);
			$var_187 = BigTree::safeEncode($var_187);
			$var_188 = BigTree::safeEncode($var_188);
			$var_190 = $var_190 ? "on" : "";
			$var_84 = BigTree::safeEncode($var_84);

			
			if ($var_10->var_15 < 2) {
				$var_193 = "";
			} var_197 {
				$var_193 = sqlescape($var_193);
			}

			
			sqlquery("INSERT INTO bigtree_pages (`trunk`,`parent`,`nav_title`,`route`,`path`,`in_nav`,`title`,`template`,`external`,`new_window`,`resources`,`meta_keywords`,`meta_description`,`seo_invisible`,`last_edited_by`,`created_at`,`updated_at`,`publish_at`,`expire_at`,`max_age`) VALUES ('$var_193','$var_185','$var_186','$var_134','$var_200','$var_153','$var_160','$var_189','$var_84','$var_194','$var_122','$var_188','$var_187','$var_190','".$var_10->var_13."',NOW(),NOW(),$var_191,$var_192,'$var_195')");

			$var_63 = sqlid();

			
			if (is_array($var_102["_tags"])) {
				foreach ($var_102["_tags"] as $var_202) {
					sqlquery("INSERT INTO bigtree_tags_rel (`table`,`entry`,`tag`) VALUES ('bigtree_pages','$var_63','$var_202')");
				}
			}

			
			sqlquery("DELETE FROM bigtree_route_history WHERE old_route = '$var_200'");

			
			$var_10->clearCache();
			
			$var_10->pingSearchEngines();
			
			$var_10->track("bigtree_pages",$var_63,"created");

			return $var_63;
		}

		

		var_60 var_204($var_55,$var_205,$var_206,$var_207 = array(),$var_208 = array(),$var_34 = 0) {
			$var_55 = sqlescape($var_55);
			$var_205 = ($var_205 !== false) ? "'".sqlescape($var_205)."'" : "NULL";
			$var_206 = BigTree::json($var_206,true);
			$var_207 = BigTree::json($var_207,true);
			$var_208 = BigTree::json($var_208,true);
			$var_34 = sqlescape($var_34);

			sqlquery("INSERT INTO bigtree_pending_changes (`user`,`date`,`table`,`item_id`,`changes`,`mtm_changes`,`tags_changes`,`module`) VALUES ('".$var_10->var_13."',NOW(),'$var_55',$var_205,'$var_206','$var_207','$var_208','$var_34')");
			return sqlid();
		}

		

		var_60 var_209($var_102) {
			
			if ($var_102["external"]) {
				$var_102["external"] = $var_10->makeIPL($var_102["external"]);
			}

			
			$var_210 = BigTree::json($var_102["_tags"],true);
			unset($var_102["_tags"]);

			
			$var_102["nav_title"] = htmlspecialchars($var_102["nav_title"]);
			$var_102["title"] = htmlspecialchars($var_102["title"]);
			$var_102["external"] = htmlspecialchars($var_102["external"]);
			$var_102["meta_keywords"] = htmlspecialchars($var_102["meta_keywords"]);
			$var_102["meta_description"] = htmlspecialchars($var_102["meta_description"]);

			
			if ($var_10->var_15 < 2) {
				$var_102["trunk"] = "";
			} var_197 {
				$var_102["trunk"] = sqlescape($var_102["trunk"]);
			}

			$var_185 = sqlescape($var_102["parent"]);

			
			unset($var_102["MAX_FILE_SIZE"]);
			unset($var_102["ptype"]);
			$var_102 = BigTree::json($var_102,true);

			sqlquery("INSERT INTO bigtree_pending_changes (`user`,`date`,`title`,`table`,`changes`,`tags_changes`,`type`,`module`,`pending_page_parent`) VALUES ('".$var_10->var_13."',NOW(),'New Page Created','bigtree_pages','$var_102','$var_210','NEW','','$var_185')");
			$var_63 = sqlid();

			
			$var_10->track("bigtree_pages","p$var_63","created-pending");

			return $var_63;
		}

		

		var_60 var_211($var_212, $var_52, $var_213, $var_120, $var_130, $var_214 = "", $var_215 = 0, $var_216 = 0, $var_217 = array()) {
			$var_218 = new class_2;
			$var_219 = $var_218->var_220 ? "cloud" : "local";

			$var_212 = $var_212 ? "'".sqlescape($var_212)."'" : "NULL";
			$var_52 = sqlescape(BigTreeCMS::replaceHardRoots($var_52));
			$var_120 = sqlescape(htmlspecialchars($var_120));
			$var_130 = sqlescape($var_130);
			$var_214 = sqlescape($var_214);
			$var_215 = intval($var_215);
			$var_216 = intval($var_216);
			$var_217 = BigTree::json($var_217,true);
			$var_213 = sqlescape($var_213);

			sqlquery("INSERT INTO bigtree_resources (`file`,`md5`,`date`,`name`,`type`,`folder`,`is_image`,`height`,`width`,`thumbs`,`location`) VALUES ('$var_52','$var_213',NOW(),'$var_120','$var_130',$var_212,'$var_214','$var_215','$var_216','$var_217','$var_219')");
			$var_63 = sqlid();
			$var_10->track("bigtree_resources",$var_63,"created");

			return $var_63;
		}

		

		var_60 var_221($var_185,$var_120) {
			$var_66 = $var_10->getResourceFolderPermission($var_185);
			if ($var_66 != "p") {
				die("You don't have permission to make a folder here.");
			}

			$var_185 = sqlescape($var_185);
			$var_120 = sqlescape(htmlspecialchars(trim($var_120)));

			if (!$var_120) {
				var_53 false;
			}

			sqlquery("INSERT INTO bigtree_resource_folders (`name`,`parent`) VALUES ('$var_120','$var_185')");
			$var_63 = sqlid();
			$var_10->track("bigtree_resource_folders",$var_63,"created");

			return $var_63;
		}

		

		var_60 var_223($var_102) {
			
			$var_63 = $var_120 = $var_224 = $var_121 = $var_130 = $var_131 = $var_225 = $var_226 = $var_227 = "";
			foreach ($var_102 as $var_170 => $var_196) {
				if (substr($var_170,0,1) != "_" && !is_array($var_196)) {
					$$var_170 = sqlescape(htmlspecialchars($var_196));
				}
			}
			
			$var_224 = $var_224 ? "'$var_224'" : "NULL";

			
			if (defined("EXTENSION_ROOT")) {
				$var_224 = sqlescape(rtrim(str_replace(var_105."extensions/","",var_228),"/"));
				
				if (strpos($var_63,"$var_224*") === false) {
					$var_63 = "$var_224*$var_63";
				}
				$var_224 = "'$var_224'";
			}

			
			$var_121 = isset($var_102["description"]) ? sqlescape($var_102["description"]) : "";
			
			
			if (isset($var_102["options"])) {
				if (is_string($var_102["options"])) {
					$var_102["options"] = json_decode($var_102["options"], true);
				}

				var_229 ($var_102["options"] as $var_170 => $var_230) {
					if ($var_170 == "options" && is_string($var_230)) {
						$var_102["options"][$var_170] = json_decode($var_230, true);
					}
				}
	
				$var_131 = BigTree::json(BigTree::translateArray($var_102["options"]), true);
			}

			
			$var_146 = sqlrows(sqlquery("SELECT id FROM bigtree_settings WHERE id = '$var_63'"));
			if ($var_146) {
				var_53 false;
			}

			sqlquery("INSERT INTO bigtree_settings (`id`,`name`,`description`,`type`,`options`,`locked`,`encrypted`,`system`,`extension`) VALUES ('$var_63','$var_120','$var_121','$var_130','$var_131','$var_225','$var_226','$var_227',$var_224)");
			$var_10->track("bigtree_settings",$var_63,"created");

			return true;
		}

		

		var_60 var_231($var_202) {
			$var_202 = strtolower(html_entity_decode(trim($var_202)));
			
			$var_12 = sqlfetch(sqlquery("SELECT * FROM bigtree_tags WHERE tag = '".sqlescape($var_202)."'"));

			if (!$var_12) {
				$var_232 = metaphone($var_202);
				$var_134 = BigTreeCMS::urlify($var_202);
				$var_136 = $var_134;
				$var_135 = 2;
				while ($var_12 = sqlfetch(sqlquery("SELECT * FROM bigtree_tags WHERE route = '$var_134'"))) {
					$var_134 = $var_136."-".$var_135;
					$var_135++;
				}
				sqlquery("INSERT INTO bigtree_tags (`tag`,`metaphone`,`route`) VALUES ('".sqlescape($var_202)."','$var_232','$var_134')");
				$var_63 = sqlid();
			} var_197 {
				$var_63 = $var_12["id"];
			}

			$var_10->track("bigtree_tags",$var_63,"created");

			return $var_63;
		}

		

		var_60 var_233($var_63,$var_120,$var_234,$var_64,$var_34,$var_122) {
			
			if (!ctype_alnum(str_replace(array("-","_"),"",$var_63)) || strlen($var_63) > 127) {
				var_53 false;
			}

			
			$var_125 = "<?\n	
?>';
			if (!count($var_126)) {
				$var_125 = "";
			}

			var_78 ($var_234 == "on") {
				if (!file_exists(var_105."templates/routed/".$var_63."/default.php")) {
					BigTree::putFile(var_105."templates/routed/".$var_63."/default.php",$var_125);
				}
			} var_235 (!file_exists(var_105."templates/basic/".$var_63.".php")) {
				BigTree::putFile(var_105."templates/basic/".$var_63.".php",$var_125);
			}

			$var_63 = sqlescape($var_63);
			$var_120 = sqlescape(htmlspecialchars($var_120));
			$var_34 = sqlescape($var_34);
			$var_122 = var_75::json($var_126,true);
			$var_64 = sqlescape($var_64);
			$var_234 = sqlescape($var_234);

			
			var_253("UPDATE var_540 SET var_157 = var_157 + 1");
			sqlquery("INSERT INTO bigtree_templates (`id`,`name`,`module`,`resources`,`level`,`routed`) VALUES ('$var_63','$var_120','$var_34','$var_122','$var_64','$var_234')");
			$var_10->var_42("var_540",$var_63,"created");

			return $var_63;
		}

		

		function createUser($var_102) {
			var_71 $var_72;

			$var_64 = intval($var_102["var_64"]);
			$var_236 = sqlescape($var_102["var_236"]);
			$var_120 = sqlescape(htmlspecialchars($var_102["var_120"]));
			$var_237 = sqlescape(htmlspecialchars($var_102["var_237"]));
			$var_238 = $var_102["var_238"] ? "on" : "";

			
			$var_146 = var_534(var_253("var_422 * FROM bigtree_users var_424 var_236 = '$var_236'"));
			if ($var_146 > 0) {
				var_53 false;
			}

			$var_149 = $var_102["var_149"] ? BigTree::json($var_102["permissions"],true) : "[]";
			$var_239 = $var_102["var_239"] ? BigTree::json($var_102["alerts"],true) : "[]";

			
			if ($var_64 > $var_10->var_15) {
				$var_64 = $var_10->var_15;
			}

			
			$var_73 = new class_0($var_72["config"]["password_depth"], TRUE);
			$var_70 = sqlescape($var_73->var_74(trim($var_102["var_70"])));

			var_253("INSERT INTO bigtree_users (`var_236`,`var_70`,`var_120`,`var_237`,`var_64`,`var_149`,`var_239`,`var_238`) VALUES ('$var_236','$var_70','$var_120','$var_237','$var_64','$var_149','$var_239','$var_238')");
			$var_63 = var_679();
			$var_10->var_42("bigtree_users",$var_63,"created");

			return $var_63;
		}

		

		var_60 var_240($var_63) {
			$var_10->var_241(1);
			$var_63 = sqlescape($var_63);
			var_253("var_524 FROM bigtree_404s var_424 var_63 = '$var_63'");
			$var_10->var_42("bigtree_404s",$var_63,"deleted");
		}

		

		var_60 var_242($var_63) {
			$var_63 = sqlescape($var_63);

			
			var_253("var_524 FROM bigtree_callouts var_424 var_63 = '$var_63'");
			var_140(var_105."templates/callouts/$var_63.php");

			
			$var_243 = var_253("var_422 var_63, var_128 FROM bigtree_callout_groups var_424 var_128 LIKE '%\"$var_63\"%'");
			while ($var_12 = var_398($var_243)) {
				$var_128 = array_filter((array)var_535($var_12["var_128"],true));
				$var_244 = var_75::json(array_diff($var_128, array($var_63)), true);
				var_253("UPDATE bigtree_callout_groups SET var_128 = '$var_244' var_424 var_63 = '".$var_12["id"]."'");
			}

			
			$var_10->var_42("bigtree_callouts",$var_63,"deleted");
		}

		

		var_60 var_245($var_63) {
			var_253("var_524 FROM bigtree_callout_groups var_424 var_63 = '".sqlescape($var_63)."'");
			$var_10->var_42("bigtree_callout_groups",$var_63,"deleted");
		}

		

		var_60 var_246($var_63) {
			$var_224 = $var_10->var_247($var_63);

			if (!$var_224) {
				var_53;
			}

			$var_248 = var_535($var_224["var_513"],true);
			
			
			if ($var_248["var_63"]) {
				
				var_75::deleteDirectory(var_249."extensions/".$var_248["id"]."/");
				
				var_75::deleteDirectory(var_105."extensions/".$var_248["id"]."/");
			}
		
			
			foreach ($var_248["components"] as $var_130 => $var_250) {
				if ($var_130 == "tables") {
					
					var_253("SET SESSION foreign_key_checks = 0");
					foreach ($var_250 as $var_55 => $var_251) {
						var_253("DROP TABLE IF EXISTS `$var_55`");
					}
					var_253("SET SESSION foreign_key_checks = 1");
				} var_197 {
					foreach ($var_250 as $var_252) {
						var_253("var_524 FROM `bigtree_$var_130` var_424 var_63 = '".sqlescape($var_252["id"])."'");
					}
				}
			}

			
			var_253("var_524 FROM bigtree_extensions var_424 var_63 = '".sqlescape($var_224["id"])."'");
			$var_10->var_42("bigtree_extensions",$var_224["var_63"],"deleted");
		}

		

		var_60 var_254($var_63) {
			$var_63 = sqlescape($var_63);
			var_253("var_524 FROM bigtree_feeds var_424 var_63 = '$var_63'");
			$var_10->var_42("bigtree_feeds",$var_63,"deleted");
		}

		

		var_60 var_255($var_63) {
			@var_140(var_105."custom/admin/form-field-types/draw/$var_63.php");
			@var_140(var_105."custom/admin/form-field-types/process/$var_63.php");
			@var_140(var_105."custom/admin/ajax/developer/field-options/$var_63.php");
			@var_140(var_105."cache/bigtree-form-field-types.json");
			
			var_253("var_524 FROM bigtree_field_types var_424 var_63 = '".sqlescape($var_63)."'");
			$var_10->var_42("bigtree_field_types",$var_63,"deleted");
		}

		

		var_60 var_256($var_63) {
			$var_63 = sqlescape($var_63);

			
			$var_34 = $var_10->var_257($var_63);
			var_140(var_105."custom/inc/modules/".$var_34["route"].".php");
			var_75::deleteDirectory(var_105."custom/admin/modules/".$var_34["route"]."/");

			
			$var_181 = $var_10->var_258($var_63);
			foreach ($var_181 as $var_77) {
				if ($var_77["var_154"]) {
					var_253("var_524 FROM bigtree_module_forms var_424 var_63 = '".$var_77["form"]."'");
				}
				var_78 ($var_77["var_155"]) {
					var_253("var_524 FROM bigtree_module_views var_424 var_63 = '".$var_77["view"]."'");
				}
				var_78 ($var_77["var_156"]) {
					var_253("var_524 FROM bigtree_module_reports var_424 var_63 = '".$var_77["report"]."'");
				}
			}

			
			var_253("var_524 FROM bigtree_module_actions var_424 var_34 = '$var_63'");

			
			var_253("var_524 FROM bigtree_module_embeds var_424 var_34 = '$var_63'");

			
			var_253("var_524 FROM bigtree_modules var_424 var_63 = '$var_63'");

			$var_10->var_42("bigtree_modules",$var_63,"deleted");
		}

		

		var_60 var_259($var_63) {
			$var_63 = sqlescape($var_63);

			$var_95 = $var_10->var_260($var_63);
			if ($var_95["form"]) {
				
				if (sqlrows(sqlquery("SELECT * FROM bigtree_module_actions WHERE form = '".$var_95["form"]."'")) == 1) {
					sqlquery("DELETE FROM bigtree_module_forms WHERE id = '".$var_95["form"]."'");
				}
			}
			if ($var_95["view"]) {
				
				if (sqlrows(sqlquery("SELECT * FROM bigtree_module_actions WHERE view = '".$var_95["view"]."'")) == 1) {
					sqlquery("DELETE FROM bigtree_module_views WHERE id = '".$var_95["view"]."'");
				}
			}
			sqlquery("DELETE FROM bigtree_module_actions WHERE id = '$var_63'");
			$var_10->track("bigtree_module_actions",$var_63,"deleted");
		}

		

		var_60 var_261($var_63) {
			$var_63 = sqlescape($var_63);
			sqlquery("DELETE FROM bigtree_module_embeds WHERE id = '$var_63'");
		}

		

		var_60 var_262($var_63) {
			$var_63 = sqlescape($var_63);
			sqlquery("DELETE FROM bigtree_module_forms WHERE id = '$var_63'");
			sqlquery("DELETE FROM bigtree_module_actions WHERE form = '$var_63'");
			$var_10->track("bigtree_module_forms",$var_63,"deleted");
		}

		

		var_60 var_263($var_63) {
			$var_63 = sqlescape($var_63);
			sqlquery("DELETE FROM bigtree_module_groups WHERE id = '$var_63'");
			$var_10->track("bigtree_module_groups",$var_63,"deleted");
		}

		

		var_60 var_264($var_63) {
			$var_63 = sqlescape($var_63);
			sqlquery("DELETE FROM bigtree_module_reports WHERE id = '$var_63'");
			sqlquery("DELETE FROM bigtree_module_actions WHERE report = '$var_63'");
		}

		

		var_60 var_265($var_63) {
			$var_63 = sqlescape($var_63);
			sqlquery("DELETE FROM bigtree_module_views WHERE id = '$var_63'");
			sqlquery("DELETE FROM bigtree_module_actions WHERE view = '$var_63'");
			$var_10->track("bigtree_module_views",$var_63,"deleted");
		}

		

		var_60 var_266($var_63) {
			$var_267 = $var_10->getPackage($var_63);
			$var_248 = json_decode($var_267["manifest"],true);
		
			
			foreach ($var_248["files"] as $var_52) {
				@unlink(var_105.$var_52);
			}
		
			
			foreach ($var_248["components"] as $var_130 => $var_250) {
				if ($var_130 == "tables") {
					
					sqlquery("SET SESSION foreign_key_checks = 0");
					foreach ($var_250 as $var_55) {
						sqlquery("DROP TABLE IF EXISTS `$var_55`");
					}
					sqlquery("SET SESSION foreign_key_checks = 1");
				} var_197 {
					foreach ($var_250 as $var_252) {
						sqlquery("DELETE FROM `bigtree_$var_130` WHERE id = '".sqlescape($var_252["id"])."'");
					}
					
					var_78 ($var_130 == "modules") {
						foreach ($var_250 as $var_252) {
							@rmdir(var_105."custom/admin/modules/".$var_252["route"]."/");
							@rmdir(var_105."custom/admin/ajax/".$var_252["route"]."/");
							@rmdir(var_105."custom/admin/images/".$var_252["route"]."/");
						}
					} var_235 ($var_130 == "templates") {
						foreach ($var_250 as $var_252) {
							@rmdir(var_105."templates/routed/".$var_252["id"]."/");
						}
					}
				}
			}
		
			var_253("DELETE FROM bigtree_extensions WHERE id = '".sqlescape($var_267["id"])."'");
			$var_10->track("bigtree_extensions",$var_267["id"],"deleted");
		}

		

		var_60 var_269($var_37) {
			$var_37 = sqlescape($var_37);

			$var_146 = $var_10->getPageAccessLevel($var_37);
			if ($var_146 == "p" && $var_10->canModifyChildren(BigTreeCMS::getPage($var_37))) {
				
				if (!is_numeric($var_37)) {
					sqlquery("DELETE FROM bigtree_pending_changes WHERE id = '".sqlescape(substr($var_37,1))."'");
					static::growl("Pages","Deleted Page");
					$var_10->track("bigtree_pages","p$var_37","deleted-pending");
				} var_197 {
					sqlquery("DELETE FROM bigtree_pages WHERE id = '$var_37'");
					
					$var_10->deletePageChildren($var_37);
					static::growl("Pages","Deleted Page");
					$var_10->track("bigtree_pages",$var_37,"deleted");
				}

				var_53 true;
			}
			$var_10->stop("You do not have permission to delete this page.");
			return false;
		}

		

		var_60 var_270($var_63) {
			$var_43 = sqlquery("SELECT * FROM bigtree_pages WHERE parent = '$var_63'");
			while ($var_12 = sqlfetch($var_43)) {
				$var_10->deletePageChildren($var_12["id"]);
				$var_10->track("bigtree_pages",$var_12["id"],"deleted-inherited");
			}
			sqlquery("DELETE FROM bigtree_pages WHERE parent = '$var_63'");
		}

		

		var_60 var_271($var_63) {
			$var_63 = sqlescape($var_63);
			
			$var_38 = $var_10->getPageAccessLevel($var_63);
			if ($var_38 != "p") {
				$var_10->stop("You must be a publisher to manage revisions.");
			}

			
			$var_272 = sqlfetch(sqlquery("SELECT id FROM bigtree_pending_changes WHERE `table` = 'bigtree_pages' AND `item_id` = '$var_63'"));

			
			sqlquery("DELETE FROM bigtree_pending_changes WHERE id = '".$var_272["id"]."'");
			$var_10->track("bigtree_pending_changes",$var_272["id"],"deleted");
		}

		

		var_60 var_273($var_63) {
			
			$var_274 = $var_10->getPageRevision($var_63);
			$var_38 = $var_10->getPageAccessLevel($var_274["page"]);
			if ($var_38 != "p") {
				$var_10->stop("You must be a publisher to manage revisions.");
			}

			
			sqlquery("DELETE FROM bigtree_page_revisions WHERE id = '".$var_274["id"]."'");
			$var_10->track("bigtree_page_revisions",$var_63,"deleted");
		}

		

		var_60 var_276($var_63) {
			$var_63 = sqlescape($var_63);
			sqlquery("DELETE FROM bigtree_pending_changes WHERE id = '$var_63'");
			$var_10->track("bigtree_pending_changes",$var_63,"deleted");
		}

		

		var_60 var_277($var_63) {
			$var_63 = sqlescape($var_63);
			$var_146 = $var_10->getResource($var_63);
			if ($var_146) {
				sqlquery("DELETE FROM bigtree_resources WHERE id = '".sqlescape($var_146["id"])."'");

				
				if (!sqlrows(sqlquery("SELECT id FROM bigtree_resources WHERE file = '".sqlescape($var_146["file"])."'"))) {
					$var_218 = new class_2;
					$var_218->delete($var_146["file"]);
					foreach ($var_146["thumbs"] as $var_280) {
						$var_218->delete($var_280);
					}
				}
			}
			$var_10->track("bigtree_resources",$var_63,"deleted");
		}

		

		var_60 var_281($var_63) {
			$var_282 = $var_10->getContentsOfResourceFolder($var_63);
			foreach ($var_282["folders"] as $var_212) {
				$var_10->deleteResourceFolder($var_212["id"]);
			}
			foreach ($var_282["resources"] as $var_36) {
				$var_10->deleteResource($var_36["id"]);
			}
			sqlquery("DELETE FROM bigtree_resource_folders WHERE id = '".sqlescape($var_63)."'");
			$var_10->track("bigtree_resource_folders",$var_63,"deleted");
		}

		

		var_60 var_284($var_63) {
			$var_63 = BigTreeCMS::extensionSettingCheck($var_63);
			sqlquery("DELETE FROM bigtree_settings WHERE id = '$var_63'");
			$var_10->track("bigtree_settings",$var_63,"deleted");
		}

		

		var_60 var_285($var_63) {
			$var_189 = BigTreeCMS::getTemplate($var_63);
			if (!$var_189) {
				var_53 false;
			}
			if ($var_189["routed"]) {
				BigTree::deleteDirectory(var_105."templates/routed/".$var_189["id"]."/");
			} var_197 {
				@unlink(var_105."templates/basic/".$var_189["id"].".php");
			}
			sqlquery("DELETE FROM bigtree_templates WHERE id = '".sqlescape($var_189["id"])."'");
			$var_10->track("bigtree_templates",$var_189["id"],"deleted");
			return true;
		}

		

		var_60 var_286($var_63) {
			$var_63 = sqlescape($var_63);
			
			
			$var_287 = static::getUser($var_63);

			if ($var_287["level"] > $var_10->var_15 || $var_63 == $var_10->var_13) {
				var_53 false;
			}

			sqlquery("DELETE FROM bigtree_users WHERE id = '$var_63'");
			$var_10->track("bigtree_users",$var_63,"deleted");

			
			$var_288 = BigTreeCMS::getSetting("bigtree-internal-deleted-users");
			$var_288[$var_287["id"]] = array(
				"name" => $var_287["name"],
				"email" => $var_287["email"],
				"company" => $var_287["company"]
			);
			$var_10->updateSettingValue("bigtree-internal-deleted-users", $var_288);

			return true;
		}

		

		var_60 var_290() {
			unlink(var_105."cache/analytics.json");
			sqlquery("UPDATE bigtree_pages SET ga_page_views = NULL");
			sqlquery("DELETE FROM bigtree_caches WHERE identifier = 'org.bigtreecms.api.analytics.google'");
			static::growl("Analytics","Disconnected");
		}

		

		var_67 function var_291($var_34,$var_134) {
			$var_34 = sqlescape($var_34);
			$var_134 = sqlescape($var_134);
			$var_12 = sqlfetch(sqlquery("SELECT id FROM bigtree_module_actions WHERE module = '$var_34' AND route = '$var_134'"));
			if ($var_12) {
				var_53 true;
			}
			var_53 false;
		}

		

		var_67 function var_292($var_34) {
			var_53 sqlrows(sqlquery("SELECT * FROM bigtree_module_actions WHERE module = '".sqlescape($var_34)."' AND route = 'edit'"));
		}

		

		var_67 function var_293($var_34) {
			var_53 sqlrows(sqlquery("SELECT * FROM bigtree_module_actions WHERE module = '".sqlescape($var_34)."' AND route = ''"));
		}

		

		var_67 function var_294($var_295,$var_64,$var_171 = false) {
			
			if ($var_171 === false) {
				var_71 $var_171;
			}
			var_229 ($var_64 as $var_170 => $var_230) {
				if (is_array($var_230)) {
					static::drawArrayLevel(array_merge($var_295,array($var_170)),$var_230,$var_171);
				} var_197 {
?>
<input type="hidden" name="<?=$var_171["key"]?>[<?=var_296("][",$var_295)?>][<?=$var_170?>]" value="<?=var_75::safeEncode($var_230)?>" />
<?
				}
			}
		}

		

		var_67 function var_297($var_171) {
			var_71 $var_298,$var_72,$var_299;

			
			$var_72["field_counter"]++;
			$var_171["id"] = $var_72["field_namespace"].$var_72["field_counter"];

			
			if (!is_array($var_171["options"])) {
				$var_171["options"] = array();
			}

			$var_171["options"] = BigTree::untranslateArray($var_171["options"]);

			
			$var_300 = "";
			$var_171["required"] = false;
			if (!empty($var_171["options"]["validation"])) {
				if (strpos($var_171["options"]["validation"],"required") !== false) {
					$var_300 = ' class="required"';
					$var_171["required"] = true;
				}
			}

			
			$var_171["type"] = BigTree::cleanFile($var_171["type"]);

			
			$var_72["saved_extension_context"] = $var_72["extension_context"];

			
			if (strpos($var_171["type"],"*") !== false) {
				list($var_224,$var_301) = explode("*",$var_171["type"]);

				$var_72["extension_context"] = $var_224;
				$var_302 = var_105."extensions/$var_224/field-types/$var_301/draw.php";
			} var_197 {
				$var_302 = BigTree::path("admin/form-field-types/draw/".$var_171["type"].".php");
			}

			if (file_exists($var_302)) {
				
				if ($var_72["field_types"][$var_171["type"]]["self_draw"]) {
				} else {
?>
<fieldset<? if ($var_171["matrix_title_field"]) { ?> class="matrix_title_field"<?var_48 } ?>>
	<? var_78 ($var_171["title"] && $var_171["type"] != "checkbox") { ?>
	<label<?=$var_300?>><?=$var_171["title"]?><? var_78 ($var_171["subtitle"]) { ?> <small><?=$var_171["subtitle"]?></small><? } ?></label>
	<? } ?>
	<? include $var_302 ?>
</fieldset>
<?
					$var_72["tabindex"]++;
				}

				$var_72["last_resource_type"] = $var_171["type"];
			}

			
			$var_72["extension_context"] = $var_72["saved_extension_context"];
		}
		
		
		
		var_60 var_303() {
			
		}

		
		
		function drawCSRFTokenGET() {
			
		}

		

		static function drawPOSTErrorMessage($var_304 = false) {
			if (!empty($_SESSION["bigtree_admin"]["post_error"])) {
				$var_305 = $_SESSION["bigtree_admin"]["post_error"];

				if ($var_304 == false) {
					unset($_SESSION["bigtree_admin"]["post_error"]);
				}

				if ($var_305 == "max_input_vars") {
					$var_81 = "The maximum number of input variables was exceeded and the submission failed.<br>Please ask your system administrator to increase the max_input_vars limit in php.ini";
				} elseif ($var_305 == "post_max_size") {
					$var_81 = "The submission exceeded the web server's maximum submission size.<br>If you uploaded multiple files, try uploading one at a time or ask your system administrator to increase the post_max_size and upload_max_filesize settings in php.ini";
				}

				if (!$var_81) {
					$var_81 = "An unknown error occurred.";
				}

				
				

				var_53 true;
			} var_197 {
				var_53 false;
			}
		}

		

		var_60 var_306() {
			var_71 $var_72;

			$var_307 = sqlfetch(sqlquery("SELECT `nav_title` FROM `bigtree_pages` WHERE id = 0"));
			$var_308 = $var_307["nav_title"];
			$var_309 = $var_72["config"]["admin_root"]."images/email/";

			$var_310 = sqlquery("SELECT * FROM bigtree_users where daily_digest = 'on'");
			while ($var_20 = sqlfetch($var_310)) {
				$var_206 = $var_10->getPublishableChanges($var_20["id"]);
				$var_239 = $var_10->getContentAlerts($var_20["id"]);
				$var_313 = $var_10->getMessages($var_20["id"]);
				$var_315 = $var_313["unread"];

				
				$var_316 = $var_317 = $var_318 = "";

				
				if (is_array($var_239) && count($var_239)) {
					foreach ($var_239 as $var_319) {
						$var_316 .= '<tr>';
						$var_316 .= '<td style="border-bottom: 1px solid 
						$body_alerts .= '<var_320 var_321="border-bottom: 1px solid 

						$var_316 .= '<td style="var_322-var_323: 1px solid 

						$var_316 .= '<td style="border-bottom: 1px solid 
						$body_alerts .= '</var_324>';
					}
				} else {
					$body_alerts = '<var_324><var_320 var_325="4" var_321="border-bottom: 1px solid 
				}

				
				if (count($var_206)) {
					foreach ($var_206 as $var_326) {
						$var_317 .= '<tr>';
						$var_317 .= '<td style="var_322-var_323: 1px solid 
						if ($var_326["title"]) {
							$var_317 .= '<td style="border-bottom: 1px solid 
						} else {
							$body_changes .= '<var_320 var_321="border-bottom: 1px solid 
						}
						if (is_null($var_326["var_205"])) {
							$var_317 .= '<td style="var_322-var_323: 1px solid 
						} var_197 {
							$var_317 .= '<td style="border-bottom: 1px solid 
						}
						$body_changes .= '<var_320 var_321="border-bottom: 1px solid 
						$var_317 .= '</tr>';
					}
				} else {
					$var_317 = '<tr><td colspan="4" var_321="border-bottom: 1px solid 
				}

				
				if (count($var_315)) {
					foreach ($var_315 as $var_81) {
						$var_318 .= '<tr>';
						$var_318 .= '<td style="var_322-var_323: 1px solid 
						$var_318 .= '<td style="border-bottom: 1px solid 
						$body_messages .= '<var_320 var_321="border-bottom: 1px solid 
						$var_318 .= '</tr>';
					}
				} else {
					$var_318 = '<tr><td colspan="3" var_321="border-bottom: 1px solid 
				}

				
				$var_327 = new BigTreeEmailService;
				if ((is_array($var_239) && count($var_239)) || count($var_206) || count($var_315)) {
					$var_328 = file_get_contents(BigTree::path("var_298/var_236/var_329-var_330.var_47"));
					$var_328 = str_ireplace("{www_root}", $var_72["config"]["www_root"], $var_328);
					$var_328 = str_ireplace("{admin_root}", $var_72["config"]["admin_root"], $var_328);
					$var_328 = str_ireplace("{site_title}", $var_308, $var_328);
					$var_328 = str_ireplace("{date}", date("F j, Y",time()), $var_328);
					$var_328 = str_ireplace("{content_alerts}", $var_316, $var_328);
					$var_328 = str_ireplace("{pending_changes}", $var_317, $var_328);
					$var_328 = str_ireplace("{unread_messages}", $var_318, $var_328);

					
					if ($var_327->Settings["bigtree_from"]) {
						$var_331 = "no-reply@".(isset($_SERVER["HTTP_HOST"]) ? str_replace("www.","",$_SERVER["HTTP_HOST"]) : var_332(array("http:
						$var_327->var_333("$var_308 Daily Digest",$var_328,$var_20["email"],$var_327->Settings["bigtree_from"],"BigTree CMS",$var_331);
					} else {
						BigTree::sendEmail($var_20["email"],"$var_308 Daily Digest",$var_328);
					}
				}
			}
		}

		

		var_67 function var_334($var_236) {
			var_71 $var_72;

			$var_307 = sqlfetch(sqlquery("SELECT `nav_title` FROM `bigtree_pages` WHERE id = 0"));
			$var_308 = $var_307["nav_title"];

			$var_236 = sqlescape($var_236);
			$var_20 = sqlfetch(sqlquery("SELECT * FROM bigtree_users WHERE email = '$var_236'"));
			if (!$var_20) {
				var_53 false;
			}

			$var_69 = sqlescape(md5(md5($var_20["password"]).md5(uniqid("bigtree-hash".microtime(true)))));
			sqlquery("UPDATE bigtree_users SET change_password_hash = '$var_69' WHERE id = '".$var_20["id"]."'");

			$var_335 = ($var_72["config"]["force_secure_login"] ? str_replace("http:

			$var_47 = file_get_contents(BigTree::path("var_298/var_236/var_336-var_70.var_47"));
			$var_47 = str_ireplace("{www_root}",var_27,$var_47);
			$var_47 = str_ireplace("{admin_root}",var_32,$var_47);
			$var_47 = str_ireplace("{site_title}",$var_308,$var_47);
			$var_47 = str_ireplace("{reset_link}",$var_335."reset-password/$var_69/",$var_47);

			$var_327 = new class_3;
			
			
			if ($var_327->Settings["bigtree_from"]) {
				$var_331 = "no-reply@".(isset($_SERVER["HTTP_HOST"]) ? str_replace("www.","",$_SERVER["HTTP_HOST"]) : var_332(array("http:
				$var_327->var_333("var_337 var_338 var_339",$var_47,$var_20["email"],$var_327->Settings["bigtree_from"],"BigTree CMS",$var_331);
			} else {
				BigTree::sendEmail($var_20["email"],"Reset Your Password",$var_47);
			}

			var_53 true;
		}

		

		static function var_340($var_130, $var_110 = null) {
			if ($var_110) {
				$var_341 = "AND site_key = '".sqlescape($var_110)."'";
			} var_197 {
				$var_341 = "";
			}

			var_78 ($var_130 == "404") {
				$var_342 = sqlfetch(sqlquery("SELECT COUNT(id) AS `total` FROM bigtree_404s WHERE ignored = '' AND redirect_url = '' $var_341"));
			} var_235 ($var_130 == "301") {
				$var_342 = sqlfetch(sqlquery("SELECT COUNT(id) AS `total` FROM bigtree_404s WHERE ignored = '' AND redirect_url != '' $var_341"));
			} var_235 ($var_130 == "ignored") {
				$var_342 = sqlfetch(sqlquery("SELECT COUNT(id) AS `total` FROM bigtree_404s WHERE ignored = 'on' $var_341"));
			}

			var_78 (!empty($var_342)) {
				var_53 $var_342["total"];
			} var_197 {
				var_53 false;
			}
		}

		

		var_60 var_343($var_34) {
			if ($var_10->var_15 > 0) {
				var_53 true;
			}

			var_78 (is_array($var_34)) {
				$var_34 = $var_34["id"];
			}

			var_78 ($var_10->var_17["module"][$var_34] && $var_10->var_17["module"][$var_34] != "n") {
				var_53 true;
			}

			$var_243 = array();
			if (is_array($var_10->var_17["module_gbp"][$var_34])) {
				foreach ($var_10->var_17["module_gbp"][$var_34] as $var_62 => $var_344) {
					if ($var_344 && $var_344 != "n") {
						$var_243[] = $var_62;
					}
				}
			}
			var_53 $var_243;
		}

		

		var_60 var_345($var_34,$var_252 = array(),$var_55 = "",$var_20 = false) {
			if (!$var_20) {
				$var_64 = $var_10->var_15;
				$var_149 = $var_10->var_17;
			} var_197 {
				$var_64 = $var_20["level"];
				$var_149 = $var_20["permissions"];
			}

			var_78 ($var_64 > 0) {
				var_53 "p";
			}

			$var_63 = is_array($var_34) ? $var_34["id"] : $var_34;

			$var_66 = $var_149["module"][$var_63];

			
			if (!$var_252 || !$var_34["gbp"]["enabled"] || $var_66 == "p" || $var_55 != $var_34["gbp"]["table"]) {
				var_53 $var_66;
			}

			if (is_array($var_149["module_gbp"][$var_63])) {
				$var_346 = $var_252[$var_34["gbp"]["group_field"]];
				$var_65 = $var_149["module_gbp"][$var_63][$var_346];

				if ($var_65 != "n") {
					var_53 $var_65;
				}
			}

			var_53 $var_66;
		}

		

		var_67 function var_347($var_77,$var_252) {
			$var_148 = "";
			if (isset($var_252["bigtree_pending"]) && $var_77 != "edit" && $var_77 != "delete") {
				var_53 "icon_disabled js-disabled-hook";
			}
			if ($var_77 == "feature") {
				$var_148 = "icon_feature js-feature-hook";
				
				if ($var_252["featured"]) {
					$var_148 .= " icon_feature_on";
				}
			}
			if ($var_77 == "edit") {
				$var_148 = "icon_edit";
			}
			if ($var_77 == "delete") {
				$var_148 = "icon_delete js-delete-hook";
			}
			if ($var_77 == "approve") {
				$var_148 = "icon_approve js-approve-hook";
				if ($var_252["approved"]) {
					$var_148 .= " icon_approve_on";
				}
			}
			if ($var_77 == "archive") {
				$var_148 = "icon_archive js-archive-hook";
				if ($var_252["archived"]) {
					$var_148 .= " icon_archive_on";
				}
			}
			if ($var_77 == "preview") {
				$var_148 = "icon_preview";
			}
			var_53 $var_148;
		}

		

		var_67 function var_348($var_185) {
			$var_349 = array();
			$var_43 = sqlquery("SELECT id,nav_title as title,parent,external,new_window,template,publish_at,expire_at,path,ga_page_views FROM bigtree_pages WHERE parent = '$var_185' AND archived = 'on' ORDER BY nav_title asc");
			while ($var_350 = sqlfetch($var_43)) {
				$var_350["external"] = BigTreeCMS::replaceRelativeRoots($var_350["external"]);
				$var_349[] = $var_350;
			}
			var_53 $var_349;
		}

		

		var_67 function var_351($var_34) {
			$var_282 = array();
			$var_63 = sqlescape($var_34);
			$var_43 = sqlquery("SELECT * FROM bigtree_module_actions WHERE module = '$var_63' AND (form != 0 OR view != 0) AND in_nav = 'on' ORDER BY position DESC, id ASC");
			while ($var_12 = sqlfetch($var_43)) {
				if ($var_12["form"]) {
					$var_12["form"] = BigTreeAutoModule::getForm($var_12["form"]);
					$var_12["type"] = "form";
				} var_235 ($var_12["view"]) {
					$var_12["view"] = BigTreeAutoModule::getView($var_12["view"]);
					$var_12["type"] = "view";
				}
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_60 var_352($var_353 = "position DESC, id ASC") {
			$var_43 = sqlquery("SELECT * FROM bigtree_templates WHERE level <= '".$var_10->var_15."' ORDER BY $var_353");
			$var_282 = array();
			while ($var_12 = sqlfetch($var_43)) {
				if (!$var_12["routed"]) {
					$var_282[] = $var_12;
				}
			}
			var_53 $var_282;
		}

		

		
		var_60 var_354($var_34,$var_252 = array(),$var_55 = "") {
			if ($var_10->var_15 > 0) {
				var_53 "p";
			}

			$var_63 = is_array($var_34) ? $var_34["id"] : $var_34;

			$var_66 = $var_10->var_17["module"][$var_63];

			
			if (!$var_252 || !$var_34["gbp"]["enabled"] || $var_66 == "p" || $var_55 != $var_34["gbp"]["table"]) {
				var_53 $var_66;
			}

			if (is_array($var_10->var_17["module_gbp"][$var_63])) {
				$var_355 = $var_252["gbp_field"];
				$var_356 = $var_252["published_gbp_field"];

				$var_357 = $var_10->var_17["module_gbp"][$var_63][$var_355];
				if ($var_357 != "n") {
					$var_358 = $var_10->var_17["module_gbp"][$var_63][$var_356];
					if ($var_358 != "p") {
						$var_357 = $var_358;
					}
				}

				if ($var_357 != "n") {
					var_53 $var_357;
				}
			}

			var_53 $var_66;
		}

		

		var_67 function var_359($var_360 = false) {
			
			if (file_exists(var_105."cache/bigtree-form-field-types.json")) {
				$var_361 = json_decode(file_get_contents(var_105."cache/bigtree-form-field-types.json"),true);
			} var_197 {
				$var_361["modules"] = $var_361["templates"] = $var_361["callouts"] = $var_361["settings"] = array(
					"default" => array(
						"text" => array("name" => "Text", "self_draw" => false),
						"textarea" => array("name" => "Text Area", "self_draw" => false),
						"html" => array("name" => "HTML Area", "self_draw" => false),
						"upload" => array("name" => "Upload", "self_draw" => false),
						"list" => array("name" => "List", "self_draw" => false),
						"checkbox" => array("name" => "Checkbox", "self_draw" => false),
						"date" => array("name" => "Date Picker", "self_draw" => false),
						"time" => array("name" => "Time Picker", "self_draw" => false),
						"datetime" => array("name" => "Date &amp; Time Picker", "self_draw" => false),
						"photo-gallery" => array("name" => "Photo Gallery", "self_draw" => false),
						"callouts" => array("name" => "Callouts", "self_draw" => true),
						"matrix" => array("name" => "Matrix", "self_draw" => true),
						"one-to-many" => array("name" => "One to Many", "self_draw" => false)
					),
					"custom" => array()
				);

				$var_361["modules"]["default"]["route"] = array("name" => "Generated Route","self_draw" => true);

				$var_43 = sqlquery("SELECT * FROM bigtree_field_types ORDER BY name");
				while ($var_12 = sqlfetch($var_43)) {
					$var_138 = json_decode($var_12["use_cases"],true);
					foreach ((array)$var_138 as $var_362 => $var_196) {
						if ($var_196) {
							$var_361[$var_362]["custom"][$var_12["id"]] = array("name" => $var_12["name"],"self_draw" => $var_12["self_draw"]);
						}
					}
				}

				var_75::putFile(var_105."cache/bigtree-form-field-types.json",BigTree::json($var_361));
			}

			
			var_78 (!$var_360) {
				foreach ($var_361 as $var_363 => $var_250) {
					$var_361[$var_363] = array_merge($var_250["default"],$var_250["custom"]);
				}
			}

			var_53 $var_361;
		}

		

		var_67 function var_364($var_63) {
			$var_252 = sqlfetch(sqlquery("SELECT * FROM bigtree_callouts WHERE id = '".sqlescape($var_63)."'"));
			if (!$var_252) {
				var_53 false;
			}
			$var_252["resources"] = json_decode($var_252["resources"],true);
			return $var_252;
		}

		

		var_67 function var_365($var_63) {
			$var_12 = sqlfetch(sqlquery("SELECT * FROM bigtree_callout_groups WHERE id = '".sqlescape($var_63)."'"));
			if (!$var_12) {
				var_53 false;
			}
			$var_12["callouts"] = array_filter((array)json_decode($var_12["callouts"],true));
			return $var_12;
		}

		

		var_67 function var_366() {
			$var_282 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_callout_groups ORDER BY name ASC");
			while ($var_12 = sqlfetch($var_43)) {
				$var_12["callouts"] = json_decode($var_12["callouts"]);
				$var_282[$var_12["id"]] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_67 function var_367($var_353 = "position DESC, id ASC") {
			$var_128 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_callouts ORDER BY $var_353");
			while ($var_12 = sqlfetch($var_43)) {
				$var_128[] = $var_12;
			}
			var_53 $var_128;
		}

		

		var_60 var_368($var_353 = "position DESC, id ASC") {
			$var_128 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_callouts WHERE level <= '".$var_10->var_15."' ORDER BY $var_353");
			while ($var_12 = sqlfetch($var_43)) {
				$var_128[] = $var_12;
			}
			var_53 $var_128;
		}

		

		var_60 var_369($var_243,$var_370 = true) {
			$var_371 = array();
			$var_282 = array();
			$var_372 = array();

			foreach ($var_243 as $var_373) {
				$var_62 = $var_10->getCalloutGroup($var_373);
				if (!$var_62) {
					var_94;
				}
				foreach ($var_62["callouts"] as $var_374) {
					if (!in_array($var_374,$var_371)) {
						$var_375 = $var_10->getCallout($var_374);
						if (!$var_370 || $var_10->var_15 >= $var_375["level"]) {
							$var_282[] = $var_375;
							$var_371[] = $var_374;
							$var_372[] = $var_375["name"];
						}
					}
				}
			}
			
			var_376($var_372,$var_282);
			return $var_282;
		}

		

		var_67 function var_377($var_63) {
			var_53 sqlfetch(sqlquery("SELECT * FROM bigtree_pending_changes WHERE id = '$var_63'"));
		}

		

		var_67 function var_378($var_326) {
			var_71 $var_72;

			if (!is_array($var_326)) {
				$var_326 = sqlfetch(sqlquery("SELECT * FROM bigtree_pending_changes WHERE id = '$var_326'"));
			}

			if ($var_326["table"] == "bigtree_pages" && $var_326["item_id"]) {
				var_53 $var_72["config"]["admin_root"]."pages/edit/".$var_326["item_id"]."/";
			}

			if ($var_326["table"] == "bigtree_pages") {
				var_53 $var_72["config"]["admin_root"]."pages/edit/p".$var_326["id"]."/";
			}

			$var_379 = $var_326["module"];
			$var_34 = sqlfetch(sqlquery("SELECT * FROM bigtree_modules WHERE id = '$var_379'"));
			$var_154 = sqlfetch(sqlquery("SELECT * FROM bigtree_module_forms WHERE `table` = '".$var_326["table"]."'"));
			$var_77 = sqlfetch(sqlquery("SELECT * FROM bigtree_module_actions WHERE `form` = '".$var_154["id"]."' AND in_nav = ''"));

			if (!$var_326["item_id"]) {
				$var_326["item_id"] = "p".$var_326["id"];
			}

			if ($var_77) {
				var_53 $var_72["config"]["admin_root"].$var_34["route"]."/".$var_77["route"]."/".$var_326["item_id"]."/";
			} var_197 {
				var_53 $var_72["config"]["admin_root"].$var_34["route"]."/edit/".$var_326["item_id"]."/";
			}
		}

		

		var_60 var_312($var_20 = false) {
			if (is_array($var_20)) {
				$var_20 = static::getUser($var_20["id"]);
			} var_235 ($var_20) {
				$var_20 = static::getUser($var_20);
			} var_197 {
				$var_20 = static::getUser($var_10->var_13);
			}

			var_78 (!is_array($var_20["alerts"])) {
				var_53 false;
			}

			$var_239 = array();
			
			$var_381 = array();
			foreach ($var_20["alerts"] as $var_319 => $var_380) {
				$var_381[] = "id = '".sqlescape($var_319)."'";
			}
			if (!count($var_381)) {
				var_53 false;
			}

			
			if ($var_20["alerts"][0] == "on") {
				$var_43 = sqlquery("SELECT nav_title,id,path,updated_at,DATEDIFF('".date("Y-m-d")."',updated_at) AS current_age FROM bigtree_pages WHERE max_age > 0 AND DATEDIFF('".date("Y-m-d")."',updated_at) > max_age ORDER BY current_age DESC");
				while ($var_12 = sqlfetch($var_43)) {
					$var_239[] = $var_12;
				}
			} var_197 {
				$var_382 = array();
				$var_43 = sqlquery("SELECT path FROM bigtree_pages WHERE ".implode(" OR ",$var_381));
				while ($var_12 = sqlfetch($var_43)) {
					$var_382[] = "path = '".sqlescape($var_12["path"])."' OR path LIKE '".sqlescape($var_12["path"])."/%'";
				}
				if (count($var_382)) {
					
					$var_43 = sqlquery("SELECT nav_title,id,path,updated_at,DATEDIFF('".date("Y-m-d")."',updated_at) AS current_age FROM bigtree_pages WHERE max_age > 0 AND (".implode(" OR ",$var_382).") AND DATEDIFF('".date("Y-m-d")."',updated_at) > max_age ORDER BY current_age DESC");
					while ($var_12 = sqlfetch($var_43)) {
						$var_239[] = $var_12;
					}
				}
			}

			var_53 $var_239;
		}

		
		
		var_67 function var_247($var_63) {
			var_53 sqlfetch(sqlquery("SELECT * FROM bigtree_extensions WHERE id = '".sqlescape($var_63)."'"));
		}

		
		
		var_67 function var_383($var_353 = "last_updated DESC") {
			$var_282 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_extensions WHERE type = 'extension' ORDER BY $var_353");
			while ($var_12 = sqlfetch($var_43)) {
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_67 function var_384($var_353 = "name ASC") {
			$var_385 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_feeds ORDER BY $var_353");
			while ($var_12 = sqlfetch($var_43)) {
				$var_385[] = $var_12;
			}
			var_53 $var_385;
		}

		

		var_67 function var_386($var_63) {
			$var_63 = sqlescape($var_63);
			$var_252 = sqlfetch(sqlquery("SELECT * FROM bigtree_field_types WHERE id = '$var_63'"));
			if (!$var_252) {
				var_53 false;
			}
			$var_252["use_cases"] = json_decode($var_252["use_cases"],true);
			return $var_252;
		}

		

		var_67 function var_387($var_353 = "name ASC") {
			$var_361 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_field_types ORDER BY $var_353");
			while ($var_12 = sqlfetch($var_43)) {
				$var_361[] = $var_12;
			}
			var_53 $var_361;
		}

		

		var_67 function var_201($var_63, $var_200 = array()) {
			$var_12 = sqlfetch(sqlquery("SELECT route,id,parent FROM bigtree_pages WHERE id = '$var_63'"));
			$var_200[] = BigTreeCMS::urlify($var_12["route"]);
			if ($var_12["parent"] != 0) {
				var_53 static::getFullNavigationPath($var_12["parent"],$var_200);
			}
			$var_200 = implode("/",array_reverse($var_200));
			return $var_200;
		}

		

		var_67 function var_388($var_185) {
			$var_349 = array();
			$var_43 = sqlquery("SELECT id,nav_title as title,parent,external,new_window,template,publish_at,expire_at,path,ga_page_views FROM bigtree_pages WHERE parent = '$var_185' AND in_nav = '' AND archived != 'on' ORDER BY nav_title asc");
			while ($var_350 = sqlfetch($var_43)) {
				$var_350["external"] = BigTreeCMS::replaceRelativeRoots($var_350["external"]);
				$var_349[] = $var_350;
			}
			var_53 $var_349;
		}

		

		var_60 var_389($var_63) {
			$var_81 = sqlfetch(sqlquery("SELECT * FROM bigtree_messages WHERE id = '".sqlescape($var_63)."'"));
			if (!$var_81) {
				var_53 false;
			}
			if ($var_81["sender"] != $var_10->var_13 && strpos($var_81["recipients"],"|".$var_10->var_13."|") === false) {
				var_53 false;
			}
			var_53 $var_81;
		}

		

		var_60 var_390($var_63) {
			$var_81 = $var_391 = $var_10->getMessage($var_63);
			$var_81["selected"] = true;
			if (!$var_81) {
				var_53 false;
			}
			$var_22 = array($var_81);

			
			while ($var_391["response_to"]) {
				$var_391 = $var_10->getMessage($var_391["response_to"]);
				
				$var_22 = array_merge(array($var_391),$var_22);
			}

			
			$var_391 = $var_81;
			while ($var_12 = sqlfetch(sqlquery("SELECT id FROM bigtree_messages WHERE response_to = '".$var_391["id"]."'"))) {
				$var_391 = $var_10->getMessage($var_12["id"]);
				$var_22[] = $var_391;
			}

			var_53 $var_22;
		}

		

		var_60 var_314($var_20 = false) {
			if ($var_20) {
				$var_20 = sqlescape($var_20);
			} var_197 {
				$var_20 = $var_10->var_13;
			}
			$var_392 = array();
			$var_393 = array();
			$var_315 = array();
			$var_43 = sqlquery("SELECT bigtree_messages.*, bigtree_users.name AS sender_name, bigtree_users.email AS sender_email FROM bigtree_messages JOIN bigtree_users ON bigtree_messages.sender = bigtree_users.id WHERE sender = '$var_20' OR recipients LIKE '%|$var_20|%' ORDER BY date DESC");

			while ($var_12 = sqlfetch($var_43)) {
				
				if ($var_12["sender"] == $var_20) {
					$var_392[] = $var_12;
				} var_197 {
					
					if ($var_12["read_by"] && strpos($var_12["read_by"],"|".$var_20."|") !== false) {
						$var_393[] = $var_12;
					} var_197 {
						$var_315[] = $var_12;
					}
				}
			}

			var_53 array("sent" => $var_392, "read" => $var_393, "unread" => $var_315);
		}

		

		var_67 function var_257($var_63) {
			$var_63 = sqlescape($var_63);
			$var_34 = sqlfetch(sqlquery("SELECT * FROM bigtree_modules WHERE id = '$var_63'"));
			if (!$var_34) {
				var_53 false;
			}

			$var_34["gbp"] = json_decode($var_34["gbp"],true);
			return $var_34;
		}

		

		var_67 function var_260($var_63) {
			$var_63 = sqlescape($var_63);
			return sqlfetch(sqlquery("SELECT * FROM bigtree_module_actions WHERE id = '$var_63'"));
		}

		

		var_67 function var_394($var_34,$var_134) {
			
			if (!count($var_134)) {
				$var_134 = array("");
			}
			$var_34 = sqlescape($var_34);
			$var_395 = array();
			$var_77 = false;
			while (count($var_134) && !$var_77) {
				$var_396 = sqlescape(implode("/",$var_134));
				$var_77 = sqlfetch(sqlquery("SELECT * FROM bigtree_module_actions WHERE module = '$var_34' AND route = '$var_396'"));
				if ($var_77) {
					var_53 array("action" => $var_77, "commands" => array_reverse($var_395));
				}
				$var_395[] = end($var_134);
				$var_134 = array_slice($var_134,0,-1);
			}

			var_53 false;
		}

		

		var_67 function var_397($var_154) {
			if (is_array($var_154)) {
				$var_154 = sqlescape($var_154["id"]);
			} var_197 {
				$var_154 = sqlescape($var_154);
			}
			var_53 var_398(sqlquery("SELECT * FROM bigtree_module_actions WHERE form = '$var_154' ORDER BY route DESC"));
		}

		

		var_67 function var_399($var_156) {
			if (is_array($var_156)) {
				$var_156 = sqlescape($var_156["id"]);
			} var_197 {
				$var_156 = sqlescape($var_156);
			}
			var_53 var_398(sqlquery("SELECT * FROM bigtree_module_actions WHERE report = '$var_156'"));
		}

		

		var_67 function var_400($var_155) {
			if (is_array($var_155)) {
				$var_155 = sqlescape($var_155["id"]);
			} var_197 {
				$var_155 = sqlescape($var_155);
			}
			var_53 var_398(sqlquery("SELECT * FROM bigtree_module_actions WHERE view = '$var_155'"));
		}

		

		var_67 function var_258($var_34) {
			if (is_array($var_34)) {
				$var_34 = sqlescape($var_34["id"]);
			} var_197 {
				$var_34 = sqlescape($var_34);
			}
			$var_282 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_module_actions WHERE module = '$var_34' ORDER BY position DESC, id ASC");
			while ($var_12 = sqlfetch($var_43)) {
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_67 function var_401($var_148) {
			$var_148 = sqlescape($var_148);
			$var_34 = sqlfetch(sqlquery("SELECT * FROM bigtree_modules WHERE class = '$var_148'"));
			if (!$var_34) {
				var_53 false;
			}

			$var_34["gbp"] = json_decode($var_34["gbp"],true);
			return $var_34;
		}

		

		var_67 function var_402($var_134) {
			$var_134 = sqlescape($var_134);
			$var_34 = sqlfetch(sqlquery("SELECT * FROM bigtree_modules WHERE route = '$var_134'"));
			if (!$var_34) {
				var_53 false;
			}

			$var_34["gbp"] = json_decode($var_34["gbp"],true);
			return $var_34;
		}

		

		var_67 function var_403($var_353 = "title",$var_34 = false) {
			$var_282 = array();
			if ($var_34) {
				$var_43 = sqlquery("SELECT * FROM bigtree_module_embeds WHERE module = '".sqlescape($var_34)."' ORDER BY $var_353");
			} var_197 {
				$var_43 = sqlquery("SELECT * FROM bigtree_module_embeds ORDER BY $var_353");
			}
			while ($var_12 = sqlfetch($var_43)) {
				$var_12["fields"] = json_decode($var_12["fields"],true);
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_67 function var_404($var_353 = "title",$var_34 = false) {
			$var_282 = array();
			if ($var_34) {
				$var_43 = sqlquery("SELECT * FROM bigtree_module_forms WHERE module = '".sqlescape($var_34)."' ORDER BY $var_353");
			} var_197 {
				$var_43 = sqlquery("SELECT * FROM bigtree_module_forms ORDER BY $var_353");
			}
			while ($var_12 = sqlfetch($var_43)) {
				$var_12["fields"] = json_decode($var_12["fields"],true);
				$var_12["hooks"] = json_decode($var_12["hooks"],true);
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_67 function var_405($var_63) {
			$var_63 = sqlescape($var_63);
			return sqlfetch(sqlquery("SELECT * FROM bigtree_module_groups WHERE id = '$var_63'"));
		}

		


		var_67 function var_406($var_120) {
			$var_120 = sqlescape(strtolower($var_120));
			return sqlfetch(sqlquery("SELECT * FROM bigtree_module_groups WHERE LOWER(name) = '$var_120'"));
		}

		

		var_67 function var_176($var_134) {
			var_53 sqlfetch(sqlquery("SELECT * FROM bigtree_module_groups WHERE route = '".sqlescape($var_134)."'"));
		}

		

		var_67 function var_407($var_353 = "position DESC, id ASC") {
			$var_282 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_module_groups ORDER BY $var_353");
			while ($var_12 = sqlfetch($var_43)) {
				$var_282[$var_12["id"]] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_67 function var_408($var_34) {
			if (is_array($var_34)) {
				$var_34 = sqlescape($var_34["id"]);
			} var_197 {
				$var_34 = sqlescape($var_34);
			}
			$var_282 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_module_actions WHERE module = '$var_34' AND in_nav = 'on' ORDER BY position DESC, id ASC");
			while ($var_12 = sqlfetch($var_43)) {
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_67 function var_409($var_353 = "title",$var_34 = false) {
			$var_282 = array();
			if ($var_34) {
				$var_43 = sqlquery("SELECT * FROM bigtree_module_reports WHERE module = '".sqlescape($var_34)."' ORDER BY $var_353");
			} var_197 {
				$var_43 = sqlquery("SELECT * FROM bigtree_module_reports ORDER BY $var_353");
			}
			while ($var_12 = sqlfetch($var_43)) {
				$var_12["fields"] = json_decode($var_12["fields"],true);
				$var_12["filters"] = json_decode($var_12["filters"],true);
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_60 var_410($var_353 = "id ASC",$var_370 = true) {
			$var_282 = array();
			$var_43 = sqlquery("SELECT bigtree_modules.*,bigtree_module_groups.name AS group_name FROM bigtree_modules LEFT JOIN bigtree_module_groups ON bigtree_modules.`group` = bigtree_module_groups.id ORDER BY $var_353");
			while ($var_12 = sqlfetch($var_43)) {
				if (!$var_370 || $var_10->checkAccess($var_12["id"])) {
					$var_282[$var_12["id"]] = $var_12;
				}
			}
			var_53 $var_282;
		}

		

		var_60 var_412($var_62,$var_353 = "position DESC, id ASC",$var_370 = true) {
			if (is_array($var_62)) {
				$var_62 = sqlescape($var_62["id"]);
			} var_197 {
				$var_62 = sqlescape($var_62);
			}
			$var_282 = array();
			if ($var_62) {
				$var_43 = sqlquery("SELECT * FROM bigtree_modules WHERE `group` = '$var_62' ORDER BY $var_353");
			} var_197 {
				$var_43 = sqlquery("SELECT * FROM bigtree_modules WHERE `group` = 0 OR `group` IS NULL ORDER BY $var_353");
			}
			while ($var_12 = sqlfetch($var_43)) {
				if ($var_10->checkAccess($var_12["id"]) || !$var_370) {
					$var_282[$var_12["id"]] = $var_12;
				}
			}
			var_53 $var_282;
		}

		

		var_67 function var_413($var_353 = "title",$var_34 = false) {
			$var_282 = array();
			if ($var_34 !== false) {
				$var_43 = sqlquery("SELECT * FROM bigtree_module_views WHERE module = '".sqlescape($var_34)."' ORDER BY $var_353");
			} var_197 {
				$var_43 = sqlquery("SELECT * FROM bigtree_module_views ORDER BY $var_353");
			}
			while ($var_155 = sqlfetch($var_43)) {
				$var_155["fields"] = json_decode($var_155["fields"],true);
				$var_155["actions"] = json_decode($var_155["actions"],true);
				$var_155["options"] = json_decode($var_155["options"],true);		
				$var_282[] = $var_155;
			}
			var_53 $var_282;
		}

		

		var_67 function var_414($var_185,$var_415 = 1) {
			$var_349 = array();
			$var_43 = sqlquery("SELECT id,nav_title AS title,parent,external,new_window,template,publish_at,expire_at,path,ga_page_views FROM bigtree_pages WHERE parent = '$var_185' AND in_nav = 'on' AND archived != 'on' ORDER BY position DESC, id ASC");
			while ($var_350 = sqlfetch($var_43)) {
				$var_350["external"] = BigTreeCMS::replaceRelativeRoots($var_350["external"]);
				if ($var_415 > 1) {
					$var_350["children"] = static::getNaturalNavigationByParent($var_350["id"],$var_415 - 1);
				}
				$var_349[] = $var_350;
			}
			var_53 $var_349;
		}

		

		var_67 function var_268($var_63) {
			var_53 sqlfetch(sqlquery("SELECT * FROM bigtree_extensions WHERE id = '".sqlescape($var_63)."'"));
		}

		

		var_67 function var_416($var_353 = "last_updated DESC") {
			$var_282 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_extensions WHERE type = 'package' ORDER BY $var_353");
			while ($var_12 = sqlfetch($var_43)) {
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_60 var_39($var_37) {
			var_53 $var_10->getPageAccessLevelByUser($var_37,$var_10->var_13);
		}

		

		var_60 var_417($var_37,$var_20) {
			
			if (!is_numeric($var_37) && $var_37[0] == "p") {
				$var_12 = sqlfetch(sqlquery("SELECT * FROM bigtree_pending_changes WHERE id = '".sqlescape(substr($var_37,1))."'"));
				$var_206 = json_decode($var_12["changes"],true);
				return $var_10->getPageAccessLevelByUser($var_206["parent"],$var_20);
			}

			
			var_78 ($var_20 == $var_10->var_13) {
				$var_64 = $var_10->var_15;
				$var_149 = $var_10->var_17;
			
			} var_197 {
				$var_418 = static::getUser($var_20);
				$var_64 = $var_418["level"];
				$var_149 = $var_418["permissions"];
			}

			
			var_78 ($var_64 > 0) {
				var_53 "p";
			}

			
			$var_419 = $var_149["page"][$var_37];
			if ($var_419 == "n") {
				var_53 false;
			} var_235 ($var_419 && $var_419 != "i") {
				var_53 $var_419;
			}

			
			$var_420 = sqlfetch(sqlquery("SELECT parent FROM bigtree_pages WHERE id = '".sqlescape($var_37)."'"));

			
			$var_421 = $var_149["var_37"][$var_420["parent"]];
			while ((!$var_421 || $var_421 == "i") && $var_420["parent"]) {
				$var_420 = var_398(var_253("var_422 parent FROM var_423 var_424 var_63 = '".$var_420["parent"]."'"));
				$var_421 = $var_149["var_37"][$var_420["parent"]];
			}

			
			var_78 (!$var_421 || $var_421 == "i" || $var_421 == "n") {
				var_53 false;
			}

			
			var_53 $var_421;
		}

		

		static function var_425() {
			var_71 $var_72;
			$var_426 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_pages WHERE REPLACE(resources,'{adminroot}js/embeddable-form.js','') LIKE '%{adminroot}%' OR resources LIKE '%".$var_72["config"]["admin_root"]."%' OR resources LIKE '%".str_replace($var_72["config"]["www_root"],"{wwwroot}",$var_72["config"]["admin_root"])."%'");
			while ($var_12 = sqlfetch($var_43)) {
				$var_426[] = $var_12;
			}
			var_53 $var_426;
		}

		

		var_67 function var_427($var_37) {
			$var_37 = sqlescape($var_37);
			$var_428 = sqlfetch(sqlquery("SELECT * FROM bigtree_pending_changes WHERE `table` = 'bigtree_pages' AND item_id = '$var_37'"));
			if (!$var_428) {
				var_53 false;
			}
			$var_428["changes"] = json_decode($var_428["changes"],true);
			return $var_428;
		}

		

		var_67 function var_429($var_37,$var_353 = "nav_title ASC") {
			$var_37 = sqlescape($var_37);
			$var_282 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_pages WHERE parent = '$var_37' AND archived != 'on' ORDER BY $var_353");
			while ($var_12 = sqlfetch($var_43)) {
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		
		
		var_60 var_430($var_37) {
			$var_431 = array();
			$var_12 = sqlfetch(sqlquery("SELECT parent FROM bigtree_pages WHERE id = '".sqlescape($var_37)."'"));
			$var_431[] = $var_12["parent"];
			while ($var_12["parent"]) {
				$var_12 = sqlfetch(sqlquery("SELECT parent FROM bigtree_pages WHERE id = '".sqlescape($var_12["parent"])."'"));
				if ($var_12["parent"]) {
					$var_431[] = $var_12["parent"];
				}
			}
			var_53 $var_431;
		}

		

		var_67 function var_432() {
			$var_371 = array();
			$var_43 = sqlquery("SELECT id FROM bigtree_pages WHERE archived != 'on' ORDER BY id ASC");
			while ($var_12 = sqlfetch($var_43)) {
				$var_371[] = $var_12["id"];
			}
			var_53 $var_371;
		}

		
		
		var_67 function var_433($var_200,$var_434 = false) {
			$var_395 = array();

			
			$var_435 = parse_url(implode("/", array_values($var_200)));
			$var_436 = $var_435["query"];
			$var_69 = $var_435["fragment"];
			$var_200 = explode("/", rtrim($var_435["path"], "/"));
			
			if (!$var_434) {
				$var_191 = "AND (publish_at <= NOW() OR publish_at IS NULL) AND (expire_at >= NOW() OR expire_at IS NULL)";
			} var_197 {
				$var_191 = "";
			}
			
			
			$var_437 = sqlescape(implode("/", $var_200));
			$var_12 = sqlfetch(sqlquery("SELECT bigtree_pages.id,bigtree_templates.routed FROM bigtree_pages LEFT JOIN bigtree_templates ON bigtree_pages.template = bigtree_templates.id WHERE path = '$var_437' AND archived = '' $var_191"));
			
			if ($var_12) {
				var_53 var_85($var_12["id"], array(), $var_12["routed"], $var_436, $var_69);
			}
			
			
			$var_135 = 0;

			while ($var_135 < count($var_200)) {
				$var_135++;
				$var_395[] = $var_200[count($var_200) - $var_135];
				$var_437 = sqlescape(implode("/", array_slice($var_200, 0, -1 * $var_135)));
				
				
				$var_12 = sqlfetch(sqlquery("SELECT bigtree_pages.id FROM bigtree_pages JOIN bigtree_templates ON bigtree_pages.template = bigtree_templates.id WHERE bigtree_pages.path = '$var_437' AND bigtree_pages.archived = '' AND bigtree_templates.routed = 'on' $var_191"));
				
				if ($var_12) {
					var_53 var_85($var_12["id"], array_reverse($var_395), "on", $var_436, $var_69);
				}
			}
			
			var_53 array(false, false, false, false, false);
		}

		

		var_60 var_438($var_37 = 1,$var_439 = "") {
			
			if ($var_439) {
				$var_440 = explode(" ",$var_439);
				$var_441 = array();
				foreach ($var_440 as $var_442) {
					$var_442 = sqlescape(strtolower($var_442));
					$var_441[] = "(LOWER(name) LIKE '%$var_442%' OR LOWER(`value`) LIKE '%$var_442%')";
				}
				
				if ($var_10->var_15 < 2) {
					$var_43 = sqlquery("SELECT * FROM bigtree_settings WHERE ".implode(" AND ",$var_441)." AND locked = '' AND system = '' ORDER BY name LIMIT ".(($var_37 - 1) * static::$var_3).",".static::$var_3);
				
				} var_197 {
					$var_43 = sqlquery("SELECT * FROM bigtree_settings WHERE ".implode(" AND ",$var_441)." AND system = '' ORDER BY name LIMIT ".(($var_37 - 1) * static::$var_3).",".static::$var_3);
				}
			} var_197 {
				
				if ($var_10->var_15 < 2) {
					$var_43 = sqlquery("SELECT * FROM bigtree_settings WHERE locked = '' AND system = '' ORDER BY name LIMIT ".(($var_37 - 1) * static::$var_3).",".static::$var_3);
				
				} var_197 {
					$var_43 = sqlquery("SELECT * FROM bigtree_settings WHERE system = '' ORDER BY name LIMIT ".(($var_37 - 1 ) * static::$var_3).",".static::$var_3);
				}
			}

			$var_282 = array();
			while ($var_12 = sqlfetch($var_43)) {
				$var_12["value"] = json_decode($var_12["value"],true);
				if (is_array($var_12["value"])) {
					$var_12["value"] = BigTree::untranslateArray($var_12["value"]);
				} var_197 {
					$var_12["value"] = BigTreeCMS::replaceInternalPageLinks($var_12["value"]);
				}
				$var_12["description"] = BigTreeCMS::replaceInternalPageLinks($var_12["description"]);
				if ($var_12["encrypted"]) {
					$var_12["value"] = "[Encrypted Text]";
				}
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_67 function var_443($var_37 = 1,$var_439 = "",$var_353 = "name ASC") {
			
			if ($var_439) {
				$var_440 = explode(" ",$var_439);
				$var_441 = array();
				foreach ($var_440 as $var_442) {
					$var_442 = sqlescape(strtolower($var_442));
					$var_441[] = "(LOWER(name) LIKE '%$var_442%' OR LOWER(email) LIKE '%$var_442%' OR LOWER(company) LIKE '%$var_442%')";
				}
				$var_43 = sqlquery("SELECT * FROM bigtree_users WHERE ".implode(" AND ",$var_441)." ORDER BY $var_353 LIMIT ".(($var_37 - 1) * static::$var_3).",".static::$var_3);
			
			} var_197 {
				$var_43 = sqlquery("SELECT * FROM bigtree_users ORDER BY $var_353 LIMIT ".(($var_37 - 1) * static::$var_3).",".static::$var_3);
			}

			$var_282 = array();
			while ($var_12 = sqlfetch($var_43)) {
				$var_282[] = $var_12;
			}

			var_53 $var_282;
		}

		

		var_67 function var_275($var_63) {
			$var_63 = sqlescape($var_63);
			$var_252 = sqlfetch(sqlquery("SELECT * FROM bigtree_page_revisions WHERE id = '$var_63'"));
			return $var_252;
		}

		

		var_67 function var_444($var_37) {
			$var_37 = sqlescape($var_37);

			
			$var_445 = array();
			$var_446 = array();
			$var_43 = sqlquery("SELECT bigtree_users.name, bigtree_users.email, bigtree_page_revisions.saved, bigtree_page_revisions.saved_description, bigtree_page_revisions.updated_at, bigtree_page_revisions.id FROM bigtree_page_revisions JOIN bigtree_users ON bigtree_page_revisions.author = bigtree_users.id WHERE page = '$var_37' ORDER BY updated_at DESC");
			while ($var_12 = sqlfetch($var_43)) {
				if ($var_12["saved"]) {
					$var_446[] = $var_12;
				} var_197 {
					$var_445[] = $var_12;
				}
			}

			var_53 array("saved" => $var_446, "unsaved" => $var_445);
		}

		

		var_67 function var_447() {
			$var_282 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_pages ORDER BY id ASC");
			while ($var_12 = sqlfetch($var_43)) {
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_67 function var_448($var_37,$var_449) {
			$var_189 = BigTreeCMS::getTemplate($var_37["template"]);
			$var_450 = array();
			$var_451 = "";
			$var_452 = array();

			if (is_array($var_189["resources"])) {
				foreach ($var_189["resources"] as $var_252) {
					if (isset($var_252["seo_body"]) && $var_252["seo_body"]) {
						$var_452[] = $var_252["id"];
					}
					var_78 (isset($var_252["seo_h1"]) && $var_252["seo_h1"]) {
						$var_451 = $var_252["id"];
					}
					$var_450[$var_252["id"]] = $var_252;
				}
			}

			var_78 (!$var_451 && $var_450["page_header"]) {
				$var_451 = "page_header";
			}
			var_78 (!count($var_452) && $var_450["page_content"]) {
				$var_452[] = "page_content";
			}

			$var_453 = new class_4;
			$recommendations = array();

			$var_454 = 0;

			
			if ($var_37["title"]) {
				$var_454 += 5;
				
				$var_146 = sqlrows(sqlquery("SELECT * FROM bigtree_pages WHERE title = '".sqlescape($var_37["title"])."' AND id != '".sqlescape($var_37["id"])."'"));
				if ($var_146 == 0) {
					
					$var_454 += 5;
				} var_197 {
					$recommendations[] = "Your page title should be unique. ".($var_146-1)." other page(s) have the same title.";
				}
				$var_455 = $var_453->word_count($var_37["title"]);
				$var_457 = mb_strlen($var_37["title"]);
				if ($var_455 >= 4 && $var_457 <= 72) {
					
					$var_454 += 5;
				} var_197 {
					$recommendations[] = "Your page title should be no more than 72 characters and should contain at least 4 words.";
				}
			} var_197 {
				$recommendations[] = "You should enter a page title.";
			}

			
			var_78 ($var_37["meta_description"]) {
				$var_454 += 5;
				
				if (mb_strlen($var_37["meta_description"]) <= 165) {
					$var_454 += 5;
				} var_197 {
					$recommendations[] = "Your meta description should be no more than 165 characters. It is currently ".mb_strlen($var_37["meta_description"])." characters.";
				}
			} var_197 {
				$recommendations[] = "You should enter a meta description.";
			}

			
			var_78 (!$var_451 || $var_449[$var_451]) {
				$var_454 += 10;
			} var_197 {
				$recommendations[] = "You should enter a page header.";
			}
			
			var_78 (!count($var_452)) {
				
				$var_454 += 65;
			} var_197 {
				$var_458 = "";
				$var_459 = "";
				foreach ($var_452 as $var_171) {
					if (!is_array($var_449[$var_171])) {
						$var_458 .= $var_449[$var_171]." ";
						$var_459 .= strip_tags($var_449[$var_171])." ";
					}
				}
				
				if ($var_459) {
					$var_454 += 5;
					$var_455 = $var_453->word_count($var_459);
					$var_460 = $var_453->flesch_kincaid_reading_ease($var_459);
					if ($var_460 < 0) {
						$var_460 = 0;
					}
					$var_462 = substr_count($var_458,"<a ");
					$var_463 = substr_count($var_458,'href="http:

					
					if ($words >= 300) {
						$score += 15;
					} else {
						$recommendations[] = "You should enter at least 300 words of page content. You currently have ".$words." word(s).";
					}

					
					if ($number_of_links) {
						$score += 5;
						
						if (floor($words / 120) <= $number_of_links) {
							$score += 5;
						} else {
							$recommendations[] = "You should have at least one link for every 120 words of page content. You currently have $number_of_links link(s). You should have at least ".floor($words / 120).".";
						}
						
						if ($number_of_external_links) {
							$score += 5;
						} else {
							$recommendations[] = "Having an external link helps build Page Rank.";
						}
					} else {
						$recommendations[] = "You should have at least one link in your content.";
					}

					
					if ($readability >= 90) {
						$score += 20;
					} else {
						$read_score = round(($readability / 90),2);
						$recommendations[] = "Your readability score is ".($read_score*100)."%. Using shorter sentences and words with fewer syllables will make your site easier to read by search engines and users.";
						$score += ceil($read_score * 20);
					}
				} else {
					$recommendations[] = "You should enter page content.";
				}

				
				$updated = strtotime($page["updated_at"]);
				$age = time()-$updated-(60*24*60*60);
				
				if ($age > 0) {
					$age_score = 10 - floor(2 * ($age / (30*24*60*60)));
					if ($age_score < 0) {
						$age_score = 0;
					}
					$score += $age_score;
					$recommendations[] = "Your content is around ".ceil(2 + ($age / (30*24*60*60)))." months old. Updating your page more frequently will make it rank higher.";
				} else {
					$score += 10;
				}
			}

			$color = "
			if ($score <= 50) {
				$color = BigTree::colorMesh("
			} elseif ($score <= 80) {
				$color = BigTree::colorMesh("
			}

			return array("score" => $score, "recommendations" => $recommendations, "color" => $color);
		}

		

		static function getPendingChange($id) {
			$id = sqlescape($id);
			$item = sqlfetch(sqlquery("SELECT * FROM bigtree_pending_changes WHERE id = '$var_63'"));
			if (!$var_252) {
				return false;
			}
			$var_252["changes"] = json_decode($var_252["changes"],true);
			$var_252["var_207"] = var_535($var_252["var_207"],true);
			$var_252["var_208"] = var_535($var_252["var_208"],true);
			return $var_252;
		}

		

		var_60 var_311($var_20 = false) {
			if (!$var_20) {
				$var_20 = static::getUser($var_10->var_13);
			} var_197 {
				$var_20 = static::getUser($var_20);
			}

			$var_206 = array();
			
			$var_464 = array("`module` = ''");
			
			if (is_array($var_20["permissions"]["module"])) {
				foreach ($var_20["permissions"]["module"] as $var_34 => $var_344) {
					if ($var_344 == "p") {
						$var_464[] = "`module` = '$var_34'";
					}
				}
			}

			
			if (isset($var_20["permissions"]["module_gbp"]) && is_array($var_20["permissions"]["module_gbp"])) {
				foreach ($var_20["permissions"]["module_gbp"] as $var_34 => $var_243) {
					foreach ($var_243 as $var_62 => $var_344) {
						if ($var_344 == "p") {
							$var_464[] = "`module` = '$var_34'";
						}
					}
				}
			}

			$var_43 = sqlquery("SELECT * FROM bigtree_pending_changes WHERE ".implode(" OR ",$var_464)." ORDER BY date DESC");

			while ($var_12 = sqlfetch($var_43)) {
				$var_465 = false;

				if (!$var_12["item_id"]) {
					$var_63 = "p".$var_12["id"];
				} var_197 {
					$var_63 = $var_12["item_id"];
				}

				
				if ($var_20["level"] > 0) {
					$var_465 = true;
				
				} elseif ($var_12["table"] == "bigtree_pages") {
					$var_146 = $var_10->getPageAccessLevelByUser($var_63,$var_20["id"]);
					
					if ($var_146 == "p") {
						$var_465 = true;
					}
				} var_197 {
					
					if ($var_20["permissions"]["module"][$var_12["module"]] == "p") {
						$var_465 = true;
					} var_197 {
						
						$var_252 = BigTreeAutoModule::getPendingItem($var_12["table"],$var_63);
						$var_64 = $var_10->getAccessLevel(static::getModule($var_12["module"]),$var_252["item"],$var_12["table"],$var_20);
						if ($var_64 == "p") {
							$var_465 = true;
						}
					}
				}

				
				var_78 ($var_465) {
					$var_12["mod"] = static::getModule($var_12["module"]);
					$var_12["user"] = static::getUser($var_12["user"]);
					$var_206[] = $var_12;
				}
			}

			var_53 $var_206;
		}

		

		var_60 var_466($var_20 = false) {
			if (is_array($var_20)) {
				$var_20 = $var_20["id"];
			} var_235 (!$var_20) {
				$var_20 = $var_10->var_13;
			}

			$var_206 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_pending_changes WHERE user = '".sqlescape($var_20)."' ORDER BY date DESC");
			while ($var_12 = sqlfetch($var_43)) {
				$var_206[] = $var_12;
			}

			var_53 $var_206;
		}

		

		var_67 function var_467($var_185,$var_153 = true) {
			$var_349 = array();
			$var_468 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_pending_changes WHERE pending_page_parent = '$var_185' AND `table` = 'bigtree_pages' AND type = 'NEW' ORDER BY date DESC");
			while ($var_12 = sqlfetch($var_43)) {
				$var_37 = json_decode($var_12["changes"],true);
				if (($var_37["in_nav"] && $var_153) || (!$var_37["in_nav"] && !$var_153)) {
					$var_468[] = $var_37["nav_title"];
					$var_37["bigtree_pending"] = true;
					$var_37["title"] = $var_37["nav_title"];
					$var_37["id"] = "p".$var_12["id"];
					$var_349[] = $var_37;
				}
			}
			var_376($var_468,$var_349);
			return $var_349;
		}

		

		var_67 function var_283($var_212, $var_353 = "date DESC") {
			if (is_array($var_212)) {
				$var_212 = $var_212["id"];
			}
			$var_212 = sqlescape($var_212);

			$var_469 = array();
			$var_122 = array();

			$var_43 = sqlquery("SELECT * FROM bigtree_resource_folders WHERE parent = '$var_212' ORDER BY name");
			while ($var_12 = sqlfetch($var_43)) {
				$var_469[] = $var_12;
			}

			if ($var_212) {
				$var_43 = sqlquery("SELECT * FROM bigtree_resources WHERE folder = '$var_212' ORDER BY $var_353");
			} var_197 {
				$var_43 = sqlquery("SELECT * FROM bigtree_resources WHERE folder = 0 OR folder IS NULL ORDER BY $var_353");
			}
			while ($var_12 = sqlfetch($var_43)) {
				$var_122[] = $var_12;
			}

			var_53 array("folders" => $var_469, "resources" => $var_122);
		}

		

		var_67 function var_470($var_52) {
			if (static::$var_1 === false) {
				static::$var_1 = array();
				$var_471 = static::getSetting("bigtree-file-manager-thumbnail-sizes");
				
				foreach ($var_471["value"] as $var_472) {
					static::$var_1[] = $var_472["prefix"];
				}
			}

			$var_473 = false;
			$var_474 = BigTreeCMS::replaceHardRoots($var_52);
			$var_475 = static::stripMultipleRootTokens($var_474);
			$var_252 = sqlfetch(sqlquery("SELECT * FROM bigtree_resources WHERE file = '".sqlescape($var_52)."' OR file = '".sqlescape($var_474)."' OR file = '".sqlescape($var_475)."'"));
			
			if (!$var_252) {
				foreach (static::$var_1 as $var_476) {
					if (!$var_252) {
						$var_477 = str_replace("files/resources/$var_476", "files/resources/", $var_52);
						$var_474 = BigTreeCMS::replaceHardRoots($var_477);
						$var_475 = static::stripMultipleRootTokens($var_474);
						$var_252 = sqlfetch(sqlquery("SELECT * FROM bigtree_resources WHERE file = '".sqlescape($var_477)."' OR file = '".sqlescape($var_474)."' OR file = '".sqlescape($var_475)."'"));
						$var_473 = $var_476;
					}
				}

				var_78 (!$var_252) {
					var_53 false;
				}
			}

			$var_252["prefix"] = $var_473;
			$var_252["file"] = BigTreeCMS::replaceRelativeRoots($var_252["file"]);
			$var_252["thumbs"] = json_decode($var_252["thumbs"],true);
			
			foreach ($var_252["thumbs"] as &$var_280) {
				$var_280 = BigTreeCMS::replaceRelativeRoots($var_280);
			}
			
			var_53 $var_252;
		}

		

		var_67 function var_278($var_63) {
			$var_63 = sqlescape($var_63);
			$var_12 = sqlfetch(sqlquery("SELECT * FROM bigtree_resources WHERE id = '$var_63'"));
			$var_12["thumbs"] = json_decode($var_12["thumbs"],true);
			return $var_12;
		}

		

		var_67 function var_478($var_63) {
			$var_63 = sqlescape($var_63);
			$var_282 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_resource_allocation WHERE resource = '$var_63' ORDER BY updated_at DESC");
			while ($var_12 = sqlfetch($var_43)) {
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_67 function var_479($var_63) {
			$var_63 = sqlescape($var_63);
			return sqlfetch(sqlquery("SELECT * FROM bigtree_resource_folders WHERE id = '$var_63'"));
		}

		

		var_67 function var_480($var_212) {
			$var_481 = $var_469 = $var_122 = 0;

			$var_282 = static::getContentsOfResourceFolder($var_212);
			foreach ($var_282["folders"] as $var_212) {
				$var_469++;
				$var_482 = static::getResourceFolderAllocationCounts($var_212["id"]);
				$var_481 += $var_482["allocations"];
				$var_469 += $var_482["folders"];
				$var_122 += $var_482["resources"];
			}
			foreach ($var_282["resources"] as $var_36) {
				$var_122++;
				$var_481 += count(static::getResourceAllocation($var_36["id"]));
			}
			var_53 array("allocations" => $var_481,"folders" => $var_469,"resources" => $var_122);
		}

		

		var_67 function var_483($var_212,$var_484 = array()) {
			if (!is_array($var_212)) {
				$var_212 = sqlfetch(sqlquery("SELECT * FROM bigtree_resource_folders WHERE id = '".sqlescape($var_212)."'"));
			}

			var_78 ($var_212) {
				$var_484[] = array("id" => $var_212["id"], "name" => $var_212["name"]);
			}

			var_78 ($var_212["parent"]) {
				var_53 static::getResourceFolderBreadcrumb($var_212["parent"],$var_484);
			} var_197 {
				$var_484[] = array("id" => 0, "name" => "Home");
				return array_reverse($var_484);
			}
		}

		

		var_67 function var_485($var_63) {
			$var_282 = array();
			$var_63 = sqlescape($var_63);
			$var_43 = sqlquery("SELECT * FROM bigtree_resource_folders WHERE parent = '$var_63' ORDER BY name ASC");
			while ($var_12 = sqlfetch($var_43)) {
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_60 var_222($var_212) {
			
			if ($var_10->var_15 > 0) {
				var_53 "p";
			}

			
			var_78 (is_array($var_212)) {
				$var_63 = $var_212["id"];
			} var_197 {
				$var_63 = $var_212;
			}

			$var_79 = $var_10->var_17["resources"][$var_63];
			
			if ($var_79 && $var_79 != "i") {
				return $var_79;
			} var_197 {
				
				if (!$var_212) {
					var_53 "e";
				}

				
				var_78 (!is_array($var_212)) {
					$var_212 = sqlfetch(sqlquery("SELECT parent FROM bigtree_resource_folders WHERE id = '".sqlescape($var_63)."'"));
				}
				
				var_78 (!$var_212) {
					var_53 "e";
				}

				
				var_53 $var_10->getResourceFolderPermission($var_212["parent"]);
			}
		}

		

		var_60 var_486($var_353 = "position DESC, id ASC") {
			$var_43 = sqlquery("SELECT * FROM bigtree_templates WHERE level <= '".$var_10->var_15."' ORDER BY $var_353");
			$var_282 = array();
			while ($var_12 = sqlfetch($var_43)) {
				if ($var_12["routed"]) {
					$var_282[] = $var_12;
				}
			}
			var_53 $var_282;
		}

		

		var_67 function var_487($var_63,$var_488 = true) {
			var_71 $var_72;
			$var_63 = BigTreeCMS::extensionSettingCheck($var_63);
			$var_489 = sqlfetch(sqlquery("SELECT * FROM bigtree_settings WHERE id = '$var_63'"));
			
			
			if (!$var_489) {
				var_53 false;
			}

			
			if ($var_489["encrypted"]) {
				$var_30 = sqlfetch(sqlquery("SELECT AES_DECRYPT(`value`,'".sqlescape($var_72["config"]["settings_key"])."') AS `value` FROM bigtree_settings WHERE id = '$var_63'"));
				$var_489["value"] = $var_30["value"];
			}

			
			if ($var_488) {
				$var_489["value"] = json_decode($var_489["value"],true);
	
				if (is_array($var_489["value"])) {
					$var_489["value"] = BigTree::untranslateArray($var_489["value"]);
				} var_197 {
					$var_489["value"] = BigTreeCMS::replaceInternalPageLinks($var_489["value"]);
				}
			}

			var_53 $var_489;
		}

		

		var_60 var_490($var_353 = "name ASC") {
			$var_282 = array();
			if ($var_10->var_15 < 2) {
				$var_43 = sqlquery("SELECT * FROM bigtree_settings WHERE locked = '' AND system = '' ORDER BY $var_353");
			} var_197 {
				$var_43 = sqlquery("SELECT * FROM bigtree_settings WHERE system = '' ORDER BY $var_353");
			}
			while ($var_12 = sqlfetch($var_43)) {
				foreach ($var_12 as $var_170 => $var_196) {
					$var_12[$var_170] = BigTreeCMS::replaceRelativeRoots($var_196);
				}
				$var_12["value"] = json_decode($var_12["value"],true);
				if ($var_12["encrypted"] == "on") {
					$var_12["value"] = "[Encrypted Text]";
				}
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_60 var_491($var_439 = "") {
			
			if ($var_439) {
				$var_440 = explode(" ",$var_439);
				$var_441 = array();
				foreach ($var_440 as $var_442) {
					$var_442 = sqlescape(strtolower($var_442));
					$var_441[] = "(LOWER(name) LIKE '%$var_442%' OR LOWER(value) LIKE '%$var_442%')";
				}
				
				if ($var_10->var_15 < 2) {
					$var_43 = sqlquery("SELECT id FROM bigtree_settings WHERE system = '' AND locked = '' AND ".implode(" AND ",$var_441));
				
				} var_197 {
					$var_43 = sqlquery("SELECT id FROM bigtree_settings WHERE system = '' AND ".implode(" AND ",$var_441));
				}
			} var_197 {
				
				if ($var_10->var_15 < 2) {
					$var_43 = sqlquery("SELECT id FROM bigtree_settings WHERE system = '' AND locked = ''");
				
				} var_197 {
					$var_43 = sqlquery("SELECT id FROM bigtree_settings WHERE system = ''");
				}
			}

			$var_146 = sqlrows($var_43);
			$var_426 = var_492($var_146 / static::$var_3);
			if ($var_426 == 0) {
				$var_426 = 1;
			}

			var_53 $var_426;
		}

		

		static function var_493($var_353 = "name ASC") {
			$var_282 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_settings WHERE id NOT LIKE 'bigtree-internal-%' AND system != '' ORDER BY $var_353");
			while ($var_12 = sqlfetch($var_43)) {
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_67 function var_494($var_63) {
			$var_63 = sqlescape($var_63);
			return sqlfetch(sqlquery("SELECT * FROM bigtree_tags WHERE id = '$var_63'"));
		}

		

		var_67 function var_495($var_353 = "position DESC, name ASC") {
			$var_282 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_templates ORDER BY $var_353");
			while ($var_12 = sqlfetch($var_43)) {
				$var_282[] = $var_12;
			}
			var_53 $var_282;
		}

		

		var_60 var_496() {
			var_53 sqlrows(sqlquery("SELECT id FROM bigtree_messages WHERE recipients LIKE '%|".$var_10->var_13."|%' AND read_by NOT LIKE '%|".$var_10->var_13."|%'"));
		}

		

		var_67 function var_497($var_63) {
			$var_63 = sqlescape($var_63);
			$var_252 = sqlfetch(sqlquery("SELECT * FROM bigtree_users WHERE id = '$var_63'"));
			if (!$var_252) {
				var_53 false;
			}
			if ($var_252["level"] > 0) {
				$var_149 = array();
				$var_43 = sqlquery("SELECT * FROM bigtree_modules");
				while ($var_12 = sqlfetch($var_43)) {
					$var_149["module"][$var_12["id"]] = "p";
				}
				$var_252["permissions"] = $var_149;
			} var_197 {
				$var_252["permissions"] = json_decode($var_252["permissions"],true);
			}
			$var_252["alerts"] = json_decode($var_252["alerts"],true);
			return $var_252;
		}

		

		var_67 function var_498($var_236) {
			$var_236 = sqlescape($var_236);
			return sqlfetch(sqlquery("SELECT * FROM bigtree_users WHERE email = '$var_236'"));
		}

		

		var_67 function var_499($var_69) {
			$var_69 = sqlescape($var_69);
			return sqlfetch(sqlquery("SELECT * FROM bigtree_users WHERE change_password_hash = '$var_69'"));
		}

		

		var_67 function var_500($var_353 = "name ASC") {
			$var_282 = array();
			$var_43 = sqlquery("SELECT * FROM bigtree_users ORDER BY $var_353");
			while ($var_12 = sqlfetch($var_43)) {
				$var_282[$var_12["id"]] = $var_12;
			}

			var_53 $var_282;
		}

		

		var_67 function var_501($var_439 = "") {
			
			if ($var_439) {
				$var_440 = explode(" ",$var_439);
				$var_441 = array();
				foreach ($var_440 as $var_442) {
					$var_442 = sqlescape(strtolower($var_442));
					$var_441[] = "(LOWER(name) LIKE '%$var_442%' OR LOWER(email) LIKE '%$var_442%' OR LOWER(company) LIKE '%$var_442%')";
				}
				$var_43 = sqlquery("SELECT id FROM bigtree_users WHERE ".implode(" AND ",$var_441));
			
			} var_197 {
				$var_43 = sqlquery("SELECT id FROM bigtree_users");
			}

			$var_146 = sqlrows($var_43);
			$var_426 = var_492($var_146 / static::$var_3);
			if ($var_426 == 0) {
				$var_426 = 1;
			}

			var_53 $var_426;
		}

		

		static function var_502($var_160,$var_81,$var_130 = "success") {
			$_SESSION["bigtree_admin"]["growl"] = array("message" => $var_81, "title" => $var_160, "type" => $var_130);
		}

		

		var_67 function var_503($var_47) {
			var_53 str_replace("<br></br>","<br />",strip_tags($var_47,"<a><abbr><address><area><article><aside><audio><b><base><bdo><blockquote><body><br><button><canvas><caption><cite><code><col><colgroup><command><datalist><dd><del><details><dfn><div><dl><dt><em><emded><fieldset><figcaption><figure><footer><form><h1><h2><h3><h4><h5><h6><header><hgroup><hr><i><iframe><img><input><ins><keygen><kbd><label><legend><li><link><map><mark><menu><meter><nav><noscript><object><ol><optgroup><option><output><p><param><pre><progress><q><rp><rt><ruby><s><samp><script><section><select><small><source><span><strong><style><sub><summary><sup><table><tbody><td><textarea><tfoot><th><thead><time><title><tr><ul><var><video><wbr>"));
		}

		

		var_60 var_504($var_63) {
			$var_10->requireLevel(1);
			$var_63 = sqlescape($var_63);
			sqlquery("UPDATE bigtree_404s SET ignored = 'on' WHERE id = '$var_63'");
			$var_10->track("bigtree_404s",$var_63,"ignored");
		}

		

		var_60 var_505() {
			var_71 $var_72;

			$var_506 = ip2long($_SERVER["REMOTE_ADDR"]);
			$var_72["security-policy"] = $var_79 = BigTreeCMS::getSetting("bigtree-internal-security-policy");

			
			if (!empty($var_79["banned_ips"])) {
				$var_507 = explode("\n",$var_79["banned_ips"]);
				
				foreach ($var_507 as $var_508) {
					if (ip2long(trim($var_508)) == $var_506) {
						$var_72["layout"] = "login";
						$var_10->stop(file_get_contents(BigTree::path("admin/pages/ip-restriction.php")));
					}
				}
			}

			
			var_78 (!empty($var_79["allowed_ips"])) {
				$var_509 = false;
				
				$var_250 = explode("\n",$var_79["allowed_ips"]);
				
				foreach ($var_250 as $var_252) {
					list($var_510,$var_511) = explode(",",$var_252);
					$var_510 = ip2long(trim($var_510));
					$var_511 = ip2long(trim($var_511));
					
					if ($var_510 <= $var_506 && $var_511 >= $var_506) {
						$var_509 = true;
					}
				}

				if (!$var_509) {
					$var_72["layout"] = "login";
					$var_10->stop(file_get_contents(BigTree::path("admin/pages/ip-restriction.php")));
				}
			}
		}

		

		var_60 var_512($var_513,$var_514 = false) {
			$var_72["group_match"] = $var_72["module_match"] = $var_72["route_match"] = $var_72["class_name_match"] = $var_72["form_id_match"] = $var_72["view_id_match"] = $var_72["report_id_match"] = array();
			$var_224 = sqlescape($var_513["id"]);

			
			sqlquery("SET foreign_key_checks = 0");

			
			if (is_array($var_514)) {
				sqlquery("DELETE FROM bigtree_module_groups WHERE extension = '$var_224'");
				sqlquery("DELETE FROM bigtree_modules WHERE extension = '$var_224'");
				sqlquery("DELETE FROM bigtree_templates WHERE extension = '$var_224'");
				sqlquery("DELETE FROM bigtree_callouts WHERE extension = '$var_224'");
				sqlquery("DELETE FROM bigtree_field_types WHERE extension = '$var_224'");
				sqlquery("DELETE FROM bigtree_feeds WHERE extension = '$var_224'");

			
			} var_197 { 
				foreach ($var_513["components"]["tables"] as $var_515 => $var_516) {
					sqlquery("DROP TABLE IF EXISTS `$var_515`");
					sqlquery($var_516);
				}
			}

			
			var_229 ($var_513["components"]["module_groups"] as &$var_62) {
				if ($var_62) {
					$var_72["group_match"][$var_62["id"]] = $var_10->createModuleGroup($var_62["name"]);
					
					$var_62["id"] = $var_72["group_match"][$var_62["id"]];
					sqlquery("UPDATE bigtree_module_groups SET extension = '$var_224' WHERE id = '".$var_62["id"]."'");
				}
			}
		
			
			var_229 ($var_513["components"]["modules"] as &$var_34) {
				if ($var_34) {
					$var_62 = ($var_34["group"] && isset($var_72["group_match"][$var_34["group"]])) ? $var_72["group_match"][$var_34["group"]] : "NULL";
					$var_151 = sqlescape(is_array($var_34["gbp"]) ? BigTree::json($var_34["gbp"]) : $var_34["gbp"]);
					
					$var_136 = $var_134 = $var_34["route"];
					$var_135 = 2;
					while (sqlrows(sqlquery("SELECT * FROM bigtree_modules WHERE route = '".sqlescape($var_134)."'"))) {
						$var_134 = $var_136."-$var_135";
						$var_135++;
					}
					
					sqlquery("INSERT INTO bigtree_modules (`name`,`route`,`class`,`icon`,`group`,`gbp`,`extension`) VALUES ('".sqlescape($var_34["name"])."','".sqlescape($var_134)."','".sqlescape($var_34["class"])."','".sqlescape($var_34["icon"])."',$var_62,'$var_151','$var_224')");
					$var_518 = sqlid();
					$var_72["module_match"][$var_34["id"]] = $var_518;
					$var_72["route_match"][$var_34["route"]] = $var_134;
					
					$var_34["id"] = $var_518;
			
					
					foreach ($var_34["embed_forms"] as $var_154) {
						$var_10->createModuleEmbedForm($var_518,$var_154["title"],$var_154["table"],(is_array($var_154["fields"]) ? $var_154["fields"] : json_decode($var_154["fields"],true)),$var_154["hooks"],$var_154["default_position"],$var_154["default_pending"],$var_154["css"],$var_154["redirect_url"],$var_154["thank_you_message"]);
					}
					
					foreach ($var_34["views"] as $var_155) {
						$var_72["view_id_match"][$var_155["id"]] = $var_10->createModuleView($var_518,$var_155["title"],$var_155["description"],$var_155["table"],$var_155["type"],(is_array($var_155["options"]) ? $var_155["options"] : json_decode($var_155["options"],true)),(is_array($var_155["fields"]) ? $var_155["fields"] : json_decode($var_155["fields"],true)),(is_array($var_155["actions"]) ? $var_155["actions"] : json_decode($var_155["actions"],true)),$var_155["suffix"],$var_155["preview_url"]);
					}
					
					var_229 ($var_34["forms"] as $var_154) {
						$var_72["form_id_match"][$var_154["id"]] = $var_10->createModuleForm($var_518,$var_154["title"],$var_154["table"],(is_array($var_154["fields"]) ? $var_154["fields"] : json_decode($var_154["fields"],true)),$var_154["hooks"],$var_154["default_position"],($var_154["return_view"] ? $var_72["view_id_match"][$var_154["return_view"]] : false),$var_154["return_url"],$var_154["tagging"]);
					}
					
					var_229 ($var_34["reports"] as $var_156) {
						$var_72["report_id_match"][$var_156["id"]] = $var_10->createModuleReport($var_518,$var_156["title"],$var_156["table"],$var_156["type"],(is_array($var_156["filters"]) ? $var_156["filters"] : json_decode($var_156["filters"],true)),(is_array($var_156["fields"]) ? $var_156["fields"] : json_decode($var_156["fields"],true)),$var_156["parser"],($var_156["view"] ? $var_72["view_id_match"][$var_156["view"]] : false));
					}
					
					var_229 ($var_34["actions"] as $var_77) {
						$var_10->createModuleAction($var_518,$var_77["name"],$var_77["route"],$var_77["in_nav"],$var_77["class"],$var_72["form_id_match"][$var_77["form"]],$var_72["view_id_match"][$var_77["view"]],$var_72["report_id_match"][$var_77["report"]],$var_77["level"],$var_77["position"]);
					}
				}
			}
		
			
			var_229 ($var_513["components"]["templates"] as $var_189) {
				if ($var_189) {
					$var_122 = sqlescape(is_array($var_189["resources"]) ? BigTree::json($var_189["resources"]) : $var_189["resources"]);
					sqlquery("INSERT INTO bigtree_templates (`id`,`name`,`module`,`resources`,`level`,`routed`,`extension`) VALUES ('".sqlescape($var_189["id"])."','".sqlescape($var_189["name"])."','".$var_72["module_match"][$var_189["module"]]."','$var_122','".sqlescape($var_189["level"])."','".sqlescape($var_189["routed"])."','$var_224')");
				}
			}
		
			
			var_229 ($var_513["components"]["callouts"] as $var_375) {
				if ($var_375) {
					$var_122 = sqlescape(is_array($var_375["resources"]) ? BigTree::json($var_375["resources"]) : $var_375["resources"]);
					sqlquery("INSERT INTO bigtree_callouts (`id`,`name`,`description`,`display_default`,`display_field`,`resources`,`level`,`position`,`extension`) VALUES ('".sqlescape($var_375["id"])."','".sqlescape($var_375["name"])."','".sqlescape($var_375["description"])."','".sqlescape($var_375["display_default"])."','".sqlescape($var_375["display_field"])."','$var_122','".sqlescape($var_375["level"])."','".sqlescape($var_375["position"])."','$var_224')");	
				}
			}
		
			
			var_229 ($var_513["components"]["settings"] as $var_489) {
				if ($var_489) {
					$var_10->createSetting($var_489);
					sqlquery("UPDATE bigtree_settings SET extension = '$var_224' WHERE id = '".sqlescape($var_489["id"])."'");
				}
			}
		
			
			var_229 ($var_513["components"]["feeds"] as $var_519) {
				if ($var_519) {
					$var_132 = sqlescape(is_array($var_519["fields"]) ? BigTree::json($var_519["fields"]) : $var_519["fields"]);
					$var_131 = sqlescape(is_array($var_519["options"]) ? BigTree::json($var_519["options"]) : $var_519["options"]);
					sqlquery("INSERT INTO bigtree_feeds (`route`,`name`,`description`,`type`,`table`,`fields`,`options`,`extension`) VALUES ('".sqlescape($var_519["route"])."','".sqlescape($var_519["name"])."','".sqlescape($var_519["description"])."','".sqlescape($var_519["type"])."','".sqlescape($var_519["table"])."','$var_132','$var_131','$var_224')");
				}
			}
		
			
			var_229 ($var_513["components"]["field_types"] as $var_130) {
				if ($var_130) {
					$var_139 = $var_130["self_draw"] ? "'on'" : "NULL";
					$var_138 = sqlescape(is_array($var_130["use_cases"]) ? json_encode($var_130["use_cases"]) : $var_130["use_cases"]);
					sqlquery("INSERT INTO bigtree_field_types (`id`,`name`,`use_cases`,`self_draw`,`extension`) VALUES ('".sqlescape($var_130["id"])."','".sqlescape($var_130["name"])."','$var_138',$var_139,'$var_224')");
				}
			}

			
			var_78 (is_array($var_514)) {
				$var_520 = $var_514["revision"];
				$var_521 = $var_513["sql_revisions"];

				
				ksort($var_521);
				foreach ($var_521 as $var_170 => $var_522) {
					if ($var_170 > $var_520) {
						foreach ($var_522 as $var_516) {
							sqlquery($var_516);
						}
					}
				}

				
				sqlquery("UPDATE bigtree_extensions SET name = '".sqlescape($var_513["title"])."', version = '".sqlescape($var_513["version"])."', last_updated = NOW(), manifest = '".BigTree::json($var_513,true)."' WHERE id = '".sqlescape($var_513["id"])."'");
			
			
			} var_197 {
				
				$var_523 = var_105."extensions/".$var_513["id"]."/"; 
				BigTree::deleteDirectory($var_523);

				
				rename(var_105."cache/package/",$var_523);
				BigTree::setDirectoryPermissions($var_523);

				
				sqlquery("INSERT INTO bigtree_extensions (`id`,`type`,`name`,`version`,`last_updated`,`manifest`) VALUES ('".sqlescape($var_513["id"])."','extension','".sqlescape($var_513["title"])."','".sqlescape($var_513["version"])."',NOW(),'".BigTree::json($var_513,true)."')");	
			}

			
			var_253("SET foreign_key_checks = 1");

			
			var_253("var_524 FROM var_525");

			
			$var_526 = var_105."extensions/".$var_513["id"]."/public/";
			$var_527 = var_528($var_526) ? BigTree::directoryContents($var_526) : array();
			foreach ($var_527 as $var_529) {
				$var_523 = var_332($var_526,var_249."extensions/".$var_513["id"]."/",$var_529);
				var_75::copyFile($var_529,$var_523);
			}

			
			@var_140(var_105."cache/bigtree-module-class-list.json");
			@var_140(var_105."cache/bigtree-form-field-types.json");

			return $var_513;
		}

		

		static function var_530($var_531) {
			$var_531 = var_532("

			
			$var_533 = $var_531[1];
			if (!var_534(var_253("var_422 var_63 FROM var_423 var_424 var_63 = '$var_533'"))) {
				return false;
			}

			
			$var_395 = var_535(var_536($var_531[2]),true);
			
			if (var_537($var_395[0])) {
				return true;
			}
			
			if (var_538($var_395[0],0,1) == "
				return true;
			}
			
			$var_539 = sqlfetch(sqlquery("var_422 var_540.var_234 var_541 var_540 var_542 var_423 var_543 var_540.var_63 = var_423.var_189 var_424 var_423.var_63 = '$nav_id'"));
			
			if ($var_539["routed"]) {
				var_53 true;
			}

			
			var_53 false;
		}

		

		static function var_544($var_96) {
			$var_96 = var_532("
			$var_36 = static::var_278($var_96[1]);
			if ($var_36) {
				return true;
			}
			return false;
		}

		

		static function var_545($var_506) {
			global $var_72;

			
			$var_546 = var_398(var_253("var_422 * var_541 var_547 var_424 var_548 > NOW() AND var_506 = '$ip'"));
			
			if ($var_546) {
				$var_72["ban_expiration"] = date("F j, Y @ g:ia",strtotime($var_546["expires"]));
				$var_72["ban_is_user"] = false;
				
				return true;
			}

			var_53 false;
		}

		

		static function var_549($var_20) {
			global $var_72;

			
			$var_546 = sqlfetch(sqlquery("SELECT * FROM bigtree_login_bans WHERE expires > NOW() AND `user` = '".intval($var_20)."'"));
			
			if ($var_546) {
				$var_72["ban_expiration"] = date("F j, Y @ g:ia",strtotime($var_546["expires"]));
				$var_72["ban_is_user"] = true;
				
				return true;
			}

			var_53 false;
		}

		

		function lockCheck($var_55,$var_63,$var_550,$var_551 = false,$var_552 = true) {
			var_71 $var_298,$var_72,$var_299;
			$var_55 = sqlescape($var_55);
			$var_63 = sqlescape($var_63);

			$var_12 = sqlfetch(sqlquery("SELECT * FROM bigtree_locks WHERE `table` = '$var_55' AND item_id = '$var_63'"));
			if ($var_12 && $var_12["user"] != $var_10->var_13 && strtotime($var_12["last_accessed"]) > (time()-300) && !$var_551) {
				$var_553 = static::getUser($var_12["user"]);
				$var_554 = $var_12["last_accessed"];
				if ($var_552) {
					$var_10->stop();
				}
				var_53 false;
			}

			if ($var_12) {
				sqlquery("UPDATE bigtree_locks SET last_accessed = NOW(), user = '".$var_10->var_13."' WHERE id = '".$var_12["id"]."'");
				return $var_12["id"];
			} var_197 {
				sqlquery("INSERT INTO bigtree_locks (`table`,`item_id`,`user`,`title`) VALUES ('$var_55','$var_63','".$var_10->var_13."','Page')");
				return sqlid();
			}
		}

		

		var_67 function var_555($var_236,$var_70,$var_556 = false,$var_115 = null,$var_557 = null) {
			var_71 $var_72;

			$var_506 = ip2long($_SERVER["REMOTE_ADDR"]);

			if ($var_557) {
				$var_20 = sqlfetch(sqlquery("SELECT * FROM bigtree_users WHERE 2fa_login_token = '".sqlescape($var_557)."'"));

				if ($var_20) {
					$var_465 = true;
					sqlquery("UPDATE bigtree_users SET 2fa_login_token = '' WHERE id = '".$var_20["id"]."'");
				} var_197 {
					$var_465 = false;
				}
			} var_197 {
				if (static::isIPBanned($var_506)) {
					var_53 false;
				}
	
				
				$var_236 = trim(strtolower($var_236));
				$var_70 = trim($var_70);
				$var_20 = sqlfetch(sqlquery("SELECT * FROM bigtree_users WHERE LOWER(email) = '".sqlescape($var_236)."'"));
	
				if ($var_20) {
					if (static::isUserBanned($var_20["id"])) {
						var_53 false;
					}
	
					$var_73 = new class_0($var_72["config"]["password_depth"], true);
					$var_465 = $var_73->CheckPassword($var_70, $var_20["password"]);
				} var_197 {
					$var_465 = false;
				}
			}
			
			var_78 ($var_465) {
				
				$var_24 = base64_encode(openssl_random_pseudo_bytes(32));
				$var_25 = "__csrf_token_".BigTree::randomString(32)."__";
				
				
				$var_22 = uniqid("chain-",true);

				while (sqlrows(sqlquery("SELECT id FROM bigtree_user_sessions WHERE chain = '".sqlescape($var_22)."'"))) {
					$var_22 = uniqid("chain-",true);
				}

				
				$var_21 = uniqid("session-",true);

				while (sqlrows(sqlquery("SELECT id FROM bigtree_user_sessions WHERE id = '".sqlescape($var_21)."'"))) {
					$var_21 = uniqid("session-",true);
				}

				
				sqlquery("INSERT INTO bigtree_user_sessions (`id`,`chain`,`email`,`csrf_token`,`csrf_token_field`) VALUES ('".sqlescape($var_21)."','".sqlescape($var_22)."','".sqlescape($var_20["email"])."','$var_24','$var_25')");
				
				if (is_array($var_72["config"]["sites"]) && count($var_72["config"]["sites"])) {
					
					$var_559 = array(
						"user_id" => $var_20["id"],
						"session" => $var_21,
						"chain" => $var_22,
						"stay_logged_in" => $var_556,
						"login_redirect" => isset($_SESSION["bigtree_login_redirect"]) ? $_SESSION["bigtree_login_redirect"] : false,
						"remaining_sites" => array(),
						"csrf_token" => $var_24,
						"csrf_token_field" => $var_25
					);

					
					if (count($var_72["config"]["sites"]) < 4) {
						foreach ($var_72["config"]["sites"] as $var_110 => $var_560) {
							$var_559["remaining_sites"][$var_110] = $var_560["www_root"];
						}
					} var_197 {
						list($var_561, $var_562, $var_563) = explode("/", var_32);

						foreach ($var_72["config"]["sites"] as $var_110 => $var_560) {
							$var_564 = var_332(array("https:

							if ($var_564 == $var_115 || $var_564 == $var_563) {
								$var_559["var_565"][$var_110] = $var_560["var_566"];
							}
						}
					}
					
					$var_567 = BigTreeCMS::cacheUnique("var_568.var_569.var_555-var_21", $var_559);
					$var_570 = array_shift(array_values($var_559["remaining_sites"]));
					
					
					BigTree::redirect($var_570."?bigtree_login_redirect_session_key=".$var_567);
				} else {
					$var_571 = str_replace(var_26,"",var_27);
					$var_572 = json_encode(array($var_21, $var_22));
					
					
					setcookie('bigtree_admin[email]', $var_20["email"], strtotime("+1 month"), $var_571, "", false, true);
					
					if ($var_556) {
						setcookie('bigtree_admin[login]', $var_572, strtotime("+1 month"), $var_571, "", false, true);
					}
					
					$_SESSION["bigtree_admin"]["id"] = $var_20["id"];
					$_SESSION["bigtree_admin"]["email"] = $var_20["email"];
					$_SESSION["bigtree_admin"]["level"] = $var_20["level"];
					$_SESSION["bigtree_admin"]["name"] = $var_20["name"];
					$_SESSION["bigtree_admin"]["permissions"] = json_decode($var_20["permissions"],true);
					$_SESSION["bigtree_admin"]["csrf_token"] = $var_24;
					$_SESSION["bigtree_admin"]["csrf_token_field"] = $var_25;
					
					if (isset($_SESSION["bigtree_login_redirect"])) {
						BigTree::redirect($_SESSION["bigtree_login_redirect"]);
					} var_197 {
						BigTree::redirect(var_32);
					}
				}
			} else {
				
				if ($var_20) {
					$var_573 = "'".$var_20["id"]."'";
				} var_197 {
					$var_573 = "NULL";
				}
				
				var_253("INSERT INTO bigtree_login_attempts (`ip`,`user`) VALUES ('$var_506', $var_573)");

				
				if ($var_20["id"] && count(array_filter((array)$var_72["security-policy"]["user_fails"])) == 3) {
					$var_79 = $var_72["security-policy"]["user_fails"];
					$var_146 = sqlrows(sqlquery("SELECT * FROM bigtree_login_attempts WHERE `user` = $var_573 AND `timestamp` >= DATE_SUB(NOW(),INTERVAL ".$var_79["time"]." MINUTE)"));
					
					
					if ($var_146 >= $var_79["count"]) {
						
						$var_118 = sqlfetch(sqlquery("SELECT * FROM bigtree_login_bans WHERE `user` = $var_573 AND expires >= NOW()"));
						
						if ($var_118) {
							sqlquery("UPDATE bigtree_login_bans SET expires = DATE_ADD(NOW(),INTERVAL ".$var_79["ban"]." MINUTE) WHERE id = '".$var_118["id"]."'");
						} var_197 {
							sqlquery("INSERT INTO bigtree_login_bans (`ip`,`user`,`expires`) VALUES ('$var_506', $var_573, DATE_ADD(NOW(), INTERVAL ".$var_79["ban"]." MINUTE))");
						}
						
						$var_72["ban_expiration"] = date("F j, Y @ g:ia",strtotime("+".$var_79["ban"]." minutes"));
						$var_72["ban_is_user"] = true;
					}
				}

				
				var_78 (count(array_filter((array)$var_72["security-policy"]["ip_fails"])) == 3) {
					$var_79 = $var_72["security-policy"]["ip_fails"];
					$var_146 = sqlrows(sqlquery("SELECT * FROM bigtree_login_attempts WHERE `ip` = '$var_506' AND `timestamp` >= DATE_SUB(NOW(),INTERVAL ".$var_79["time"]." MINUTE)"));
					
					
					if ($var_146 >= $var_79["count"]) {
						$var_118 = sqlfetch(sqlquery("SELECT * FROM bigtree_login_bans WHERE `ip` = '$var_506' AND expires >= NOW()"));
						
						if ($var_118) {
							sqlquery("UPDATE bigtree_login_bans SET expires = DATE_ADD(NOW(),INTERVAL ".$var_79["ban"]." HOUR) WHERE id = '".$var_118["id"]."'");						
						} var_197 {
							sqlquery("INSERT INTO bigtree_login_bans (`ip`,`expires`) VALUES ('$var_506',DATE_ADD(NOW(),INTERVAL ".$var_79["ban"]." HOUR))");
						}
						
						$var_72["ban_expiration"] = date("F j, Y @ g:ia", strtotime("+".$var_79["ban"]." hours"));
						$var_72["ban_is_user"] = false;
					}
				}

				var_53 false;
			}
			
			var_53 true;
		}

		

		function var_45($var_574, $var_575 = false) {

			
			$var_20 = sqlfetch(sqlquery("SELECT 2fa_secret FROM bigtree_users WHERE id = '".$_SESSION["bigtree_admin"]["2fa_id"]."'"));
			$var_576 = GoogleAuthenticator::verifyCode($var_20["2fa_secret"], $var_574);

			if ($var_576 || $var_575) {
				$var_10->login(null, null, $_SESSION["bigtree_admin"]["2fa_stay_logged_in"], $_SESSION["bigtree_admin"]["2fa_domain"], $_SESSION["bigtree_admin"]["2fa_login_token"]);

				return false;
			}

			var_53 true;
		}
		
		var_67 function var_577($var_578) {
			$var_559 = BigTreeCMS::cacheGet("org.bigtreecms.login-session", $var_578);
			$var_20 = sqlfetch(sqlquery("SELECT * FROM bigtree_users WHERE id = '".$var_559["user_id"]."'"));
			
			foreach ($var_559["remaining_sites"] as $var_110 => $var_566) {
				if ($var_110 == var_579) {
					$var_571 = str_replace(var_26, "", var_27);
					$var_572 = json_encode(array($var_559["session"], $var_559["chain"]));

					
					setcookie('bigtree_admin[email]', $var_20["email"], strtotime("+1 month"), $var_571, "", false, true);
					
					if ($var_559["stay_logged_in"]) {
						setcookie('bigtree_admin[login]', $var_572, strtotime("+1 month"), $var_571, "", false, true);
					}
					
					$_SESSION["bigtree_admin"]["id"] = $var_20["id"];
					$_SESSION["bigtree_admin"]["email"] = $var_20["email"];
					$_SESSION["bigtree_admin"]["level"] = $var_20["level"];
					$_SESSION["bigtree_admin"]["name"] = $var_20["name"];
					$_SESSION["bigtree_admin"]["permissions"] = json_decode($var_20["permissions"], true);
					$_SESSION["bigtree_admin"]["csrf_token"] = $var_559["csrf_token"];
					$_SESSION["bigtree_admin"]["csrf_token_field"] = $var_559["csrf_token_field"];
					
					unset($var_559["remaining_sites"][$var_110]);
				}
			}
			
			var_78 (count($var_559["remaining_sites"]) == 0) {
				
				BigTreeCMS::cacheDelete("org.bigtreecms.login-session", $var_578);
				
				if (!empty($var_559["login_redirect"])) {
					BigTree::redirect($var_559["login_redirect"]);
				} var_197 {
					BigTree::redirect(var_32);
				}
			} var_197 {
				$var_570 = array_shift(array_values($var_559["remaining_sites"]));
				BigTreeCMS::cachePut("org.bigtreecms.login-session", $var_578, $var_559);
				
				
				BigTree::redirect($var_570."?bigtree_login_redirect_session_key=".$var_578);
			}
		}

		

		var_67 function var_580() {
			
			if (!empty($_COOKIE["bigtree_admin"]["login"])) {
				list($var_21,$var_22) = json_decode($_COOKIE["bigtree_admin"]["login"], true);

				
				$var_22 = sqlescape($var_22);
				$var_21 = sqlescape($var_21);

				if (sqlrows(sqlquery("SELECT * FROM bigtree_user_sessions WHERE id = '$var_21' AND chain = '$var_22'"))) {
					sqlquery("DELETE FROM bigtree_user_sessions WHERE chain = '$var_22'");
				}

				setcookie("bigtree_admin[email]","",time()-3600,str_replace(var_26,"",var_27));
				setcookie("bigtree_admin[login]","",time()-3600,str_replace(var_26,"",var_27));
			}

			var_581($_COOKIE["bigtree_admin"]);
			unset($_SESSION["bigtree_admin"]);

			var_75::var_76(var_32);
		}

		

		var_67 function var_168($var_582) {
			var_71 $var_72;

			$var_583 = explode("/", rtrim(str_replace(var_27, "", $var_582), "/"));
			
			
			$var_584 = str_replace(var_27,var_249,$var_582);
			
			if (($var_583[0] != "files" || $var_583[1] != "resources") && 
				(substr($var_584,0,1) == "/" || substr($var_584,0,2) == "\\\\") && 
				file_exists($var_584)) {
				
				var_53 BigTreeCMS::replaceHardRoots($var_582);
			}

			
			if (is_array($var_72["config"]["sites"]) && count($var_72["config"]["sites"]) > 1) {
				foreach ($var_72["config"]["sites"] as $var_110 => $var_585) {
					
					if (strpos($var_582, $var_585["www_root"]) !== false) {
						$var_583 = explode("/", rtrim(str_replace($var_585["www_root"], "", $var_582), "/"));
						
						
						if ($var_583[0] == "files" && $var_583[1] == "resources") {
							$var_36 = static::getResourceByFile($var_582);

							if ($var_36) {
								static::$var_2[] = $var_36["id"];
								
								return "irl:
							}
						}
						
						
						$var_12 = sqlfetch(sqlquery("var_422 var_200 var_541 var_423 var_424 var_63 = '".$configuration["trunk"]."'"));
						$var_583 = array_filter(array_merge(explode("/", $var_12["path"]), $var_583));
						
						
						list($var_586, $var_395, $var_587, $var_117, $var_69) = static::getPageIDForPath($var_583);
						
						if ($var_586) {
							var_53 "ipl:
						} else {
							return BigTreeCMS::replaceHardRoots($var_582);
						}
					}
				}
				
				return BigTreeCMS::replaceHardRoots($var_582);
			} else {
				
				if ($var_583[0] == "var_588" && $var_583[1] == "resources") {
					$var_36 = static::getResourceByFile($var_582);
					if ($var_36) {
						static::$var_2[] = $var_36["id"];
						
						return "irl:
					}
				}
				
				
				list($var_586, $var_395, $var_587, $var_117, $var_69) = static::getPageIDForPath($var_583);
			}
			
			if (!$var_586) {
				return BigTreeCMS::replaceHardRoots($var_582);
			}
			
			return "var_531:
		}

		

		var_60 var_589($var_63) {
			$var_81 = $var_10->getMessage($var_63);
			if (!$var_81) {
				var_53 false;
			}
			$var_590 = str_replace("|".$var_10->var_13."|","",$var_81["read_by"])."|".$var_10->var_13."|";
			sqlquery("UPDATE bigtree_messages SET read_by = '".sqlescape($var_590)."' WHERE id = '".$var_81["id"]."'");
			return true;
		}

		

		var_67 function var_591($var_52,$var_592) {
			$var_213 = sqlescape(md5_file($var_52));
			$var_36 = sqlfetch(sqlquery("SELECT * FROM bigtree_resources WHERE md5 = '$var_213' LIMIT 1"));
			if (!$var_36) {
				var_53 false;
			}

			
			if ($var_36["folder"] == $var_592) {
				sqlquery("UPDATE bigtree_resources SET date = NOW() WHERE id = '".$var_36["id"]."'");
			} var_197 {
				foreach ($var_36 as $var_170 => $var_196) {
					$$var_170 = "'".sqlescape($var_196)."'";
				}
				$var_592 = $var_592 ? "'".sqlescape($var_592)."'" : "NULL";
				sqlquery("INSERT INTO bigtree_resources (`folder`,`file`,`md5`,`date`,`name`,`type`,`is_image`,`height`,`width`,`crops`,`thumbs`,`list_thumb_margin`) VALUES ($var_592,$var_52,$var_213,NOW(),$var_120,$var_130,$var_214,$var_215,$var_216,$var_593,$var_217,$var_594)");
			}
			var_53 true;
		}

		

		var_67 function var_595($var_37) {
			$var_37 = sqlescape($var_37);
			$var_428 = sqlfetch(sqlquery("SELECT id FROM bigtree_pending_changes WHERE `table` = 'bigtree_pages' AND item_id = '$var_37'"));
			if (!$var_428) {
				var_53 false;
			}
			var_53 true;
		}

		

		var_67 function var_203() {
			$var_489 = static::getSetting("ping-search-engines");
			if ($var_489["value"] == "on") {
				
				var_596("http:
				
				file_get_contents("var_97:
			}
		}

		

		static function processCrops($var_597) {
			$var_218 = new class_2;

			
			$var_593 = BigTreeCMS::cacheGet("org.bigtreecms.crops",$var_597);
			BigTreeCMS::cacheDelete("org.bigtreecms.crops",$var_597);

			foreach ($var_593 as $var_170 => $var_598) {
				$var_599 = $var_598["image"];
				$var_600 = $var_598["width"];
				$var_601 = $var_598["height"];
				$var_135 = $var_728["x"][$var_170];
				$var_602 = $var_728["y"][$var_170];
				$var_216 = $var_728["width"][$var_170];
				$var_215 = $var_728["height"][$var_170];
				$var_217 = $var_598["thumbs"];
				$var_603 = $var_598["center_crops"];

				$var_604 = pathinfo($var_599);

				
				$var_605 = var_249."files/".uniqid("temp-").".".$var_604["extension"];
				BigTree::createCrop($var_599,$var_605,$var_135,$var_602,$var_600,$var_601,$var_216,$var_215,$var_598["retina"],$var_598["grayscale"]);
				
				
				if (is_array($var_217)) {
					foreach ($var_217 as $var_280) {
						if (is_array($var_280) && ($var_280["height"] || $var_280["width"])) {
							
							list($var_130,$var_606,$var_607,$var_608,$var_609) = BigTree::getThumbnailSizes($var_605,$var_280["width"],$var_280["height"]);

							$var_610 = var_249."files/".uniqid("temp-").".".$var_604["extension"];
							BigTree::createCrop($var_599,$var_610,$var_135,$var_602,$var_608,$var_609,$var_216,$var_215,$var_598["retina"],$var_280["grayscale"]);
							$var_218->replace($var_610,$var_280["prefix"].$var_598["name"],$var_598["directory"]);
						}
					}
				}

				
				var_78 (is_array($var_603)) {
					foreach ($var_603 as $var_611) {
						if (is_array($var_611) && $var_611["height"] && $var_611["width"]) {
							$var_612 = var_249."files/".uniqid("temp-").".".$var_604["extension"];
							BigTree::centerCrop($var_605,$var_612,$var_611["width"],$var_611["height"],$var_598["retina"],$var_611["grayscale"]);
							$var_218->replace($var_612,$var_611["prefix"].$var_598["name"],$var_598["directory"]);
						}
					}
				}

				
				$var_218->replace($var_605,$var_598["prefix"].$var_598["name"],$var_598["directory"]);
			}

			
			var_229 ($var_593 as $var_598) {
				@unlink($var_598["image"]);
			}
		}

		

		var_67 function var_613($var_171) {
			var_71 $var_298,$var_72,$var_299;

			
			$var_72["saved_extension_context"] = $var_72["extension_context"];

			
			if (strpos($var_171["type"],"*") !== false) {
				list($var_224,$var_301) = explode("*",$var_171["type"]);

				$var_72["extension_context"] = $var_224;
				$var_302 = var_105."extensions/$var_224/field-types/$var_301/process.php";
			} var_197 {
				$var_302 = BigTree::path("admin/form-field-types/process/".$var_171["type"].".php");
			}

			
			var_78 (file_exists($var_302)) {

				
				if ($var_171["ignore"]) {
					var_53 null;
				} var_197 {
					$var_614 = $var_171["output"];
				}

			
			} var_197 {
				if (is_array($var_171["input"])) {
					$var_614 = $var_171["input"];
				} var_197 {
					$var_614 = BigTree::safeEncode($var_171["input"]);
				}
			}

			
			var_78 (!BigTreeAutoModule::validate($var_614,$var_171["options"]["validation"])) {
				$var_80 = $var_171["options"]["error_message"] ? $var_171["options"]["error_message"] : BigTreeAutoModule::validationErrorMessage($var_614,$var_171["options"]["validation"]);
				$var_72["errors"][] = array(
					"field" => $var_171["title"],
					"error" => $var_80
				);
			}

			
			var_78 (is_array($var_614)) {
				$var_614 = BigTree::translateArray($var_614);
			} var_197 {
				$var_614 = $var_298->autoIPL($var_614);
			}

			
			$var_72["extension_context"] = $var_72["saved_extension_context"];

			return $var_614;
		}

		

		var_67 var_60 var_615($var_171, $var_616 = false, $var_617 = false) {
			var_71 $var_72;

			$var_618 = false;
			$var_120 = $var_171["file_input"]["name"];
			$var_619 = $var_171["file_input"]["tmp_name"];
			$var_80 = $var_171["file_input"]["error"];

			
			if ($var_80 == 1 || $var_80 == 2) {
				$var_72["errors"][] = array("field" => $var_171["title"], "error" => "The file you uploaded ($var_120) was too large &mdash; <strong>Max file size: ".ini_get("upload_max_filesize")."</strong>");
				return false;
			} elseif ($var_80 == 3) {
				$var_72["errors"][] = array("field" => $var_171["title"], "error" => "The file upload failed ($var_120).");
				return false;
			}

			
			$var_218 = new class_2;
			$var_218->var_620 = $var_72["config"]["image_force_jpeg"];

			
			$var_621 = @getimagesize($var_619);
			$var_622 = $var_621[0];
			$var_623 = $var_621[1];
			$var_624 = $var_621[2];
			$var_625 = $var_621["channels"];
			$var_626 = null;

			
			if ($var_171["options"]["preset"]) {
				$var_627 = BigTreeCMS::getSetting("bigtree-internal-media-settings");
				$var_628 = $var_627["presets"][$var_171["options"]["preset"]];
				
				if ($var_628) {
					foreach ($var_628 as $var_170 => $var_196) {
						$var_171["options"][$var_170] = $var_196;
					}
				}
			}

			
			var_78 ((isset($var_171["options"]["min_height"]) && $var_623 < $var_171["options"]["min_height"]) || (isset($var_171["options"]["min_width"]) && $var_622 < $var_171["options"]["min_width"])) {
				$var_80 = "Image uploaded (".htmlspecialchars($var_120).") did not meet the minimum size of ";
				if ($var_171["options"]["min_height"] && $var_171["options"]["min_width"]) {
					$var_80 .= $var_171["options"]["min_width"]."x".$var_171["options"]["min_height"]." pixels.";
				} elseif ($var_171["options"]["min_height"]) {
					$var_80 .= $var_171["options"]["min_height"]." pixels tall.";
				} elseif ($var_171["options"]["min_width"]) {
					$var_80 .= $var_171["options"]["min_width"]." pixels wide.";
				}
				$var_72["errors"][] = array("field" => $var_171["title"], "error" => $var_80);
				$var_618 = true;
			}

			
			var_78 ($var_624 != var_629 && $var_624 != var_630 && $var_624 != var_631) {
				$var_72["errors"][] = array("field" => $var_171["title"], "error" => "An invalid file was uploaded. Valid file types: JPG, GIF, PNG.");
				$var_618 = true;
			}

			
			var_78 ($var_625 == 4) {
				$var_72["errors"][] = array("field" => $var_171["title"], "error" => "A CMYK encoded file was uploaded. Please upload an RBG image.");
				$var_618 = true;
			}

			
			var_78 (!$var_618 && ((is_array($var_171["options"]["crops"]) && count($var_171["options"]["crops"])) || (is_array($var_171["options"]["thumbs"]) && count($var_171["options"]["thumbs"])))) {
				if (is_array($var_171["options"]["crops"])) {
					foreach ($var_171["options"]["crops"] as $var_598) {
						if (!$var_618 && is_array($var_598) && array_filter($var_598)) {
							if ($var_171["options"]["retina"]) {
								$var_598["width"] *= 2;
								$var_598["height"] *= 2;
							}
							
							var_78 (!BigTree::imageManipulationMemoryAvailable($var_619,$var_598["width"],$var_598["height"],$var_622,$var_623)) {
								$var_72["errors"][] = array("field" => $var_171["title"], "error" => "Image uploaded is too large for the server to manipulate. Please upload a smaller version of this image.");
								$var_618 = true;
							}
						}
					}
				}
				var_78 (is_array($var_171["options"]["thumbs"])) {
					foreach ($var_171["options"]["thumbs"] as $var_280) {
						
						if (!$var_618 && is_array($var_280) && array_filter($var_280)) {
							if ($var_171["options"]["retina"]) {
								$var_280["width"] *= 2;
								$var_280["height"] *= 2;
							}
							$var_632 = BigTree::getThumbnailSizes($var_619,$var_280["width"],$var_280["height"]);
							if (!BigTree::imageManipulationMemoryAvailable($var_619,$var_632[3],$var_632[4],$var_622,$var_623)) {
								$var_72["errors"][] = array("field" => $var_171["title"], "error" => "Image uploaded is too large for the server to manipulate. Please upload a smaller version of this image.");
								$var_618 = true;
							}
						}
					}
				}
				var_78 (is_array($var_171["options"]["center_crops"])) {
					foreach ($var_171["options"]["center_crops"] as $var_598) {
						
						if (!$var_618 && is_array($var_598) && array_filter($var_598)) {
							list($var_606,$var_607) = getimagesize($var_619);
							if (!BigTree::imageManipulationMemoryAvailable($var_619,$var_606,$var_607,$var_598["width"],$var_598["height"])) {
								$var_72["errors"][] = array("field" => $var_171["title"], "error" => "Image uploaded is too large for the server to manipulate. Please upload a smaller version of this image.");
								$var_618 = true;
							}
						}
					}
				}
			}

			var_78 (!$var_618) {
				
				$var_633 = array(var_631 => ".png", var_630 => ".jpg", var_629 => ".gif");

				
				$var_634 = var_249."files/".uniqid("temp-").$var_633[$var_624];
				BigTree::moveFile($var_619,$var_634);

				
				if ($var_624 == var_630 && function_exists("exif_read_data")) {
					$var_635 = @exif_read_data($var_634);
					$var_636 = $var_635['Orientation'];
					if ($var_636 == 3 || $var_636 == 6 || $var_636 == 8) {
						$var_637 = imagecreatefromjpeg($var_634);

						if ($var_636 == 3) {
							$var_637 = imagerotate($var_637,180,0);
						} elseif ($var_636 == 6) {
							$var_637 = imagerotate($var_637,270,0);
						} var_197 {
							$var_637 = imagerotate($var_637,90,0);
						}

						
						$var_626 = var_249."files/".uniqid("temp-").".png";
						imagepng($var_637, $var_626);
						imagejpeg($var_637, $var_634);

						
						$var_218->var_620 = true;

						
						imagedestroy($var_637);

						
						list($var_622,$var_623,$var_624,$var_638) = getimagesize($var_634);
					}
				}

				var_78 (!$var_626) {
					
					$var_626 = var_249."files/".uniqid("temp-").$var_633[$var_624];
					BigTree::copyFile($var_634,$var_626);
				}

				
				$var_639 = array();
				if (is_array($var_171["options"]["thumbs"])) {
					foreach ($var_171["options"]["thumbs"] as $var_280) {
						if (!empty($var_280["prefix"])) {
							$var_639[] = $var_280["prefix"];
						}
					}
				}
				if (is_array($var_171["options"]["center_crops"])) {
					foreach ($var_171["options"]["center_crops"] as $var_598) {
						if (!empty($var_598["prefix"])) {
							$var_639[] = $var_598["prefix"];
						}
					}
				}
				if (is_array($var_171["options"]["crops"])) {
					foreach ($var_171["options"]["crops"] as $var_598) {
						if (is_array($var_598)) {
							if (!empty($var_598["prefix"])) {
								$var_639[] = $var_598["prefix"];
							}
							var_78 (is_array($var_598["thumbs"])) {
								foreach ($var_598["thumbs"] as $var_280) {
									if (!empty($var_280["prefix"])) {
										$var_639[] = $var_280["prefix"];
									}
								}
							}
							var_78 (is_array($var_598["center_crops"])) {
								foreach ($var_598["center_crops"] as $var_611) {
									if (!empty($var_611["prefix"])) {
										$var_639[] = $var_611["prefix"];
									}
								}
							}
						}
					}
				}

				
				var_78 ($var_616) {
					$var_171["output"] = $var_218->replace($var_634, $var_120, $var_171["options"]["directory"], true, $var_617);
				} var_197 {
					$var_171["output"] = $var_218->store($var_634,$var_120,$var_171["options"]["directory"],true,$var_639);
				}

 				
 				var_78 (!$var_171["output"]) {
 					if ($var_218->var_641) {
						$var_72["errors"][] = array("field" => $var_171["title"], "error" => "Could not upload file. The file extension is not allowed.");
					} var_197 {
						$var_72["errors"][] = array("field" => $var_171["title"], "error" => "Could not upload file. The destination is not writable.");
					}
					var_140($var_626);
					var_140($var_634);

					
					return false;
				
				} var_197 {
					
					$var_604 = BigTree::pathInfo($var_171["output"]);

					
					if (is_array($var_171["options"]["crops"])) {
						foreach ($var_171["options"]["crops"] as $var_598) {
							if (is_array($var_598)) {
								
								if ($var_598["width"] && $var_598["height"] && is_numeric($var_598["width"]) && is_numeric($var_598["height"])) {
									$var_642 = $var_598["width"];
									$var_643 = $var_598["height"];
		
									
									if (($var_623 >= $var_643 && $var_622 > $var_642) || ($var_622 >= $var_642 && $var_623 > $var_643)) {
										
										if (!$var_642) {
											$var_642 = $var_643;
										} var_235 (!$var_643) {
											$var_643 = $var_642;
										}
										$var_72["crops"][] = array(
											"image" => $var_626,
											"directory" => $var_171["options"]["directory"],
											"retina" => $var_171["options"]["retina"],
											"name" => $var_604["basename"],
											"width" => $var_642,
											"height" => $var_643,
											"prefix" => $var_598["prefix"],
											"thumbs" => $var_598["thumbs"],
											"center_crops" => $var_598["center_crops"],
											"grayscale" => $var_598["grayscale"]
										);
									
									} var_235 ($var_623 == $var_643 && $var_622 == $var_642) {
										
										if (is_array($var_598["thumbs"])) {
											foreach ($var_598["thumbs"] as $var_280) {
												
												if (($var_280["width"] && is_numeric($var_280["width"])) || ($var_280["height"] && is_numeric($var_280["height"]))) {
													
													$var_610 = var_249."files/".uniqid("temp-").$var_633[$var_624];
													BigTree::createThumbnail($var_626,$var_610,$var_280["width"],$var_280["height"],$var_171["options"]["retina"],$var_280["grayscale"]);
													
													$var_218->replace($var_610, $var_280["prefix"].$var_604["basename"], $var_171["options"]["directory"], true, $var_617);
												}
											}
										}
	
										
										var_78 (is_array($var_598["center_crops"])) {
											foreach ($var_598["center_crops"] as $var_611) {
												
												if ($var_611["width"] && is_numeric($var_611["width"]) && $var_611["height"] && is_numeric($var_611["height"])) {
													
													$var_605 = var_249."files/".uniqid("temp-").$var_633[$var_624];
													BigTree::centerCrop($var_626,$var_605,$var_611["width"],$var_611["height"],$var_171["options"]["retina"],$var_611["grayscale"]);
													
													$var_218->replace($var_605, $var_611["prefix"].$var_604["basename"], $var_171["options"]["directory"], true, $var_617);
												}
											}
										}
										
										var_78 ($var_598["prefix"]) {
											$var_218->replace($var_626, $var_598["prefix"].$var_604["basename"], $var_171["options"]["directory"], false, $var_617);
										}
									}
								}
							}
						}
					}

					
					var_78 (is_array($var_171["options"]["thumbs"])) {
						foreach ($var_171["options"]["thumbs"] as $var_280) {
							
							if (($var_280["width"] && is_numeric($var_280["width"])) || ($var_280["height"] && is_numeric($var_280["height"]))) {
								$var_610 = var_249."files/".uniqid("temp-").$var_633[$var_624];
								BigTree::createThumbnail($var_626,$var_610,$var_280["width"],$var_280["height"],$var_171["options"]["retina"],$var_280["grayscale"]);
								
								$var_218->replace($var_610, $var_280["prefix"].$var_604["basename"], $var_171["options"]["directory"], true, $var_617);
							}
						}
					}

					
					var_78 (is_array($var_171["options"]["center_crops"])) {
						foreach ($var_171["options"]["center_crops"] as $var_598) {
							
							if ($var_598["width"] && is_numeric($var_598["width"]) && $var_598["height"] && is_numeric($var_598["height"])) {
								$var_605 = var_249."files/".uniqid("temp-").$var_633[$var_624];
								BigTree::centerCrop($var_626,$var_605,$var_598["width"],$var_598["height"],$var_171["options"]["retina"],$var_598["grayscale"]);
								
								$var_218->replace($var_605, $var_598["prefix"].$var_604["basename"], $var_171["options"]["directory"], true, $var_617);
							}
						}
					}

					
					var_78 (!is_array($var_72["crops"]) || !count($var_72["crops"])) {
						unlink($var_626);
					}
				}
			
			} var_197 {
				var_53 false;
			}

			var_53 $var_171["output"];
		}

		

		var_60 var_644($var_55,$var_63) {
			$var_63 = sqlescape($var_63);
			$var_55 = sqlescape($var_55);
			sqlquery("UPDATE bigtree_locks SET last_accessed = NOW() WHERE `table` = '$var_55' AND item_id = '$var_63' AND user = '".$var_10->var_13."'");
		}

		

		var_60 var_645($var_20) {
			sqlquery("UPDATE bigtree_users SET 2fa_secret = '' WHERE id = '".sqlescape($var_20)."'");
		}

		

		var_60 var_646($var_34) {
			var_71 $var_298,$var_72,$var_299;
			if ($var_10->var_15 > 0) {
				var_53 "p";
			}
			var_78 (!isset($var_10->var_17[$var_34]) || $var_10->var_17[$var_34] == "") {
				define("BIGTREE_ACCESS_DENIED",true);
				$var_10->stop(file_get_contents(BigTree::path("admin/pages/_denied.php")));
			}
			var_53 $var_10->var_17[$var_34];
		}

		

		var_60 var_241($var_64) {
			var_71 $var_298,$var_72,$var_299;
			if (!isset($var_10->var_15) || $var_10->var_15 < $var_64) {
				define("BIGTREE_ACCESS_DENIED",true);
				$var_10->stop(file_get_contents(BigTree::path("admin/pages/_denied.php")));
			}
		}

		

		var_60 var_647($var_34) {
			var_71 $var_298,$var_72,$var_299;
			if ($var_10->var_15 > 0) {
				var_53 true;
			}
			var_78 ($var_10->var_17[$var_34] != "p") {
				ob_clean();
				$var_72["content"] = ob_get_clean();
				die();
			}
			var_53 true;
		}

		

		var_60 var_648($var_37,$var_121) {
			$var_38 = $var_10->getPageAccessLevel($var_37);
			
			if ($var_38 != "p") {
				$var_10->stop("You must be a publisher to manage revisions.");
			}

			$var_37 = sqlescape($var_37);
			$var_121 = sqlescape(htmlspecialchars($var_121));

			
			$var_649 = sqlfetch(sqlquery("SELECT * FROM bigtree_pages WHERE id = '$var_37'"));
			foreach ($var_649 as $var_170 => $var_196) {
				$$var_170 = sqlescape($var_196);
			}

			
			sqlquery("INSERT INTO bigtree_page_revisions (`page`,`title`,`meta_keywords`,`meta_description`,`template`,`external`,`new_window`,`resources`,`author`,`updated_at`,`saved`,`saved_description`) VALUES ('$var_37','$var_160','$var_188','$var_187','$var_189','$var_84','$var_194','$var_122','$var_650','$var_651','on','$var_121')");
			$var_63 = sqlid();
			$var_10->track("bigtree_page_revisions",$var_63,"created");

			return $var_63;
		}

		

		var_67 function var_652($var_130, $var_439 = "", $var_37 = 1, $var_110 = null) {
			$var_282 = array();

			if ($var_110) {
				$var_341 = "AND site_key = '".sqlescape($var_110)."'";
			} var_197 {
				$var_341 = "";
			}

			if ($var_439) {
				$var_653 = sqlescape(strtolower($var_439));
				if ($var_130 == "301") {
					$var_381 = "ignored = '' AND (broken_url LIKE '%$var_653%' OR redirect_url LIKE '%$var_653%' OR get_vars LIKE '%$var_653%') AND redirect_url != ''";
				} elseif ($var_130 == "ignored") {
					$var_381 = "ignored != '' AND (broken_url LIKE '%$var_653%' OR redirect_url LIKE '%$var_653%' OR get_vars LIKE '%$var_653%')";
				} var_197 {
					$var_381 = "ignored = '' AND (broken_url LIKE '%$var_653%' OR get_vars LIKE '%$var_653%') AND redirect_url = ''";
				}
			} var_197 {
				if ($var_130 == "301") {
					$var_381 = "ignored = '' AND redirect_url != ''";
				} var_235 ($var_130 == "ignored") {
					$var_381 = "ignored != ''";
				} var_197 {
					$var_381 = "ignored = '' AND redirect_url = ''";
				}
			}

			
			$var_12 = sqlfetch(sqlquery("SELECT COUNT(id) AS `count` FROM bigtree_404s WHERE $var_381 $var_341"));
			$var_426 = ceil($var_12["count"] / 20);
			$var_426 = ($var_426 < 1) ? 1 : $var_426;

			
			$var_43 = sqlquery("SELECT * FROM bigtree_404s WHERE $var_381 $var_341 ORDER BY requests DESC LIMIT ".(($var_37 - 1) * 20).",20");
			
			while ($var_12 = sqlfetch($var_43)) {
				$var_12["redirect_url"] = BigTreeCMS::replaceInternalPageLinks($var_12["redirect_url"]);
				$var_282[] = $var_12;
			}

			var_53 array($var_426,$var_282);
		}

		

		var_67 function var_654($var_20 = false,$var_55 = false,$var_35 = false,$var_655 = false,$var_511 = false) {
			$var_656 = $var_282 = $var_381 = array();
			$var_288 = BigTreeCMS::getSetting("bigtree-internal-deleted-users");
			$var_439 = "SELECT * FROM bigtree_audit_trail";

			if ($var_20) {
				$var_381[] = "user = '".sqlescape($var_20)."'";
			}
			if ($var_55) {
				$var_381[] = "`table` = '".sqlescape($var_55)."'";
			}
			if ($var_35) {
				$var_381[] = "entry = '".sqlescape($var_35)."'";
			}
			if ($var_655) {
				$var_381[] = "`date` >= '".date("Y-m-d H:i:s",strtotime($var_655))."'";
			}
			if ($var_511) {
				$var_381[] = "`date` <= '".date("Y-m-d H:i:s",strtotime($var_511))."'";
			}
			if (count($var_381)) {
				$var_439 .= " WHERE ".implode(" AND ",$var_381);
			}

			$var_43 = sqlquery($var_439." ORDER BY `date` DESC");
			
			while ($var_12 = sqlfetch($var_43)) {
				if (isset($var_288[$var_12["user"]])) {
					$var_20 = $var_288[$var_12["user"]];
					$var_20["deleted"] = true;
					$var_20["id"] = $var_12["user"];
					$var_12["user"] = $var_20;
				} var_197 {
					if (!$var_656[$var_12["user"]]) {
						$var_418 = static::getUser($var_12["user"]);
						$var_656[$var_12["user"]] = array("id" => $var_418["id"],"name" => $var_418["name"],"email" => $var_418["email"],"level" => $var_418["level"]);
					}

					$var_12["user"] = $var_656[$var_12["user"]];
				}

				$var_282[] = $var_12;
			}

			var_53 $var_282;
		}

		

		var_67 function var_657($var_439,$var_132 = array("nav_title"),$var_658 = 10) {
			
			$var_439 = str_replace('/','\\\/',$var_439);

			$var_659 = array();
			$var_660 = explode(" ",$var_439);
			$var_661 = array("archived != 'on'");

			foreach ($var_660 as $var_662) {
				$var_662 = sqlescape(strtolower($var_662));
				$var_663 = array();
				foreach ($var_132 as $var_171) {
					$var_663[] = "LOWER(`$var_171`) LIKE '%$var_662%'";
				}
				$var_661[] = "(".implode(" OR ",$var_663).")";
			}

			$var_43 = sqlquery("SELECT * FROM bigtree_pages WHERE ".implode(" AND ",$var_661)." ORDER BY nav_title LIMIT $var_658");
			while ($var_12 = sqlfetch($var_43)) {
				$var_659[] = $var_12;
			}
			var_53 $var_659;
		}

		

		var_60 var_664($var_439, $var_353 = "date DESC") {
			$var_439 = sqlescape(strtolower($var_439));
			$var_469 = array();
			$var_122 = array();
			$var_665 = array();
			$var_118 = array();

			$var_43 = sqlquery("SELECT * FROM bigtree_resource_folders WHERE LOWER(name) LIKE '%$var_439%' ORDER BY name");

			while ($var_12 = sqlfetch($var_43)) {
				$var_12["permission"] = $var_10->getResourceFolderPermission($var_12);
				
				$var_665[$var_12["id"]] = $var_12["permission"];

				$var_469[] = $var_12;
			}

			$var_43 = sqlquery("SELECT * FROM bigtree_resources WHERE LOWER(name) LIKE '%$var_439%' ORDER BY $var_353");

			while ($var_12 = sqlfetch($var_43)) {
				$var_666 = array($var_12["name"], $var_12["md5"]);

				if (!in_array($var_666, $var_118)) {
					
					if ($var_665[$var_12["folder"]]) {
						$var_12["permission"] = $var_665[$var_12["folder"]];
					} var_197 {
						$var_12["permission"] = $var_10->getResourceFolderPermission($var_12["folder"]);
						$var_665[$var_12["folder"]] = $var_12["permission"];
					}
	
					$var_122[] = $var_12;
					$var_118[] = $var_666;
				}
			}

			var_53 array("folders" => $var_469, "resources" => $var_122);
		}

		

		var_67 function var_667($var_202) {
			$var_210 = $var_668 = array();
			$var_232 = metaphone($var_202);
			$var_43 = sqlquery("SELECT * FROM bigtree_tags");
			while ($var_12 = sqlfetch($var_43)) {
				$var_669 = levenshtein($var_12["metaphone"],$var_232);
				if ($var_669 < 2) {
					$var_210[] = $var_12["tag"];
					$var_668[] = $var_669;
				}
			}

			array_multisort($var_668,var_670,$var_210);
			return array_slice($var_210,0,8);
		}

		

		var_60 var_671($var_63, $var_582) {
			$var_10->requireLevel(1);
			$var_63 = sqlescape($var_63);
			$var_582 = trim($var_582);

			
			if (strpos($var_582,"
				$var_582 = WWW_ROOT.ltrim($var_582,"/");
			}
			
			$var_582 = sqlescape(htmlspecialchars($var_10->var_46($var_582)));

			
			if (WWW_ROOT === STATIC_ROOT) {
				$var_582 = str_replace("{var_672}","{wwwroot}",$var_582);
			}

			sqlquery("UPDATE bigtree_404s SET redirect_url = '$var_582' WHERE id = '$var_63'");
			$var_10->track("bigtree_404s",$var_63,"updated");
		}

		

		static function setCalloutPosition($var_63,$var_157) {
			$var_63 = sqlescape($var_63);
			$var_157 = sqlescape($var_157);
			sqlquery("UPDATE bigtree_callouts SET position = '$var_157' WHERE id = '$var_63'");
		}

		

		static function setModuleActionPosition($var_63,$var_157) {
			$var_63 = sqlescape($var_63);
			$var_157 = sqlescape($var_157);
			sqlquery("UPDATE bigtree_module_actions SET position = '$var_157' WHERE id = '$var_63'");
		}

		

		static function setModuleGroupPosition($var_63,$var_157) {
			$var_63 = sqlescape($var_63);
			$var_157 = sqlescape($var_157);
			sqlquery("UPDATE bigtree_module_groups SET position = '$var_157' WHERE id = '$var_63'");
		}

		

		static function setModulePosition($var_63,$var_157) {
			$var_63 = sqlescape($var_63);
			$var_157 = sqlescape($var_157);
			sqlquery("UPDATE bigtree_modules SET position = '$var_157' WHERE id = '$var_63'");
		}

		

		static function setPagePosition($var_63,$var_157) {
			$var_63 = sqlescape($var_63);
			$var_157 = sqlescape($var_157);
			sqlquery("UPDATE bigtree_pages SET position = '$var_157' WHERE id = '$var_63'");
		}

		

		static function setPasswordHashForUser($var_20) {
			$var_69 = md5(microtime().$var_20["password"]);
			sqlquery("UPDATE bigtree_users SET change_password_hash = '$var_69' WHERE id = '".$var_20["id"]."'");
		}

		

		static function setTemplatePosition($var_63,$var_157) {
			$var_63 = sqlescape($var_63);
			$var_157 = sqlescape($var_157);
			sqlquery("UPDATE bigtree_templates SET position = '$var_157' WHERE id = '$var_63'");
		}

		

		static function settingExists($var_63) {
			$var_63 = BigTreeCMS::extensionSettingCheck($var_63);
			return sqlrows(sqlquery("SELECT id FROM bigtree_settings WHERE id = '".sqlescape($var_63)."'"));
		}

		

		var_60 stop($var_81 = "") {
			var_71 $var_298,$var_72,$var_299;
			
			$var_72["content"] = ob_get_clean();
			die();
		}

		

		static function stripMultipleRootTokens($var_673) {
			var_71 $var_72;

			if (empty($var_72["config"]["sites"]) || !array_filter((array) $var_72["config"]["sites"])) {
				var_53 $var_673;
			}

			foreach ($var_72["config"]["sites"] as $var_170 => $var_102) {
				$var_673 = str_replace(
					array("{wwwroot:$var_170}", "{staticroot:$var_170}"),
					array("{wwwroot}", "{staticroot}"),
					$var_673
				);
			}

			var_53 $string;
		}

		

		var_60 var_674($var_37,$var_206) {
			$var_37 = sqlescape($var_37);
			
			if ($var_37[0] == "p") {
				
				$var_130 = "NEW";
				$var_675 = true;
				$var_676 = array();
				$var_677 = array("id" => substr($var_37,1));
			} var_197 {
				
				$var_130 = "EDIT";
				$var_675 = false;
				$var_676 = BigTreeCMS::getPage($var_37);
				$var_677 = sqlfetch(sqlquery("SELECT id FROM bigtree_pending_changes WHERE `table` = 'bigtree_pages' AND item_id = '$var_37'"));
			}

			
			$var_210 = BigTree::json($var_206["_tags"],true);
			unset($var_206["_tags"]);

			
			$var_206["title"] = htmlspecialchars($var_206["title"]);
			$var_206["nav_title"] = htmlspecialchars($var_206["nav_title"]);
			$var_206["meta_description"] = htmlspecialchars($var_206["meta_description"]);
			$var_206["meta_keywords"] = htmlspecialchars($var_206["meta_keywords"]);
			$var_206["seo_invisible"] = $var_206["seo_invisible"]["seo_invisible"] ? "on" : "";
			$var_206["external"] = htmlspecialchars($var_206["external"]);

			
			if (!empty($var_206["external"])) {
				$var_206["external"] = $var_10->makeIPL($var_206["external"]);
			}

			
			if ($var_10->var_15 < 2) {
				unset($var_206["trunk"]);
			
			} var_197 {
				$var_206["trunk"] = !empty($var_206["trunk"]) ? "on" : "";
			}

			
			$var_206["in_nav"] = !empty($var_206["in_nav"]) ? "on" : "";

			
			if ($var_677) {
				
				if ($var_675) {
					$var_206 = BigTree::json($var_206,true);
				
				} var_197 {

					
					$var_678 = array();
					foreach ($var_206 as $var_170 => $var_196) {
						if (array_key_exists($var_170,$var_676) && $var_676[$var_170] != $var_196) {
							$var_678[$var_170] = $var_196;
						}
					}
					$var_206 = BigTree::json($var_678,true);
				}

				
				var_253("UPDATE bigtree_pending_changes SET changes = '$var_206', tags_changes = '$var_210', date = NOW(), user = '".$var_10->var_13."', type = '$var_130' WHERE id = '".$var_677["id"]."'");
				$var_10->track("bigtree_pages",$var_37,"updated-draft");

			
			} var_197 {
				$var_678 = array();
				foreach ($var_206 as $var_170 => $var_196) {
					if (array_key_exists($var_170,$var_676) && $var_196 != $var_676[$var_170]) {
						$var_678[$var_170] = $var_196;
					}
				}
				$var_206 = BigTree::json($var_678,true);

				
				sqlquery("INSERT INTO bigtree_pending_changes (`user`,`date`,`table`,`item_id`,`changes`,`tags_changes`,`type`,`title`) VALUES ('".$var_10->var_13."',NOW(),'bigtree_pages','$var_37','$var_206','$var_210','EDIT','Page Change Pending')");
				$var_10->track("bigtree_pages",$var_37,"saved-draft");
			}

			var_53 var_679();
		}

		

		var_60 var_42($var_55,$var_35,$var_130) {
			
			if (isset($var_10->var_13)) {
				$var_55 = sqlescape($var_55);
				$var_35 = sqlescape($var_35);
				$var_130 = sqlescape($var_130);
				sqlquery("INSERT INTO bigtree_audit_trail (`table`,`user`,`entry`,`date`,`type`) VALUES ('$var_55','".$var_10->var_13."','$var_35',NOW(),'$var_130')");
			}
		}

		

		var_60 var_680($var_37) {
			if (is_array($var_37)) {
				$var_37 = sqlescape($var_37["id"]);
			} var_197 {
				$var_37 = sqlescape($var_37);
			}
			$var_38 = $var_10->getPageAccessLevel($var_37);
			if ($var_38 == "p" && $var_10->canModifyChildren(BigTreeCMS::getPage($var_37))) {
				sqlquery("UPDATE bigtree_pages SET archived = '' WHERE id = '$var_37'");
				$var_10->track("bigtree_pages",$var_37,"unarchived");
				$var_10->unarchivePageChildren($var_37);
				return true;
			}
			var_53 false;
		}

		

		var_60 var_681($var_63) {
			$var_43 = sqlquery("SELECT * FROM bigtree_pages WHERE parent = '$var_63' AND archived_inherited = 'on'");
			while ($var_12 = sqlfetch($var_43)) {
				$var_10->track("bigtree_pages",$var_12["id"],"unarchived-inherited");
				$var_10->unarchivePageChildren($var_12["id"]);
			}
			sqlquery("UPDATE bigtree_pages SET archived = '', archived_inherited = '' WHERE parent = '$var_63' AND archived_inherited = 'on'");
		}

		

		var_67 function var_682() {
			unset($_SESSION["bigtree_admin"]["growl"]);
		}

		

		var_67 function var_683($var_582) {
			var_53 BigTree::urlExists($var_582);
		}

		

		var_67 function var_684($var_37) {
			$var_582 = "";

			
			if (is_array($var_37)) {
				$var_582 = $var_37["path"]."/";
			} var_197 {
				if ($var_37 != 0) {
					$var_582 = str_replace(var_27,"",BigTreeCMS::getLink($var_37));
				}
			}

			@unlink(md5(json_encode(array("bigtree_htaccess_url" => $var_582))).".page");
			@unlink(md5(json_encode(array("bigtree_htaccess_url" => rtrim($var_582,"/")))).".page");
		}

		

		var_60 var_685($var_63) {
			$var_10->requireLevel(1);
			$var_63 = sqlescape($var_63);
			sqlquery("UPDATE bigtree_404s SET ignored = '' WHERE id = '$var_63'");
			$var_10->track("bigtree_404s",$var_63,"unignored");
		}

		

		var_67 function var_158($var_34,$var_134,$var_77 = false) {
			$var_34 = sqlescape($var_34);
			$var_136 = $var_134 = sqlescape($var_134);
			$var_135 = 2;
			$var_686 = ($var_77 !== false) ? " AND id != '".sqlescape($var_77)."'" : "";
			while (sqlrows(sqlquery("SELECT * FROM bigtree_module_actions WHERE module = '$var_34' AND route = '$var_134' $var_686"))) {
				$var_134 = $var_136."-".$var_135;
				$var_135++;
			}
			var_53 $var_134;
		}

		

		var_67 function var_687($var_55,$var_63) {
			sqlquery("DELETE FROM bigtree_locks WHERE `table` = '".sqlescape($var_55)."' AND item_id = '".sqlescape($var_63)."'");
		}

		

		var_60 var_688($var_63,$var_120,$var_121,$var_64,$var_122,$var_123,$var_124) {
			$var_126 = array();
			foreach ($var_122 as $var_36) {
				
				if ($var_36["id"] && $var_36["id"] != "type") {
					$var_126[] = array(
						"id" => BigTree::safeEncode($var_36["id"]),
						"type" => BigTree::safeEncode($var_36["type"]),
						"title" => BigTree::safeEncode($var_36["title"]),
						"subtitle" => BigTree::safeEncode($var_36["subtitle"]),
						"options" => BigTree::translateArray(json_decode($var_36["options"],true))
					);
				}
			}

			$var_63 = sqlescape($var_63);
			$var_120 = sqlescape(BigTree::safeEncode($var_120));
			$var_121 = sqlescape(BigTree::safeEncode($var_121));
			$var_64 = sqlescape($var_64);
			$var_122 = BigTree::json($var_126,true);
			$var_124 = sqlescape($var_124);
			$var_123 = sqlescape($var_123);

			sqlquery("UPDATE bigtree_callouts SET resources = '$var_122', name = '$var_120', description = '$var_121', level = '$var_64', display_field = '$var_123', display_default = '$var_124' WHERE id = '$var_63'");
			$var_10->track("bigtree_callouts",$var_63,"updated");
		}

		

		var_60 var_689($var_63,$var_120,$var_128) {
			sort($var_128);
			$var_128 = BigTree::json($var_128,true);
			sqlquery("UPDATE bigtree_callout_groups SET name = '".sqlescape(BigTree::safeEncode($var_120))."', callouts = '$var_128' WHERE id = '".sqlescape($var_63)."'");
			$var_10->track("bigtree_callout_groups",$var_63,"updated");
		}

		

		var_67 function var_690($var_37) {
			$var_37 = sqlescape($var_37);
			$var_43 = sqlquery("SELECT id,path FROM bigtree_pages WHERE parent = '$var_37'");
			while ($var_12 = sqlfetch($var_43)) {
				$var_691 = $var_12["path"];
				$var_200 = static::getFullNavigationPath($var_12["id"]);
				if ($var_691 != $var_200) {
					sqlquery("DELETE FROM bigtree_route_history WHERE old_route = '$var_200' OR old_route = '$var_691'");
					sqlquery("INSERT INTO bigtree_route_history (`old_route`,`new_route`) VALUES ('$var_691','$var_200')");
					sqlquery("UPDATE bigtree_pages SET path = '$var_200' WHERE id = '".$var_12["id"]."'");
					static::updateChildPagePaths($var_12["id"]);
				}
			}
		}

		

		var_60 var_692($var_63,$var_120,$var_121,$var_55,$var_130,$var_131,$var_132) {
			$var_131 = json_decode($var_131,true);
			foreach ($var_131 as &$var_133) {
				$var_133 = BigTreeCMS::replaceHardRoots($var_133);
			}

			
			$var_63 = sqlescape($var_63);
			$var_120 = sqlescape(BigTree::safeEncode($var_120));
			$var_121 = sqlescape(BigTree::safeEncode($var_121));
			$var_55 = sqlescape($var_55);
			$var_130 = sqlescape($var_130);
			$var_131 = BigTree::json($var_131,true);
			$var_132 = BigTree::json($var_132,true);

			sqlquery("UPDATE bigtree_feeds SET name = '$var_120', description = '$var_121', `table` = '$var_55', type = '$var_130', fields = '$var_132', options = '$var_131' WHERE id = '$var_63'");
			$var_10->track("bigtree_feeds",$var_63,"updated");
		}

		

		var_60 var_693($var_63,$var_120,$var_138,$var_139) {
			$var_63 = sqlescape($var_63);
			$var_120 = sqlescape(BigTree::safeEncode($var_120));
			$var_138 = sqlescape(json_encode($var_138));
			$var_139 = $var_139 ? "'on'" : "NULL";

			sqlquery("UPDATE bigtree_field_types SET name = '$var_120', use_cases = '$var_138', self_draw = $var_139 WHERE id = '$var_63'");
			$var_10->track("bigtree_field_types",$var_63,"updated");

			unlink(var_105."cache/bigtree-form-field-types.json");
		}

		

		var_60 var_694($var_63,$var_120,$var_62,$var_148,$var_149,$var_150) {
			
			if ($var_149["table"]) {
				BigTreeAutoModule::clearCache($var_149["table"]);
			}

			$var_63 = sqlescape($var_63);
			$var_120 = sqlescape(BigTree::safeEncode($var_120));
			$var_62 = $var_62 ? "'".sqlescape($var_62)."'" : "NULL";
			$var_148 = sqlescape($var_148);
			$var_149 = BigTree::json($var_149,true);
			$var_150 = sqlescape($var_150);

			sqlquery("UPDATE bigtree_modules SET name = '$var_120', `group` = $var_62, class = '$var_148', icon = '$var_150', `gbp` = '$var_149' WHERE id = '$var_63'");
			$var_10->track("bigtree_modules",$var_63,"updated");

			
			unlink(var_105."cache/bigtree-module-class-list.json");
		}

		

		var_60 var_695($var_63,$var_120,$var_134,$var_153,$var_150,$var_154,$var_155,$var_156,$var_64,$var_157) {
			$var_63 = sqlescape($var_63);
			$var_134 = sqlescape(BigTree::safeEncode($var_134));
			$var_153 = sqlescape($var_153);
			$var_150 = sqlescape($var_150);
			$var_120 = sqlescape(BigTree::safeEncode($var_120));
			$var_64 = sqlescape($var_64);
			$var_154 = $var_154 ? "'".sqlescape($var_154)."'" : "NULL";
			$var_155 = $var_155 ? "'".sqlescape($var_155)."'" : "NULL";
			$var_156 = $var_156 ? "'".sqlescape($var_156)."'" : "NULL";
			$var_157 = sqlescape($var_157);

			$var_252 = $var_10->getModuleAction($var_63);
			$var_134 = $var_10->uniqueModuleActionRoute($var_252["module"],$var_134,$var_63);

			sqlquery("UPDATE bigtree_module_actions SET name = '$var_120', route = '$var_134', class = '$var_150', in_nav = '$var_153', level = '$var_64', position = '$var_157', form = $var_154, view = $var_155, report = $var_156 WHERE id = '$var_63'");
			$var_10->track("bigtree_module_actions",$var_63,"updated");
		}

		

		var_60 var_696($var_63,$var_160,$var_55,$var_132,$var_161 = array(),$var_162 = "",$var_163 = "",$var_164 = "",$var_165 = "",$var_166 = "") {
			$var_63 = sqlescape($var_63);
			$var_160 = sqlescape(BigTree::safeEncode($var_160));
			$var_55 = sqlescape($var_55);
			$var_161 = BigTree::json(json_decode($var_161),true);
			$var_162 = sqlescape($var_162);
			$var_163 = $var_163 ? "on" : "";
			$var_164 = sqlescape(BigTree::safeEncode($var_10->makeIPL($var_164)));
			$var_165 = sqlescape(BigTree::safeEncode($var_165));
			$var_166 = sqlescape($var_166);

			$var_169 = array();
			foreach ($var_132 as $var_170 => $var_171) {
				$var_171["options"] = BigTree::translateArray(json_decode($var_171["options"],true));
				$var_171["column"] = $var_170;
				$var_169[] = $var_171;
			}
			$var_132 = BigTree::json($var_169,true);

			sqlquery("UPDATE bigtree_module_embeds SET `title` = '$var_160', `table` = '$var_55', `fields` = '$var_132', `default_position` = '$var_162', `default_pending` = '$var_163', `css` = '$var_164', `redirect_url` = '$var_165', `thank_you_message` = '$var_166', `hooks` = '$var_161' WHERE id = '$var_63'");
			$var_10->track("bigtree_module_embeds",$var_63,"updated");
		}

		

		var_60 var_697($var_63,$var_160,$var_55,$var_132,$var_161 = array(),$var_162 = "",$var_173 = false,$var_174 = "",$var_175 = "") {
			$var_63 = sqlescape($var_63);
			$var_160 = sqlescape(BigTree::safeEncode($var_160));
			$var_55 = sqlescape($var_55);
			$var_161 = BigTree::json(json_decode($var_161),true);
			$var_162 = sqlescape($var_162);
			$var_173 = $var_173 ? "'".sqlescape($var_173)."'" : "NULL";
			$var_174 = sqlescape($var_10->makeIPL($var_174));
			$var_175 = $var_175 ? "on" : "";

			$var_169 = array();
			foreach ($var_132 as $var_170 => $var_171) {
				$var_171["options"] = BigTree::translateArray(json_decode($var_171["options"],true));
				$var_171["column"] = $var_170;
				$var_171["title"] = BigTree::safeEncode($var_171["title"]);
				$var_171["subtitle"] = BigTree::safeEncode($var_171["subtitle"]);
				$var_169[] = $var_171;
			}
			$var_132 = BigTree::json($var_169,true);

			sqlquery("UPDATE bigtree_module_forms SET title = '$var_160', `table` = '$var_55', fields = '$var_132', default_position = '$var_162', return_view = $var_173, return_url = '$var_174', `tagging` = '$var_175', `hooks` = '$var_161' WHERE id = '$var_63'");
			sqlquery("UPDATE bigtree_module_actions SET name = 'Add $var_160' WHERE form = '$var_63' AND route LIKE 'add%'");
			sqlquery("UPDATE bigtree_module_actions SET name = 'Edit $var_160' WHERE form = '$var_63' AND route LIKE 'edit%'");

			
			$var_43 = sqlquery("SELECT id FROM bigtree_module_views WHERE `table` = '$var_55'");
			while ($var_12 = sqlfetch($var_43)) {
				static::updateModuleViewColumnNumericStatus(BigTreeAutoModule::getView($var_12["id"]));
			}

			$var_10->track("bigtree_module_forms",$var_63,"updated");
		}

		

		var_60 var_698($var_63,$var_120) {
			
			$var_135 = 2;
			$var_134 = BigTreeCMS::urlify($var_120);
			$var_136 = $var_134;
			$var_118 = $var_10->getModuleGroupByRoute($var_134);
			while ($var_118 && $var_118["id"] != $var_63) {
				$var_134 = $var_136."-".$var_135;
				$var_118 = $var_10->getModuleGroupByRoute($var_134);
				$var_135++;
			}

			$var_134 = sqlescape($var_134);
			$var_63 = sqlescape($var_63);
			$var_120 = sqlescape(BigTree::safeEncode($var_120));

			sqlquery("UPDATE bigtree_module_groups SET name = '$var_120', route = '$var_134' WHERE id = '$var_63'");
			$var_10->track("bigtree_module_groups",$var_63,"updated");
		}

		

		var_60 var_699($var_63,$var_160,$var_55,$var_130,$var_178,$var_132 = "",$var_179 = "",$var_155 = "") {
			$var_63 = sqlescape($var_63);
			$var_160 = sqlescape(BigTree::safeEncode($var_160));
			$var_55 = sqlescape($var_55);
			$var_130 = sqlescape($var_130);
			$var_178 = BigTree::json($var_178,true);
			$var_132 = BigTree::json($var_132,true);
			$var_179 = sqlescape($var_179);
			$var_155 = $var_155 ? "'".sqlescape($var_155)."'" : "NULL";
			sqlquery("UPDATE bigtree_module_reports SET `title` = '$var_160', `table` = '$var_55', `type` = '$var_130', `filters` = '$var_178', `fields` = '$var_132', `parser` = '$var_179', `view` = $var_155 WHERE id = '$var_63'");
			
			sqlquery("UPDATE bigtree_module_actions SET `name` = '$var_160' WHERE `report` = '$var_63'");
			$var_10->track("bigtree_module_reports",$var_63,"updated");
		}

		

		var_60 var_700($var_63,$var_160,$var_121,$var_55,$var_130,$var_131,$var_132,$var_181,$var_182,$var_183 = "") {
			$var_63 = sqlescape($var_63);
			$var_160 = sqlescape(BigTree::safeEncode($var_160));
			$var_121 = sqlescape(BigTree::safeEncode($var_121));
			$var_55 = sqlescape($var_55);
			$var_130 = sqlescape($var_130);

			$var_131 = BigTree::json($var_131,true);
			$var_132 = BigTree::json($var_132,true);
			$var_181 = BigTree::json($var_181,true);
			$var_182 = $var_182 ? intval($var_182) : "NULL";
			$var_183 = sqlescape(BigTree::safeEncode($var_10->makeIPL($var_183)));

			sqlquery("UPDATE bigtree_module_views SET title = '$var_160', description = '$var_121', `table` = '$var_55', type = '$var_130', options = '$var_131', fields = '$var_132', actions = '$var_181', preview_url = '$var_183', related_form = $var_182 WHERE id = '$var_63'");
			sqlquery("UPDATE bigtree_module_actions SET name = 'View $var_160' WHERE view = '$var_63'");

			static::updateModuleViewColumnNumericStatus(BigTreeAutoModule::getView($var_63));
			$var_10->track("bigtree_module_views",$var_63,"updated");
		}

		

		var_67 function var_701($var_155) {
			if (is_array($var_155["fields"])) {
				$var_154 = BigTreeAutoModule::getRelatedFormForView($var_155);
				$var_55 = BigTree::describeTable($var_155["table"]);

				foreach ($var_155["fields"] as $var_170 => $var_171) {
					$var_702 = false;
					$var_539 = $var_55["columns"][$var_170]["type"];
					if ($var_539 == "int" || $var_539 == "float" || $var_539 == "double" || $var_539 == "double precision" || $var_539 == "tinyint" || $var_539 == "smallint" || $var_539 == "mediumint" || $var_539 == "bigint" || $var_539 == "real" || $var_539 == "decimal" || $var_539 == "dec" || $var_539 == "fixed" || $var_539 == "numeric") {
						$var_702 = true;
					}
					if ($var_171["parser"] || ($var_154["fields"][$var_170]["type"] == "list" && $var_154["fields"][$var_170]["list_type"] == "db")) {
						$var_702 = false;
					}

					$var_155["fields"][$var_170]["numeric"] = $var_702;
				}

				$var_132 = BigTree::json($var_155["fields"],true);
				sqlquery("UPDATE bigtree_module_views SET fields = '$var_132' WHERE id = '".$var_155["id"]."'");
			}
		}

		

		var_60 var_703($var_155,$var_132) {
			$var_155 = sqlescape($var_155);
			$var_132 = BigTree::json($var_132,true);
			sqlquery("UPDATE bigtree_module_views SET `fields` = '$var_132' WHERE id = '$var_155'");
			$var_10->track("bigtree_module_views",$var_155,"updated");
		}

		

		var_60 var_704($var_37,$var_102) {
			$var_37 = sqlescape($var_37);

			
			$var_649 = sqlfetch(sqlquery("SELECT * FROM bigtree_pages WHERE id = '$var_37'"));
			foreach ($var_649 as $var_170 => $var_196) {
				$$var_170 = sqlescape($var_196);
			}
			
			$var_705 = BigTreeCMS::getTemplate($var_189);
			if (is_array($var_705) && $var_705["level"] > $var_10->var_15) {
				$var_102["template"] = $var_189;
			}
			
			sqlquery("INSERT INTO bigtree_page_revisions (`page`,`title`,`meta_keywords`,`meta_description`,`template`,`external`,`new_window`,`resources`,`author`,`updated_at`) VALUES ('$var_37','$var_160','$var_188','$var_187','$var_189','$var_84','$var_194','$var_122','$var_650','$var_651')");
			
			$var_146 = sqlrows(sqlquery("SELECT id FROM bigtree_page_revisions WHERE page = '$var_37' AND saved = ''"));
			
			if ($var_146 > 10) {
				sqlquery("DELETE FROM bigtree_page_revisions WHERE page = '$var_37' AND updated_at < '".date("Y-m-d",strtotime("-1 month"))."' AND saved = '' ORDER BY updated_at ASC LIMIT ".($var_146 - 10));
			}

			
			static::unCache($var_37);

			
			foreach ($var_102 as $var_170 => $var_196) {
				if (substr($var_170,0,1) != "_" && $var_170 != "current" && $var_170 != "page") {
					if (is_array($var_196)) {
						$$var_170 = BigTree::json($var_196,true);
					} var_197 {
						$$var_170 = sqlescape($var_196);
					}
				}
			}

			
			var_78 ($var_10->var_15 < 2) {
				$var_193 = $var_649["trunk"];
			} var_197 {
				$var_193 = sqlescape($var_102["trunk"]);
			}

			
			var_78 (!$var_649["parent"] && $var_10->var_15 < 2) {
				$var_153 = sqlescape($var_649["in_nav"]);
			} var_197 {
				$var_153 = sqlescape($var_102["in_nav"]);
			}

			
			var_78 ($var_84) {
				$var_84 = static::makeIPL($var_84);
			}

			
			var_78 (!isset($var_102["parent"])) {
				$var_185 = $var_649["parent"];
			}

			var_78 ($var_37 == 0) {
				
				$var_134 = "";
			} var_197 {
				
				$var_134 = $var_102["route"];
				if (!$var_134) {
					$var_134 = BigTreeCMS::urlify($var_102["nav_title"]);
				} var_197 {
					$var_134 = BigTreeCMS::urlify($var_134);
				}

				
				$var_136 = $var_134;
				$var_135 = 2;
				
				if ($var_185 == 0) {
					while (file_exists(var_105."site/".$var_134."/")) {
						$var_134 = $var_136."-".$var_135;
						$var_135++;
					}
					var_199 (in_array($var_134,static::$var_6)) {
						$var_134 = $var_136."-".$var_135;
						$var_135++;
					}
				}

				
				$var_12 = sqlfetch(sqlquery("SELECT id FROM bigtree_pages WHERE `route` = '$var_134' AND parent = '$var_185' AND id != '$var_37'"));
				while ($var_12) {
					$var_134 = $var_136."-".$var_135;
					$var_12 = sqlfetch(sqlquery("SELECT id FROM bigtree_pages WHERE `route` = '$var_134' AND parent = '$var_185' AND id != '$var_37'"));
					$var_135++;
				}

				
				$var_134 = substr($var_134,0,255);
			}

			
			var_78 ($var_649["nav_title"] != $var_186 || $var_649["route"] != $var_134 || $var_649["in_nav"] != $var_153 || $var_649["parent"] != $var_185) {
				static::clearCache();
			}

			
			var_78 ($var_191 && $var_191 != "NULL") {
				$var_191 = "'".date("Y-m-d",strtotime($var_191))."'";
			} var_197 {
				$var_191 = "NULL";
			}

			
			var_78 ($var_192 && $var_192 != "NULL") {
				$var_192 = "'".date("Y-m-d",strtotime($var_192))."'";
			} var_197 {
				$var_192 = "NULL";
			}

			
			var_78 ($var_185 > 0) {
				$var_200 = static::getFullNavigationPath($var_185)."/".$var_134;
			} var_197 {
				$var_200 = $var_134;
			}

			
			$var_160 = BigTree::safeEncode($var_160);
			$var_186 = var_75::var_706($var_186);
			$var_187 = var_75::var_706($var_187);
			$var_188 = var_75::var_706($var_188);
			$var_190 = $var_102["var_190"] ? "on" : "";
			$var_84 = var_75::var_706($var_84);

			
			sqlquery("UPDATE bigtree_pages SET `trunk` = '$var_193', `parent` = '$var_185', `nav_title` = '$var_186', `route` = '$var_134', `path` = '$var_200', `in_nav` = '$var_153', `title` = '$var_160', `template` = '$var_189', `external` = '$var_84', `new_window` = '$var_194', `resources` = '$var_122', `meta_keywords` = '$var_188', `meta_description` = '$var_187', `seo_invisible` = '$var_190', `last_edited_by` = '".$var_10->var_13."', updated_at = NOW(), publish_at = $var_191, expire_at = $var_192, max_age = '$var_195' WHERE id = '$var_37'");

			
			sqlquery("DELETE FROM bigtree_pending_changes WHERE `table` = 'bigtree_pages' AND item_id = '$var_37'");

			
			sqlquery("DELETE FROM bigtree_route_history WHERE old_route = '$var_200' OR old_route = '".$var_649["path"]."'");

			
			if ($var_649["path"] != $var_200) {
				sqlquery("INSERT INTO bigtree_route_history (`old_route`,`new_route`) VALUES ('".$var_649["path"]."','$var_200')");

				
				static::updateChildPagePaths($var_37);
				static::pingSearchEngines();
				static::clearCache();
			}

			
			sqlquery("DELETE FROM bigtree_tags_rel WHERE `table` = 'bigtree_pages' AND entry = '$var_37'");
			if (is_array($var_102["_tags"])) {
				foreach ($var_102["_tags"] as $var_202) {
					sqlquery("INSERT INTO bigtree_tags_rel (`table`,`entry`,`tag`) VALUES ('bigtree_pages','$var_37','$var_202')");
				}
			}

			
			$var_10->track("bigtree_pages",$var_37,"updated");
			
			
			foreach (var_707::$var_708 as $var_709 => $var_710) {
				if ($var_710["trunk"] == $var_37) {
					unlink(var_105."cache/multi-site-cache.json");
				}
			}

			var_53 $var_37;
		}

		

		var_60 var_711($var_37,$var_185) {
			$var_37 = sqlescape($var_37);
			$var_185 = sqlescape($var_185);

			if ($var_10->var_15 < 1) {
				$var_10->stop("You are not allowed to move pages.");
			}

			
			$var_649 = sqlfetch(sqlquery("SELECT in_nav,path FROM bigtree_pages WHERE id = '$var_37'"));
			$var_712 = sqlescape($var_649["path"]);

			
			$var_153 = $var_649["in_nav"] ? "on" : "";
			if ($var_10->var_15 < 2 && $var_185 == 0) {
				$var_153 = "";
			}

			sqlquery("UPDATE bigtree_pages SET in_nav = '$var_153', parent = '$var_185' WHERE id = '$var_37'");
			$var_200 = sqlescape($var_10->getFullNavigationPath($var_37));

			
			sqlquery("DELETE FROM bigtree_route_history WHERE old_route = '$var_200' OR old_route = '$var_712'");
			sqlquery("INSERT INTO bigtree_route_history (`old_route`,`new_route`) VALUES ('$var_712','$var_200')");

			
			sqlquery("UPDATE bigtree_pages SET path = '$var_200' WHERE id = '$var_37'");

			
			$var_10->updateChildPagePaths($var_37);
			$var_10->track("bigtree_pages",$var_37,"moved");
		}

		

		var_60 var_713($var_63,$var_121) {
			
			$var_274 = $var_10->getPageRevision($var_63);
			$var_38 = $var_10->getPageAccessLevel($var_274["page"]);
			if ($var_38 != "p") {
				$var_10->stop("You must be a publisher to manage revisions.");
			}

			
			$var_121 = sqlescape(htmlspecialchars($var_121));
			sqlquery("UPDATE bigtree_page_revisions SET saved = 'on', saved_description = '$var_121' WHERE id = '".$var_274["id"]."'");
			$var_10->track("bigtree_page_revisions",$var_63,"updated");
		}

		

		var_60 var_714($var_63,$var_206,$var_207 = array(),$var_208 = array()) {
			$var_63 = sqlescape($var_63);
			$var_206 = BigTree::json($var_206,true);
			$var_207 = BigTree::json($var_207,true);
			$var_208 = BigTree::json($var_208,true);

			sqlquery("UPDATE bigtree_pending_changes SET changes = '$var_206', mtm_changes = '$var_207', tags_changes = '$var_208', date = NOW(), user = '".$var_10->var_13."' WHERE id = '$var_63'");
			$var_10->track("bigtree_pending_changes",$var_63,"updated");
		}

		

		var_60 var_715($var_102) {
			var_71 $var_72;

			$var_120 = sqlescape(htmlspecialchars($var_102["name"]));
			$var_237 = sqlescape(htmlspecialchars($var_102["company"]));
			$var_238 = $var_102["daily_digest"] ? "on" : "";
			$var_63 = sqlescape($var_10->var_13);

			if ($var_102["password"]) {
				$var_73 = new class_0($var_72["config"]["password_depth"], TRUE);
				$var_70 = sqlescape($var_73->HashPassword($var_102["password"]));
				sqlquery("UPDATE bigtree_users SET `password` = '$var_70', `name` = '$var_120', `company` = '$var_237', `daily_digest` = '$var_238' WHERE id = '$var_63'");
			} var_197 {
				sqlquery("UPDATE bigtree_users SET `name` = '$var_120', `company` = '$var_237', `daily_digest` = '$var_238' WHERE id = '$var_63'");
			}
		}

		

		var_60 var_716($var_63,$var_717) {
			$var_63 = sqlescape($var_63);
			$var_132 = array();
			foreach ($var_717 as $var_170 => $var_196) {
				$var_132[] = "`$var_170` = '".sqlescape($var_196)."'";
			}
			sqlquery("UPDATE bigtree_resources SET ".implode(", ",$var_132)." WHERE id = '$var_63'");
			$var_10->track("bigtree_resources",$var_63,"updated");
		}

		

		var_60 var_718($var_719,$var_102) {
			var_71 $var_72;

			
			$var_118 = static::getSetting($var_719);
			$var_719 = sqlescape($var_118["id"]);

			
			foreach ($var_102 as $var_170 => $var_196) {
				if (substr($var_170,0,1) != "_" && !is_array($var_196)) {
					$$var_170 = sqlescape(htmlspecialchars($var_196));
				}
			}

			
			$var_121 = sqlescape($var_102["description"]);

			
			$var_131 = json_decode($var_102["options"], true);

			foreach ($var_131 as $var_170 => $var_230) {
				if ($var_170 == "options" && is_string($var_230)) {
					$var_131[$var_170] = json_decode($var_230, true);
				}
			}

			$var_131 = BigTree::json(BigTree::translateArray($var_131), true);

			
			if ($var_719 != $var_63 && static::settingExists($var_63)) {
				var_53 false;
			}

			sqlquery("UPDATE bigtree_settings SET id = '$var_63', type = '$var_130', `options` = '$var_131', name = '$var_120', description = '$var_121', locked = '$var_225', system = '$var_227', encrypted = '$var_226' WHERE id = '$var_719'");

			
			if ($var_118["encrypted"] && !$var_226) {
				sqlquery("UPDATE bigtree_settings SET value = AES_DECRYPT(value,'".sqlescape($var_72["config"]["settings_key"])."') WHERE id = '$var_63'");
			}
			if (!$var_118["encrypted"] && $var_226) {
				sqlquery("UPDATE bigtree_settings SET value = AES_ENCRYPT(value,'".sqlescape($var_72["config"]["settings_key"])."') WHERE id = '$var_63'");
			}

			
			$var_10->track("bigtree_settings",$var_63,"updated");

			return true;
		}

		

		var_67 function var_289($var_63,$var_230) {
			var_71 $var_72,$var_298;

			$var_252 = static::getSetting($var_63,false);
			$var_63 = sqlescape(BigTreeCMS::extensionSettingCheck($var_63));

			if (is_array($var_230)) {
				$var_230 = BigTree::translateArray($var_230);
			} var_197 {
				$var_230 = static::autoIPL($var_230);
			}

			$var_230 = BigTree::json($var_230,true);

			if ($var_252["encrypted"]) {
				sqlquery("UPDATE bigtree_settings SET `value` = AES_ENCRYPT('$var_230','".sqlescape($var_72["config"]["settings_key"])."') WHERE id = '$var_63'");
			} var_197 {
				sqlquery("UPDATE bigtree_settings SET `value` = '$var_230' WHERE id = '$var_63'");
			}

			if ($var_298 && !$var_252["system"]) {
				
				$var_298->track("bigtree_settings",$var_63,"updated");
			}
		}

		

		var_60 var_720($var_63,$var_120,$var_64,$var_34,$var_122) {
			$var_126 = array();
			foreach ($var_122 as $var_36) {
				if ($var_36["id"]) {
					$var_126[] = array(
						"id" => BigTree::safeEncode($var_36["id"]),
						"title" => BigTree::safeEncode($var_36["title"]),
						"subtitle" => BigTree::safeEncode($var_36["subtitle"]),
						"type" => BigTree::safeEncode($var_36["type"]),
						"options" => BigTree::translateArray(json_decode($var_36["options"],true))
					);
				}
			}

			$var_63 = sqlescape($var_63);
			$var_120 = sqlescape(htmlspecialchars($var_120));
			$var_34 = sqlescape($var_34);
			$var_122 = BigTree::json($var_126,true);
			$var_64 = sqlescape($var_64);

			sqlquery("UPDATE bigtree_templates SET resources = '$var_122', name = '$var_120', module = '$var_34', level = '$var_64' WHERE id = '$var_63'");
			$var_10->track("bigtree_templates",$var_63,"updated");
		}

		

		var_60 var_721($var_63,$var_102) {
			var_71 $var_72;
			$var_63 = sqlescape($var_63);

			
			$var_146 = sqlrows(sqlquery("SELECT * FROM bigtree_users WHERE email = '".sqlescape($var_102["email"])."' AND id != '$var_63'"));
			if ($var_146) {
				var_53 false;
			}

			
			$var_649 = static::getUser($var_63);
			if ($var_649["level"] > $var_10->var_15) {
				var_53 false;
			}

			$var_64 = intval($var_102["level"]);
			$var_236 = sqlescape($var_102["email"]);
			$var_120 = sqlescape(htmlspecialchars($var_102["name"]));
			$var_237 = sqlescape(htmlspecialchars($var_102["company"]));
			$var_238 = $var_102["daily_digest"] ? "on" : "";

			$var_149 = BigTree::json($var_102["permissions"],true);
			$var_239 = BigTree::json($var_102["alerts"],true);

			
			if ($var_10->var_13 == $var_649["id"]) {
				$var_64 = $var_649["level"];
			}

			
			if ($var_64 > $var_10->var_15) {
				$var_64 = $var_10->var_15;
			}

			if ($var_102["password"]) {
				$var_73 = new class_0($var_72["config"]["password_depth"], TRUE);
				$var_70 = sqlescape($var_73->HashPassword(trim($var_102["password"])));
				sqlquery("UPDATE bigtree_users SET `email` = '$var_236', `password` = '$var_70', `name` = '$var_120', `company` = '$var_237', `level` = '$var_64', `permissions` = '$var_149', `alerts` = '$var_239', `daily_digest` = '$var_238' WHERE id = '$var_63'");
			} var_197 {
				sqlquery("UPDATE bigtree_users SET `email` = '$var_236', `name` = '$var_120', `company` = '$var_237', `level` = '$var_64', `permissions` = '$var_149', `alerts` = '$var_239', `daily_digest` = '$var_238' WHERE id = '$var_63'");
			}

			$var_10->track("bigtree_users",$var_63,"updated");

			return true;
		}

		

		var_67 function var_722($var_63,$var_70) {
			var_71 $var_72;

			$var_63 = sqlescape($var_63);
			$var_73 = new class_0($var_72["config"]["password_depth"], TRUE);
			$var_70 = sqlescape($var_73->HashPassword(trim($var_70)));
			sqlquery("UPDATE bigtree_users SET password = '$var_70' WHERE id = '$var_63'");
		}

		

		var_67 function var_723($var_70) {
			var_71 $var_72;

			$var_724 = $var_72["security-policy"]["password"];
			$var_618 = false;

			
			if ($var_724["length"] && strlen($var_70) < $var_724["length"]) {
				$var_618 = true;
			}
			
			if ($var_724["multicase"] && strtolower($var_70) === $var_70) {
				$var_618 = true;
			}
			
			if ($var_724["numbers"] && !preg_match("/[0-9]/",$var_70)) {
				$var_618 = true;
			}
			
			if ($var_724["nonalphanumeric"] && ctype_alnum($var_70)) {
				$var_618 = true;
			}
			var_53 !$var_618;
		}
		
		
		
		var_60 var_725() {
			$var_726 = var_332(array("http:
			$var_727 = str_replace(array("var_97:
			$var_574 = isset($var_728[$var_10->var_19]) ? $var_728[$var_10->var_19] : $var_729[$var_10->var_19];
			
			if (strpos($var_726, $var_727) !== 0 || $var_574 != $var_10->var_18) {
				
				$var_43 = sqlquery("var_422 * var_541 var_730 var_424 var_236 = '".sqlescape($var_10->var_14)."'");
				
				while ($var_731 = sqlfetch($var_43)) {
					$var_574 = isset($var_728[$var_731["csrf_token_field"]]) ? $var_728[$var_731["csrf_token_field"]] : $var_729[$var_731["csrf_token_field"]];
					
					if ($var_574 && $var_574 == $var_731["csrf_token"]) {
						var_53;
					}
				}
				
				$var_10->stop("Cross site request forgery detected.");
			}
		}

		

		static function verifyLogin2FA($var_236, $var_70) {
			var_71 $var_72;

			$var_506 = ip2long($_SERVER["REMOTE_ADDR"]);

			if (static::isIPBanned($var_506)) {
				var_53 null;
			}

			
			$var_236 = trim(strtolower($var_236));
			$var_70 = trim($var_70);
			$var_20 = sqlfetch(sqlquery("SELECT * FROM bigtree_users WHERE LOWER(email) = '".sqlescape($var_236)."'"));

			if ($var_20) {
				if (static::isUserBanned($var_20["id"])) {
					var_53 null;
				}
				
				$var_73 = new class_0($var_72["config"]["password_depth"], true);
				
				if ($var_73->CheckPassword($var_70, $var_20["password"])) {
					$var_574 = $var_73->HashPassword(BigTree::randomString(64).trim($var_70).BigTree::randomString(64));
					$_SESSION["bigtree_admin"]["2fa_id"] = intval($var_20["id"]);
					$_SESSION["bigtree_admin"]["2fa_login_token"] = $var_574;
					sqlquery("UPDATE bigtree_users SET 2fa_login_token = '".sqlescape($var_574)."' WHERE id = '".intval($var_20["id"])."'");

					return $var_20["2fa_secret"];
				}
			}
			
			var_53 null;
		}

		

		var_67 function var_733($var_734) {
			$var_735 = explode(".",$var_734);
			$var_736 = $var_735[0] * 10000;
			if (isset($var_735[1])) {
				$var_736 += $var_735[1] * 100;
			}
			if (isset($var_735[2])) {
				$var_736 += $var_735[2];
			}
			var_53 $var_736;
		}
	}
