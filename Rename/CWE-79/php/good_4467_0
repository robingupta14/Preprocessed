<?php





define('HTDOCDIR',sprintf('%s/',realpath(var_0.'../htdocs/')));
define('LANGDIR',sprintf('%s/',realpath(var_0.'../locale/')));
define('CONFDIR',sprintf('%s/',realpath(var_0.'../config')));
define('QUERYDIR',sprintf('%s/',realpath(var_0.'../queries/')));
define('TMPLDIR',sprintf('%s/',realpath(var_0.'../templates/')));
define('DOCDIR',sprintf('%s/',realpath(var_0.'../doc/')));
define('HOOKSDIR',sprintf('%s/',realpath(var_0.'../hooks/')));
define('JSDIR','js/');


$app['function_files'] = array(
	
	var_0.'session_functions.php',
	
	var_0.'schema_functions.php',
	
	var_0.'template_functions.php',
	
	var_0.'emuhash_functions.php',
	
	var_0.'createlm.php',
	
	var_0.'ds.php',
	
	var_0.'page.php'
);

if (file_exists(var_0.'functions.custom.php'))
	array_push($app['function_files'],var_0.'functions.custom.php');


function fn_0($var_1) {
	if (file_exists(var_2."classes/$var_1.php"))
	elseif (file_exists(var_0."$var_1.php"))
	var_3 (file_exists(var_0."ds_$var_1.php"))
	var_4
		var_5(array(
			'title'=>fn_3('Generic Error'),
			'body'=>sprintf('%s: %s [%s]',
				var_6,fn_3('Called to load a class that cant be found'),$var_1),
			'type'=>'error'));
}

if (version_compare(phpversion(), '7.0', '>=')) {
	spl_autoload_register('pla_autoload');
} else {
	eval('function __autoload($className) {pla_autoload($className);}');
}


function fn_2(&$var_7) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (is_array($var_7))
		while (list($var_12) = each($var_7))
			if (is_array($var_7[$var_12]) && $var_12 != $var_7)
				fn_2($var_7[$var_12]);
			else
				$var_7[$var_12] = stripslashes($var_7[$var_12]);
}




if (! function_exists('_')) {
	function fn_3($var_13) {
		return $var_13;
	}
}




function fn_4($var_14,$var_15,$var_16,$var_17) {
	if (defined('DEBUG_ENABLED') && var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	if (ini_get('error_reporting') == 0 || error_reporting() == 0)
		return;

	$var_16 = basename($var_16);
	$var_18 = basename($_SERVER['PHP_SELF']);
	$var_19 = '';

	switch ($var_14) {
		case var_20: $var_19 = 'E_STRICT'; break;
		case var_21: $var_19 = 'E_ERROR'; break;
		case var_22: $var_19 = 'E_WARNING'; break;
		case var_23: $var_19 = 'E_PARSE'; break;
		case var_24: $var_19 = 'E_NOTICE'; break;
		case var_25: $var_19 = 'E_CORE_ERROR'; break;
		case var_26: $var_19 = 'E_CORE_WARNING'; break;
		case var_27: $var_19 = 'E_COMPILE_ERROR'; break;
		case var_28: $var_19 = 'E_COMPILE_WARNING'; break;
		case var_29: $var_19 = 'E_USER_ERROR'; break;
		case var_30: $var_19 = 'E_USER_WARNING'; break;
		case var_31: $var_19 = 'E_USER_NOTICE'; break;
		case var_32: $var_19 = 'E_ALL'; break;

		default: $var_19 = sprintf('%s: %s',fn_3('Unrecognized error number'),$var_14);
	}

	
	$var_15 = preg_replace('/\s+/',' ',$var_15);

	if ($var_14 == var_24) {
		$var_33 = '<table class="notice">';
		$var_33 .= sprintf('<tr><td>%s:</td><td><b>%s</b> (<b>%s</b>)</td></tr>',fn_3('Error'),$var_15,$var_19);
		$var_33 .= sprintf('<tr><td>%s:</td><td><b>%s</b> %s <b>%s</b>, %s <b>%s</b></td></tr>',
			fn_3('File'),$var_16,fn_3('line'),$var_17,fn_3('caller'),$var_18);
		$var_33 .= sprintf('<tr><td>Versions:</td><td>PLA: <b>%s</b>, PHP: <b>%s</b>, SAPI: <b>%s</b></td></tr>',
			fn_6(),phpversion(),php_sapi_name());
		$var_33 .= sprintf('<tr><td>Web server:</td><td><b>%s</b></td></tr>',isset($_SERVER['SERVER_SOFTWARE']) ? $_SERVER['SERVER_SOFTWARE'] : 'SCRIPT');

		if (function_exists('get_href'))
			$var_33 .= sprintf('<tr><td colspan="2"><a href="%s" onclick="target=\'_blank\';"><center>%s.</center></a></td></tr>',
				fn_51('search_bug',"&summary_keyword=".rawurlencode($var_15)),
				fn_3('Please check and see if this bug has been reported'));
		$var_33 .= '</table>';

		fn_1(array(
			'title'=>fn_3('You found a non-fatal phpLDAPadmin bug!'),
			'body'=>$var_33,
			'type'=>'error'));

		return;
	}

	
	fn_8(sprintf('%s: %s',$var_19,$var_15),'error',null,true,true);
}


function fn_5() {
	return 'phpLDAPadmin';
}


function fn_6() {
	static $var_34 = null;

	if ($var_34)
		return $var_34;

	$var_35 = realpath(var_0.'../VERSION');
	if (! file_exists($var_35))
		$var_34 = 'UNKNOWN';

	else {
		$var_36 = rtrim(file_get_contents($var_35));

		$var_34 = preg_replace('/^RELEASE-([0-9\.]+(-.*)*)$/','$1',$var_36);

		
		if (preg_match('/^(DEVEL)?$/',$var_34))
			$var_34 = 'DEVEL';

		
		elseif (preg_match('/^DEVEL-([0-9\.]+)+$/',$var_34)) {}

		
		elseif ($var_34 == $var_36)
			$var_34 = 'UNKNOWN';
	}

	return $var_34;
}


function fn_7($var_37) {
	switch ($var_37) {
		case 'ja': return 'ja_JP';
		case 'cs': return 'cs_CZ';
		default: return sprintf('%s_%s',$var_37,strtoupper($var_37));
	}
}


function var_38($var_39) {
	

	
	if (strcmp(phpversion(),var_40) < 0)
		fn_1(array(
			'title'=>fn_3('Incorrect version of PHP'),
			'body'=>sprintf('phpLDAPadmin requires PHP version %s or greater.<br /><small>(You are using %s)</small>',
				var_40,phpversion()),
			'type'=>'error'));

	$var_41 = new class_0;

	if (file_exists(var_0.'config_custom.php') && is_readable(var_0.'config_custom.php'))

	ob_start();
	$var_42 = '';
	if (ob_get_level()) {
		$var_42 = ob_get_contents();
		ob_end_clean();
	}

	if ($var_42) {
		$var_42 = strip_tags($var_42);
		$var_43 = array();
		preg_match('/(.*):\s+(.*):.*\s+on line (\d+)/',$var_42,$var_43);

		if (isset($var_43[1]) && isset($var_43[2]) && isset($var_43[3])) {
			$var_44 = $var_43[1];
			$var_45 = $var_43[2];
			$var_46 = $var_43[3];

			$var_16 = file($var_39);

			$var_33 = '<h3 class="title">Config file ERROR</h3>';
			$var_33 .= sprintf('<h3 class="subtitle">%s (%s) on line %s</h3>',$var_44,$var_45,$var_46);

			$var_33 .= '<center>';
			$var_33 .= sprintf('Looks like your config file has an ERROR on line %s.<br />',$var_46);
			$var_33 .= 'Here is a snippet around that line <br />';
			$var_33 .= '<br />'."\n";

			$var_33 .= '<div style="text-align: left; font-family: monospace; margin-left: 80px; margin-right: 80px; border: 1px solid black; padding: 10px;">';

			for ($var_47 = $var_46-9; $var_47<$var_46+5; $var_47++) {
				if ($var_47+1 == $var_46)
					$var_33 .= '<div style="color:red;background:

				if ($i < 0)
					continue;

				$body .= sprintf('<var_48>%var_49</var_48>: %var_49<var_50 />',$i+1,$file[$i]);

				if ($i+1 == $line_num)
					$body .= '</var_51>';
			}

			$body .= '</var_51>';
			$body .= '<var_50 />';
			$body .= 'var_52: var_53 var_54 var_55 var_56 var_57 var_58 var_59 <var_48>var_60</var_48> var_61 var_62 var_63.';
			$body .= '</var_64>';

			$block = new block();
			$block->SetBody($body);
			$www['var_65'] = new var_65();
			$var_92['page']->block_add('body',$var_67);
			$var_92['page']->display();

			die();
		}
	}

	
	if (! isset($var_69) || count($var_69->GetServerList()) == 0)
		fn_8(fn_3('Your config.php is missing Server Definitions. Please see the sample file config/config.php.example.'),'error','index.php',true);

	$var_41->setServers($var_69);

	
	if ((ini_get('memory_limit') > -1) && ini_get('memory_limit') < $var_41->getValue('session','memorylimit'))
		fn_1(array(
			'title'=>fn_3('Memory Limit low.'),
			'body'=>sprintf('Your php memory limit is low - currently %s, you should increase it to atleast %s. This is normally controlled in /etc/php.ini.',
				ini_get('memory_limit'),$var_41->getValue('session','memorylimit')),
			'type'=>'error'));

	return $var_41;
}


function fn_9($var_73) {
	if (defined('DEBUG_ENABLED') && var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	switch ($var_73) {
		case 'main' :
			return array(
				'home'=>array(
					'title'=>fn_3('Home'),
					'enable'=>true,
					'link'=>sprintf('href="index.php" title="%s"',fn_3('Home')),
					'image'=>sprintf('<img src="%s/home-big.png" alt="%s" />',var_74,fn_3('Home'))),

				'purge'=>array(
					'title'=>fn_3('Purge caches'),
					'enable'=>isset($_SESSION[var_75]) ? $_SESSION[var_75]->isCommandAvailable('script','purge_cache') : false,
					'link'=>sprintf('href="cmd.php?cmd=purge_cache" onclick="return ajDISPLAY(\'BODY\',\'cmd=purge_cache\',\'%s\');" title="%s"',
						fn_3('Clearing cache'),fn_3('Purge caches')),
					'image'=>sprintf('<img src="%s/trash-big.png" alt="%s" />',var_74,fn_3('Purge caches'))),

				'hide_debug_info'=>array(
					'title'=>fn_3('Show Cache'),
					'enable'=>isset($_SESSION[var_75]) ? ($_SESSION[var_75]->isCommandAvailable('script','show_cache')) && (! $_SESSION[var_75]->getValue('appearance','hide_debug_info')) : false,
					'link'=>sprintf('href="cmd.php?cmd=show_cache" onclick="return ajDISPLAY(\'BODY\',\'cmd=show_cache\',\'%s\');" title="%s"',
						fn_3('Loading'),fn_3('Show Cache'),fn_3('Show Cache')),
					'image'=>sprintf('<img src="%s/debug-cache.png" alt="%s" />',var_74,fn_3('Show Cache'))),
			);

			break;

		case 'top' :
			return array(
				'forum'=>array(
					'title'=>fn_3('Forum'),
					'enable'=>isset($_SESSION[var_75]) ? $_SESSION[var_75]->isCommandAvailable('cmd','oslinks') : true,
					'link'=>sprintf('href="%s" title="%s" onclick="target=\'_blank\';"',fn_51('forum'),fn_3('Forum')),
					'image'=>sprintf('<img src="%s/forum-big.png" alt="%s" />',var_74,fn_3('Forum'))),

				'feature'=>array(
					'title'=>fn_3('Request feature'),
					'enable'=>isset($_SESSION[var_75]) ? $_SESSION[var_75]->isCommandAvailable('cmd','oslinks') : true,
					'link'=>sprintf('href="%s" title="%s" onclick="target=\'_blank\';"',fn_51('add_rfe'),fn_3('Request feature')),
					'image'=>sprintf('<img src="%s/request-feature-big.png" alt="%s" />',var_74,fn_3('Request feature'))),

				'bug'=>array(
					'title'=>fn_3('Report a bug'),
					'enable'=>isset($_SESSION[var_75]) ? $_SESSION[var_75]->isCommandAvailable('cmd','oslinks') : true,
					'link'=>sprintf('href="%s" title="%s" onclick="target=\'_blank\';"',fn_51('add_bug'),fn_3('Report a bug')),
					'image'=>sprintf('<img src="%s/bug-big.png" alt="%s" />',var_74,fn_3('Report a bug'))),

				'donation'=>array(
					'title'=>fn_3('Donate'),
					'enable'=>isset($_SESSION[var_75]) ? $_SESSION[var_75]->isCommandAvailable('cmd','oslinks') : true,
					'link'=>sprintf('href="%s" title="%s" onclick="target=\'_blank\';"',fn_51('donate'),fn_3('Donate')),
					'image'=>sprintf('<img src="%s/smile-big.png" alt="%s" />',var_74,fn_3('Donate'))),

				'help'=>array(
					'title'=>fn_3('Help'),
					'enable'=>isset($_SESSION[var_75]) ? $_SESSION[var_75]->isCommandAvailable('cmd','oslinks') : true,
					'link'=>sprintf('href="%s" title="%s" onclick="target=\'_blank\';"',fn_51('documentation'),fn_3('Help')),
					'image'=>sprintf('<img src="%s/help-big.png" alt="%s" />',var_74,fn_3('Help')))
			);

			break;
	}
}


function fn_10($var_77,$var_78=false,$var_79=false) {
	if ($var_79 &&
		isset($_SESSION[var_75]) && $_SESSION[var_75]->getValue('debug','addr') &&
		$_SERVER['HTTP_X_FORWARDED_FOR'] != $_SESSION[var_75]->getValue('debug','addr') &&
		$_SERVER['REMOTE_ADDR'] != $_SESSION[var_75]->getValue('debug','addr'))
		return;

	$var_80 = debug_backtrace();
	$var_18['class'] = isset($var_80[0]['class']) ? $var_80[0]['class'] : 'N/A';
	$var_18['function'] = isset($var_80[0]['function']) ? $var_80[0]['function'] : 'N/A';
	$var_18['file'] = isset($var_80[0]['file']) ? $var_80[0]['file'] : 'N/A';
	$var_18['line'] = isset($var_80[0]['line']) ? $var_80[0]['line'] : 'N/A';
	$var_18['debug'] = $var_77;

	
	print_r($var_18);
	

	if ($var_78)
		die();
}


function fn_11($var_13='Calling BackTrace',$var_78=false) {
	fn_8($var_13,'note',null,$var_78,true);
}


function fn_12($var_13) {
	fn_1(array('title'=>fn_3('Debug'),'body'=>$var_13,'type'=>'debug'));
}


function fn_13($var_13,$var_81,$var_82) {
	static $var_83;

	
	if (! isset($_SESSION[var_75])
		|| ! ($_SESSION[var_75]->getValue('debug','file') || $_SESSION[var_75]->getValue('debug','syslog')))
		return;

	$var_84 = $_SESSION[var_75]->getValue('debug','level');
	if (! $var_84 || (! ($var_81 & $var_84)))
		return;

	if ($_SESSION[var_75]->getValue('debug','addr'))
		if (isset($_SERVER['HTTP_X_FORWARDED_FOR']) && $_SERVER['HTTP_X_FORWARDED_FOR'] == $_SESSION[var_75]->getValue('debug','addr'))
			$var_85 = true;
		elseif ($_SERVER['REMOTE_ADDR'] == $_SESSION[var_75]->getValue('debug','addr'))
			$var_85 = true;
		else
			$var_85 = false;

	else
		$var_85 = true;

	if (! $var_85)
		return;

	
	$var_18 = basename($_SERVER['PHP_SELF']);

	$var_86 = func_get_args();
	
	array_shift($var_86);
	array_shift($var_86);
	array_shift($var_86);

	
	if (is_string($var_86[0]) && preg_match('/.php$/',$var_86[0])) {
		$var_16 = preg_replace('/.php$/','',array_shift($var_86));
		$var_62 = array_shift($var_86);
		$var_87 = array_shift($var_86);

	} else {
		$var_16 = 'UNKNOWN';
		$var_62 = 'UNKNOWN';
		$var_87 = 'UNKNOWN';
	}

	
	if (preg_match('/%%/',$var_13) && $var_86[0] != 'NOARGS')
		$var_86 = array_shift($var_86);

	$var_9 = array();
	foreach ($var_86 as $var_12) {
		if (is_array($var_12))
			array_push($var_9,serialize($var_12));
		elseif (is_object($var_12))
			array_push($var_9,sprintf('OBJECT:%s',get_class($var_12)));
		else
			array_push($var_9,$var_12);
	}

	if (preg_match('/%%/',$var_13))
		$var_13 = preg_replace('/%%/',join('|',$var_9),$var_13);
	else
		$var_13 = vsprintf($var_13,array_values($var_9));

	if (function_exists('stopwatch'))
		$var_88 = stopwatch();
	else
		$var_88 = null;

	$var_89 = sprintf('[%2.3f] %15s(%04s-%03s): %s%s: %s',$var_88,basename($var_16),$var_62,$var_81,str_repeat('.',$var_82),$var_87,substr($var_13,0,200));

	if ($var_83 || $_SESSION[var_75]->getValue('debug','file')) {
		if (! $var_83)
			$var_83 = fopen($_SESSION[var_75]->getValue('debug','file'),
				$_SESSION[var_75]->getValue('debug','append') ? 'a' : 'w');

		fwrite($var_83,$var_89."\n");
	}

	if ($_SESSION[var_75]->getValue('debug','syslog') && function_exists('syslog_notice'))
		syslog_notice($var_89);
}


function fn_8($var_13,$var_73='note',$var_90=null,$var_91=false,$var_80=false) {
	global $var_92;
	static $var_93;

	
	if (! isset($var_92['page']) && ! $var_91)
		die("Function error called incorrectly [$var_13]");

	
	if (! isset($var_92['page']))
		$var_92['page'] = new class_1();

	if ($var_91)
		$var_92['page']->setsysmsg(array('title'=>fn_3('Error'),'body'=>$var_13,'type'=>$var_73));
	else
		fn_1(array('title'=>fn_3('Error'),'body'=>$var_13,'type'=>$var_73),$var_90);

	
	if ($var_93++ > 20) {
		fn_10('Spin loop detection.');
		fn_10(array('msg'=>$var_13,'session'=>$_SESSION['sysmsg'],'www'=>$var_92),1);
	}

	
	if ($var_80) {
		$var_95 = new class_2();
		$var_95->SetTitle('PHP Debug Backtrace');

		$var_33 = '<table class="result_table">';
		$var_33 .= "\n";

		foreach (debug_backtrace() as $var_45 => $var_62) {
			$_SESSION['backtrace'][$var_45]['file'] = isset($var_62['file']) ? $var_62['file'] : 'unknown';
			$_SESSION['backtrace'][$var_45]['line'] = isset($var_62['line']) ? $var_62['line'] : 'unknown';
			$var_33 .= sprintf('<tr class="hightlight"><td colspan="2"><b><small>%s</small></b></td><td>%s (%s)</td></tr>',
				fn_3('File'),isset($var_62['file']) ? $var_62['file'] : $last['file'],isset($var_62['line']) ? $var_62['line'] : '');

			$_SESSION['backtrace'][$var_45]['function'] = $var_62['function'];
			$var_33 .= sprintf('<tr><td>&nbsp;</td><td><b><small>%s</small></b></td><td><small>%s',
				fn_3('Function'),$var_62['function']);

			if (isset($var_62['args'])) {
				$var_68 = strlen(serialize($var_62['args'])) < 50 ? htmlspecialchars(serialize($var_62['args'])) : htmlspecialchars(substr(serialize($var_62['args']),0,50)).'...<TRUNCATED>';
				$_SESSION['backtrace'][$var_45]['args'] = $var_62['args'];
				if (file_exists(var_0.'../tools/unserialize.php'))
					$var_33 .= sprintf('&nbsp;(<a href="%s?index=%s" onclick="target=\'backtrace\';">%s</a>)',
						'../tools/unserialize.php',$var_45,$var_68);
				else
					$var_33 .= sprintf('&nbsp;(%s)',$var_68);
			}
			$var_33 .= '</small></td></tr>';
			$var_33 .= "\n";

			if (isset($var_62['file']))
				$last['file'] = $var_62['file'];
		}

		$var_33 .= '</table>';
		$var_33 .= "\n";
		$var_95->SetBody($var_33);

		$var_92['page']->block_add('body',$var_95);
	}

	if ($var_91) {
		$var_92['page']->display(array('tree'=>false));
		die();
	}
}


function fn_14($var_98,$var_73='POST',$var_78=false,$var_99=null,$var_100=true) {
	switch($var_73) {
		case 'GET':
			$var_101 = isset($_GET[$var_98]) ? (is_array($_GET[$var_98]) ? $_GET[$var_98] : (empty($_GET['nodecode'][$var_98]) ? rawurldecode($_GET[$var_98]) : $_GET[$var_98])) : $var_99;
			break;

		case 'REQUEST':
			$var_101 = isset($_REQUEST[$var_98]) ? (is_array($_REQUEST[$var_98]) ? $_REQUEST[$var_98] : (empty($_REQUEST['nodecode'][$var_98]) ? rawurldecode($_REQUEST[$var_98]) : $_REQUEST[$var_98])) : $var_99;
			break;

		case 'SESSION':
			$var_101 = isset($_SESSION[$var_98]) ? (is_array($_SESSION[$var_98]) ? $_SESSION[$var_98] : (empty($_SESSION['nodecode'][$var_98]) ? rawurldecode($_SESSION[$var_98]) : $_SESSION[$var_98])) : $var_99;
			break;

		case 'POST':
		default:
			$var_101 = isset($_POST[$var_98]) ? (is_array($_POST[$var_98]) ? $_POST[$var_98] : (empty($_POST['nodecode'][$var_98]) ? rawurldecode($_POST[$var_98]) : $_POST[$var_98])) : $var_99;
			break;
	}
	
	if ($var_78 && is_null($var_101))
		fn_1(array(
			'title'=>fn_3('Generic Error'),
			'body'=>sprintf('%s: Called "%s" without "%s" using "%s"',
				basename($_SERVER['PHP_SELF']),fn_14('cmd','REQUEST'),fn_15($var_98),fn_15($var_73)),
			'type'=>'error'),
			'index.php');
	if($var_100 && !is_null($var_101))
		$var_101 = fn_15($var_101);
	return $var_101;
}

 function fn_15($var_102){
        if (gettype($var_102) == 'array') {
            foreach ($var_102 as $var_12 => $var_101) {
                if (gettype($var_101) == 'array')
                    $var_102[$var_12] = fn_15($var_101);
                else
                    $var_102[$var_12] = htmlspecialchars($var_101);
            }
            return $var_102;
        }
        return htmlspecialchars($var_102, var_103, 'UTF-8');
}


function fn_1($var_13,$var_90=null) {
	if (! is_array($var_13))
		return null;

	if (! isset($var_13['title']) && ! isset($var_13['body']))
		return null;

	if (! isset($var_13['type']))
		$var_13['type'] = 'info';

	if (! isset($_SESSION['sysmsg']) || ! is_array($_SESSION['sysmsg']))
		$_SESSION['sysmsg'] = array();

	
	if (fn_14('redirect','GET') && $var_13['type'] != 'debug') {
		foreach ($_SESSION['sysmsg'] as $var_104) {
			if ($var_13 == $var_104 && ! isset($var_104['special'])) {
				fn_10(array('Incoming MSG'=>$var_13,'existing'=>$_SESSION['sysmsg']));
				fn_11('Redirect Loop Detected',true);
			}
		}
	}

	array_push($_SESSION['sysmsg'],$var_13);

	if ($var_90) {
		if (preg_match('/\?/',$var_90))
			$var_90 .= '&';
		else
			$var_90 .= '?';
		$var_90 .= 'redirect=true';

		
		if (fn_14('meth','REQUEST') == 'ajax')
			$var_90 .= '&meth=ajax';

		header("Location: $var_90");
		die();
	}
}




function fn_16($var_102,$var_105=null) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	if ($var_105 === null || ! trim($var_105))
		$var_105 = $_SESSION[var_75]->getValue('session','blowfish') ? $_SESSION[var_75]->getValue('session','blowfish') : session_id();

	
	if (! trim($var_105))
		return $var_102;

	if (! empty($var_102) && function_exists('openssl_encrypt') && in_array('bf-ecb', openssl_get_cipher_methods())) {
		$var_106 = openssl_cipher_iv_length('bf-ecb') * 2;
		return openssl_encrypt($var_102, 'bf-ecb', substr($var_105,0,$var_106));
	}

	if (function_exists('mcrypt_module_open') && ! empty($var_102)) {
		$var_107 = mcrypt_module_open(var_108,'',var_109,'');
		$var_110 = mcrypt_create_iv(mcrypt_enc_get_iv_size($var_107),var_111);
		mcrypt_generic_init($var_107,substr($var_105,0,mcrypt_enc_get_key_size($var_107)),$var_110);
		$var_112 = base64_encode(mcrypt_generic($var_107,$var_102));
		mcrypt_generic_deinit($var_107);

		return $var_112;
	}

	if (file_exists(var_0.'blowfish.php'))
	var_4
		return $var_102;

	$var_113 = new class_3;
	$var_114 = '';

	for ($var_47=0; $var_47<strlen($var_102); $var_47+=8) {
		$var_67 = substr($var_102, $var_47, 8);

		if (strlen($var_67) < 8)
			$var_67 = fn_18($var_67,8,"\0", 1);

		$var_114 .= $var_113->encryptBlock($var_67, $var_105);
	}

	return base64_encode($var_114);
}


function fn_17($var_116,$var_105=null) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	static $var_34 = array();

	if (isset($var_34[$var_116]))
		return $var_34[$var_116];

	
	if ($var_105 === null || ! trim($var_105))
		$var_105 = $_SESSION[var_75]->getValue('session','blowfish') ? $_SESSION[var_75]->getValue('session','blowfish') : session_id();

	
	if (! trim($var_105))
		return $var_116;

	if (! empty($var_116) && function_exists('openssl_encrypt') && in_array('bf-ecb', openssl_get_cipher_methods())) {
		$var_106 = openssl_cipher_iv_length('bf-ecb') * 2;
		return trim(openssl_decrypt($var_116, 'bf-ecb', substr($var_105,0,$var_106)));
	}

	if (function_exists('mcrypt_module_open') && ! empty($var_116)) {
		$var_107 = mcrypt_module_open(var_108,'',var_109,'');
		$var_110 = mcrypt_create_iv(mcrypt_enc_get_iv_size($var_107),var_111);
		mcrypt_generic_init($var_107,substr($var_105,0,mcrypt_enc_get_key_size($var_107)),$var_110);
		$var_117 = trim(mdecrypt_generic($var_107,base64_decode($var_116)));
		mcrypt_generic_deinit($var_107);

		return $var_117;
	}

	if (file_exists(var_0.'blowfish.php'))
	var_4
		return $var_116;

	$var_113 = new class_3;
	$var_118 = '';
	$var_102 = base64_decode($var_116);

	for ($var_47=0; $var_47<strlen($var_102); $var_47+=8)
		$var_118 .= $var_113->decryptBlock(substr($var_102, $var_47, 8), $var_105);

	
	$var_120 = preg_replace("/\\0*$/",'',$var_118);
	$var_34[$var_116] = $var_120;
	return $var_120;
}


function fn_18($var_121,$var_122,$var_123='',$var_124=0) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_42 = '';
	$var_125 = $var_122 - strlen($var_121);

	if ($var_125 > 0) { 
		if ($var_124 == var_126) { 
			$var_42 = $var_121.str_repeat($var_123, $var_125);
		} elseif ($var_124 == var_127) { 
			$var_42 = str_repeat($var_123, floor($var_125/2));
			$var_42 .= $var_121;
			$var_42 .= str_repeat($var_123, ceil($var_125/2));
		} else { 
			$var_42 = str_repeat($var_123, $var_125).$var_121;
		}

	} else { 
		$var_42 = $var_121;
	}
	return $var_42;
}


function fn_19($var_128,$var_129,$var_130='null') {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	$var_120 = null;

	
	if ($_SESSION[var_75]->getValue('cache',$var_129) && isset($_SESSION['cache'][$var_128][$var_129][$var_130]))
		$var_120 = $_SESSION['cache'][$var_128][$var_129][$var_130];

	if (var_8)
		fn_13('Returning (%s)',1,0,var_10,var_11,var_6,$var_120);

	return $var_120;
}


function fn_20($var_128,$var_129,$var_130='null',$var_102) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	if ($_SESSION[var_75]->getValue('cache',$var_129)) {
		global $var_34;

		$var_34[$var_128][$var_129][$var_130] = $var_102;
		$_SESSION['cache'][$var_128][$var_129][$var_130] = $var_102;

		return true;

	} else
		return false;
}


function fn_21($var_128,$var_129,$var_130='null') {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	global $var_34;

	
	if (isset($_SESSION['cache'][$var_128][$var_129][$var_130]))
		unset($_SESSION['cache'][$var_128][$var_129][$var_130]);

	if (isset($var_34[$var_128][$var_129][$var_130]))
		unset($var_34[$var_128][$var_129][$var_130]);
}


function fn_22($var_131,$var_132,$var_133=null,$var_134=null) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	$var_120 = false;

	if ($var_133 == null) {
		$var_135 = $_SESSION[var_75]->getValue('session','cookie_time');
		$var_133 = $var_135 == 0 ? null : time() + $var_135;
	}

	if ($var_134 == null)
		$var_134 = dirname($_SERVER['PHP_SELF']);

	if (@setcookie($var_131,$var_132,$var_133,$var_134)) {
		$_COOKIE[$var_131] = $var_132;
		$var_120 = true;
	}

	if (var_8)
		fn_13('Returning (%s)',1,0,var_10,var_11,var_6,$var_120);

	return $var_120;
}


function fn_23($var_128,$var_136,$var_137) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	$var_120 = $var_137.$var_136;
	$var_138 = $_SESSION[var_75]->getServer($var_128);

	$var_140 = $var_138->getValue('custom','pages_prefix');
	if (! is_null($var_140) && is_file(realpath($var_137.$var_140.$var_136)))
		$var_120 = $var_137.$var_140.$var_136;

	if (var_8)
		fn_13('Returning (%s)',1,0,var_10,var_11,var_6,$var_120);

	return $var_120;
}


function fn_24($var_86, $var_141) {
	if (version_compare(phpversion(),'7.0','>=')) {
		
		return eval("return function(".$var_86."){".$var_141."};");

	} else {
		
		return create_function($var_86, $var_141);
	}
}


function fn_25(&$var_102,$var_142,$var_143=0) {
	if (defined('DEBUG_ENABLED') && var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	if (! preg_match('/^[a-zA-Z0-9_]+(\([a-zA-Z0-9_,]*\))?$/',$var_142) || ! $var_102)
		return;

	static $var_34 = array();

	if (empty($var_34[$var_142])) {
		$var_141 = "\$c=0;\n";

		foreach (explode(',',$var_142) as $var_12) {
			$var_141 .= "if (is_object(\$a) || is_object(\$b)) {\n";

			$var_141 .= "	if (is_array(\$a->$var_12)) {\n";
			$var_141 .= "		asort(\$a->$var_12);\n";
			$var_141 .= "		\$aa = array_shift(\$a->$var_12);\n";
			$var_141 .= "	} else\n";
			$var_141 .= "		\$aa = \$a->$var_12;\n";

			$var_141 .= "	if (is_array(\$b->$var_12)) {\n";
			$var_141 .= "		asort(\$b->$var_12);\n";
			$var_141 .= "		\$bb = array_shift(\$b->$var_12);\n";
			$var_141 .= "	} else\n";
			$var_141 .= "		\$bb = \$b->$var_12;\n";

			$var_141 .= "	if (\$aa != \$bb)";
			if ($var_143)
				$var_141 .= "	return (\$aa < \$bb ? 1 : -1);\n";
			else
				$var_141 .= "	return (\$aa > \$bb ? 1 : -1);\n";

			$var_141 .= "} else {\n";

			$var_141 .= "	\$a = array_change_key_case(\$a);\n";
			$var_141 .= "	\$b = array_change_key_case(\$b);\n";

			$var_12 = strtolower($var_12);

			$var_141 .= "	if ((! isset(\$a['$var_12'])) && isset(\$b['$var_12'])) return 1;\n";
			$var_141 .= "	if (isset(\$a['$var_12']) && (! isset(\$b['$var_12']))) return -1;\n";

			$var_141 .= "	if ((isset(\$a['$var_12'])) && (isset(\$b['$var_12']))) {\n";
			$var_141 .= "		if (is_array(\$a['$var_12'])) {\n";
			$var_141 .= "			asort(\$a['$var_12']);\n";
			$var_141 .= "			\$aa = array_shift(\$a['$var_12']);\n";
			$var_141 .= "		} else\n";
			$var_141 .= "			\$aa = \$a['$var_12'];\n";

			$var_141 .= "		if (is_array(\$b['$var_12'])) {\n";
			$var_141 .= "			asort(\$b['$var_12']);\n";
			$var_141 .= "			\$bb = array_shift(\$b['$var_12']);\n";
			$var_141 .= "		} else\n";
			$var_141 .= "			\$bb = \$b['$var_12'];\n";

			$var_141 .= "		if (\$aa != \$bb)\n";
			$var_141 .= "			if (is_numeric(\$aa) && is_numeric(\$bb)) {\n";

			if ($var_143)
				$var_141 .= "				return (\$aa < \$bb ? 1 : -1);\n";
			else
				$var_141 .= "				return (\$aa > \$bb ? 1 : -1);\n";

			$var_141 .= "			} else {\n";

			if ($var_143)
				$var_141 .= "				if ( (\$c = strcasecmp(\$bb,\$aa)) != 0 ) return \$c;\n";
			else
				$var_141 .= "				if ( (\$c = strcasecmp(\$aa,\$bb)) != 0 ) return \$c;\n";

			$var_141 .= "		}\n";
			$var_141 .= "	}\n";
			$var_141 .= "}\n";
		}

		$var_141 .= 'return $c;';

		$var_34[$var_142] = fn_24('$a, $b',$var_141);
	}

	uasort($var_102,$var_34[$var_142]);
}


function fn_26() {
	return (isset($_SESSION[var_75]) && $_SESSION[var_75]->getValue('appearance','compress')
		&& ! ini_get('zlib.output_compression')
		&& preg_match('/gzip/',$_SERVER['HTTP_ACCEPT_ENCODING']));
}




function fn_27($var_144=null) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if ($_SESSION[var_75]->getValue('appearance','obfuscate_password_display'))
		$var_120 = true;

	elseif (! $_SESSION[var_75]->getValue('appearance','show_clear_password') && (is_null($var_144) || $var_144 == 'clear'))
		$var_120 = true;

	else
		$var_120 = false;

	if (var_8)
		fn_13('Returning (%s)',1,0,var_10,var_11,var_6,$var_120);

	return $var_120;
}


function fn_28($var_145) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_146 = $var_145;
	$var_145 = fn_48($var_145);

	if (! $var_145)
		return $var_146;

	foreach ($var_145 as $var_47 => $var_147) {
		$var_147 = htmlspecialchars($var_147);
		$var_147 = explode('=',$var_147,2);
		$var_147 = implode('<span style="color: blue; font-family: courier; font-weight: bold">=</span>',$var_147);
		$var_145[$var_47] = $var_147;
	}

	$var_145 = implode('<span style="color:red; font-family:courier; font-weight: bold;">,</span>',$var_145);

	return $var_145;
}


function fn_29($var_42) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	$var_148 = fn_48($var_42);
	if (! is_array($var_148) || ! count($var_148))
		return false;

	
	foreach ($var_148 as $var_149) {
		if (! strpos($var_149,"="))
			return false;

		$var_150 = explode('=',$var_149,2);
		$var_151 = $var_150[0];
		$var_152 = $var_150[1];

		if ( ! strlen(trim($var_151)) || ! strlen(trim($var_152)))
			return false;

		if (strpos($var_151,'
			return false;
	}

	
	return true;
}


function is_mail_string($str) {
	if (DEBUG_ENABLED && (($fargs=func_get_args())||$fargs='var_153'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_154 = "/^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9-]+)*$/";

	if (preg_match($var_154,$var_42))
		return true;
	else
		return false;
}


function fn_30($var_42) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_155 = '/^(ftp|https?):\/\/+[\w\.\-\/\?\=\&]*\w+/';

	if (preg_match($var_155,$var_42))
		return true;
	else
		return false;
}


function fn_31($var_156,$var_157) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	if (is_array($var_156))
		if (isset($var_156['dn']))
			$var_156 = $var_156['dn'];
		else
			$var_156 = implode('+',$var_156);
	if (is_array($var_157))
		if (isset($var_157['dn']))
			$var_157 = $var_157['dn'];
		else
			$var_157 = implode('+',$var_157);

	
	if (! strcasecmp($var_156,$var_157))
		return 0;

	$var_158 = fn_48(fn_54($var_156));
	$var_159 = fn_48(fn_54($var_157));
	assert(is_array($var_158));
	assert(is_array($var_159));

	
	for ($var_47=0; $var_47 < count($var_158) && $var_47 < count($var_159); $var_47++) {
		
		$var_160 = $var_158[$var_47];
		$var_161 = $var_159[$var_47];

		
		$var_162 = explode('=',$var_160,2);
		$var_163 = explode('=',$var_161,2);

		$var_164 = trim($var_162[0]);
		$var_165 = trim($var_163[0]);

		if (0 != ($var_166 = strcasecmp($var_164,$var_165)))
			return $var_166;

		$var_167 = trim($var_162[1]);
		$var_168 = trim($var_163[1]);
		if (0 != ($var_166 = strcasecmp($var_167,$var_168)))
			return $var_166;
	}

	
	if (count($var_158) > count($var_159)) {
		return 1;

	} elseif (count($var_159) > count($var_158)) {
		return -1;

	} else {
		return 0;
	}
}


function fn_32($var_169,$var_98,$var_170=false,$var_171=false,$var_172=null) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_138 = $_SESSION[var_75]->getServer(fn_14('server_id','REQUEST'));
	$var_98 = strtolower($var_98);
	$var_173 = array();

	if (! $var_138->getValue('auto_number','enable')) {
		fn_1(array(
			'title'=>fn_3('AUTO_NUMBER is disabled for this server'),
			'body'=>sprintf('%s (<b>%s</b>)',fn_3('A call was made to get_next_number(), however, it is disabled for this server'),$var_98),
			'type'=>'warn'));

		return false;
	}

	
	if (! $var_138->login($var_138->getValue('auto_number','dn'),$var_138->getValue('auto_number','pass'),'auto_number')) {
		fn_1(array(
			'title'=>fn_3('AUTO_NUMBER invalid login/password'),
			'body'=>sprintf('%s (<b>%s</b>)',fn_3('Unable to connect to LDAP server with the auto_number login/password, please check your configuration.'),
				$var_138->getName()),
			'type'=>'warn'));

		return false;
	}

	
	if (! $var_169) {
		$var_173['base'] = $var_138->getValue('auto_number','search_base');

		if (! trim($var_173['base'])) {
			fn_1(array(
				'title'=>fn_3('No AUTO_NUMBER search_base configured for this server'),
				'body'=>fn_3('A call was made to get_next_number(), however, the base to search is empty.'),
				'type'=>'warn'));

			return false;
		}

	} else
		$var_173['base'] = $var_169;

	if (! $var_138->dnExists($var_173['base'])) {
		fn_1(array(
			'title'=>fn_3('No AUTO_NUMBER search_base exists for this server'),
			'body'=>sprintf('%s (<b>%s</b>)',fn_3('A call was made to get_next_number(), however, the base to search does not exist for this server.'),$var_173['base']),
			'type'=>'warn'));

		return false;
	}

	if (! is_string($var_98) || ! $var_138->getSchemaAttribute($var_98)) {
		fn_1(array(
			'title'=>fn_3('AUTO_NUMBER search attribute invalid'),
			'body'=>sprintf('%s (<b>%s</b>)',fn_3('The search attribute for AUTO_NUMBER is invalid, expecting a single valid attribute.'),$var_98),
			'type'=>'warn'));

		return false;
	}

	$var_173['attrs'] = array($var_98);

	
	switch ($var_138->getValue('auto_number','mechanism')) {
		case 'search':
			$var_173['filter'] = sprintf('(%s=*)',$var_98);
			$var_178 = $var_138->query($var_173,'auto_number');

			
			$var_179 = array(0);

			foreach ($var_178 as $var_145 => $var_180) {
				$var_180 = array_change_key_case($var_180);
				foreach ($var_180[$var_98] as $var_101)
					array_push($var_179,$var_101);
			}

			$var_179 = array_unique($var_179);
			sort($var_179);

			
			$var_181 = is_null($var_172) ? intval($var_179[0])+1 : $var_172;

			
			if (count($var_138->getValue('auto_number','min'))) {
				$var_182 = array_change_key_case($var_138->getValue('auto_number','min'));

				if (isset($var_182[$var_98]))
					$var_181 = $var_182[$var_98] > $var_181 ? $var_182[$var_98] : $var_181;
			}

			for ($var_47=0;$var_47<count($var_179);$var_47++) {
				$var_183 = $var_179[$var_47] < $var_181 ? $var_181 : $var_179[$var_47];

				
				if ($var_47+1 == count($var_179) || $var_179[$var_47+1] > $var_183+1)
					return $var_179[$var_47] >= $var_183 ? $var_183+1 : $var_183;
			}

			
			return $var_181;

			break;

		case 'pool':
			switch ($var_98) {
				case 'gidnumber':
					$var_173['filter'] = '(objectClass=gidPool)';

					break;

				case 'uidnumber':
					$var_173['filter'] = '(objectClass=uidPool)';

					break;
			}

			
			if (! empty($var_171))
				$var_173['filter'] = $var_171;

			$var_178 = $var_138->query($var_173,'auto_number');

			switch (count($var_178)) {
				case '1':
					break;

				case '0':
					fn_1(array(
						'title'=>fn_3('AUTO_NUMBER pool filter didnt return any DNs'),
						'body'=>sprintf('%s (<b>%s</b>)',fn_3('Please change your filter parameter, or check your auto_number,search_base configuration'),$var_173['filter']),
						'type'=>'warn'));

					return false;

				default:
					fn_1(array(
					'title'=>fn_3('AUTO_NUMBER pool filter returned too many DNs'),
						'body'=>sprintf('%s (<b>%s</b>)',fn_3('Please change your filter parameter, or check your auto_number,search_base configuration'),$var_173['filter']),
						'type'=>'warn'));

					return false;
			}

			
			foreach ($var_178 as $var_145 => $var_180) {
				$var_180 = array_change_key_case($var_180);

				$var_179 = $var_180[$var_98][0];
				$var_184 = $var_180['dn'];
			}

			if ($var_170) {
				$var_185 = array($var_98=>$var_179+1);
				$var_138->modify($var_184,$var_185);
			}

			return $var_179;

		
		default:
			fn_1(array(
				'title'=>fn_3('Invalid AUTO_NUMBER mechanism'),
				'body'=>sprintf('%s (<b>%s</b>)',fn_3('Your config file specifies an unknown AUTO_NUMBER search mechanism.'),$var_138->getValue('auto_number','mechanism')),
				'type'=>'warn'));

			return false;
	}
}


function fn_33($var_187,$var_145,$var_188=array()) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_138 = $_SESSION[var_75]->getServer($var_187);

	
	if (! count($var_188))
		$var_188 = $var_138->getDNAttrValue($var_145,'objectClass');

	foreach ($var_188 as $var_128 => $var_101)
		$var_188[$var_128] = strtolower($var_101);

	$var_190 = fn_36($var_145);
	$var_191 = explode('=',$var_190,2);
	$var_192 = isset($var_191[0]) ? $var_191[0] : null;
	$var_193 = isset($var_191[1]) ? $var_191[1] : null;
	unset($var_191);

	
	if (in_array('sambaaccount',$var_188) &&
		'$' == $var_190{ strlen($var_190) - 1 })
		return 'nt_machine.png';

	if (in_array('sambaaccount',$var_188))
		return 'nt_user.png';

	elseif (in_array('person',$var_188) ||
		in_array('organizationalperson',$var_188) ||
		in_array('inetorgperson',$var_188) ||
		in_array('account',$var_188) ||
		in_array('posixaccount',$var_188))

		return 'ldap-user.png';

	elseif (in_array('organization',$var_188))
		return 'ldap-o.png';

	elseif (in_array('organizationalunit',$var_188))
		return 'ldap-ou.png';

	elseif (in_array('organizationalrole',$var_188))
		return 'ldap-uid.png';

	elseif (in_array('dcobject',$var_188) ||
		in_array('domainrelatedobject',$var_188) ||
		in_array('domain',$var_188) ||
		in_array('builtindomain',$var_188))

		return 'ldap-dc.png';

	elseif (in_array('alias',$var_188))
		return 'ldap-alias.png';

	elseif (in_array('room',$var_188))
		return 'door.png';

	elseif (in_array('iphost',$var_188))
		return 'host.png';

	elseif (in_array('device',$var_188))
		return 'device.png';

	elseif (in_array('document',$var_188))
		return 'document.png';

	elseif (in_array('country',$var_188)) {
		$var_194 = fn_48($var_145);
		$var_195 = explode('=',$var_194[0],2);
		$var_195 = isset($var_195[1]) ? $var_195[1] : false;
		if ($var_195 && false === strpos($var_195,'..') &&
			file_exists(realpath(sprintf('%s/../countries/%s.png',var_74,strtolower($var_195)))))

			return sprintf('../countries/%s.png',strtolower($var_195));

		else
			return 'country.png';
	}

	elseif (in_array('jammvirtualdomain',$var_188))
		return 'mail.png';

	elseif (in_array('locality',$var_188))
		return 'locality.png';

	elseif (in_array('posixgroup',$var_188) ||
		in_array('groupofnames',$var_188) ||
		in_array('group',$var_188))

		return 'ldap-ou.png';

	elseif (in_array('applicationprocess',$var_188))
		return 'process.png';

	elseif (in_array('groupofuniquenames',$var_188))
		return 'ldap-uniquegroup.png';

	elseif (in_array('nlsproductcontainer',$var_188))
		return 'n.png';

	elseif (in_array('ndspkikeymaterial',$var_188))
		return 'lock.png';

	elseif (in_array('server',$var_188))
		return 'server-small.png';

	elseif (in_array('volume',$var_188))
		return 'hard-drive.png';

	elseif (in_array('ndscatcatalog',$var_188))
		return 'catalog.png';

	elseif (in_array('resource',$var_188))
		return 'n.png';

	elseif (in_array('ldapgroup',$var_188))
		return 'ldap-server.png';

	elseif (in_array('ldapserver',$var_188))
		return 'ldap-server.png';

	elseif (in_array('nisserver',$var_188))
		return 'ldap-server.png';

	elseif (in_array('rbscollection',$var_188))
		return 'ldap-ou.png';

	elseif (in_array('dfsconfiguration',$var_188))
		return 'nt_machine.png';

	elseif (in_array('applicationsettings',$var_188))
		return 'server-settings.png';

	elseif (in_array('aspenalias',$var_188))
		return 'mail.png';

	elseif (in_array('container',$var_188))
		return 'folder.png';

	elseif (in_array('ipnetwork',$var_188))
		return 'network.png';

	elseif (in_array('samserver',$var_188))
		return 'server-small.png';

	elseif (in_array('lostandfound',$var_188))
		return 'find.png';

	elseif (in_array('infrastructureupdate',$var_188))
		return 'server-small.png';

	elseif (in_array('filelinktracking',$var_188))
		return 'files.png';

	elseif (in_array('automountmap',$var_188) ||
		in_array('automount',$var_188))

		return 'hard-drive.png';

	elseif (strpos($var_192,'ipsec') === 0 ||
		strcasecmp($var_192,'IP Security') == 0||
		strcasecmp($var_192,'MSRADIUSPRIVKEY Secret') == 0 ||
		strpos($var_192,'BCKUPKEY_') === 0)

		return 'lock.png';

	elseif (strcasecmp($var_192,'MicrosoftDNS') == 0)
		return 'ldap-dc.png';

	
	else
		return 'ldap-default.png';
}


function fn_34($var_169,$var_196) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_197 = (is_null($var_196) || (($var_198=strlen(trim($var_196))) == 0));

	if ($var_197)
		return $var_169;

	
	elseif ($var_196[$var_198-1] != ',')
		return $var_196;

	else
		return sprintf('%s%s',$var_196,$var_169);
}


function fn_35($var_125) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_199 = '0123456789'.
		'abcdefghijklmnopqrstuvwxyz'.
		'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
		'./';
	$var_42 = '';
	mt_srand((double)microtime() * 1000000);

	while (strlen($var_42) < $var_125)
		$var_42 .= substr($var_199,(rand()%strlen($var_199)),1);

	return $var_42;
}


function fn_36($var_145,$var_200=0,$var_201=false) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (is_null($var_145))
		return null;

	$var_190 = fn_48($var_145,$var_200);
	if (! count($var_190) || ! isset($var_190[0]))
		return $var_145;

	if ($var_201)
		$var_190 = fn_50($var_190[0]);
	else
		$var_190 = $var_190[0];

	return $var_190;
}


function fn_37($var_190) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	$var_202 = explode('\+',$var_190);

	
	foreach ($var_202 as $var_128 => $var_132) {
		if (preg_match('/=/',$var_132))
			$var_203 = $var_128;

		if (! preg_match('/=/',$var_132)) {
			$var_202[$var_203] .= '+'.$var_132;
			unset($var_202[$var_128]);
		}
	}

	return $var_202;
}


function fn_38($var_12) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	static $var_34 = array();

	if (! count($var_34)) {
		$var_204 = var_0.'ldap_error_codes.txt';

		if (! file_exists($var_204) || ! is_readable($var_204) || ! ($var_205 = fopen($var_204,'r')))
			return false;

		$var_206 = fread($var_205,filesize($var_204));
		fclose($var_205);
		$var_207 = array();
		preg_match_all("/0x[A-Fa-f0-9][A-Za-z0-9]\s+[0-9A-Za-z_]+\s+\"[^\"]*\"\n/",
				$var_206,$var_207);

		foreach ($var_207[0] as $var_180) {
			$var_208 = array();
			preg_match("/(0x[A-Za-z0-9][A-Za-z0-9])\s+([0-9A-Za-z_]+)\s+\"([^\"]*)\"/",$var_180,$var_208);

			$var_209 = isset($var_208[1]) ? $var_208[1] : null;
			$var_210 = isset($var_208[2]) ? $var_208[2] : null;
			$var_211 = isset($var_208[3]) ? $var_208[3] : null;
			$var_211 = preg_replace('/\s+/',' ',$var_211);
			$var_34[$var_209] = array('title'=>$var_210,'desc'=>$var_211);
		}
	}

	if (isset($var_34[$var_12]))
		return $var_34[$var_12];
	else
		return array('title' => null,'desc' => null);
}


function fn_39($var_12) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	static $var_34 = array();

	$var_212 = array();
	$var_212['desc'] = 'We have no description for this OID, if you know what this OID provides, please let us know. Please also include an RFC reference if it is available.';
	$var_212['title'] = 'Can you help with this OID info?';

	if (! count($var_34)) {
		$var_204 = var_0.'ldap_supported_oids.txt';

		if (! file_exists($var_204) || ! is_readable($var_204) || ! ($var_205 = fopen($var_204,'r')))
			return false;

		$var_206 = fread($var_205,filesize($var_204));
		fclose($var_205);
		$var_207 = array();
		preg_match_all("/[0-9]\..+\s+\"[^\"]*\"\n/",$var_206,$var_207);

		foreach ($var_207[0] as $var_180) {
			$var_208 = array();
			preg_match("/([0-9]\.([0-9]+\.)*[0-9]+)(\s+\"([^\"]*)\")?(\s+\"([^\"]*)\")?(\s+\"([^\"]*)\")?/",$var_180,$var_208);
			$var_213 = isset($var_208[1]) ? $var_208[1] : null;

			if ($var_213) {
				$var_34[$var_213]['title'] = isset($var_208[4]) ? $var_208[4] : null;
				$var_34[$var_213]['ref'] = isset($var_208[6]) ? $var_208[6] : null;
				$var_211 = isset($var_208[8]) ? $var_208[8] : sprintf('<acronym title="%s">%s</acronym>',$var_212['desc'],$var_212['title']);
				$var_34[$var_213]['desc'] = preg_replace('/\s+/',' ',$var_211);
			}
		}
	}

	if (isset($var_34[$var_12]))
		return $var_34[$var_12];
	else
		return array(
			'title'=>$var_12,
			'ref'=>null,
			'desc'=>sprintf('<acronym title="%s">%s</acronym>',$var_212['desc'],$var_212['title']));
}


function fn_40($var_13,$var_214) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_33 = '<table border="0">';

	$var_214 = ('0x'.str_pad(dechex($var_214),2,0,var_215));
	$var_216 = fn_38($var_214);

	$var_33 .= sprintf('<tr><td><b>%s</b>:</td><td>%s</td></tr>',fn_3('LDAP said'),$var_13);

	if ($var_216) {
		$var_33 .= sprintf('<tr><td><b>%s</b>:</td><td>%s (%s)</td></tr>',fn_3('Error number'),$var_214,$var_216['title']);
		$var_33 .= sprintf('<tr><td><b>%s</b>:</td><td>%s</td></tr>',fn_3('Description'),$var_216['desc']);

	} else {
		$var_33 .= sprintf('<tr><td><b>%s</b>:</td><td>%s</td></tr>',fn_3('Error number'),$var_214);
		$var_33 .= sprintf('<tr><td><b>%s</b>:</td><td>(%s)</td></tr>',fn_3('Description'),fn_3('no description available'));
	}

	$var_33 .= '</table>';

	return $var_33;
}


function fn_41($var_138,$var_145,$var_217='jpegphoto',$var_128,$var_218=false,$var_219=array()) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_220 = array();
	$var_220['width'] = isset($var_219['fixed_width']) ? $var_219['fixed_width'] : false;
	$var_220['height'] = isset($var_219['fixed_height']) ? $var_219['fixed_height'] : false;

	if (is_null($var_138))
		$var_221 = $_SESSION['tmp'];
	else
		$var_221 = $var_138->getDNAttrValues($var_145,null,var_223,array($var_217));

	if (! isset($var_221[$var_217][$var_128]) || ! $var_221[$var_217][$var_128]) {
		fn_1(array(
			'title'=>fn_3('Unable to retrieve image'),
			'body'=>sprintf('%s %s',
				fn_3('Could not fetch jpeg data for attribute'),$var_217),
			'type'=>'warn'));

		
		printf('<img src="view_jpeg_photo.php?location=session&attr=%s" alt="Photo" />',$var_217);

		return;
	}

	$var_224 = 0;
	$var_225 = 0;

	if (function_exists('getimagesize')) {
		$var_226 = realpath($_SESSION[var_75]->getValue('jpeg','tmpdir').'/');
		if (! is_writable($var_226))
			fn_1(array(
				'title'=>fn_3('Unable to write to jpeg tmp directory'),
				'body'=>fn_3('Please set jpeg,tmpdir to a writable directory in the phpLDAPadmin config.php'),
				'type'=>'warn'));

		else {
			
			$var_227 = tempnam($var_226.'/','pla');
			$var_228 = @file_put_contents($var_227,$var_221[$var_217][$var_128]);

			if (! $var_228) {
				fn_1(array(
					'title'=>fn_3('Error writing to jpeg tmp directory'),
					'body'=>sprintf(fn_3('Please check jpeg,tmpdir is a writable directory in the phpLDAPadmin config.php'),$var_226),
					'type'=>'warn'));

			} elseif ($var_228 < 6) {
				fn_1(array(
					'title'=>sprintf('%s %s',$var_217,fn_3('contains errors')),
					'body'=>fn_3('It appears that the jpeg image may not be a jpeg image'),
					'type'=>'warn'));

			} else {
				$var_229 = getimagesize($var_227);
				$var_224 = $var_229[0];
				$var_225 = $var_229[1];
			}

			unlink($var_227);
		}
	}

	if ($var_224 > 300) {
		$var_230 = 300 / $var_224;
		$var_231 = 300;
		$var_232 = intval($var_225 * $var_230);

	} else {
		$var_231 = $var_224;
		$var_232 = $var_225;
	}

	$var_233 = sprintf('view_jpeg_photo.php?dn=%s&index=%s&attr=%s',rawurlencode($var_145),$var_128,$var_217);

	printf('<acronym title="%s %s. %s x %s %s.">',number_format($var_228),fn_3('bytes'),$var_224,$var_225,fn_3('pixels'));

	printf('<img src="%s&amp;%s" alt="Photo" %s%s%s />',
		htmlspecialchars($var_233),
		is_null($var_138) ? 'location=session' : sprintf('server_id=%s',$var_138->getIndex()),
		(! $var_231 || $var_220['width'] ? '' : sprintf('width="%s"',$var_231)),
		(! $var_232 || $var_220['height'] ? '' : sprintf('height="%s"',$var_232)),
		(isset($var_219['img_opts']) ? $var_219['img_opts'] : ''));

	

	if ($var_218)
		
		printf('<br/><a href="javascript:deleteAttribute(\'%s\');" style="color:red; font-size: 75%%">%s</a>',
			$var_217,fn_3('Delete photo'));
}


function fn_42() {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	return array(
		''=>'clear',
		'blowfish'=>'blowfish',
		'crypt'=>'crypt',
		'ext_des'=>'ext_des',
		'md5'=>'md5',
		'k5key'=>'k5key',
		'md5crypt'=>'md5crypt',
		'sha'=>'sha',
		'smd5'=>'smd5',
		'ssha'=>'ssha',
		'sha512'=>'sha512',
		'sha256crypt'=>'sha256crypt',
		'sha512crypt'=>'sha512crypt',
	);
}


function fn_43($var_235,$var_236) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_236 = strtolower($var_236);

	switch($var_236) {
		case 'blowfish':
			if (! defined('CRYPT_BLOWFISH') || var_237 == 0)
				fn_8(fn_3('Your system crypt library does not support blowfish encryption.'),'error','index.php');

			
			$var_238 = sprintf('{CRYPT}%s',crypt($var_235,'$2a$12$'.fn_35(13)));

			break;

		case 'crypt':
			if ($_SESSION[var_75]->getValue('password', 'no_random_crypt_salt'))
				$var_238 = sprintf('{CRYPT}%s',crypt($var_235,substr($var_235,0,2)));
			else
				$var_238 = sprintf('{CRYPT}%s',crypt($var_235,fn_35(2)));

			break;

		case 'ext_des':
			
			if (! defined('CRYPT_EXT_DES') || var_239 == 0)
				fn_8(fn_3('Your system crypt library does not support extended DES encryption.'),'error','index.php');

			$var_238 = sprintf('{CRYPT}%s',crypt($var_235,'_'.fn_35(8)));

			break;

		case 'k5key':
			$var_238 = sprintf('{K5KEY}%s',$var_235);

			fn_1(array(
				'title'=>fn_3('Unable to Encrypt Password'),
				'body'=>'phpLDAPadmin cannot encrypt K5KEY passwords',
				'type'=>'warn'));

			break;

		case 'md5':
			$var_238 = sprintf('{MD5}%s',base64_encode(pack('H*',md5($var_235))));
			break;

		case 'md5crypt':
			if (! defined('CRYPT_MD5') || var_240 == 0)
				fn_8(fn_3('Your system crypt library does not support md5crypt encryption.'),'error','index.php');

			$var_238 = sprintf('{CRYPT}%s',crypt($var_235,'$1$'.fn_35(9)));

			break;

		case 'sha':
			
			if (function_exists('sha1'))
				$var_238 = sprintf('{SHA}%s',base64_encode(pack('H*',sha1($var_235))));
			elseif (function_exists('mhash'))
				$var_238 = sprintf('{SHA}%s',base64_encode(mhash(var_241,$var_235)));
			else
				fn_8(fn_3('Your PHP install does not have the mhash() function. Cannot do SHA hashes.'),'error','index.php');

			break;

		case 'ssha':
			if (function_exists('mhash') && function_exists('mhash_keygen_s2k')) {
				mt_srand((double)microtime()*1000000);
				$var_242 = mhash_keygen_s2k(var_241,$var_235,substr(pack('h*',md5(mt_rand())),0,8),4);
				$var_238 = sprintf('{SSHA}%s',base64_encode(mhash(var_241,$var_235.$var_242).$var_242));

			} else {
				fn_8(fn_3('Your PHP install does not have the mhash() or mhash_keygen_s2k() function. Cannot do S2K hashes.'),'error','index.php');
			}

			break;

		case 'smd5':
			if (function_exists('mhash') && function_exists('mhash_keygen_s2k')) {
				mt_srand((double)microtime()*1000000);
				$var_242 = mhash_keygen_s2k(var_243,$var_235,substr(pack('h*',md5(mt_rand())),0,8),4);
				$var_238 = sprintf('{SMD5}%s',base64_encode(mhash(var_243,$var_235.$var_242).$var_242));

			} else {
				fn_8(fn_3('Your PHP install does not have the mhash() or mhash_keygen_s2k() function. Cannot do S2K hashes.'),'error','index.php');
			}

			break;

		case 'sha512':
			if (function_exists('openssl_digest') && function_exists('base64_encode')) {
				$var_238 = sprintf('{SHA512}%s', base64_encode(openssl_digest($var_235, 'sha512', true)));

			} else {
				fn_8(fn_3('Your PHP install doest not have the openssl_digest() or base64_encode() function. Cannot do SHA512 hashes. '),'error','index.php');
			}

			break;

		case 'sha256crypt':
			if (! defined('CRYPT_SHA256') || var_244 == 0)
				fn_8(fn_3('Your system crypt library does not support sha256crypt encryption.'),'error','index.php');
			$var_238 = sprintf('{CRYPT}%s',crypt($var_235,'$5$'.fn_35(8)));

			break;

		case 'sha512crypt':
			if (! defined('CRYPT_SHA512') || var_245 == 0)
				fn_8(fn_3('Your system crypt library does not support sha512crypt encryption.'),'error','index.php');
			$var_238 = sprintf('{CRYPT}%s',crypt($var_235,'$6$'.fn_35(8)));

			break;

		case 'clear':
		default:
			$var_238 = $var_235;
	}

	return $var_238;
}


function fn_44($var_246,$var_247,$var_248='userpassword') {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (in_array($var_248,array('sambalmpassword','sambantpassword'))) {
		$var_249 = new class_4;

		switch($var_248) {
			case 'sambalmpassword':
				if (strcmp($var_249->lmhash($var_247),strtoupper($var_246)) == 0)
					return true;
				else
					return false;

			case 'sambantpassword':
				if (strcmp($var_249->nthash($var_247),strtoupper($var_246)) == 0)
					return true;
				else
					return false;
		}

		return false;
	}

	if (preg_match('/{([^}]+)}(.*)/',$var_246,$var_43)) {
		$var_246 = $var_43[2];
		$var_252 = strtolower($var_43[1]);

	} else {
		$var_252 = null;
	}

	switch($var_252) {
		
		case 'ssha':
			
			if (function_exists('mhash')) {
				$var_253 = base64_decode($var_246);

				
				$var_242 = substr($var_253,20);
				$var_254 = base64_encode(mhash(var_241,$var_247.$var_242).$var_242);

				if (strcmp($var_246,$var_254) == 0)
					return true;
				else
					return false;

			} else {
				fn_8(fn_3('Your PHP install does not have the mhash() function. Cannot do SHA hashes.'),'error','index.php');
			}

			break;

		
		case 'smd5':
			
			if (function_exists('mhash')) {
				$var_253 = base64_decode($var_246);
				$var_242 = substr($var_253,16);
				$var_254 = base64_encode(mhash(var_243,$var_247.$var_242).$var_242);

				if (strcmp($var_246,$var_254) == 0)
					return true;
				else
					return false;

			} else {
				fn_8(fn_3('Your PHP install does not have the mhash() function. Cannot do SHA hashes.'),'error','index.php');
			}

			break;

		
		case 'sha':
			if (strcasecmp(fn_43($var_247,'sha'),'{SHA}'.$var_246) == 0)
				return true;
			else
				return false;

			break;

		
		case 'md5':
			if( strcasecmp(fn_43($var_247,'md5'),'{MD5}'.$var_246) == 0)
				return true;
			else
				return false;

			break;

		
		case 'crypt':
			
			if (preg_match('/^\\$2+/',$var_246)) {

				
				if (! defined('CRYPT_BLOWFISH') || var_237 == 0)
					fn_8(fn_3('Your system crypt library does not support blowfish encryption.'),'error','index.php');

				list($var_36,$var_255,$var_256) = explode('$',$var_246);

				if (crypt($var_247,'$'.$var_36.'$'.$var_255.'$'.$var_256) == $var_246)
					return true;
				else
					return false;
			}

			
			elseif (strstr($var_246,'$1$')) {

				
				if (! defined('CRYPT_MD5') || var_240 == 0)
					fn_8(fn_3('Your system crypt library does not support md5crypt encryption.'),'error','index.php');

				list($var_257,$var_73,$var_242,$var_253) = explode('$',$var_246);

				if (crypt($var_247,'$1$'.$var_242) == $var_246)
					return true;
				else
					return false;
			}

			
			elseif (strstr($var_246,'_')) {

				
				if (! defined('CRYPT_EXT_DES') || var_239 == 0)
					fn_8(fn_3('Your system crypt library does not support extended DES encryption.'),'error','index.php');

				if (crypt($var_247,$var_246) == $var_246)
					return true;
				else
					return false;
			}

			
			else {

				if (crypt($var_247,$var_246) == $var_246)
					return true;
				else
					return false;
			}

			break;

		
		case 'sha512':
			if (strcasecmp(fn_43($var_247,'sha512'),'{SHA512}'.$var_246) == 0)
				return true;
			else
				return false;

			break;

		
		default:
			if ($var_247 == $var_246)
				return true;
			else
				return false;
	}
}


function fn_45($var_258) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	
	$var_236 = null;

	if (preg_match('/{([^}]+)}/',$var_258,$var_236))
		$var_236 = strtolower($var_236[1]);
	else
		return null;

	
	if (strcasecmp($var_236,'crypt') == 0) {

		
		if (preg_match('/{[^}]+}\\$1\\$+/',$var_258))
			$var_236 = 'md5crypt';

		elseif (preg_match('/{[^}]+}\\$2+/',$var_258))
			$var_236 = 'blowfish';

		elseif (preg_match('/{[^}]+}_+/',$var_258))
			$var_236 = 'ext_des';
	}

	return $var_236;
}


function fn_46($var_259,$var_147,$var_260=true,$var_190='none') {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_233 = sprintf("javascript:dnChooserPopup('%s','%s','%s');",$var_259,$var_147,$var_190 == 'none' ? '' : rawurlencode($var_190));
	$var_210 = fn_3('Click to popup a dialog to select an entry (DN) graphically');

	printf('<a href="%s" title="%s"><img class="chooser" src="%s/find.png" alt="Find" /></a>',$var_233,$var_210,var_74);

	if ($var_260)
		printf('<span class="x-small"><a href="%s" title="%s">%s</a></span>',$var_233,$var_210,fn_3('browse'));
}


function fn_47($var_145,$var_261) {
	$var_262 = ldap_explode_dn($var_145,$var_261);
	if (! $var_262)
		return null;

	
	foreach ($var_262 as $var_12 => $var_101) {
		$var_262[$var_12] = preg_replace_callback(
			"/\\\([0-9A-Fa-f]{2})/",
			function ($var_43) {
				return chr(hexdec($var_43[1]));
			},
			$var_101
		);
	}

	return $var_262;
}


function fn_48($var_145,$var_263=0) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	global $var_34;

	if (isset($var_34['explode'][$var_145][$var_263])) {
		if (var_8)
			fn_13('Return CACHED result (%s) for (%s)',1,0,var_10,var_11,var_6,
				$var_34['explode'][$var_145][$var_263],$var_145);

		return $var_34['explode'][$var_145][$var_263];
	}

	$var_145 = addcslashes($var_145,'<>+";');

	
	$var_262[0] = fn_47(fn_49($var_145),0);
	$var_262[1] = fn_47(fn_49($var_145),1);
	if (! $var_262[$var_263]) {
		if (var_8)
			fn_13('Returning NULL - NO result.',1,0,var_10,var_11,var_6);

		return array();
	}

	
	unset($var_262[0]['count']);
	unset($var_262[1]['count']);

	
	foreach ($var_262 as $var_12 => $var_101) {
		
		$var_262[$var_12] = fn_50($var_101);

		$var_34['explode'][implode(',',$var_262[0])][$var_12] = $var_262[$var_12];
		$var_34['explode'][implode(',',array_reverse($var_262[0]))][$var_12] = array_reverse($var_262[$var_12]);
	}

	if (var_8)
		fn_13('Returning (%s)',1,0,var_10,var_11,var_6,$var_262[$var_263]);

	return $var_262[$var_263];
}


function fn_49($var_145) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_264 = $var_145;

	
	while (preg_match('/([^\\\\]),(\s*[^=]*\s*),/',$var_145))
		$var_145 = preg_replace('/([^\\\\]),(\s*[^=]*\s*),/','$1\\\\2C$2,',$var_145);

	$var_145 = preg_replace('/([^\\\\]),(\s*[^=]*\s*)([^,])$/','$1\\\\2C$2$3',$var_145);

	if (var_8)
		fn_13('Returning (%s)',1,0,var_10,var_11,var_6,$var_145);

	return $var_145;
}


function fn_50($var_145) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (is_array($var_145)) {
		$var_265 = array();

		foreach ($var_145 as $var_12 => $var_190)
			$var_265[$var_12] = preg_replace_callback('/\\\([0-9A-Fa-f]{2})/',
				function ($var_266) {
					return chr(hexdec($var_266[1]));
				},
				$var_190
			);

		return $var_265;

	} else {
		return preg_replace_callback('/\\\([0-9A-Fa-f]{2})/',
			function ($var_266) {
				return chr(hexdec($var_266[1]));
			},
			$var_145
		);
	}
}


function fn_51($var_73,$var_267='') {
	$var_268 = 'http:

	switch($type) {
		case 'var_269':
			return 'https:
		case 'var_270':
			return 'https:
		case 'var_271':
			return sprintf('%s/Credits',$var_268);
		var_272 'documentation':
			return sprintf('%s/Documentation',$var_268);
		var_272 'donate':
			return 'https:
		case 'var_273':
			return 'https:
		case 'var_274':
			return sprintf('%s',$var_268);
		var_99:
			return null;
	}
}


function fn_52() {
	$var_275 = explode(' ',microtime());
	$var_276 = (double)$var_275[0];
	$var_277 = (double)$var_275[1];
	return $var_277 + $var_276;
}


function fn_53($var_7,$var_278=array()) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (! is_array($var_7) || ! count($var_7))
		return '';

	$var_42 = '';
	$var_47 = 0;
	foreach ($var_7 as $var_131 => $var_132)
		if (! in_array($var_131,$var_278))
			if (is_array($var_132))
				foreach ($var_132 as $var_279) {
					if ($var_47++ > 0)
						$var_42 .= '&';

					$var_42 .= sprintf('%s[]=%s',rawurlencode($var_131),rawurlencode($var_279));
				}

			else {
				if ($var_47++ > 0)
					$var_42 .= '&';

				$var_42 .= sprintf('%s=%s',rawurlencode($var_131),rawurlencode($var_132));
			}

	return $var_42;
}


function fn_54($var_145) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	return (implode(',',array_reverse(fn_48($var_145))));
}


function fn_55($var_265,$var_48) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if ($var_265 == $var_48)
		return 0;

	$var_138 = $_SESSION[var_75]->getServer(fn_14('server_id','REQUEST'));
	$var_280 = fn_56($_SESSION[var_75]->getValue('appearance','attr_display_order'));

	
	$var_281 = array_search($var_265->getName(),$var_280);
	$var_282 = array_search($var_48->getName(),$var_280);

	if ((! $var_281) && ($var_281 !== 0))
		if ((! $var_281 = array_search(strtolower($var_265->getFriendlyName()),$var_280)) && ($var_281 !== 0))
			$var_281 = count($var_280)+1;

	if ((! $var_282) && ($var_282 !== 0))
		if ((! $var_282 = array_search(strtolower($var_48->getFriendlyName()),$var_280)) && ($var_282 !== 0))
			$var_282 = count($var_280)+1;

	
	
	if ($var_281 === $var_282)
		return strcasecmp($var_265->getFriendlyName(),$var_48->getFriendlyName());

	
	
	return ($var_281 < $var_282) ? -1 : 1;
}


function fn_56($var_7) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (! is_array($var_7))
		return $var_7;

	$var_284 = array();
	foreach ($var_7 as $var_12 => $var_101)
		$var_284[$var_12] = strtolower($var_101);

	return $var_284;
}


function fn_57($var_285,$var_286) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (! is_array($var_286))
		return false;

	if (! is_string($var_285))
		return false;

	$var_120 = false;

	foreach ($var_286 as $var_147) {
		if (is_string($var_147) && (strcasecmp($var_285,$var_147) == 0)) {
			$var_120 = true;
			break;
		}
	}

	if (var_8)
		fn_13('Returning (%s)',1,0,var_10,var_11,var_6,$var_120);

	return $var_120;
}


function fn_58($var_138,$var_208) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_145 = $var_208->getDn();

	$var_288 = $_SESSION[var_75]->getValue('appearance','tree_display_format');

	foreach ($var_288 as $var_289) {
		$var_290 = false;
		preg_match_all('/%[a-zA-Z_0-9]+/',$var_289,$var_291);
		$var_291 = $var_291[0];

		if (var_8)
			fn_13('The tokens are (%s)',1,0,var_10,var_11,var_6,$var_291);

		foreach ($var_291 as $var_292) {
			if (strcasecmp($var_292,'%dn') == 0)
				$var_289 = str_replace($var_292,fn_28($var_145),$var_289);

			elseif (strcasecmp($var_292,'%rdn') == 0)
				$var_289 = str_replace($var_292,fn_28($var_208->getRDN()),$var_289);

			elseif (strcasecmp($var_292,'%rdnvalue') == 0) {
				$var_190 = fn_36($var_145,0,true);
				$var_192 = explode('=',$var_190,2);
				$var_192 = $var_192[1];
				$var_289 = str_replace($var_292,$var_192,$var_289);

			} else {
				$var_217 = str_replace('%','',$var_292);
				$var_294 = $var_138->getDNAttrValue($var_145,$var_217);

				if (is_null($var_294) || (count($var_294) <= 0)) {
					$var_68 = '&lt;'.fn_3('none').'&gt;';
					$var_290 = true;

				} elseif (is_array($var_294))
					$var_68 = implode(', ',$var_294);

				else
					$var_68 = $var_294;

				$var_289 = str_replace($var_292,$var_68,$var_289);
			}
		}

		
		if (!$var_290)
			return $var_289;
	}

	return $var_289;
}


function fn_59($var_295=null,$var_296=false,$var_131='index',$var_297=true,$var_298=null) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_299 = 0;
	$var_300 = sprintf('<select name="%s" id="%s" %s>',$var_131,$var_131,$var_298);

	foreach ($_SESSION[var_75]->getServerList($var_297) as $var_128 => $var_138) {
		if ($var_138->isVisible()) {

			if ($var_296 && ! $var_138->isLoggedIn())
				continue;

			$var_299++;
			$var_300 .= sprintf('<option value="%s" %s>%s</option>',
				$var_138->getIndex(),($var_138->getIndex() == $var_295 ? 'selected="selected"' : ''),$var_138->getName());

			
			$var_303 = $var_138;
		}
	}

	$var_300 .= '</select>';

	if ($var_299 > 1)
		return $var_300;

	elseif ($var_299)
		return sprintf('%s <input type="hidden" name="%s" value="%s" />',
			$var_303->getName(),$var_131,$var_303->getIndex());

	else
		return '';
}


function fn_60($var_304) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_262 = '';

	for ($var_305=strlen($var_304)-2;$var_305>= 0;$var_305=$var_305-2)
		$var_262 .= substr($var_304,$var_305,2);

	return $var_262;
}

function fn_61($var_306) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_307 = bin2hex($var_306);
	$var_143 = hexdec(substr($var_307,0,2)); 
	$var_308 = hexdec(substr($var_307,2,2)); 
	$var_309 = hexdec(substr($var_307,4,12)); 

	$var_262 = "$var_143-$var_309";

	for ($var_305=0;$var_305<$var_308;$var_305++) {
		$subauth[$var_305] = hexdec(fn_60(substr($var_307,16+($var_305*8),8))); 
		$var_262 .= sprintf('-%s',$subauth[$var_305]);
	}

	return $var_262;
}


function fn_62($var_169,$var_171,$var_12,$var_310,$var_311=true) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_138 = $_SESSION[var_75]->getServer(fn_14('server_id','REQUEST'));
	$var_12 = strtolower($var_12);

	$var_173 = array();
	$var_173['base'] = $var_169;
	$var_173['filter'] = $var_171;
	$var_173['attrs'] = $var_310;
	$var_178 = $var_138->query($var_173,null);

	$var_312 = array();

	foreach ($var_178 as $var_145 => $var_180)
		if (isset($var_180[$var_12]))
			if (is_array($var_180[$var_12]))
				foreach ($var_180[$var_12] as $var_47 => $var_313)
					foreach ($var_310 as $var_98) {
						$var_314 = strtolower($var_98);
						if (isset($var_180[$var_314])) {
							$var_279 = '';

							if (is_array($var_180[$var_314]) && isset($var_180[$var_314][$var_47]))
								$var_279 = $var_180[$var_314][$var_47];

							if (is_string($var_279) && (strlen($var_279) > 0))
								$var_312[$var_313][$var_98] = $var_279;
						}
					}

			else
				foreach ($var_310 as $var_98) {
					$var_314 = strtolower($var_98);
					if (isset($var_180[$var_314]))
						$var_312[$var_180[$var_12]][$var_98] = $var_180[$var_314];
				}

	if ($var_311)
		fn_25($var_312,is_array($var_311) ? implode(',',$var_311) : 'dn');

	return $var_312;
}


function var_315() {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	$var_316 = ! $_SESSION[var_75]->getValue('password','use_similar');
	$var_317 = $_SESSION[var_75]->getValue('password','lowercase');
	$var_318 = $_SESSION[var_75]->getValue('password','uppercase');
	$var_319 = $_SESSION[var_75]->getValue('password','numbers');
	$var_320 = $_SESSION[var_75]->getValue('password','punctuation');
	$var_125 = $_SESSION[var_75]->getValue('password','length');

	$var_321 = array();

	if ($var_316) {
		$var_322 = 'a b c d e f g h k m n p q r s t u v w x y z';
		$var_323 = '2 3 4 5 6 7 8 9';
		$var_324 = '

	} else {
		$raw_lower = 'var_265 var_48 var_325 var_326 var_327 var_205 var_328 var_329 var_47 var_330 var_313 var_331 var_332 var_333 var_334 var_335 var_336 var_266 var_49 var_337 var_338 var_279 var_339 var_305 var_340 var_341';
		$var_323 = '1 2 3 4 5 6 7 8 9 0';
		$var_324 = '
	}

	$llower = explode(' ',$var_322);
	shuffle($var_342);
	$var_343 = explode(' ',strtoupper($var_322));
	shuffle($var_343);
	$var_344 = explode(' ',$var_323);
	shuffle($var_344);
	$var_345 = explode(' ',$var_324);
	shuffle($var_345);

	if ($var_317 > 0)
		$var_321 = array_merge($var_321,fn_63($var_342,$var_317));

	if ($var_318 > 0)
		$var_321 = array_merge($var_321,fn_63($var_343,$var_318));

	if ($var_319 > 0)
		$var_321 = array_merge($var_321,fn_63($var_344,$var_319));

	if ($var_320 > 0)
		$var_321 = array_merge($var_321,fn_63($var_345,$var_320));

	$var_346 = $var_317 + $var_318 + $var_319 + $var_320;

	if ($var_346 < $var_125) {
		$var_347 = array();
		if ($var_317 > 0)
			$var_347 = array_merge($var_347,$var_342);
		if ($var_318 > 0)
			$var_347 = array_merge($var_347,$var_343);
		if ($var_319 > 0)
			$var_347 = array_merge($var_347,$var_344);
		if ($var_320 > 0)
			$var_347 = array_merge($var_347,$var_345);

		if (count($var_347) == 0)
			$var_347 = array_merge($var_347,$var_342,$var_343,$var_344,$var_345);

		shuffle($var_347);
		$var_321 = array_merge($var_321,fn_63($var_347,$var_125-$var_346));
	}

	shuffle($var_321);
	$var_120 = implode('',$var_321);

	if (var_8)
		fn_13('Returning (%s)',1,0,var_10,var_11,var_6,$var_120);

	return $var_120;
}


function fn_63($var_121,$var_348) {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (count($var_121) == 0)
		return array();

	if ($var_348 < 1)
		return array();

	$var_120 = array();
	if ($var_348 > count($var_121)) {
		for($var_47 = 0; $var_47 < $var_348; $var_47++) {
			$var_349 = array_rand($var_121,1);
			$var_120[] = $var_121[$var_349];
		}

	} else {
		$var_350 = array_rand($var_121,$var_348);
		if ($var_348 == 1)
			$var_350 = array($var_350);

		for($var_47 = 0; $var_47 < count($var_350); $var_47++)
			$var_120[] = $var_121[$var_350[$var_47]];
	}

	if (var_8)
		fn_13('Returning (%s)',1,0,var_10,var_11,var_6,$var_120);

	return $var_120;
}


function fn_64() {
	$var_275 = gettimeofday();
	return md5(strtotime('now').$var_275['usec']);
}


function fn_65($var_351,$var_145) {
	return sprintf('SID%s:%s',$var_351,preg_replace('/[\ =,]/','_',$var_145));
}


function fn_66() {
	if (var_8 && (($var_9=func_get_args())||$var_9='NOARGS'))
		fn_13('Entered (%%)',1,0,var_10,var_11,var_6,$var_9);

	if (isset($_SESSION[var_75]))
		return ($_SESSION[var_75]->getValue('appearance','tree') == 'AJAXTree');
	else
		return false;
}
?>
