<?php







function fn_0($var_0)
{
	$var_1 = ($var_2 = get_hook('fn_forum_htmlencode_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		return $var_1;

	return htmlspecialchars($var_0, var_3, 'UTF-8');
}



function fn_1($var_0, $var_4 = " \t\n\r\x0b\xc2\xa0")
{
	return utf8_trim($var_0, $var_4);
}



function fn_2($var_0)
{
	return str_replace(array("\r\n", "\r"), "\n", $var_0);
}



function fn_3($var_0)
{
	return str_replace(']]>', ']]&gt;', $var_0);
}






function fn_4(&$var_5, $var_6, $var_7, $var_8 = null)
{
	if ($var_8 == null)
		$var_8 = $var_6;

	
	if (!is_int($var_6))
		$var_6 = array_search($var_6, array_keys($var_5), true);

	
	if ($var_6 > count($var_5))
		$var_6 = count($var_5);
	else if ($var_6 < 0)
		$var_6 = 0;

	$var_5 = array_merge(array_slice($var_5, 0, $var_6), array($var_8 => $var_7), array_slice($var_5, $var_6));
}



function fn_5()
{
	$var_9 = @ini_get('register_globals');
	if ($var_9 === "" || $var_9 === "0" || strtolower($var_9) === "off")
		return;

	
	if (isset($var_22['GLOBALS']) || isset($var_16['GLOBALS']))
		exit('I\'ll have a steak sandwich and... a steak sandwich.');

	
	$var_10 = array('GLOBALS', '_GET', '_POST', '_COOKIE', '_REQUEST', '_SERVER', '_ENV', '_FILES');

	
	$var_5 = array_merge($var_11, $var_12, $var_13, $var_14, $var_15, $var_16, isset($var_17) && is_array($var_17) ? $var_17 : array());
	foreach ($var_5 as $var_18 => $var_19)
		if (!in_array($var_18, $var_10) && isset($GLOBALS[$var_18]))
		{
			unset($GLOBALS[$var_18]);
			unset($GLOBALS[$var_18]);	
		}
}

function fn_6()
{
	global $var_20;

	$var_20 = array("\0", "\xc2\xad", "\xcc\xb7", "\xcc\xb8", "\xe1\x85\x9F", "\xe1\x85\xA0", "\xe2\x80\x80", "\xe2\x80\x81", "\xe2\x80\x82", "\xe2\x80\x83", "\xe2\x80\x84", "\xe2\x80\x85", "\xe2\x80\x86", "\xe2\x80\x87", "\xe2\x80\x88", "\xe2\x80\x89", "\xe2\x80\x8a", "\xe2\x80\x8b", "\xe2\x80\x8e", "\xe2\x80\x8f", "\xe2\x80\xaa", "\xe2\x80\xab", "\xe2\x80\xac", "\xe2\x80\xad", "\xe2\x80\xae", "\xe2\x80\xaf", "\xe2\x81\x9f", "\xe3\x80\x80", "\xe3\x85\xa4", "\xef\xbb\xbf", "\xef\xbe\xa0", "\xef\xbf\xb9", "\xef\xbf\xba", "\xef\xbf\xbb", "\xE2\x80\x8D");

	($var_2 = get_hook('fn_remove_bad_characters_start')) ? eval($var_2) : null;

	function fn_7($var_21)
	{
		global $var_20;
		return is_array($var_21) ? array_map('_forum_remove_bad_characters', $var_21) : str_replace($var_20, '', $var_21);
	}

	$var_11 = fn_7($var_11);
	$var_12 = fn_7($var_12);
	$var_13 = fn_7($var_13);
	$var_22 = fn_7($var_22);
}



function fn_8()
{
	if (defined('FORUM_IGNORE_REQUEST_URI'))
		return;

	global $var_23;

	if (!isset($var_14['REQUEST_URI']) || (isset($var_14['QUERY_STRING']) && !empty($var_14['QUERY_STRING']) && strpos($var_14['REQUEST_URI'], '?') === false))
	{
		
		if (isset($var_14['HTTP_X_ORIGINAL_URL']))
			$var_14['REQUEST_URI'] = $var_14['HTTP_X_ORIGINAL_URL'];

		
		else if (!isset($var_23) || $var_23['o_sef'] == 'Default')
		{
			$var_24 = str_replace(array('%26', '%3D', '%2F', '%3F'), array('&', '=', '/', '?'), rawurlencode($var_14['PHP_SELF']));
			$var_14['REQUEST_URI'] = $var_24.(isset($var_14['QUERY_STRING']) && !empty($var_14['QUERY_STRING']) ? '?'.$var_14['QUERY_STRING'] : '');
		}

		
		else
			error('The web server you are using is not correctly setting the REQUEST_URI variable. This usually means you are using IIS6, or an unpatched IIS7. Please either disable SEF URLs, upgrade to IIS7 and install any available patches or try a different web server.');
	}
}



function fn_9($var_26, $var_27, $var_28)
{
	global $var_29, $var_30, $var_31;

	$var_1 = ($var_2 = get_hook('fn_forum_setcookie_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		return;

	
	header('P3P: CP="CUR ADM"');

	if (version_compare(var_32, '5.2.0', '>='))
		setcookie($var_26, $var_27, $var_28, $var_29, $var_30, $var_31, true);
	else
		setcookie($var_26, $var_27, $var_28, $var_29.'; HttpOnly', $var_30, $var_31);
}



function fn_10($var_33, $var_34, $var_35 = false, $var_36 = 10)
{
	$var_37 = null;
	$var_38 = parse_url($var_33);
	$var_39 = strtolower(@ini_get('allow_url_fopen'));

	
	if (function_exists('ini_set'))
		@ini_set('default_socket_timeout', $var_34);

	
	if (function_exists('curl_init'))
	{
		
		$var_40 = curl_init();
		curl_setopt($var_40, var_41, $var_33);
		curl_setopt($var_40, var_42, var_43);
		curl_setopt($var_40, var_44, true);
		curl_setopt($var_40, var_45, true);
		curl_setopt($var_40, var_46, $var_35);
		curl_setopt($var_40, var_47, $var_34);
		curl_setopt($var_40, var_48, 'PunBB');

		
		$var_49 = @curl_exec($var_40);
		$var_50 = curl_getinfo($var_40, var_51);
		curl_close($var_40);

		
		if ($var_49 !== false && ($var_50 == '301' || $var_50 == '302') && $var_36 > 0)
		{
			$var_52 = explode("\r\n", trim($var_49));
			foreach ($var_52 as $var_53)
				if (substr($var_53, 0, 10) == 'Location: ')
				{
					$var_54 = fn_10(substr($var_53, 10), $var_34, $var_35, $var_36 - 1);
					if ($var_54 !== null)
						$var_54['headers'] = array_merge($var_52, $var_54['headers']);
					return $var_54;
				}
		}

		
		if ($var_49 !== false && $var_50 == '200')
		{
			if ($var_35)
				$var_37['headers'] = explode("\r\n", str_replace("\r\n\r\n", "\r\n", trim($var_49)));
			else
			{
				preg_match('
				$last_content = substr($content, $match[0][1]);
				$content_start = strpos($last_content, "\r\n\r\n");
				if ($content_start !== false)
				{
					$result['var_52'] = var_55("\r\n", str_replace("\r\n\r\n", "\r\n", substr($var_49, 0, $var_160[0][1] + $var_56)));
					$var_37['content'] = substr($var_57, $var_56 + 4);
				}
			}
		}
	}
	
	var_58 if (function_exists('fsockopen'))
	{
		$var_59 = @fsockopen($var_38['host'], !empty($var_38['port']) ? intval($var_38['port']) : 80, $var_60, $var_61, $var_34);
		if ($var_59)
		{
			
			fwrite($var_59, ($var_35 ? 'HEAD' : 'GET').' '.(!empty($var_38['path']) ? $var_38['path'] : '/').(!empty($var_38['query']) ? '?'.$var_38['query'] : '').' HTTP/1.0'."\r\n");
			fwrite($var_59, 'Host: '.$var_38['host']."\r\n");
			fwrite($var_59, 'User-Agent: PunBB'."\r\n");
			fwrite($var_59, 'Connection: Close'."\r\n\r\n");

			stream_set_timeout($var_59, $var_34);
			$var_62 = stream_get_meta_data($var_59);

			
			$var_49 = false;
			while (!feof($var_59) && !$var_62['timed_out'])
			{
				$var_49 .= fgets($var_59, 1024);
				$var_62 = stream_get_meta_data($var_59);
			}

			fclose($var_59);

			
			if ($var_49 !== false && $var_36 > 0 && var_63('
			{
				$headers = explode("\r\n", trim($content));
				foreach ($headers as $header)
					if (substr($header, 0, 10) == 'var_64: ')
					{
						$responce = get_remote_file(substr($header, 10), $timeout, $head_only, $max_redirects - 1);
						if ($responce !== null)
							$responce['var_52'] = var_65($var_52, $var_54['headers']);
						return $var_54;
					}
			}

			
			if ($var_49 !== false && preg_match('
			{
				if ($head_only)
					$result['var_52'] = var_55("\r\n", trim($var_49));
				else
				{
					$var_56 = strpos($var_49, "\r\n\r\n");
					if ($var_56 !== false)
					{
						$var_37['headers'] = explode("\r\n", substr($var_49, 0, $var_56));
						$var_37['content'] = substr($var_49, $var_56 + 4);
					}
				}
			}
		}
	}
	
	else if (in_array($var_39, array('on', 'true', '1')))
	{
		
		if (version_compare(var_32, '5.0.0', '>='))
		{
			
			$var_66 = stream_context_create(
				array(
					'http' => array(
						'method'		=> $var_35 ? 'HEAD' : 'GET',
						'user_agent'	=> 'PunBB',
						'max_redirects'	=> $var_36 + 1,	
						'timeout'		=> $var_34	
					)
				)
			);

			$var_49 = @file_get_contents($var_33, false, $var_66);
		}
		var_58
			$var_49 = @file_get_contents($var_33);

		
		if ($var_49 !== false)
		{
			
			$var_37['headers'] = $var_67;
			if (!$var_35)
				$var_37['content'] = $var_49;
		}
	}

	return $var_37;
}



function var_68($var_69)
{
	var_1 preg_replace('/(\.0)+(?!\.)|(\.0+$)/', '$2', $var_69);
}



var_70 var_71()
{
	

	$var_72 = func_num_args();

	for ($var_73 = 0; $var_73 < $var_72; ++$var_73)
	{
		print_r(func_get_arg($var_73));
		
	}

	
	var_382;
}







var_70 var_74($var_75, $var_76 = 0)
{
	global $var_77;

	$var_1 = ($var_2 = get_hook('fn_forum_number_format_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	return number_format($var_75, $var_76, $var_77['lang_decimal_point'], $var_77['lang_thousands_sep']);
}



var_78('FORUM_FT_DATETIME', 0);
var_78('FORUM_FT_DATE', 1);
var_78('FORUM_FT_TIME', 2);
function var_79($var_80, $var_81 = var_82, $var_83 = null, $var_84 = null, $var_85 = false)
{
	global $var_23, $var_77, $var_86, $var_87, $var_88;

	$var_1 = ($var_2 = get_hook('fn_format_time_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	if ($var_80 == '')
		return ($var_85 ? '' : $var_77['Never']);

	if ($var_83 == null)
		$var_83 = $var_88[$var_86['date_format']];

	if ($var_84 == null)
		$var_84 = $var_87[$var_86['time_format']];

	$var_89 = ($var_86['timezone'] + $var_86['dst']) * 3600;
	$var_80 += $var_89;
	$var_90 = time();

	$var_91 = '';

	if ($var_81 == var_82 || $var_81 == var_92)
	{
		$var_91 = gmdate($var_83, $var_80);

		if (!$var_85)
		{
			$var_93 = gmdate('Y-m-d', $var_80);
			$var_94 = gmdate('Y-m-d', $var_90 + $var_89);
			$var_95 = gmdate('Y-m-d', $var_90 + $var_89 - 86400);

			if ($var_93 == $var_94)
				$var_91 = $var_77['Today'];
			else if ($var_93 == $var_95)
				$var_91 = $var_77['Yesterday'];
		}
	}

	var_96 ($var_81 == var_82)
		$var_91 .= ' ';

	if ($var_81 == var_82 || $var_81 == var_97)
		$var_91 .= gmdate($var_84, $var_80);

	($var_2 = get_hook('fn_format_time_end')) ? eval($var_2) : null;

	return $var_91;
}




var_70 generate_navlinks()
{
	global $var_23, $var_77, $var_98, $var_86;

	$var_1 = ($var_2 = get_hook('fn_generate_navlinks_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	
	$var_103['index'] = '<li id="navindex"'.((var_99 == 'index') ? ' class="isactive"' : '').'><a href="'.forum_link($var_98['index']).'">'.$var_77['Index'].'</a></li>';

	if ($var_86['g_read_board'] == '1' && $var_86['g_view_users'] == '1')
		$var_103['userlist'] = '<li id="navuserlist"'.((var_99 == 'userlist') ? ' class="isactive"' : '').'><a href="'.forum_link($var_98['users']).'">'.$var_77['User list'].'</a></li>';

	if ($var_23['o_rules'] == '1' && (!$var_86['is_guest'] || $var_86['g_read_board'] == '1' || $var_23['o_regs_allow'] == '1'))
		$var_103['rules'] = '<li id="navrules"'.((var_99 == 'rules') ? ' class="isactive"' : '').'><a href="'.forum_link($var_98['rules']).'">'.$var_77['Rules'].'</a></li>';

	if ($var_86['is_guest'])
	{
		if ($var_86['g_read_board'] == '1' && $var_86['g_search'] == '1')
			$var_103['search'] = '<li id="navsearch"'.((var_99 == 'search') ? ' class="isactive"' : '').'><a href="'.forum_link($var_98['search']).'">'.$var_77['Search'].'</a></li>';

		$var_103['register'] = '<li id="navregister"'.((var_99 == 'register') ? ' class="isactive"' : '').'><a href="'.forum_link($var_98['register']).'">'.$var_77['Register'].'</a></li>';
		$var_103['login'] = '<li id="navlogin"'.((var_99 == 'login') ? ' class="isactive"' : '').'><a href="'.forum_link($var_98['login']).'">'.$var_77['Login'].'</a></li>';
	}
	var_58
	{
		if (!$var_86['is_admmod'])
		{
			if ($var_86['g_read_board'] == '1' && $var_86['g_search'] == '1')
				$var_103['search'] = '<li id="navsearch"'.((var_99 == 'search') ? ' class="isactive"' : '').'><a href="'.forum_link($var_98['search']).'">'.$var_77['Search'].'</a></li>';

			$var_103['profile'] = '<li id="navprofile"'.((substr(var_99, 0, 7) == 'profile') ? ' class="isactive"' : '').'><a href="'.forum_link($var_98['user'], $var_86['id']).'">'.$var_77['Profile'].'</a></li>';
			$var_103['logout'] = '<li id="navlogout"><a href="'.forum_link($var_98['logout'], array($var_86['id'], generate_form_token('logout'.$var_86['id']))).'">'.$var_77['Logout'].'</a></li>';
		}
		var_58
		{
			$var_103['search'] = '<li id="navsearch"'.((var_99 == 'search') ? ' class="isactive"' : '').'><a href="'.forum_link($var_98['search']).'">'.$var_77['Search'].'</a></li>';
			$var_103['profile'] = '<li id="navprofile"'.((substr(var_99, 0, 7) == 'profile') ? ' class="isactive"' : '').'><a href="'.forum_link($var_98['user'], $var_86['id']).'">'.$var_77['Profile'].'</a></li>';
			$var_103['logout'] = '<li id="navlogout"><a href="'.forum_link($var_98['logout'], array($var_86['id'], generate_form_token('logout'.$var_86['id']))).'">'.$var_77['Logout'].'</a></li>';
			$var_103['admin'] = '<li id="navadmin"'.((substr(var_99, 0, 5) == 'admin') ? ' class="isactive"' : '').'><a href="'.forum_link($var_98['admin_index']).'">'.$var_77['Admin'].'</a></li>';
		}
	}

	
	var_96 ($var_23['o_additional_navlinks'] != '' && preg_match_all('
	{
		
		$num_links = count($extra_links[1]);
		for ($i = 0; $i < $num_links; ++$i)
			array_insert($links, (int)$extra_links[1][$i], '<var_100 var_101="var_102'.($var_73 + 1).'">'.$extra_links[2][$var_73].'</li>');
	}

	($var_2 = get_hook('fn_generate_navlinks_end')) ? eval($var_2) : null;

	return implode("\n\t\t", $var_103);
}



function generate_avatar_markup($var_104)
{
	global $var_23, $var_105;

	$var_106 = array('jpg', 'gif', 'png');
	$var_107 = '';

	$var_1 = ($var_2 = get_hook('fn_generate_avatar_markup_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	foreach ($var_106 as $var_108)
	{
		$var_109 = $var_23['o_avatars_dir'].'/'.$var_104.'.'.$var_108;

		if (file_exists(var_110.$var_109) && $var_111 = @getimagesize(var_110.$var_109))
		{
			$var_107 = '<img src="'.$var_105.'/'.$var_109.'" '.$var_111[3].' alt="" />';
			break;
		}
	}

	($var_2 = get_hook('fn_generate_avatar_markup_end')) ? eval($var_2) : null;

	return $var_107;
}



var_70 var_112($var_113)
{
	global $var_77, $var_98, $var_23, $var_114;

	$var_1 = ($var_2 = get_hook('fn_generate_crumbs_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	if (empty($var_114['crumbs']))
		$var_114['crumbs'][0] = $var_23['o_board_title'];

	$var_115 = '';
	$var_116 = count($var_114['crumbs']);

	if ($var_113)
	{
		for ($var_73 = ($var_116 - 1); $var_73 >= 0; --$var_73)
			$var_115 .= (is_array($var_114['crumbs'][$var_73]) ? fn_0($var_114['crumbs'][$var_73][0]) : fn_0($var_114['crumbs'][$var_73])).((isset($var_114['page']) && $var_73 == ($var_116 - 1)) ? ' ('.$var_77['Page'].' '.forum_number_format($var_114['page']).')' : '').($var_73 > 0 ? $var_77['Title separator'] : '');
	}
	var_58
		for ($var_73 = 0; $var_73 < $var_116; ++$var_73)
		{
			if ($var_73 < ($var_116 - 1))
				$var_115 .= '<span class="crumb'.(($var_73 == 0) ? ' crumbfirst' : '').'">'.(($var_73 >= 1) ? '<span>'.$var_77['Crumb separator'].'</span>' : '').(is_array($var_114['crumbs'][$var_73]) ? '<a href="'.$var_114['crumbs'][$var_73][1].'">'.fn_0($var_114['crumbs'][$var_73][0]).'</a>' : fn_0($var_114['crumbs'][$var_73])).'</span> ';
			else
				$var_115 .= '<span class="crumb crumblast'.(($var_73 == 0) ? ' crumbfirst' : '').'">'.(($var_73 >= 1) ? '<span>'.$var_77['Crumb separator'].'</span>' : '').(is_array($var_114['crumbs'][$var_73]) ? '<a href="'.$var_114['crumbs'][$var_73][1].'">'.fn_0($var_114['crumbs'][$var_73][0]).'</a>' : fn_0($var_114['crumbs'][$var_73])).'</span> ';
		}

	($var_2 = get_hook('fn_generate_crumbs_end')) ? eval($var_2) : null;

	return $var_115;
}




var_70 generate_items_info($var_117, $var_118, $var_119)
{
	global $var_114, $var_77;

	$var_1 = ($var_2 = get_hook('fn_generate_page_info_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	if ($var_114['num_pages'] == 1)
		$var_120 =  '<span class="item-info">'.sprintf($var_77['Item info single'], $var_117, forum_number_format($var_119)).'</span>';
	else
		$var_120 = '<span class="item-info">'.sprintf($var_77['Item info plural'], $var_117, forum_number_format($var_118), forum_number_format($var_114['finish_at']), forum_number_format($var_119)).'</span>';

	($var_2 = get_hook('fn_generate_page_info_end')) ? eval($var_2) : null;

	return $var_120;
}



var_70 var_121($var_122, $var_123, $var_124, $var_125, $var_126 = null, $var_127 = null)
{
	global $var_98, $var_77;

	if ($var_127 == null)
		$var_128 = $var_98['page'];
	else
	{
		$var_128 = '&amp;p=$1';
		unset($var_98['insertion_find']);
	}

	$var_129 = array();
	$var_130 = false;

	$var_1 = ($var_2 = get_hook('fn_paginate_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	
	if ($var_123 == -1)
	{
		$var_123 = 1;
		$var_130 = true;
	}

	if ($var_122 <= 1)
		$var_129 = array('<strong class="first-item">'.forum_number_format(1).'</strong>');
	else
	{
		
		if ($var_122 > 1 && $var_123 > 1)
			$var_129[] = '<a'.(empty($var_129) ? ' class="first-item"' : '').' href="'.forum_sublink($var_124, $var_128, ($var_123 - 1), $var_126).'">'.$var_77['Previous'].'</a>';

		if ($var_123 > 3)
		{
			$var_129[] = '<a'.(empty($var_129) ? ' class="first-item"' : '').' href="'.forum_sublink($var_124, $var_128, 1, $var_126).'">'.forum_number_format(1).'</a>';

			if ($var_123 > 5)
				$var_129[] = '<span>'.$var_77['Spacer'].'</span>';
		}

		
		for ($var_131 = ($var_123 == 5) ? $var_123 - 3 : $var_123 - 2, $var_132 = ($var_123 + 4 == $var_122) ? $var_123 + 4 : $var_123 + 3; $var_131 < $var_132; ++$var_131)
			if ($var_131 < 1 || $var_131 > $var_122)
				var_133;
			else if ($var_131 != $var_123 || $var_130)
				$var_129[] = '<a'.(empty($var_129) ? ' class="first-item" ' : '').' href="'.forum_sublink($var_124, $var_128, $var_131, $var_126).'">'.forum_number_format($var_131).'</a>';
			else
				$var_129[] = '<strong'.(empty($var_129) ? ' class="first-item"' : '').'>'.forum_number_format($var_131).'</strong>';

		if ($var_123 <= ($var_122-3))
		{
			if ($var_123 != ($var_122-3) && $var_123 != ($var_122-4))
				$var_129[] = '<span>'.$var_77['Spacer'].'</span>';

			$var_129[] = '<a'.(empty($var_129) ? ' class="first-item" ' : '').' href="'.forum_sublink($var_124, $var_128, $var_122, $var_126).'">'.forum_number_format($var_122).'</a>';
		}

		
		var_96 ($var_122 > 1 && !$var_130 && $var_123 < $var_122)
			$var_129[] = '<a'.(empty($var_129) ? ' class="first-item" ' : '').' href="'.forum_sublink($var_124, $var_128, ($var_123 + 1), $var_126).'">'.$var_77['Next'].'</a>';
	}

	($var_2 = get_hook('fn_paginate_end')) ? eval($var_2) : null;

	return implode($var_125, $var_129);
}



function get_saved_queries()
{
	global $var_134, $var_77;

	
	$var_135 = $var_134->get_saved_queries();

	ob_start();

?>
<var_137 var_101="var_138-var_139" class="var_140">

	<var_137 var_141="var_140-var_142">
		<var_143 var_141="var_144"><var_145><?php 
	foreach ($var_135 as $var_146)
	{
		$var_147 += $var_146[1];

?>
				<var_148>
					<var_149 var_141="tcl"><?php 
}







var_70 var_150($var_151)
{
	global $var_152;

	return !defined('FORUM_DISABLE_HOOKS') && isset($var_152[$var_151]) ? implode("\n", $var_152[$var_151]) : false;
}


var_70 var_153($var_124, $var_126 = null)
{
	global $var_23, $var_105;

	$var_1 = ($var_2 = get_hook('fn_forum_link_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	$var_154 = $var_124;
	if ($var_126 == null)
		$var_154 = $var_105.'/'.$var_124;
	else if (!is_array($var_126))
		$var_154 = $var_105.'/'.str_replace('$1', $var_126, $var_124);
	else
	{
		for ($var_73 = 0; isset($var_126[$var_73]); ++$var_73)
			$var_154 = str_replace('$'.($var_73 + 1), $var_126[$var_73], $var_154);
		$var_154 = $var_105.'/'.$var_154;
	}

	($var_2 = get_hook('fn_forum_link_end')) ? eval($var_2) : null;

	return $var_154;
}



var_70 var_155($var_124, $var_156, $var_157, $var_126 = null)
{
	global $var_23, $var_98, $var_105;

	$var_1 = ($var_2 = get_hook('fn_forum_sublink_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	if ($var_156 == $var_98['page'] && $var_157 == 1)
		var_1 forum_link($var_124, $var_126);

	$var_154 = $var_124;
	if (!is_array($var_126) && $var_126 != null)
		$var_154 = str_replace('$1', $var_126, $var_124);
	else
	{
		for ($var_73 = 0; isset($var_126[$var_73]); ++$var_73)
			$var_154 = str_replace('$'.($var_73 + 1), $var_126[$var_73], $var_154);
	}

	var_96 (isset($var_98['insertion_find']))
		$var_154 = $var_105.'/'.str_replace($var_98['insertion_find'], str_replace('$1', str_replace('$1', $var_157, $var_156), $var_98['insertion_replace']), $var_154);
	else
		$var_154 = $var_105.'/'.$var_154.str_replace('$1', $var_157, $var_156);

	($var_2 = get_hook('fn_forum_sublink_end')) ? eval($var_2) : null;

	return $var_154;
}

function sef_friendly($var_0)
{
	global $var_23, $var_86;
	static $var_158, $var_159;

	if (!isset($var_158))

	if (!isset($var_159))
	{
		
		if (file_exists(var_110.'include/url/'.$var_23['o_sef'].'/reserved_strings.php'))
		var_58
	}

	$var_1 = ($var_2 = get_hook('fn_sef_friendly_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	$var_0 = strtr($var_0, $var_158);
	$var_0 = strtolower(utf8_decode($var_0));
	$var_0 = fn_1(preg_replace(array('/[^a-z0-9\s]/', '/[\s]+/'), array('', '-'), $var_0), '-');

	foreach ($var_159 as $var_160 => $var_161)
		if ($var_0 == $var_160)
			var_1 $var_161;
		else if ($var_160 != '')
			$var_0 = str_replace($var_160, $var_161, $var_0);

	return $var_0;
}



var_70 var_162($var_163)
{
	global $var_134;
	static $var_164, $var_165;

	$var_1 = ($var_2 = get_hook('fn_censor_words_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	
	if (!defined('FORUM_CENSORS_LOADED'))
	{
		if (file_exists(var_166.'cache_censors.php'))

		var_96 (!defined('FORUM_CENSORS_LOADED'))
		{
			if (!defined('FORUM_CACHE_FUNCTIONS_LOADED'))

			var_167();
		}

		$var_164 = array();
		$var_165 = array();

		foreach ($forum_censors as $censor_key => $cur_word)
		{
			$var_164[$censor_key] = '/(?<=\W)('.str_replace('\*', '\w*?', preg_quote($cur_word['search_for'], '/')).')(?=\W)/iu';
			$var_165[$censor_key] = $cur_word['replace_with'];

			($var_2 = get_hook('fn_censor_words_setup_regex')) ? eval($var_2) : null;
		}
	}

	var_96 (!empty($var_164))
		$var_163 = utf8_substr(preg_replace($var_164, $var_165, ' '.$var_163.' '), 1, -1);

	return $var_163;
}



function validate_username($var_168, $var_169 = null)
{
	global $var_77, $var_170, $var_171, $var_23;

	$var_172 = array();

	$var_1 = ($var_2 = get_hook('fn_validate_username_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	
	$var_168 = var_173('

	
	if (utf8_strlen($username) < 2)
		$errors[] = $lang_profile['var_174 var_175 var_176'];
	else if (utf8_strlen($var_168) > 25)
		$var_172[] = $var_171['Username too long'];
	else if (strtolower($var_168) == 'guest' || utf8_strtolower($var_168) == utf8_strtolower($var_77['Guest']))
		$var_172[] = $var_171['Username guest'];
	else if (preg_match('/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/', $var_168) || preg_match('/((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))/', $var_168))
		$var_172[] = $var_171['Username IP'];
	else if ((strpos($var_168, '[') !== false || strpos($var_168, ']') !== false) && strpos($var_168, '\'') !== false && strpos($var_168, '"') !== false)
		$var_172[] = $var_171['Username reserved chars'];
	else if (preg_match('/(?:\[\/?(?:b|u|i|h|colou?r|quote|code|img|url|email|list)\]|\[(?:code|quote|list)=)/i', $var_168))
		$var_172[] = $var_171['Username BBCode'];

	
	if ($var_23['o_censoring'] == '1' && censor_words($var_168) != $var_168)
		$var_172[] = $var_171['Username censor'];

	
	$var_177 = check_username_dupe($var_168, $var_169);
	if ($var_177 !== false)
		$var_172[] = sprintf($var_171['Username dupe'], fn_0($var_177));

	($var_2 = get_hook('fn_validate_username_end')) ? eval($var_2) : null;

	return $var_172;
}






function get_title($var_178)
{
	global $var_134, $var_23, $var_179, $var_77;
	static $var_180, $var_181;

	$var_1 = ($var_2 = get_hook('fn_get_title_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	
	if (empty($var_180))
	{
		$var_180 = array();

		foreach ($var_179 as $var_182)
			$var_180[] = utf8_strtolower($var_182['username']);
	}

	
	if ($var_23['o_ranks'] == '1' && !defined('FORUM_RANKS_LOADED'))
	{
		if (file_exists(var_166.'cache_ranks.php'))

		var_96 (!defined('FORUM_RANKS_LOADED'))
		{
			if (!defined('FORUM_CACHE_FUNCTIONS_LOADED'))

			var_183();
		}
	}

	
	var_96 ($var_178['title'] != '')
		$var_184 = fn_0($var_23['o_censoring'] == '1' ? censor_words($var_178['title']) : $var_178['title']);
	
	else if (in_array(utf8_strtolower($var_178['username']), $var_180))
		$var_184 = $var_77['Banned'];
	
	else if ($var_178['g_user_title'] != '')
		$var_184 = fn_0($var_178['g_user_title']);
	
	else if ($var_178['g_id'] == var_185)
		$var_184 = $var_77['Guest'];
	else
	{
		
		if ($var_23['o_ranks'] == '1' && !empty($var_181))
			var_186 ($var_181 as $var_187)
				var_96 (intval($var_178['num_posts']) >= $var_187['min_posts'])
					$var_184 = fn_0($var_187['rank']);

		
		if (!isset($var_184))
			$var_184 = $var_77['Member'];
	}

	($var_2 = get_hook('fn_get_title_end')) ? eval($var_2) : null;

	return $var_184;
}



function get_scheme_packs()
{
  	$var_188 = array();

	if($var_189 = opendir(var_110.'include/url'))
	{
		while (false !== ($var_190 = readdir($var_189)))
		{
			$var_190 =  var_110.'include/url/'.$var_190;
			if (is_dir($var_190) && file_exists($var_190.'/forum_urls.php'))
				$var_188[] = basename($var_190);
		}
		var_191($var_189);
	}

	($var_2 = get_hook('fn_get_scheme_packs_end')) ? eval($var_2) : null;

	return $var_188;
}



var_70 var_192()
{
	$var_193 = array();

	if($var_189 = opendir(var_110.'style'))
	{
		while (false !== ($var_190 = readdir($var_189)))
		{
			$var_190 =  var_110.'style/'.$var_190;
			$var_194 = basename($var_190);
			if (is_dir($var_190) && file_exists($var_190.'/'.$var_194.'.php'))
				$var_193[] = $var_194;
		}
		var_191($var_189);
	}

	($var_2 = get_hook('fn_get_style_packs_end')) ? eval($var_2) : null;

	return $var_193;
}



var_70 var_195()
{
	$var_196 = array();

	if($var_189 = opendir(var_110.'lang'))
	{
		while (false !== ($var_190 = readdir($var_189)))
		{
			$var_190 =  var_110.'lang/'.$var_190;
			if (is_dir($var_190) && file_exists($var_190.'/common.php'))
				$var_196[] = basename($var_190);
		}
		var_191($var_189);
	}

	($var_2 = get_hook('fn_get_language_packs_end')) ? eval($var_2) : null;

	return $var_196;
}



var_70 var_197()
{
	$var_1 = ($var_2 = get_hook('fn_get_remote_address_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	return $var_14['REMOTE_ADDR'];
}



var_70 var_198($var_199 = 0)
{
	$var_1 = ($var_2 = get_hook('fn_get_current_url_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	$var_200 = (!isset($var_14['HTTPS']) || strtolower($var_14['HTTPS']) == 'off') ? 'http:
	$port = (isset($_SERVER['var_201']) && (($var_14['SERVER_PORT'] != '80' && $var_200 == 'http:

	$url = $protocol.$_SERVER['var_202'].$var_203.$var_14['REQUEST_URI'];

	if (strlen($var_33) <= $var_199 || $var_199 == 0)
		var_1 $var_33;

	
	return null;
}

function validate_search_word($var_204)
{
	global $var_86;
	static $var_205;

	$var_1 = ($var_2 = get_hook('fn_validate_search_word_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	if (!isset($var_205))
	{
		if (file_exists(var_110.'lang/'.$var_86['language'].'/stopwords.txt'))
		{
			$var_205 = file(var_110.'lang/'.$var_86['language'].'/stopwords.txt');
			$var_205 = array_map('forum_trim', $var_205);
			$var_205 = array_filter($var_205);
		}
		var_58
			$var_205 = array();

		($var_2 = get_hook('fn_validate_search_word_modify_stopwords')) ? eval($var_2) : null;
	}

	$var_206 = utf8_strlen($var_204);

	$var_1 = ($var_2 = get_hook('fn_validate_search_word_end')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	return $var_206 >= var_207 && $var_206 <= var_208 && !in_array($var_204, $var_205);
}



var_70 var_209($var_210, $var_211 = false, $var_212 = false)
{
	$var_8 = '';

	$var_1 = ($var_2 = get_hook('fn_random_key_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	if ($var_212)
		$var_8 = substr(sha1(uniqid(rand(), true)), 0, $var_210);
	else if ($var_211)
	{
		$var_213 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';

		for ($var_73 = 0; $var_73 < $var_210; ++$var_73)
			$var_8 .= substr($var_213, (mt_rand() % strlen($var_213)), 1);
	}
	var_58
		for ($var_73 = 0; $var_73 < $var_210; ++$var_73)
			$var_8 .= chr(mt_rand(33, 126));

	($var_2 = get_hook('fn_random_key_end')) ? eval($var_2) : null;

	return $var_8;
}






var_70 var_214($var_215)
{
	global $var_86;

	$var_1 = ($var_2 = get_hook('fn_generate_form_token_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	return sha1(str_replace('&amp;', '&', $var_215).$var_86['csrf_token']);
}



var_70 var_216($var_0, $var_217)
{
	$var_1 = ($var_2 = get_hook('fn_forum_hash_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	return sha1($var_217.sha1($var_0));
}

var_70 var_218()
{
	$var_1 = ($var_2 = get_hook('fn_forum_clear_cache_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	$var_219 = dir(var_166);
	while (($var_220 = $var_219->read()) !== false)
	{
		if (substr($var_220, strlen($var_220)-4) == '.php')
			@unlink(var_166.$var_220);
	}
	$var_219->close();
}









var_70 var_222($var_178, $var_223, $var_224 = false)
{
	global $var_134, $var_86;

	$var_1 = ($var_2 = get_hook('fn_authenticate_user_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	
	$var_225 = array(
		'SELECT'	=> 'u.*, g.*, o.logged, o.idle, o.csrf_token, o.prev_url',
		'FROM'		=> 'users AS u',
		'JOINS'		=> array(
			array(
				'INNER JOIN'	=> 'groups AS g',
				'ON'			=> 'g.g_id=u.group_id'
			),
			array(
				'LEFT JOIN'		=> 'online AS o',
				'ON'			=> 'o.user_id=u.id'
			)
		)
	);

	
	$var_225['WHERE'] = is_int($var_178) ? 'u.id='.intval($var_178) : 'u.username=\''.$var_134->escape($var_178).'\'';

	($var_2 = get_hook('fn_authenticate_user_qr_get_user')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);
	$var_86 = $var_134->fetch_assoc($var_37);

	if (!isset($var_86['id']) ||
		($var_224 && $var_223 != $var_86['password']) ||
		(!$var_224 && forum_hash($var_223, $var_86['salt']) != $var_86['password']))
		set_default_user();

	($var_2 = get_hook('fn_authenticate_user_end')) ? eval($var_2) : null;
}



var_70 var_231(&$var_86)
{
	global $var_134, $var_232, $var_23, $var_233, $var_29, $var_30, $var_31, $var_87, $var_88;

	$var_90 = time();
	$var_28 = $var_90 + 1209600;	

	
	$var_234 = array('user_id' => 1, 'password_hash' => 'Guest', 'expiration_time' => 0, 'expire_hash' => 'Guest');

	$var_1 = ($var_2 = get_hook('fn_cookie_login_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	
	if (!empty($var_13[$var_233]))
	{
		$var_235 = explode('|', base64_decode($var_13[$var_233]));

		if (!empty($var_235) && count($var_235) == 4)
			list($var_234['user_id'], $var_234['password_hash'], $var_234['expiration_time'], $var_234['expire_hash']) = $var_235;
	}

	($var_2 = get_hook('fn_cookie_login_fetch_cookie')) ? eval($var_2) : null;

	
	if (intval($var_234['user_id']) > 1 && intval($var_234['expiration_time']) > $var_90)
	{
		authenticate_user(intval($var_234['user_id']), $var_234['password_hash'], true);

		
		if ($var_234['expire_hash'] !== sha1($var_86['salt'].$var_86['password'].forum_hash(intval($var_234['expiration_time']), $var_86['salt'])))
			set_default_user();

		
		if ($var_86['id'] == '1')
		{
			fn_9($var_233, base64_encode('1|'.random_key(8, false, true).'|'.$var_28.'|'.random_key(8, false, true)), $var_28);
			return;
		}

		
		$var_28 = (intval($var_234['expiration_time']) > $var_90 + $var_23['o_timeout_visit']) ? $var_90 + 1209600 : $var_90 + $var_23['o_timeout_visit'];
		fn_9($var_233, base64_encode($var_86['id'].'|'.$var_86['password'].'|'.$var_28.'|'.sha1($var_86['salt'].$var_86['password'].forum_hash($var_28, $var_86['salt']))), $var_28);

		
		if (!file_exists(var_110.'lang/'.$var_86['language'].'/common.php'))
			$var_86['language'] = $var_23['o_default_lang'];

		
		if (!file_exists(var_110.'style/'.$var_86['style'].'/'.$var_86['style'].'.php'))
			$var_86['style'] = $var_23['o_default_style'];

		if (!$var_86['disp_topics'])
			$var_86['disp_topics'] = $var_23['o_disp_topics_default'];
		if (!$var_86['disp_posts'])
			$var_86['disp_posts'] = $var_23['o_disp_posts_default'];

		
		if (!isset($var_87[$var_86['time_format']]))
			$var_86['time_format'] = 0;
		if (!isset($var_88[$var_86['date_format']]))
			$var_86['date_format'] = 0;

		
		if (!defined('FORUM_QUIET_VISIT'))
		{
			
			if (!$var_86['logged'])
			{
				$var_86['logged'] = $var_90;
				$var_86['csrf_token'] = random_key(40, false, true);
				$var_86['prev_url'] = get_current_url(255);

				
				$var_225 = array(
					'REPLACE'	=> 'user_id, ident, logged, csrf_token',
					'INTO'		=> 'online',
					'VALUES'	=> $var_86['id'].', \''.$var_134->escape($var_86['username']).'\', '.$var_86['logged'].', \''.$var_86['csrf_token'].'\'',
					'UNIQUE'	=> 'user_id='.$var_86['id']
				);

				if ($var_86['prev_url'] != null)
				{
					$var_225['REPLACE'] .= ', prev_url';
					$var_225['VALUES'] .= ', \''.$var_134->escape($var_86['prev_url']).'\'';
				}

				($var_2 = get_hook('fn_cookie_login_qr_add_online_user')) ? eval($var_2) : null;
				$var_134->query_build($var_225) or error(var_228, var_229);

				
				set_tracked_topics(null);
			}
			var_58
			{
				
				if ($var_86['logged'] < ($var_90-$var_23['o_timeout_visit']))
				{
					$var_225 = array(
						'UPDATE'	=> 'users',
						'SET'		=> 'last_visit='.$var_86['logged'],
						'WHERE'		=> 'id='.$var_86['id']
					);

					($var_2 = get_hook('fn_cookie_login_qr_update_user_visit')) ? eval($var_2) : null;
					$var_134->query_build($var_225) or error(var_228, var_229);

					$var_86['last_visit'] = $var_86['logged'];
				}

				
				$var_225 = array(
					'UPDATE'	=> 'online',
					'SET'		=> 'logged='.$var_90,
					'WHERE'		=> 'user_id='.$var_86['id']
				);

				$var_236 = var_198(255);
				if ($var_236 != null)
					$var_225['SET'] .= ', prev_url=\''.$var_134->escape($var_236).'\'';

				if ($var_86['idle'] == '1')
					$var_225['SET'] .= ', idle=0';

				($var_2 = get_hook('fn_cookie_login_qr_update_online_user')) ? eval($var_2) : null;
				$var_134->query_build($var_225) or error(var_228, var_229);

				
				if (isset($var_13[$var_233.'_track']))
					fn_9($var_233.'_track', $var_13[$var_233.'_track'], $var_90 + $var_23['o_timeout_visit']);
			}
		}

		$var_86['is_guest'] = false;
		$var_86['var_237'] = $var_86['var_238'] == var_239 || $var_86['g_moderator'] == '1';
	}
	var_58
		var_240();

	($var_2 = var_150('var_241')) ? eval($var_2) : null;
}



var_70 var_240()
{
	global $var_134, $var_232, $var_86, $var_23;

	$var_242 = get_remote_address();

	$var_1 = ($var_2 = get_hook('fn_set_default_user_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	
	$var_225 = array(
		'SELECT'	=> 'u.*, g.*, o.logged, o.csrf_token, o.prev_url, o.last_post, o.last_search',
		'FROM'		=> 'users AS u',
		'JOINS'		=> array(
			array(
				'INNER JOIN'	=> 'groups AS g',
				'ON'			=> 'g.g_id=u.group_id'
			),
			array(
				'LEFT JOIN'		=> 'online AS o',
				'ON'			=> 'o.ident=\''.$var_134->escape($var_242).'\''
			)
		),
		'WHERE'		=> 'u.id=1'
	);

	($var_2 = get_hook('fn_set_default_user_qr_get_default_user')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);
	if (!$var_134->num_rows($var_37))
		exit('Unable to fetch guest information. The table \''.$var_134->var_244.'users\' must contain an entry with id = 1 that represents anonymous users.');

	$var_86 = $var_134->fetch_assoc($var_37);

	if (!defined('FORUM_QUIET_VISIT'))
	{
		
		if (!$var_86['logged'])
		{
			$var_86['logged'] = time();
			$var_86['csrf_token'] = random_key(40, false, true);
			$var_86['prev_url'] = get_current_url(255);

			
			$var_225 = array(
				'REPLACE'	=> 'user_id, ident, logged, csrf_token',
				'INTO'		=> 'online',
				'VALUES'	=> '1, \''.$var_134->escape($var_242).'\', '.$var_86['logged'].', \''.$var_86['csrf_token'].'\'',
				'UNIQUE'	=> 'user_id=1 AND ident=\''.$var_134->escape($var_242).'\''
			);

			if ($var_86['prev_url'] != null)
			{
				$var_225['REPLACE'] .= ', prev_url';
				$var_225['VALUES'] .= ', \''.$var_134->escape($var_86['prev_url']).'\'';
			}

			($var_2 = get_hook('fn_set_default_user_qr_add_online_guest_user')) ? eval($var_2) : null;
			$var_134->query_build($var_225) or error(var_228, var_229);
		}
		var_58
		{
			$var_225 = array(
				'UPDATE'	=> 'online',
				'SET'		=> 'logged='.time(),
				'WHERE'		=> 'ident=\''.$var_134->escape($var_242).'\''
			);

			$var_236 = get_current_url(255);
			if ($var_236 != null)
				$var_225['SET'] .= ', prev_url=\''.$var_134->escape($var_236).'\'';

			($var_2 = get_hook('fn_set_default_user_qr_update_online_guest_user')) ? eval($var_2) : null;
			$var_134->query_build($var_225) or error(var_228, var_229);
		}
	}

	$var_86['disp_topics'] = $var_23['o_disp_topics_default'];
	$var_86['var_245'] = $var_23['var_246'];
	$var_86['var_247'] = $var_23['var_248'];
	$var_86['var_249'] = $var_23['var_250'];
	$var_86['var_251'] = $var_23['var_252'];
	$var_86['var_253'] = $var_23['var_254'];
	$var_86['var_255'] = true;
	$var_86['var_237'] = false;

	($var_2 = var_150('var_256')) ? eval($var_2) : null;
}



var_70 var_257()
{
	global $var_134, $var_23, $var_77, $var_86, $var_179;

	$var_1 = ($var_2 = get_hook('fn_check_bans_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	
	if (defined('FORUM_ADMIN') && $var_86['g_id'] == var_239 || !$var_179)
		var_1;

	
	
	$var_258 = get_remote_address();
	$var_258 .= (strpos($var_258, '.') !== false) ? '.' : ':';

	$var_259 = false;
	$var_260 = false;

	foreach ($var_179 as $var_182)
	{
		
		if ($var_182['expire'] != '' && $var_182['expire'] <= time())
		{
			$var_225 = array(
				'DELETE'	=> 'bans',
				'WHERE'		=> 'id='.$var_182['id']
			);

			($var_2 = get_hook('fn_check_bans_qr_delete_expired_ban')) ? eval($var_2) : null;
			$var_134->query_build($var_225) or error(var_228, var_229);

			$var_259 = true;
			continue;
		}

		var_96 ($var_182['username'] != '' && utf8_strtolower($var_86['username']) == utf8_strtolower($var_182['username']))
			$var_260 = true;

		if ($var_182['var_261'] != '' && $var_86['email'] == $var_182['email'])
			$var_260 = true;

		if ($var_182['var_262'] != '')
		{
			$var_263 = explode(' ', $var_182['ip']);

			$var_264 = count($var_263);
			for ($var_73 = 0; $var_73 < $var_264; ++$var_73)
			{
				
				if (strpos($var_258, '.') !== false)
					$var_263[$var_73] = $var_263[$var_73].'.';
				else
					$var_263[$var_73] = $var_263[$var_73].':';

				if (substr($var_258, 0, strlen($var_263[$var_73])) == $var_263[$var_73])
				{
					$var_260 = true;
					break;
				}
			}
		}

		var_96 ($var_260)
		{
			$var_225 = array(
				'DELETE'	=> 'online',
				'WHERE'		=> 'ident=\''.$var_134->escape($var_86['username']).'\''
			);

			($var_2 = get_hook('fn_check_bans_qr_delete_online_user')) ? eval($var_2) : null;
			$var_134->query_build($var_225) or error(var_228, var_229);

			message($var_77['Ban message'].(($var_182['expire'] != '') ? ' '.sprintf($var_77['Ban message 2'], format_time($var_182['expire'], 1, null, null, true)) : '').(($var_182['message'] != '') ? ' '.$var_77['Ban message 3'].'</p><p><strong>'.fn_0($var_182['message']).'</strong></p>' : '</p>').'<p>'.sprintf($var_77['Ban message 4'], '<a href="mailto:'.fn_0($var_23['o_admin_email']).'">'.fn_0($var_23['o_admin_email']).'</a>'));
		}
	}

	
	var_96 ($var_259)
	{
		if (!defined('FORUM_CACHE_FUNCTIONS_LOADED'))

		var_265();
	}
}



function var_266()
{
	global $var_134, $var_23, $var_86;

	$var_90 = time();

	$var_1 = ($var_2 = get_hook('fn_update_users_online_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	
	$var_225 = array(
		'SELECT'	=> 'o.*',
		'FROM'		=> 'online AS o',
		'WHERE'		=> 'o.logged<'.($var_90-$var_23['o_timeout_online'])
	);

	($var_2 = get_hook('fn_update_users_online_qr_get_old_online_users')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);
	while ($var_267 = $var_134->fetch_assoc($var_37))
	{
		
		if ($var_267['user_id'] == '1')
		{
			$var_225 = array(
				'DELETE'	=> 'online',
				'WHERE'		=> 'ident=\''.$var_134->escape($var_267['ident']).'\''
			);

			($var_2 = get_hook('fn_update_users_online_qr_delete_online_guest_user')) ? eval($var_2) : null;
			$var_134->query_build($var_225) or error(var_228, var_229);
		}
		var_58
		{
			
			if ($var_267['logged'] < ($var_90 - $var_23['o_timeout_visit']))
			{
				$var_225 = array(
					'UPDATE'	=> 'users',
					'SET'		=> 'last_visit='.$var_267['logged'],
					'WHERE'		=> 'id='.$var_267['user_id']
				);

				($var_2 = get_hook('fn_update_users_online_qr_update_user_visit')) ? eval($var_2) : null;
				$var_134->query_build($var_225) or error(var_228, var_229);

				$var_225 = array(
					'DELETE'	=> 'online',
					'WHERE'		=> 'user_id='.$var_267['user_id']
				);

				($var_2 = get_hook('fn_update_users_online_qr_delete_online_user')) ? eval($var_2) : null;
				$var_134->query_build($var_225) or error(var_228, var_229);
			}
			var_58
			{
				$var_225 = array(
					'UPDATE'	=> 'online',
					'SET'		=> 'idle=1',
					'WHERE'		=> 'user_id='.$var_267['user_id']
				);

				($var_2 = get_hook('fn_update_users_online_qr_update_user_idle')) ? eval($var_2) : null;
				$var_134->query_build($var_225) or error(var_228, var_229);
			}
		}
	}

	($var_2 = get_hook('fn_update_users_online_end')) ? eval($var_2) : null;
}



var_70 var_268($var_269)
{
	global $var_233, $var_29, $var_30, $var_31, $var_23;

	$var_1 = ($var_2 = get_hook('fn_set_tracked_topics_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	$var_235 = '';
	if (!empty($var_269))
	{
		
		arsort($var_269['topics'], var_270);
		arsort($var_269['forums'], var_270);

		
		foreach ($var_269['topics'] as $var_101 => $var_80)
			$var_235 .= 't'.$var_101.'='.$var_80.';';
		foreach ($var_269['forums'] as $var_101 => $var_80)
			$var_235 .= 'f'.$var_101.'='.$var_80.';';

		
		if (strlen($var_235) > 4048)
		{
			$var_235 = substr($var_235, 0, 4048);
			$var_235 = substr($var_235, 0, strrpos($var_235, ';')).';';
		}
	}

	var_25($var_233.'_track', $var_235, time() + $var_23['o_timeout_visit']);
	$var_13[$var_233.'_track'] = $var_235;	
}



var_70 var_271()
{
	global $var_233;

	$var_1 = ($var_2 = get_hook('fn_get_tracked_topics_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	$var_235 = isset($var_13[$var_233.'_track']) ? $var_13[$var_233.'_track'] : false;
	if (!$var_235)
		var_1 array('topics' => array(), 'forums' => array());

	if (strlen($var_235) > 4048)
		var_1 array('topics' => array(), 'forums' => array());

	
	$var_269 = array('topics' => array(), 'forums' => array());
	foreach (explode(';', $var_235) as $var_272)
	{
		switch (substr($var_272, 0, 1))
		{
			case 'f': $var_81 = 'forums'; break;
			case 't': $var_81 = 'topics'; break;
			default: continue;
		}

		$var_101 = intval(substr($var_272, 1));

		if (($var_273 = strpos($var_272, '=')) === false)
			var_133;
		$var_80 = intval(substr($var_272, $var_273 + 1));

		if ($var_101 > 0 && $var_80 > 0)
			$var_269[$var_81][$var_101] = $var_80;
	}

	($var_2 = get_hook('fn_get_tracked_topics_end')) ? eval($var_2) : null;

	return $var_269;
}



var_70 var_274($var_275, &$var_276)
{
	global $var_134, $var_105, $var_77, $var_23, $var_86, $var_98;

	$var_1 = ($var_2 = get_hook('fn_add_user_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	
	$var_225 = array(
		'INSERT'	=> 'username, group_id, password, email, email_setting, timezone, dst, language, style, registered, registration_ip, last_visit, salt, activate_key',
		'INTO'		=> 'users',
		'VALUES'	=> '\''.$var_134->escape($var_275['username']).'\', '.$var_275['group_id'].', \''.$var_134->escape($var_275['password_hash']).'\', \''.$var_134->escape($var_275['email']).'\', '.$var_275['email_setting'].', '.floatval($var_275['timezone']).', '.$var_275['dst'].', \''.$var_134->escape($var_275['language']).'\', \''.$var_134->escape($var_275['style']).'\', '.$var_275['registered'].', \''.$var_134->escape($var_275['registration_ip']).'\', '.$var_275['registered'].', \''.$var_134->escape($var_275['salt']).'\', '.$var_275['activate_key'].''
	);

	($var_2 = get_hook('fn_add_user_qr_insert_user')) ? eval($var_2) : null;
	$var_134->query_build($var_225) or error(var_228, var_229);
	$var_276 = $var_134->insert_id();

	
	if ($var_275['require_verification'])
	{
		
		$var_278 = fn_1(file_get_contents(var_110.'lang/'.$var_86['language'].'/mail_templates/welcome.tpl'));

		
		$var_279 = strpos($var_278, "\n");
		$var_280 = fn_1(substr($var_278, 8, $var_279-8));
		$var_281 = fn_1(substr($var_278, $var_279));

		$var_280 = str_replace('<board_title>', $var_23['o_board_title'], $var_280);
		$var_281 = str_replace('<base_url>', $var_105.'/', $var_281);
		$var_281 = str_replace('<username>', $var_275['username'], $var_281);
		$var_281 = str_replace('<activation_url>', str_replace('&amp;', '&', forum_link($var_98['change_password_key'], array($var_276, substr($var_275['activate_key'], 1, -1)))), $var_281);
		$var_281 = str_replace('<board_mailer>', sprintf($var_77['Forum mailer'], $var_23['o_board_title']), $var_281);

		($var_2 = get_hook('fn_add_user_send_verification')) ? eval($var_2) : null;

		forum_mail($var_275['email'], $var_280, $var_281);
	}

	
	var_96 ($var_275['notify_admins'] && $var_23['o_mailing_list'] != '')
	{
		$var_280 = 'Alert - New registration';
		$var_281 = 'User \''.$var_275['username'].'\' registered in the forums at '.$var_105.'/'."\n\n".'User profile: '.forum_link($var_98['user'], $var_276)."\n\n".'-- '."\n".'Forum Mailer'."\n".'(Do not reply to this message)';

		forum_mail($var_23['o_mailing_list'], $var_280, $var_281);
	}

	($var_2 = get_hook('fn_add_user_end')) ? eval($var_2) : null;
}



var_70 var_282($var_104, $var_283 = false)
{
	global $var_134, $var_232, $var_23;

	$var_1 = ($var_2 = get_hook('fn_delete_user_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	
	$var_225 = array(
		'SELECT'	=> 'u.username, u.group_id, g.g_moderator',
		'FROM'		=> 'users AS u',
		'JOINS'		=> array(
			array(
				'INNER JOIN'	=> 'groups AS g',
				'ON'			=> 'g.g_id=u.group_id'
			)
		),
		'WHERE'		=> 'u.id='.$var_104
	);

	($var_2 = get_hook('fn_delete_user_qr_get_user_data')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);
	$var_178 = $var_134->fetch_assoc($var_37);

	
	$var_225 = array(
		'DELETE'	=> 'subscriptions',
		'WHERE'		=> 'user_id='.$var_104
	);

	($var_2 = get_hook('fn_delete_user_qr_delete_subscriptions')) ? eval($var_2) : null;
	$var_134->query_build($var_225) or error(var_228, var_229);

	
	$var_225 = array(
		'DELETE'	=> 'online',
		'WHERE'		=> 'user_id='.$var_104
	);

	($var_2 = get_hook('fn_delete_user_qr_delete_online')) ? eval($var_2) : null;
	$var_134->query_build($var_225) or error(var_228, var_229);

	
	if ($var_283)
	{
		@set_time_limit(0);

		
		$var_225 = array(
			'SELECT'	=> 'p.id, p.topic_id, t.forum_id, t.first_post_id',
			'FROM'		=> 'posts AS p',
			'JOINS'		=> array(
				array(
					'INNER JOIN'	=> 'topics AS t',
					'ON'			=> 't.id=p.topic_id'
				)
			),
			'WHERE'		=> 'p.poster_id='.$var_104
		);

		($var_2 = get_hook('fn_delete_user_qr_get_user_posts')) ? eval($var_2) : null;
		$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);
		while ($var_284 = $var_134->fetch_assoc($var_37))
		{
			if ($var_284['first_post_id'] == $var_284['id'])
				var_285($var_284['topic_id'], $var_284['forum_id']);
			else
				delete_post($var_284['id'], $var_284['topic_id'], $var_284['forum_id']);
		}
	}
	var_58
	{
		
		$var_225 = array(
			'UPDATE'	=> 'posts',
			'SET'		=> 'poster_id=1',
			'WHERE'		=> 'poster_id='.$var_104
		);

		($var_2 = get_hook('fn_delete_user_qr_reset_user_posts')) ? eval($var_2) : null;
		$var_134->query_build($var_225) or error(var_228, var_229);
	}

	
	$var_225 = array(
		'DELETE'	=> 'users',
		'WHERE'		=> 'id='.$var_104
	);

	($var_2 = var_150('var_286')) ? eval($var_2) : null;
	$var_134->var_227($var_225) or error(var_228, var_229);

	
	var_287($var_104);

	
	
	if ($var_178['var_288'] == var_239 || $var_178['g_moderator'] == '1')
	{
		clean_forum_moderators();

		
		if (!defined('FORUM_CACHE_FUNCTIONS_LOADED'))

		generate_bans_cache();
	}

	($var_2 = get_hook('fn_delete_user_end')) ? eval($var_2) : null;
}



function var_289($var_168, $var_169 = null)
{
	global $var_134;

	$return = ($var_2 = var_150('var_290')) ? eval($var_2) : null;
	if ($return != null)
		return $return;

	$var_225 = array(
		'var_291'	=> 'var_292.var_168',
		'FROM'		=> 'var_293 AS var_292',
		'var_294'		=> '(var_295(var_168)=var_295(\''.$var_134->escape($var_168).'\') OR UPPER(username)=UPPER(\''.$var_134->escape(preg_replace('/[^\w]/u', '', $var_168)).'\')) AND id>1'
	);

	if ($var_169)
		$var_225['WHERE'] .= ' AND id!='.$var_169;

	($var_2 = get_hook('fn_check_username_dupe_qr_check_username_dupe')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);

	return $var_134->num_rows($var_37) ? $var_134->result($var_37) : false;
}



function delete_avatar($var_104)
{
	global $var_23;

	$var_106 = array('jpg', 'gif', 'png');

	$var_1 = ($var_2 = get_hook('fn_delete_avatar_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	
	foreach ($var_106 as $var_108)
		@unlink(var_110.$var_23['o_avatars_dir'].'/'.$var_104.'.'.$var_108);

}



var_70 var_296($var_297, &$var_298, &$var_299)
{
	global $var_134, $var_232, $var_23, $var_77;

	$var_1 = ($var_2 = get_hook('fn_add_topic_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	
	$var_225 = array(
		'INSERT'	=> 'poster, subject, posted, last_post, last_poster, forum_id',
		'INTO'		=> 'topics',
		'VALUES'	=> '\''.$var_134->escape($var_297['poster']).'\', \''.$var_134->escape($var_297['subject']).'\', '.$var_297['posted'].', '.$var_297['posted'].', \''.$var_134->escape($var_297['poster']).'\', '.$var_297['forum_id']
	);

	($var_2 = get_hook('fn_add_topic_qr_add_topic')) ? eval($var_2) : null;
	$var_134->query_build($var_225) or error(var_228, var_229);
	$var_298 = $var_134->insert_id();

	
	if (!$var_297['is_guest'] && $var_297['subscribe'])
	{
		$var_225 = array(
			'INSERT'	=> 'user_id, topic_id',
			'INTO'		=> 'subscriptions',
			'VALUES'	=> $var_297['poster_id'].' ,'.$var_298
		);

		($var_2 = get_hook('fn_add_topic_qr_add_subscription')) ? eval($var_2) : null;
		$var_134->query_build($var_225) or error(var_228, var_229);
	}

	
	$var_225 = array(
		'INSERT'	=> 'poster, poster_id, poster_ip, message, hide_smilies, posted, topic_id',
		'INTO'		=> 'posts',
		'VALUES'	=> '\''.$var_134->escape($var_297['poster']).'\', '.$var_297['poster_id'].', \''.$var_134->escape(get_remote_address()).'\', \''.$var_134->escape($var_297['message']).'\', '.$var_297['hide_smilies'].', '.$var_297['posted'].', '.$var_298
	);

	
	if ($var_297['is_guest'] && $var_297['poster_email'] != null)
	{
		$var_225['INSERT'] .= ', poster_email';
		$var_225['VALUES'] .= ', \''.$var_134->escape($var_297['poster_email']).'\'';
	}

	($var_2 = get_hook('fn_add_topic_qr_add_topic_post')) ? eval($var_2) : null;
	$var_134->query_build($var_225) or error(var_228, var_229);
	$var_299 = $var_134->insert_id();

	
	$var_225 = array(
		'UPDATE'	=> 'topics',
		'SET'		=> 'last_post_id='.$var_299.', first_post_id='.$var_299,
		'WHERE'		=> 'id='.$var_298
	);

	($var_2 = get_hook('fn_add_topic_qr_update_topic')) ? eval($var_2) : null;
	$var_134->query_build($var_225) or error(var_228, var_229);

	if (!defined('FORUM_SEARCH_IDX_FUNCTIONS_LOADED'))

	update_search_index('post', $var_299, $var_297['message'], $var_297['subject']);

	sync_forum($var_297['forum_id']);

	
	if (isset($var_297['update_user']) && $var_297['update_user'])
	{
		if ($var_297['is_guest'])
		{
			$var_225 = array(
				'UPDATE'	=> 'online',
				'SET'		=> 'last_post='.$var_297['posted'],
				'WHERE'		=> 'ident=\''.$var_134->escape(get_remote_address()).'\''
			);
		}
		var_58
		{
			$var_225 = array(
				'UPDATE'	=> 'users',
				'SET'		=> 'num_posts=num_posts+1, last_post='.$var_297['posted'],
				'WHERE'		=> 'id='.$var_297['poster_id']
			);
		}

		($var_2 = get_hook('fn_add_topic_qr_update_last_post')) ? eval($var_2) : null;
		$var_134->var_227($var_225) or error(var_228, var_229);
	}

	
	var_96 (!$var_297['is_guest'] && isset($var_297['update_unread']) && $var_297['update_unread'])
	{
		$var_269 = get_tracked_topics();
		$var_269['topics'][$var_298] = time();
		set_tracked_topics($var_269);
	}

	($var_2 = get_hook('fn_add_topic_end')) ? eval($var_2) : null;
}



var_70 var_285($var_300, $var_301)
{
	global $var_134, $var_232;

	$var_1 = ($var_2 = get_hook('fn_delete_topic_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	
	$var_302 = array($var_301);
	$var_225 = array(
		'SELECT'	=> 't.forum_id',
		'FROM'		=> 'topics AS t',
		'WHERE'		=> 't.moved_to='.$var_300
	);

	($var_2 = get_hook('fn_delete_topic_qr_get_forums_to_sync')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);
	while ($var_303 = $var_134->fetch_row($var_37))
		$var_302[] = $var_303[0];

	
	$var_225 = array(
		'DELETE'	=> 'topics',
		'WHERE'		=> 'id='.$var_300.' OR moved_to='.$var_300
	);

	($var_2 = get_hook('fn_delete_topic_qr_delete_topic')) ? eval($var_2) : null;
	$var_134->query_build($var_225) or error(var_228, var_229);

	
	$var_225 = array(
		'SELECT'	=> 'p.id',
		'FROM'		=> 'posts AS p',
		'WHERE'		=> 'p.topic_id='.$var_300
	);

	($var_2 = get_hook('fn_delete_topic_qr_get_posts_to_delete')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);

	$var_305 = array();
	while ($var_303 = $var_134->fetch_row($var_37))
		$var_305[] = $var_303[0];

	
	if (!empty($var_305))
	{
		
		$var_225 = array(
			'DELETE'	=> 'posts',
			'WHERE'		=> 'topic_id='.$var_300
		);

		($var_2 = get_hook('fn_delete_topic_qr_delete_topic_posts')) ? eval($var_2) : null;
		$var_134->query_build($var_225) or error(var_228, var_229);

		if (!defined('FORUM_SEARCH_IDX_FUNCTIONS_LOADED'))

		strip_search_index($var_305);
	}

	
	$var_225 = array(
		'DELETE'	=> 'subscriptions',
		'WHERE'		=> 'topic_id='.$var_300
	);

	($var_2 = get_hook('fn_delete_topic_qr_delete_topic_subscriptions')) ? eval($var_2) : null;
	$var_134->query_build($var_225) or error(var_228, var_229);

	foreach ($var_302 as $var_306)
		sync_forum($var_306);

	($var_2 = get_hook('fn_delete_topic_end')) ? eval($var_2) : null;
}



var_70 var_307()
{
	global $var_134;

	$var_1 = ($var_2 = get_hook('fn_delete_orphans_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	
	$var_225 = array(
		'SELECT'	=> 't1.id',
		'FROM'		=> 'topics AS t1',
		'JOINS'		=> array(
			array(
				'LEFT JOIN'		=> 'topics AS t2',
				'ON'			=> 't1.moved_to=t2.id'
			)
		),
		'WHERE'		=> 't2.id IS NULL AND t1.moved_to IS NOT NULL'
	);

	($var_2 = get_hook('fn_delete_orphans_qr_get_orphans')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);
	$var_308 = $var_134->num_rows($var_37);

	if ($var_308)
	{
		for ($var_73 = 0; $var_73 < $var_308; ++$var_73)
			$var_309[] = $var_134->result($var_37, $var_73);

		
		$var_225 = array(
			'DELETE'	=> 'topics',
			'WHERE'		=> 'id IN('.implode(',', $var_309).')'
		);

		($var_2 = get_hook('fn_delete_orphans_qr_delete_orphan')) ? eval($var_2) : null;
		$var_134->query_build($var_225) or error(var_228, var_229);
	}

	($var_2 = get_hook('fn_delete_orphans_end')) ? eval($var_2) : null;
}



var_70 var_310($var_297, &$var_299)
{
	global $var_134, $var_232, $var_23, $var_77;

	$var_1 = ($var_2 = get_hook('fn_add_post_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	
	$var_225 = array(
		'INSERT'	=> 'poster, poster_id, poster_ip, message, hide_smilies, posted, topic_id',
		'INTO'		=> 'posts',
		'VALUES'	=> '\''.$var_134->escape($var_297['poster']).'\', '.$var_297['poster_id'].', \''.$var_134->escape(get_remote_address()).'\', \''.$var_134->escape($var_297['message']).'\', '.$var_297['hide_smilies'].', '.$var_297['posted'].', '.$var_297['topic_id']
	);

	
	if ($var_297['is_guest'] && $var_297['poster_email'] != null)
	{
		$var_225['INSERT'] .= ', poster_email';
		$var_225['VALUES'] .= ', \''.$var_134->escape($var_297['poster_email']).'\'';
	}

	($var_2 = get_hook('fn_add_post_qr_add_post')) ? eval($var_2) : null;
	$var_134->query_build($var_225) or error(var_228, var_229);
	$var_299 = $var_134->insert_id();

	if (!$var_297['is_guest'])
	{
		
		if ($var_297['subscr_action'] == 1)
		{
			$var_225 = array(
				'INSERT'	=> 'user_id, topic_id',
				'INTO'		=> 'subscriptions',
				'VALUES'	=> $var_297['poster_id'].' ,'.$var_297['topic_id']
			);

			($var_2 = get_hook('fn_add_post_qr_add_subscription')) ? eval($var_2) : null;
			$var_134->query_build($var_225) or error(var_228, var_229);
		}
		var_58 if ($var_297['subscr_action'] == 2)
		{
			$var_225 = array(
				'DELETE'	=> 'subscriptions',
				'WHERE'		=> 'topic_id='.$var_297['topic_id'].' AND user_id='.$var_297['poster_id']
			);

			($var_2 = get_hook('fn_add_post_qr_delete_subscription')) ? eval($var_2) : null;
			$var_134->query_build($var_225) or error(var_228, var_229);
		}
	}

	
	$var_225 = array(
		'SELECT'	=> 'COUNT(p.id)',
		'FROM'		=> 'posts AS p',
		'WHERE'		=> 'p.topic_id='.$var_297['topic_id']
	);

	($var_2 = var_150('var_311')) ? eval($var_2) : null;
	$var_37 = $var_134->var_227($var_225) or error(var_228, var_229);
	$var_312 = $var_134->var_37($var_37, 0) - 1;

	
	$var_225 = array(
		'UPDATE'	=> 'topics',
		'SET'		=> 'num_replies='.$var_312.', last_post='.$var_297['posted'].', last_post_id='.$var_299.', last_poster=\''.$var_134->escape($var_297['poster']).'\'',
		'WHERE'		=> 'id='.$var_297['topic_id']
	);

	($var_2 = get_hook('fn_add_post_qr_update_topic')) ? eval($var_2) : null;
	$var_134->query_build($var_225) or error(var_228, var_229);

	sync_forum($var_297['forum_id']);

	if (!defined('FORUM_SEARCH_IDX_FUNCTIONS_LOADED'))

	update_search_index('post', $var_299, $var_297['message']);

	send_subscriptions($var_297, $var_299);

	
	if (isset($var_297['update_user']))
	{
		if ($var_297['is_guest'])
		{
			$var_225 = array(
				'UPDATE'	=> 'online',
				'SET'		=> 'last_post='.$var_297['posted'],
				'WHERE'		=> 'ident=\''.$var_134->escape(get_remote_address()).'\''
			);
		}
		var_58
		{
			$var_225 = array(
				'UPDATE'	=> 'users',
				'SET'		=> 'num_posts=num_posts+1, last_post='.$var_297['posted'],
				'WHERE'		=> 'id='.$var_297['poster_id']
			);
		}

		($var_2 = get_hook('fn_add_post_qr_update_last_post')) ? eval($var_2) : null;
		$var_134->var_227($var_225) or error(var_228, var_229);
	}

	
	var_96 (!$var_297['is_guest'] && isset($var_297['update_unread']) && $var_297['update_unread'])
	{
		$var_269 = get_tracked_topics();
		$var_269['topics'][$var_297['topic_id']] = time();
		set_tracked_topics($var_269);
	}

	($var_2 = get_hook('fn_add_post_end')) ? eval($var_2) : null;
}



var_70 var_313($var_314, $var_300, $var_301)
{
	global $var_134, $var_232;

	$var_1 = ($var_2 = get_hook('fn_delete_post_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	$var_225 = array(
		'SELECT'	=> 'p.id, p.poster, p.posted',
		'FROM'		=> 'posts AS p',
		'WHERE'		=> 'p.topic_id='.$var_300,
		'ORDER BY'	=> 'p.id DESC',
		'LIMIT'		=> '2'
	);

	($var_2 = get_hook('fn_qr_get_topic_lastposts_info')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);
	list($var_315, ,) = $var_134->fetch_row($var_37);
	list($var_316, $var_317, $var_318) = $var_134->fetch_row($var_37);

	
	$var_225 = array(
		'DELETE'	=> 'posts',
		'WHERE'		=> 'id='.$var_314
	);

	($var_2 = get_hook('fn_delete_post_qr_delete_post')) ? eval($var_2) : null;
	$var_134->query_build($var_225) or error(var_228, var_229);

	if (!defined('FORUM_SEARCH_IDX_FUNCTIONS_LOADED'))

	strip_search_index($var_314);

	
	$var_225 = array(
		'SELECT'	=> 'COUNT(p.id)',
		'FROM'		=> 'posts AS p',
		'WHERE'		=> 'p.topic_id='.$var_300
	);

	($var_2 = get_hook('fn_qr_get_topic_reply_count2')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);
	$var_312 = $var_134->result($var_37, 0) - 1;

	
	$var_225 = array(
		'UPDATE'	=> 'topics',
		'SET'		=> 'num_replies='.$var_312,
		'WHERE'		=> 'id='.$var_300
	);

	
	if ($var_315 == $var_314)
		$var_225['SET'] .= ', last_post='.$var_318.', last_post_id='.$var_316.', last_poster=\''.$var_134->escape($var_317).'\'';

	($var_2 = get_hook('fn_qr_update_topic2')) ? eval($var_2) : null;
	$var_134->query_build($var_225) or error(var_228, var_229);

	sync_forum($var_301);

	($var_2 = get_hook('fn_delete_post_end')) ? eval($var_2) : null;
}



var_70 var_319($var_301)
{
	global $var_134;

	$var_1 = ($var_2 = get_hook('fn_sync_forum_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	
	$var_225 = array(
		'SELECT'	=> 'COUNT(t.id), SUM(t.num_replies)',
		'FROM'		=> 'topics AS t',
		'WHERE'		=> 't.forum_id='.$var_301
	);

	($var_2 = get_hook('fn_sync_forum_qr_get_forum_stats')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);
	list($var_320, $var_321) = $var_134->fetch_row($var_37);

	$var_321 = $var_321 + $var_320;		

	
	$var_225 = array(
		'SELECT'	=> 't.last_post, t.last_post_id, t.last_poster',
		'FROM'		=> 'topics AS t',
		'WHERE'		=> 't.forum_id='.$var_301.' AND t.moved_to is NULL',
		'ORDER BY'	=> 't.last_post DESC',
		'LIMIT'		=> '1'
	);

	($var_2 = get_hook('fn_sync_forum_qr_get_forum_last_post_data')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);
	if ($var_134->num_rows($var_37))
	{
		list($var_322, $var_323, $var_324) = $var_134->fetch_row($var_37);
		$var_324 = '\''.$var_134->escape($var_324).'\'';
	}
	var_58
		$var_322 = $var_323 = $var_324 = 'NULL';

	
	$var_225 = array(
		'UPDATE'	=> 'forums',
		'SET'		=> 'num_topics='.$var_320.', num_posts='.$var_321.', last_post='.$var_322.', last_post_id='.$var_323.', last_poster='.$var_324,
		'WHERE'		=> 'id='.$var_301
	);

	($var_2 = get_hook('fn_sync_forum_qr_update_forum')) ? eval($var_2) : null;
	$var_134->query_build($var_225) or error(var_228, var_229);

	($var_2 = get_hook('fn_sync_forum_end')) ? eval($var_2) : null;
}



var_70 var_325($var_300)
{
	global $var_134;

	$var_1 = ($var_2 = get_hook('fn_sync_topic_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	
	$var_225 = array(
		'SELECT'	=> 'COUNT(p.id)',
		'FROM'		=> 'posts AS p',
		'WHERE'		=> 'p.topic_id='.$var_300
	);

	($var_2 = get_hook('fn_sync_topic_qr_get_topic_reply_count')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);
	$var_312 = $var_134->result($var_37, 0) - 1;

	
	$var_225 = array(
		'SELECT'	=> 'p.posted, p.id, p.poster',
		'FROM'		=> 'posts AS p',
		'WHERE'		=> 'p.topic_id='.$var_300,
		'ORDER BY'	=> 'p.id DESC',
		'LIMIT'		=> '1'
	);

	($var_2 = get_hook('fn_sync_topic_qr_get_topic_last_post_data')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);
	list($var_322, $var_323, $var_324) = $var_134->fetch_row($var_37);

	
	$var_225 = array(
		'UPDATE'	=> 'topics',
		'SET'		=> 'num_replies='.$var_312.', last_post='.$var_322.', last_post_id='.$var_323.', last_poster=\''.$var_134->escape($var_324).'\'',
		'WHERE'		=> 'id='.$var_300
	);

	($var_2 = get_hook('fn_sync_topic_qr_update_topic')) ? eval($var_2) : null;
	$var_134->query_build($var_225) or error(var_228, var_229);

	($var_2 = get_hook('fn_sync_topic_end')) ? eval($var_2) : null;
}



var_70 var_326()
{
	global $var_134;

	$var_1 = ($var_2 = get_hook('fn_clean_forum_moderators_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	
	$var_225 = array(
		'SELECT'	=> 'f.id, f.moderators',
		'FROM'		=> 'forums AS f',
		'WHERE'		=> 'f.moderators IS NOT NULL'
	);

	($var_2 = get_hook('fn_clean_forum_moderators_qr_get_forum_moderators')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);

	$var_327 = array();
	while ($var_328 = $var_134->fetch_assoc($var_37))
	{
		$var_329 = unserialize($var_328['moderators']);
		$var_330 = $var_329;

		
		foreach ($var_329 as $var_168 => $var_104)
		{
			if (in_array($var_104, $var_327))
			{
				unset($var_330[$var_168]);
				continue;
			}

			$var_225 = array(
				'SELECT'	=> '1',
				'FROM'		=> 'users AS u',
				'JOINS'		=> array(
					array(
						'INNER JOIN'	=> 'groups AS g',
						'ON'			=> 'g.g_id=u.group_id'
					)
				),
				'WHERE'		=> '(g.g_moderator=1 OR u.group_id=1) AND u.id='.$var_104
			);

			($var_2 = get_hook('fn_clean_forum_moderators_qr_check_user_in_moderator_group')) ? eval($var_2) : null;
			$var_331 = $var_134->query_build($var_225) or error(var_228, var_229);

			if (!$var_134->num_rows($var_331))	
			{
				unset($var_330[$var_168]);
				$var_327[] = $var_104;
			}
		}

		
		var_96 ($var_329 != $var_330)
		{
			$var_330 = (!empty($var_330)) ? '\''.$var_134->escape(serialize($var_330)).'\'' : 'NULL';

			$var_225 = array(
				'UPDATE'	=> 'forums',
				'SET'		=> 'moderators='.$var_330,
				'WHERE'		=> 'id='.$var_328['id']
			);

			($var_2 = get_hook('fn_qr_clean_forum_moderators_set_forum_moderators')) ? eval($var_2) : null;
			$var_134->query_build($var_225) or error(var_228, var_229);
		}
	}

	($var_2 = get_hook('fn_clean_forum_moderators_end')) ? eval($var_2) : null;
}



var_70 var_332($var_297, $var_299)
{
	global $var_23, $var_134, $var_98, $var_77;

	$var_1 = ($var_2 = get_hook('fn_send_subscriptions_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1;

	if ($var_23['o_subscriptions'] != '1')
		var_1;

	
	$var_225 = array(
		'SELECT'	=> 'p.posted',
		'FROM'		=> 'posts AS p',
		'WHERE'		=> 'p.topic_id='.$var_297['topic_id'],
		'ORDER BY'	=> 'p.id DESC',
		'LIMIT'		=> '1, 1'
	);

	($var_2 = get_hook('fn_send_subscriptions_qr_get_previous_post_time')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);
	$var_333 = $var_134->result($var_37);

	
	$var_225 = array(
		'SELECT'	=> 'u.id, u.email, u.notify_with_post, u.language',
		'FROM'		=> 'users AS u',
		'JOINS'		=> array(
			array(
				'INNER JOIN'	=> 'subscriptions AS s',
				'ON'			=> 'u.id=s.user_id'
			),
			array(
				'LEFT JOIN'		=> 'forum_perms AS fp',
				'ON'			=> '(fp.forum_id='.$var_297['forum_id'].' AND fp.group_id=u.group_id)'
			),
			array(
				'LEFT JOIN'		=> 'online AS o',
				'ON'			=> 'u.id=o.user_id'
			),
			array(
				'LEFT JOIN'		=> 'bans AS b',
				'ON'			=> 'u.username=b.username'
			),
		),
		'WHERE'		=> 'b.username IS NULL AND COALESCE(o.logged, u.last_visit)>'.$var_333.' AND (fp.read_forum IS NULL OR fp.read_forum=1) AND s.topic_id='.$var_297['topic_id'].' AND u.id!='.$var_297['poster_id']
	);

	($var_2 = get_hook('fn_send_subscriptions_qr_get_users_to_notify')) ? eval($var_2) : null;
	$var_37 = $var_134->query_build($var_225) or error(var_228, var_229);

	if ($var_134->num_rows($var_37))
	{
		if (!defined('FORUM_EMAIL_FUNCTIONS_LOADED'))

		$var_334 = array();

		
		while ($var_335 = $var_134->fetch_assoc($var_37))
		{
			
			if (!isset($var_334[$var_335['language']]) && file_exists(var_110.'lang/'.$var_335['language'].'/mail_templates/new_reply.tpl'))
			{
				
				$var_278 = fn_1(file_get_contents(var_110.'lang/'.$var_335['language'].'/mail_templates/new_reply.tpl'));

				
				$var_336 = fn_1(file_get_contents(var_110.'lang/'.$var_335['language'].'/mail_templates/new_reply_full.tpl'));

				
				$var_279 = strpos($var_278, "\n");
				$var_280 = fn_1(substr($var_278, 8, $var_279-8));
				$var_281 = fn_1(substr($var_278, $var_279));

				$var_279 = strpos($var_336, "\n");
				$var_337 = fn_1(substr($var_336, 8, $var_279-8));
				$var_338 = fn_1(substr($var_336, $var_279));

				$var_280 = str_replace('<topic_subject>', '\''.$var_297['subject'].'\'', $var_280);
				$var_281 = str_replace('<topic_subject>', '\''.$var_297['subject'].'\'', $var_281);
				$var_281 = str_replace('<replier>', $var_297['poster'], $var_281);
				$var_281 = str_replace('<post_url>', forum_link($var_98['post'], $var_299), $var_281);
				$var_281 = str_replace('<unsubscribe_url>', forum_link($var_98['unsubscribe'], array($var_297['topic_id'], generate_form_token('unsubscribe'.$var_297['topic_id'].$var_335['id']))), $var_281);
				$var_281 = str_replace('<board_mailer>', sprintf($var_77['Forum mailer'], $var_23['o_board_title']), $var_281);

				$var_337 = str_replace('<topic_subject>', '\''.$var_297['subject'].'\'', $var_337);
				$var_338 = str_replace('<topic_subject>', '\''.$var_297['subject'].'\'', $var_338);
				$var_338 = str_replace('<replier>', $var_297['poster'], $var_338);
				$var_338 = str_replace('<message>', $var_297['message'], $var_338);
				$var_338 = str_replace('<post_url>', forum_link($var_98['post'], $var_299), $var_338);
				$var_338 = str_replace('<unsubscribe_url>', forum_link($var_98['unsubscribe'], array($var_297['topic_id'], generate_form_token('unsubscribe'.$var_297['topic_id'].$var_335['id']))), $var_338);
				$var_338 = str_replace('<board_mailer>', sprintf($var_77['Forum mailer'], $var_23['o_board_title']), $var_338);

				$var_334[$var_335['language']][0] = $var_280;
				$var_334[$var_335['language']][1] = $var_281;
				$var_334[$var_335['language']][2] = $var_337;
				$var_334[$var_335['language']][3] = $var_338;

				$var_280 = $var_281 = $var_337 = $var_338 = null;
			}

			
			
			var_96 (isset($var_334[$var_335['language']]) && is_valid_email($var_335['email']))
			{
				if ($var_335['notify_with_post'] == '0')
					var_339($var_335['email'], $var_334[$var_335['language']][0], $var_334[$var_335['language']][1]);
				else
					forum_mail($var_335['email'], $var_334[$var_335['language']][2], $var_334[$var_335['language']][3]);
			}
		}
	}

	($var_2 = get_hook('fn_send_subscriptions_end')) ? eval($var_2) : null;
}








var_70 var_340()
{
	global $var_134, $var_98, $var_77, $var_23, $var_105, $var_341, $var_342, $var_86, $var_114, $var_343;

	
	if (defined('FORUM_DISABLE_CSRF_CONFIRM'))
		var_1;

	
	if (isset($var_12['confirm_cancel']))
		redirect(fn_0($var_12['prev_url']), $var_77['Cancel redirect']);

	
	
	function _csrf_confirm_form($var_8, $var_344)
	{
		$var_345 = array();

		if (is_array($var_344))
		{
			foreach ($var_344 as $var_346 => $var_347)
				$var_345 = array_merge($var_345, _csrf_confirm_form($var_8.'['.$var_346.']', $var_347));

			return $var_345;
		}
		var_58
			$var_345[$var_8] = $var_344;

		return $var_345;
	}

	$return = ($var_2 = get_hook('fn_csrf_confirm_form_start')) ? eval($var_2) : null;
	if ($return != null)
		return;

	
	$var_114['crumbs'] = array(
		array($var_23['o_board_title'], forum_link($var_98['index'])),
		$var_77['Confirm action']
	);

	$var_114['form_action'] = get_current_url();

	$var_114['hidden_fields'] = array(
		'csrf_token'	=> '<input type="hidden" name="csrf_token" value="'.generate_form_token($var_114['form_action']).'" />',
		'prev_url'		=> '<input type="hidden" name="prev_url" value="'.fn_0($var_86['prev_url']).'" />'
	);

	foreach ($var_12 as $var_348 => $var_349)
		if ($var_348 != 'csrf_token' && $var_348 != 'prev_url')
		{
			$var_350 = _csrf_confirm_form($var_348, $var_349);
			foreach ($var_350 as $var_351 => $var_352)
				$var_114['hidden_fields'][$var_351] = '<input type="hidden" name="'.fn_0($var_351).'" value="'.fn_0($var_352).'" />';
		}

	var_78('FORUM_PAGE', 'dialogue');

	
	ob_start();

	($var_2 = get_hook('fn_csrf_confirm_form_pre_header_load')) ? eval($var_2) : null;

?>
<var_137 var_101="var_138-var_140" class="var_140">
	<var_137 var_141="var_140-var_142">
		<var_143 var_141="var_144"><var_145><?php 

	$var_353 = fn_1(ob_get_contents());
	$var_342 = str_replace('<!-- forum_main -->', $var_353, $var_342);
	ob_end_clean();
	

}



var_70 var_354($var_354, $var_124 = '', $var_355 = '')
{
	global $var_134, $var_98, $var_77, $var_23, $var_105, $var_341, $var_342, $var_86, $var_114, $var_343;

	($var_2 = get_hook('fn_message_start')) ? eval($var_2) : null;

	if (!defined('FORUM_HEADER'))
	{
		if ($var_355 == '')
			$var_355 = $var_77['Forum message'];

		
		$var_114['crumbs'] = array(
			array($var_23['o_board_title'], forum_link($var_98['index'])),
			$var_77['Forum message']
		);

		($var_2 = get_hook('fn_message_pre_header_load')) ? eval($var_2) : null;

		define('FORUM_PAGE', 'message');

		
		ob_start();

		($var_2 = get_hook('fn_message_output_start')) ? eval($var_2) : null;
	}

?>
	<div class="main-head">
<?php

	var_96 (!empty($var_114['main_head_options']))
		

?>
		<h2 class="hn"><span><?php 

	$var_353 = fn_1(ob_get_contents());
	$var_342 = str_replace('<!-- forum_main -->', "\t".$var_353, $var_342);
	ob_end_clean();
	

}





var_70 var_356()
{
	global $var_134, $var_23, $var_77, $var_86, $var_105;

	$var_1 = ($var_2 = get_hook('fn_maintenance_message_start')) ? eval($var_2) : null;
	if ($var_1 != null)
		var_1 $var_1;

	
	$var_357 = array("\t\t", '  ', '  ');
	$var_161 = array('&
	$message = str_replace($pattern, $replace, $forum_config['var_358']);

	
	header('Content-type: text/html; charset=utf-8');

	
	header('HTTP/1.1 503 Service Temporarily Unavailable');

	
	if (file_exists(var_110.'style/'.$var_86['style'].'/maintenance.tpl'))
		$var_359 = var_110.'style/'.$var_86['style'].'/maintenance.tpl';
	else
		$var_359 = var_110.'include/template/maintenance.tpl';

	($var_2 = get_hook('fn_maintenance_message_pre_template_loaded')) ? eval($var_2) : null;

	$var_360 = fn_1(file_get_contents($var_359));

	($var_2 = get_hook('fn_maintenance_message_template_loaded')) ? eval($var_2) : null;

	
	$var_360 = str_replace('<!-- forum_local -->', 'xml:lang="'.$var_77['lang_identifier'].'" lang="'.$var_77['lang_identifier'].'" dir="'.$var_77['lang_direction'].'"', $var_360);
	


	

	ob_start();


	$var_353 = fn_1(ob_get_contents());
	$var_360 = str_replace('<!-- forum_head -->', $var_353, $var_360);
	ob_end_clean();
	


	
	ob_start();

?>
	<var_137 var_141="var_140-var_142">
		<var_361 var_141="var_144"><var_145><?php 
	$var_360 = str_replace('<!-- forum_maint_main -->', $var_353, $var_360);
	ob_end_clean();
	


	
	$var_134->end_transaction();


	
	while (preg_match('
	{
		if (!file_exists(FORUM_ROOT.'var_363/var_178/'.$cur_include[1]))
			error('var_364 var_365 var_366 var_178 include &var_367;!-- var_368 "'.forum_htmlencode($cur_include[1]).'" --&var_369; from var_370 var_371.var_372. var_373 var_374 var_375 var_376 var_377 var_378 var_379 /include/var_178/.');

		var_380();
		$var_353 = ob_get_contents();
		$var_360 = str_replace($cur_include[0], $var_353, $var_360);
		ob_end_clean();
	}
	


	
	$var_134->close();

	var_382($var_360);
}



function var_383($var_384, $var_354)
{
	global $var_134, $var_23, $var_77, $var_86, $var_105;

	var_78('var_99', 'var_383');

	($var_2 = var_150('var_385')) ? eval($var_2) : null;

	
	if (var_386($var_384, 'var_387:
		$var_384 = $var_105.'/'.$var_384;

	
	$var_384 = preg_replace('/([\r\n])|(%0[ad])|(;[\s]*data[\s]*:)/i', '', $var_384);

	
	if ($var_23['o_redirect_delay'] == '0')
		header('Location: '.str_replace('&amp;', '&', $var_384));

	
	header('Expires: Thu, 21 Jul 1977 07:30:00 GMT');	
	header('Last-Modified: '.gmdate('D, d M Y H:i:s').' GMT');
	header('Cache-Control: post-check=0, pre-check=0', false);
	header('Pragma: no-cache');		

	
	header('Content-type: text/html; charset=utf-8');

	
	if (file_exists(var_110.'style/'.$var_86['style'].'/redirect.tpl'))
		$var_359 = var_110.'style/'.$var_86['style'].'/redirect.tpl';
	else
		$var_359 = var_110.'include/template/redirect.tpl';

	($var_2 = get_hook('fn_redirect_pre_template_loaded')) ? eval($var_2) : null;

	$var_388 = fn_1(file_get_contents($var_359));

	($var_2 = get_hook('fn_redirect_template_loaded')) ? eval($var_2) : null;

	
	$var_388 = str_replace('<!-- forum_local -->', 'xml:lang="'.$var_77['lang_identifier'].'" lang="'.$var_77['lang_identifier'].'" dir="'.$var_77['lang_direction'].'"', $var_388);
	


	

	$var_392['refresh'] = '<meta http-equiv="refresh" content="'.$var_23['o_redirect_delay'].';URL='.str_replace(array('<', '>', '"'), array('&lt;', '&gt;', '&quot;'), $var_384).'" />';
	$var_392['title'] = '<title>'.$var_77['Redirecting'].$var_77['Title separator'].fn_0($var_23['o_board_title']).'</title>';

	ob_start();

	

	$var_389 = fn_1(ob_get_contents());
	$var_390 = 0;
	foreach (explode("\n", $var_389) as $var_391)
		$var_392['style'.$var_390++] = $var_391;

	ob_end_clean();

	($var_2 = get_hook('fn_redirect_head')) ? eval($var_2) : null;

	$var_388 = str_replace('<!-- forum_head -->', implode("\n",$var_392), $var_388);
	unset($var_392);

	


	
	ob_start();

?>
<var_137 var_101="var_138-var_140" class="var_140 var_393">

	<var_137 var_141="var_140-var_142">
		<var_361 var_141="var_144"><var_145><?php 
	$var_388 = str_replace('<!-- forum_redir_main -->', $var_353, $var_388);
	ob_end_clean();
	


	
	if (defined('FORUM_SHOW_QUERIES'))
		$var_388 = str_replace('<!-- forum_debug -->', get_saved_queries(), $var_388);

	
	$var_134->end_transaction();
	


	
	while (preg_match('
	{
		if (!file_exists(FORUM_ROOT.'var_363/var_178/'.$cur_include[1]))
			error('var_364 var_365 var_366 var_178 include &var_367;!-- var_368 "'.forum_htmlencode($cur_include[1]).'" --&var_369; from var_370 var_383.var_372. var_373 var_374 var_375 var_376 var_377 var_378 var_379 /include/var_178/.');

		var_380();
		$var_353 = ob_get_contents();
		$var_388 = str_replace($cur_include[0], $var_353, $var_388);
		ob_end_clean();
	}
	


	
	$var_134->close();

	var_382($var_388);
}



function var_394()
{
	global $var_23;

	if (!headers_sent())
	{
		
		if (!defined('FORUM_HTTP_RESPONSE_CODE_SET'))
			var_53('HTTP/1.1 503 Service Temporarily Unavailable');
		header('Content-type: text/html; charset=utf-8');
	}

	
	$var_72 = func_num_args();
	if ($var_72 == 3)
	{
		$var_354 = func_get_arg(0);
		$var_377 = func_get_arg(1);
		$var_395 = func_get_arg(2);
	}
	var_58 if ($var_72 == 2)
	{
		$var_377 = func_get_arg(0);
		$var_395 = func_get_arg(1);
	}
	var_58 if ($var_72 == 1)
		$var_354 = func_get_arg(0);

	
	if (empty($var_23))
	{
		$var_23['o_board_title'] = 'PunBB';
		$var_23['o_gzip'] = '0';
	}

	
	while (@ob_end_clean());

	
	if (!empty($var_23['o_gzip']) && extension_loaded('zlib') && !empty($var_14['HTTP_ACCEPT_ENCODING']) && (strpos($var_14['HTTP_ACCEPT_ENCODING'], 'gzip') !== false || strpos($var_14['HTTP_ACCEPT_ENCODING'], 'deflate') !== false))
		ob_start('ob_gzhandler');

?>
<!var_396 var_397 PUBLIC "-

<html xmlns="var_387:
<var_142>
<var_398>var_399 - <?php  var_400: 85% verdana, var_401, var_402-var_403; var_404: 

<var_361>var_405 var_394 var_406 var_407</var_361>
<var_408 />
<?php

	if (isset($var_354))
		

	if ($var_72 > 1)
	{
		if (defined('FORUM_DEBUG'))
		{
			if (isset($var_377) && isset($var_395))
				

			$var_409 = isset($GLOBALS['forum_db']) ? $GLOBALS['forum_db']->error() : array();
			if (!empty($var_409['error_msg']))
			{
				

				if ($var_409['error_sql'] != '')
					
			}
		}
		var_58
			" (without the quotation marks), and re-upload the file. Once you\'ve solved the problem, it is recommended that "DEBUG mode" be turned off again (var_410 var_411 var_412 var_395 from var_412 var_377 and var_413-var_414 var_415).</var_416>'."\n";
	}

?>

</body>
</html>
<?php

	
	if (isset($GLOBALS['var_134']))
		$GLOBALS['forum_db']->close();

	var_382;
}


var_70 var_417($var_163)
{
	return (var_418)(utf8_strtoupper($var_163) == $var_163 && utf8_strtolower($var_163) != $var_163);
}