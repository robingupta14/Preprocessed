<?php




class class_0 extends var_0
{
    public function fn_0($var_1 = null, $var_2 = null)
    {
        parent::fn_0($var_1, $var_2);
        Yii::app()->var_3->updateNavigationStack();
        
        Yii::import('application.helpers.viewHelper');
    }

    
    public function fn_1($var_5)
    {
        
        $var_6 = 'index';

        
        if (empty($var_5['sa'])) {
            $var_7 = $var_6; 
        } else {
            $var_7 = $var_5['sa'];
        }
        
        $var_8 = new class_1($var_9);
        if (!$var_8->hasMethod($var_7)) {
            
            $var_7 = 'run';
        }

        
        $var_5 = $var_9->fn_2($var_5);

        if (!empty($var_5['iSurveyId'])) {
            LimeExpressionManager::SetSurveyId($var_5['iSurveyId']); 
        }
        
        
        
        $var_12  = new class_2($var_9, $var_7);

        
        $var_13 = Yii::app()->getController()->getActionClasses();

        if (empty($var_13[$var_9->getId()]) || strtolower($var_12->getDeclaringClass()->var_17) != strtolower($var_13[$var_9->getId()]) || !$var_12->isPublic()) {
            
            
            $var_12 = new class_2($var_9, $var_6);
        }

        
        
        return parent::runWithParamsInternal($var_9, $var_12, $var_5);
    }

    
    private function fn_2($var_5)
    {
        
        if (empty($var_5) || !is_array($var_5)) {
            return $var_5;
        }

        $var_19 = array(
            'id' => 'iId',
            'gid' => 'iGroupId',
            'qid' => 'iQuestionId',
            
            
            'sid' => array('iSurveyId', 'iSurveyID', 'surveyid'), 
            'surveyId' => array('iSurveyId', 'iSurveyID', 'surveyid'), 
            'surveyid' => array('iSurveyId', 'iSurveyID', 'surveyid'),
            'srid' => 'iSurveyResponseId',
            'scid' => 'iSavedControlId',
            'uid' => 'iUserId',
            'ugid' => 'iUserGroupId',
            'fieldname' => 'sFieldName',
            'fieldtext' => 'sFieldText',
            'action' => 'sAction',
            'lang' => 'sLanguage',
            'browselang' => 'sBrowseLang',
            'tokenids' => 'aTokenIds',
            'tokenid' => 'iTokenId',
            'subaction' => 'sSubAction',
        );

        
        
        
        
        foreach ($var_19 as $var_20 => $var_21) {
            if (isset($var_5[$var_20])) {
                $var_21 = (array) $var_21;
                foreach ($var_21 as $var_22) {
                    if (empty($var_5[$var_22])) {
                        $var_5[$var_22] = $var_5[$var_20];
                    }
                }
            }
        }

        
    public function fn_3()
    {
        $var_9->index();
    }

    
    protected function fn_4($var_24, array $var_25)
    {
        $var_26 = array();
        foreach ($var_25 as $var_27 => $var_28) {
                    $var_26[$var_27] = Yii::app()->var_3->getQuery($var_28);
        }

        return call_user_func_array(array($var_9, $var_24), $var_26);
    }

    
    public function fn_5($var_31, $var_32 = null, $var_33 = false)
    {
        
        if (is_array($var_32)) {
            extract($var_32, var_34, 'data');
        } else {
            $var_35 = $var_32;
        }

        if ($var_33) {
            ob_start();
            ob_implicit_flush(0);
            return ob_get_clean();
        } else {
        }
    }

    
    private function fn_6($var_37, $var_38, $var_39 = [])
    {
        
        $var_38 = (array) $var_38; $var_40 = '/admin/';
        if (!empty($var_37)) {
                    $var_40 .= $var_37.'/';
        }
        
        
        $var_41 = "";
        foreach ($var_38 as $var_42 => $var_43) {
            if (empty($var_42) || !in_array($var_42, array('message', 'output'))) {
                if (is_numeric($var_42)) {
                    $var_41 .= Yii::app()->getController()->renderPartial($var_40.$var_43, $var_39, true);
                } elseif (is_array($var_43)) {
                    foreach ($var_43 as $var_45) {
                        $var_45 = array_merge($var_39, $var_45);
                        $var_41 .= Yii::app()->getController()->renderPartial($var_40.$var_42, $var_45, true);
                    }
                }
            } else {
                switch ($var_42) {
                    
                    
                    case 'message' :
                        if (empty($var_43['class'])) {
                            $var_41 .= Yii::app()->getController()->_showMessageBox($var_43['title'], $var_43['message'], null, true);
                        } else {
                            $var_41 .= Yii::app()->getController()->_showMessageBox($var_43['title'], $var_43['message'], $var_43['class'], true);
                        }
                        break;

                        
                    case 'output' :
                        

                        $var_41 .= $var_43;

                        if (isset($var_38['afteroutput'])) {
                            $var_41 .= $var_38['afteroutput'];
                        }
                        break;
                }
            }
        }
        return $var_41;
    }

    
    protected function fn_7($var_37 = '', $var_38 = array(), $var_39 = array(), $var_47 = false)
    {
        
        $var_39 = $var_9->fn_2($var_39); 

        $var_48 = (string) Yii::getPathOfAlias('application.views.admin.super');
        
        if ($var_47 == false) {
            if (!empty($var_39['surveyid'])) {

                $var_39['oSurvey'] = Survey::model()->findByPk($var_39['surveyid']);

                
                
                LimeExpressionManager::SetSurveyId($var_39['surveyid']);
                LimeExpressionManager::StartProcessingPage(false,true);

                $var_50 = $var_48.'/layout_insurvey.php';
            } else {
                $var_50 = $var_48.'/layout_main.php';
            }
        } else {
            $var_50 = $var_48.'/'.$var_47;
        }

        $var_41 = $var_9->fn_6($var_37, $var_38, $var_39);
        $var_51 = $var_9->fn_5($var_50, ['content' => $var_41, 'aData' => $var_39], true);

        App()->getClientScript()->render($var_51);
        
    }

    
    protected function fn_8()
    {
        
        
        
        if (get_class($var_9) == 'databaseupdate') {
            return;
        }

        if (!Yii::app()->var_54->var_55 && Yii::app()->getConfig('updatable')) {
            $var_57 = new class_3();
            $var_58 = $var_57->var_58;

            if ($var_58->var_59) {
                return $var_9->getController()->renderPartial("/admin/update/_update_notification", array('security_update_available'=>$var_58->var_60));
            }
        }
    }

    
    private function fn_9()
    {
            $var_61 = App()->session['arrayNotificationMessages'];
            if (!is_array($var_61)) {
                $var_61 = array();
            }
            unset(App()->session['arrayNotificationMessages']);
            return $var_9->getController()->renderPartial("notifications/notifications", array('aMessage'=>$var_61));
    }

    
    private function fn_10($var_39)
    {
        if (isset($var_39['display']['surveysummary'])) {
            if ((empty($var_39['display']['menu_bars']['surveysummary']) || !is_string($var_39['display']['menu_bars']['surveysummary'])) && !empty($var_39['gid'])) {
                $var_39['display']['menu_bars']['surveysummary'] = 'viewgroup';
            }
            $var_9->fn_11($var_39);
        }
    }

    
    private function fn_12($var_39, $var_63 = true)
    {
        if (!isset($var_39['display']['header']) || $var_39['display']['header'] !== false) {
            
            if ($var_63) {
                header("Content-type: text/html; charset=UTF-8"); 
            }
            Yii::app()->getController()->_getAdminHeader();
        }
    }

    
    public function fn_13($var_39)
    {
        
        if (!Yii::app()->var_54->var_55) {
            
            if (Yii::app()->session['pw_notify'] && Yii::app()->getConfig("debug") < 2) {
                $var_65 = new class_4(array(
                    'user_id' => App()->var_54->var_2,
                    'importance' => var_66::var_67,
                    'title' => gT('Password warning'),
                    'message' => '<span class="fa fa-exclamation-circle text-warning"></span>&nbsp;'.
                        gT("Warning: You are still using the default password ('password'). Please change your password and re-login again.")
                ));
                $var_65->save();
            }
            if (strtolower(getGlobalSetting('force_ssl')!='on') && Yii::app()->getConfig("debug") < 2) {
                $var_65 = new class_4(array(
                    'user_id' => App()->var_54->var_2,
                    'importance' => var_66::var_67,
                    'title' => gT('SSL not enforced'),
                    'message' => '<span class="fa fa-exclamation-circle text-warning"></span>&nbsp;'.
                        gT("Warning: Please enforce SSL encrpytion in Global settings/Security after SSL is properly configured for your webserver.")
                ));
                $var_65->save();                
            }

            
            $var_39['dataForConfigMenu']['activesurveyscount'] = $var_39['activesurveyscount'] = Survey::model()->permission(Yii::app()->var_54->getId())->active()->count();

            
            $var_39['dataForConfigMenu']['surveyscount'] = Survey::model()->count();

            
            $var_39['dataForConfigMenu']['userscount'] = User::model()->count();

            
            if (getGlobalSetting('emailsmtpdebug') != '') {
                $var_39['dataForConfigMenu']['comfortUpdateKey'] = gT('Activated');
            } else {
                $var_39['dataForConfigMenu']['comfortUpdateKey'] = gT('None');
            }

            $var_39['sitename'] = Yii::app()->getConfig("sitename");

            $var_57 = new class_3();
            $var_58 = $var_57->var_58;
            $var_39['showupdate'] = Yii::app()->getConfig('updatable') && $var_58->var_59 && !$var_58->var_73;

            
            $var_39['extraMenus'] = $var_9->fn_14($var_39);

            
            $var_75 = isset($var_39['surveyid']) ? $var_39['surveyid'] : null;
            Yii::import('application.controllers.admin.NotificationController');
            $var_39['adminNotifications'] = NotificationController::getMenuWidget($var_75, true );

            $var_9->getController()->renderPartial("/admin/super/adminmenu", $var_39);
        }
        return null;
    }

    private function fn_15($var_39)
    {
        if (isset($var_39['title_bar'])) {
            $var_9->getController()->renderPartial("/admin/super/title_bar", $var_39);
        }
    }

    private function fn_16($var_39)
    {
        if (isset($var_39['token_bar'])) {

            if (isset($var_39['token_bar']['closebutton']['url'])) {
                $var_76 = $var_39['token_bar']['closebutton']['url'];
                $var_39['token_bar']['closebutton']['url'] = Yii::app()->var_3->getUrlReferrer(Yii::app()->createUrl($var_76));
            }

            $var_9->getController()->renderPartial("/admin/token/token_bar", $var_39);
        }
    }

    
    private function fn_17($var_39)
    {
        if (isset($var_39['organizebar'])) {
            if (isset($var_39['questionbar']['closebutton']['url'])) {
                $var_76 = $var_39['questionbar']['closebutton']['url'];
                $var_39['questionbar']['closebutton']['url'] = Yii::app()->var_3->getUrlReferrer(Yii::app()->createUrl($var_76));
            }

            $var_39['questionbar'] = $var_39['organizebar'];
            $var_9->getController()->renderPartial("/admin/survey/Question/questionbar_view", $var_39);
        }
    }

    
    public function fn_18($var_39)
    {
        if (isset($var_39['questionbar'])) {
            if (is_object($var_39['oSurvey'])) {

                $var_79 = $var_39['surveyid'];
                
                $var_80 = $var_39['oSurvey'];
                $var_81 = $var_39['gid'];
                $var_82 = $var_39['qid'];

                
                $var_83 = (!empty($var_39['display']['menu_bars']['qid_action'])) ? $var_39['display']['menu_bars']['qid_action'] : null;
                $var_84 = $var_80->var_85;

                
                
                $var_39['qct'] = Answer::model()->countByAttributes(array('qid' => $var_82, 'language' => $var_84));

                
                $var_39['sqct'] = class_6::model()->countByAttributes(array('parent_qid' => $var_82, 'language' => $var_84));

                $var_87 = class_6::model()->findByAttributes(array('qid' => $var_82, 'gid' => $var_81, 'sid' => $var_79, 'language' => $var_84));
                if (is_null($var_87)) {
                    return;
                }
                $var_89 = "";

                
                $var_90 = getQuestDepsForConditions($var_79, "all", "all", $var_82, "by-targqid", "outsidegroup");

                
                
                $var_39['activated'] = $var_80->var_71;

                $var_87 = $var_87->var_91;
                $var_39['languagelist'] = $var_80->getAllLanguages();
                $var_39['qtypes'] = getQuestionTypeList('', 'array');
                $var_39['action'] = $var_83;
                $var_39['surveyid'] = $var_79;
                $var_39['qid'] = $var_82;
                $var_39['gid'] = $var_81;
                $var_39['qrrow'] = $var_87;
                $var_39['baselang'] = $var_84;

                $var_93 = class_6::model()->getAdvancedSettingsWithValues($var_82, $var_87['type'], $var_79, $var_84);

                $var_95 = array();
                foreach ($var_93 as $var_96) {
                    if (($var_96['i18n'] == false && isset($var_96['value']) && $var_96['value'] != $var_96['default']) ||
                        ($var_96['i18n'] == true && isset($var_96['value'][$var_84]) && $var_96['value'][$var_84] != $var_96['default'])) {
                        if ($var_96['inputtype'] == 'singleselect') {
                            if (isset($var_96['options'][$var_96['value']])) {
                                                            $var_96['value'] = $var_96['options'][$var_96['value']];
                            }
                        }
                        $var_95[] = $var_96;
                    }
                }

                $var_39['advancedsettings'] = $var_95;
                $var_39['condarray'] = $var_90;
                if (isset($var_39['questionbar']['closebutton']['url'])) {
                    $var_76 = $var_39['questionbar']['closebutton']['url'];
                    $var_39['questionbar']['closebutton']['url'] = Yii::app()->var_3->getUrlReferrer(Yii::app()->createUrl($var_76));
                }
                $var_89 .= $var_9->getController()->renderPartial('/admin/survey/Question/questionbar_view', $var_39, true);
                $var_9->getController()->renderPartial('/survey_view', ['display'=>$var_89]);
            } else {
                Yii::app()->session['flashmessage'] = gT("Invalid survey ID");
                $var_9->getController()->redirect(array("admin/index"));
            }
        }
    }

    
    function fn_19($var_39)
    {
        if (isset($var_39['questiongroupbar'])) {
            if (!isset($var_39['gid'])) {
                if (isset($_GET['gid'])) {
                    $var_39['gid'] = $_GET['gid'];
                }
            }

            $var_39['surveyIsActive'] = $var_39['oSurvey']->var_71 !== 'N';

            $var_98 = $var_39['surveyid'];
            $var_81 = $var_39['gid'];
            $var_80 = $var_39['oSurvey'];
            $var_84 = $var_80->var_85;

            $var_39['sumcount4'] = class_6::model()->countByAttributes(array('sid' => $var_98, 'gid' => $var_81, 'language' => $var_84));

            $var_99 = Survey::model()->with(array(
                'languagesettings' => array('condition' => 'surveyls_language=language'))
                )->findByPk($var_98); 
            
            
            
            
            $var_39['activated'] = $var_101 = $var_99->var_71;

            $var_90 = getGroupDepsForConditions($var_98, "all", $var_81, "by-targgid");
            $var_39['condarray'] = $var_90;

            $var_39['languagelist'] = $var_80->getAllLanguages();

            if (isset($var_39['questiongroupbar']['closebutton']['url'])) {
                $var_76 = $var_39['questiongroupbar']['closebutton']['url'];
                $var_39['questiongroupbar']['closebutton']['url'] = Yii::app()->var_3->getUrlReferrer(Yii::app()->createUrl($var_76));
            }

            $var_9->getController()->renderPartial("/admin/survey/QuestionGroups/questiongroupbar_view", $var_39);
        }
    }

    function fn_20($var_39)
    {
        if ((isset($var_39['fullpagebar']))) {
            if (isset($var_39['fullpagebar']['closebutton']['url']) && !isset($var_39['fullpagebar']['closebutton']['url_keep'])) {
                $var_76 = '/admin/index';
                $var_39['fullpagebar']['closebutton']['url'] = Yii::app()->var_3->getUrlReferrer(Yii::app()->createUrl($var_76));
            }
            $var_9->getController()->renderPartial("/admin/super/fullpagebar_view", $var_39);
        }
    }

    
    function fn_21($var_39)
    {
        if ((isset($var_39['surveybar']))) {
            $var_79 = $var_39['surveyid'];
            
            $var_80 = $var_39['oSurvey'];
            $var_81 = isset($var_39['gid']) ? $var_39['gid'] : null;
            $var_39['baselang'] = $var_80->var_85;
            App()->getClientScript()->registerPackage('js-cookie');

            

            

            $var_103 = array('sid' => $var_79, 'parent_qid' => 0, 'language' => $var_80->var_85);

            $var_104 = class_6::model()->countByAttributes($var_103); 

            $var_39['canactivate'] = $var_104 > 0 && Permission::model()->hasSurveyPermission($var_79, 'surveyactivation', 'update');
            $var_39['candeactivate'] = Permission::model()->hasSurveyPermission($var_79, 'surveyactivation', 'update');
            $var_39['expired'] = $var_80->var_106 != '' && ($var_80->var_106 < dateShift(date("Y-m-d H:i:s"), "Y-m-d H:i", Yii::app()->getConfig('timeadjust')));
            $var_39['notstarted'] = ($var_80->var_107 != '') && ($var_80->var_107 > dateShift(date("Y-m-d H:i:s"), "Y-m-d H:i", Yii::app()->getConfig('timeadjust')));

            
            
            if (!$var_80->var_108) {
                $var_39['icontext'] = gT("Preview survey");
            } else {
                $var_39['icontext'] = gT("Execute survey");
            }

            $var_39['onelanguage'] = (count($var_80->var_109) == 1);
            $var_39['hasadditionallanguages'] = (count($var_80->var_110) > 0);

            
            $var_39['surveylocale'] = Permission::model()->hasSurveyPermission($var_79, 'surveylocale', 'read');
            
            $var_39['surveysettings'] = Permission::model()->hasSurveyPermission($var_79, 'surveysettings', 'read');
            
            $var_39['surveysecurity'] = Permission::model()->hasSurveyPermission($var_79, 'surveysecurity', 'read');
            
            $var_39['surveycontentread'] = Permission::model()->hasSurveyPermission($var_79, 'surveycontent', 'read');
            $var_39['groupsum'] = ($var_80->var_111 > 1);
            
            $var_39['quotas'] = Permission::model()->hasSurveyPermission($var_79, 'quotas', 'read');
            
            $var_39['assessments'] = Permission::model()->hasSurveyPermission($var_79, 'assessments', 'read');
            
            
            
            
            $var_39['surveydelete'] = Permission::model()->hasSurveyPermission($var_79, 'survey', 'delete');
            
            $var_39['surveytranslate'] = Permission::model()->hasSurveyPermission($var_79, 'translations', 'read');
            
            
            
            

            
            $var_39['showSurveyPropertiesMenu'] =
                    $var_39['surveylocale']
                || $var_39['surveysettings']
                || $var_39['surveysecurity']
                || $var_39['surveycontentread']
                || $var_39['quotas']
                || $var_39['assessments'];

            
            $var_112 = new class_5('beforeToolsMenuRender', $var_9);
            $var_112->set('surveyId', $var_79);
            App()->getPluginManager()->dispatchEvent($var_112);
            $var_116 = $var_112->get('menuItems');
            $var_39['extraToolsMenuItems'] = $var_116;

            
            $var_112 = new class_5('beforeSurveyBarRender', $var_9);
            $var_112->set('surveyId', $var_79);
            App()->getPluginManager()->dispatchEvent($var_112);
            $var_118 = $var_112->get('menus');
            $var_39['beforeSurveyBarRender'] = $var_118 ? $var_118 : array();

            
            $var_39['showToolsMenu'] =
                    $var_39['surveydelete']
                || $var_39['surveytranslate']
                || Permission::model()->hasSurveyPermission($var_79, 'surveycontent', 'update')
                || !is_null($var_116);

            $var_119 = Condition::model()->with(array('questions'=>array('condition'=>'sid ='.$var_79)))->count();

            $var_39['surveycontent'] = Permission::model()->hasSurveyPermission($var_79, 'surveycontent', 'update');
            $var_39['conditionscount'] = ($var_119 > 0);
            
            $var_39['surveyexport'] = Permission::model()->hasSurveyPermission($var_79, 'surveycontent', 'export');
            
            
            
            $var_39['respstatsread'] = Permission::model()->hasSurveyPermission($var_79, 'responses', 'read')
                || Permission::model()->hasSurveyPermission($var_79, 'statistics', 'read')
                || Permission::model()->hasSurveyPermission($var_79, 'responses', 'export');
            
            $var_39['responsescreate'] = Permission::model()->hasSurveyPermission($var_79, 'responses', 'create');
            $var_39['responsesread'] = Permission::model()->hasSurveyPermission($var_79, 'responses', 'read');
            
            if (!$var_80->var_120) {
                $var_39['tokenmanagement'] = Permission::model()->hasSurveyPermission($var_79, 'surveysettings', 'update')
                    || Permission::model()->hasSurveyPermission($var_79, 'tokens', 'create');
            } else {
                $var_39['tokenmanagement'] = Permission::model()->hasSurveyPermission($var_79, 'surveysettings', 'update')
                    || Permission::model()->hasSurveyPermission($var_79, 'tokens', 'create')
                    || Permission::model()->hasSurveyPermission($var_79, 'tokens', 'read')
                    || Permission::model()->hasSurveyPermission($var_79, 'tokens', 'export')
                    || Permission::model()->hasSurveyPermission($var_79, 'tokens', 'import'); 
            }

            $var_39['gid'] = $var_81; 

            if (Permission::model()->hasSurveyPermission($var_79, 'surveycontent', 'read')) {
                $var_39['permission'] = true;
            } else {
                $var_39['gid'] = $var_81 = null;
                $var_39['permission'] = false;
            }

            if (getGroupListLang($var_81, $var_80->var_85, $var_79)) {
                $var_39['groups'] = getGroupListLang($var_81, $var_80->var_85, $var_79);
            } else {
                $var_39['groups'] = "<option>".gT("None")."</option>";
            }

            $var_39['GidPrev'] = getGidPrevious($var_79, $var_81);

            $var_39['GidNext'] = getGidNext($var_79, $var_81);
            $var_39['iIconSize'] = Yii::app()->getConfig('adminthemeiconsize');

            if (isset($var_39['surveybar']['closebutton']['url'])) {
                $var_76 = $var_39['surveybar']['closebutton']['url'];
                $var_39['surveybar']['closebutton']['url'] = Yii::app()->var_3->getUrlReferrer(Yii::app()->createUrl($var_76));
            }

            if ($var_39['gid'] == null) {
                            $var_9->getController()->renderPartial("/admin/survey/surveybar_view", $var_39);
            }
        }
    }

    
    private function fn_22($var_39)
    {
        $var_79 = $var_39['surveyid'];

        $var_121 = Survey::model()->findByPk($var_79);
        
        $var_99 = Survey::model()->with(array(
            'languagesettings' => array('condition'=>'surveyls_language=language'))
        )->find('sid = :surveyid', array(':surveyid' => $var_39['surveyid'])); 

        if (Permission::model()->hasSurveyPermission($var_79, 'surveycontent', 'read')) {
            $var_39['permission'] = true;
        } else {
            $var_39['gid'] = null;
            $var_39['permission'] = false;
        }

        if (!is_null($var_99)) {
            
            
            
            $var_39['activated'] = $var_121->var_108;

            
            $var_123 = $var_121->var_120;
            if (!$var_123) {
                $var_39['tokenmanagement'] = Permission::model()->hasSurveyPermission($var_79, 'surveysettings', 'update')
                    || Permission::model()->hasSurveyPermission($var_79, 'tokens', 'create');
            } else {
                $var_39['tokenmanagement'] = Permission::model()->hasSurveyPermission($var_79, 'surveysettings', 'update')
                    || Permission::model()->hasSurveyPermission($var_79, 'tokens', 'create')
                    || Permission::model()->hasSurveyPermission($var_79, 'tokens', 'read')
                    || Permission::model()->hasSurveyPermission($var_79, 'tokens', 'export')
                    || Permission::model()->hasSurveyPermission($var_79, 'tokens', 'import'); 
            }

            
            $var_124 = QuestionGroup::model()->findAllByAttributes(array('sid' => $var_79, "language" => $var_99->var_126->var_127), array('order'=>'group_order ASC'));
            if (count($var_124)) {
                foreach ($var_124 as $var_128) {
                    $var_128->var_129 = class_6::model()->findAllByAttributes(array("sid"=>$var_79, "gid"=>$var_128['gid'], "language"=>$var_99->var_126->var_127), array('order'=>'question_order ASC'));

                    foreach ($var_128->var_129 as $var_130) {
                        if (is_object($var_130)) {
                            $var_130->var_130 = viewHelper::flatEllipsizeText($var_130->var_130, true, 60, '[...]', 0.5);
                        }
                    }
                }
            }

            $var_39['quickmenu'] = $var_9->fn_23($var_39);
            $var_39['beforeSideMenuRender'] = $var_9->fn_24($var_39);
            $var_39['aGroups'] = $var_124;
            $var_39['surveycontent'] = Permission::model()->hasSurveyPermission($var_39['surveyid'], 'surveycontent', 'read');
            $var_39['surveycontentupdate'] = Permission::model()->hasSurveyPermission($var_39['surveyid'], 'surveycontent', 'update');
            $var_39['sideMenuBehaviour'] = getGlobalSetting('sideMenuBehaviour');
            $var_9->getController()->renderPartial("/admin/super/sidemenu", $var_39);
        } else {
            Yii::app()->session['flashmessage'] = gT("Invalid survey ID");
            $var_9->getController()->redirect(array("admin/index"));
        }
    }

    
    protected function fn_23(array $var_39)
    {
        $var_112 = new class_5('afterQuickMenuLoad', $var_9);
        $var_112->set('aData', $var_39);
        $var_59 = App()->getPluginManager()->dispatchEvent($var_112);

        $var_133 = $var_59->get('quickMenuItems');
        if (!empty($var_133)) {
            usort($var_133, function($var_134, $var_135)
            {
                return (int) $var_134['order'] > (int) $var_135['order'];
            });
        }

        $var_39['quickMenuItems'] = $var_133;

        if ($var_39['quickMenuItems'] === null) {
            $var_39['quickMenuItems'] = array();
        }

        $var_136 = $var_9->getController()->renderPartial('/admin/super/quickmenu', $var_39, true);
        return $var_136;
    }

    
    protected function fn_24(array $var_39)
    {
        $var_112 = new class_5('beforeSideMenuRender', $var_9);
        $var_112->set('aData', $var_39);
        $var_59 = App()->getPluginManager()->dispatchEvent($var_112);
        return $var_59->get('html');
    }

    
    private function fn_25(array $var_39)
    {
        if (isset($var_39['display']['menu_bars']['listquestiongroups'])) {
            $var_9->getController()->renderPartial("/admin/survey/QuestionGroups/listquestiongroups", $var_39);
        }
    }

    private function fn_26($var_39)
    {
        if (isset($var_39['display']['menu_bars']['listquestions'])) {
            $var_79 = $var_39['surveyid'];
            $var_80 = $var_39['oSurvey'];
            $var_84 = $var_80->var_85;

            
            $var_137 = new class_6('search');

            
            if (isset($_GET['Question'])) {
                $var_137->setAttributes($_GET['Question'], false);
            }

            
            if (isset($_GET['gid'])) {
                $var_137->var_81 = $_GET['gid'];
            }

            
            if (isset($_GET['pageSize'])) {
                Yii::app()->var_54->setState('pageSize', (int) $_GET['pageSize']);
            }

            
            $var_137->var_140 = $var_79;
            $var_137->var_85 = $var_84;

            $var_39['model'] = $var_137;

            $var_9->getController()->renderPartial("/admin/survey/Question/listquestions", $var_39);
        }
    }

    
    public function fn_11($var_39)
    {
        $var_79 = $var_39['surveyid'];

        $var_141 = getSurveyInfo($var_79);
        
        $var_80 = $var_39['oSurvey'];
        $var_84 = $var_141['language'];
        $var_101 = $var_141['active'];

        $var_103 = array('sid' => $var_79, 'parent_qid' => 0, 'language' => $var_84);

        $var_104 = class_6::model()->countByAttributes($var_103); 
        $var_103 = array('sid' => $var_79, 'language' => $var_84);
        $var_142 = QuestionGroup::model()->countByAttributes($var_103); 

        
        $var_143 = $var_80->var_110;
        $var_144 = "";
        if ($var_141['anonymized'] != "N") {
            $var_144 .= gT("Responses to this survey are anonymized.")."<br />";
        } else {
            $var_144 .= gT("Responses to this survey are NOT anonymized.")."<br />";
        }
        if ($var_141['format'] == "S") {
            $var_144 .= gT("It is presented question by question.")."<br />";
        } elseif ($var_141['format'] == "G") {
            $var_144 .= gT("It is presented group by group.")."<br />";
        } else {
            $var_144 .= gT("It is presented on one single page.")."<br />";
        }
        if ($var_141['questionindex'] > 0) {
            if ($var_141['format'] == 'A') {
                $var_144 .= gT("No question index will be shown with this format.")."<br />";
            } elseif ($var_141['questionindex'] == 1) {
                $var_144 .= gT("A question index will be shown; participants will be able to jump between viewed questions.")."<br />";
            } elseif ($var_141['questionindex'] == 2) {
                $var_144 .= gT("A full question index will be shown; participants will be able to jump between relevant questions.")."<br />";
            }
        }
        if ($var_80->var_145) {
            $var_144 .= gT("Responses will be date stamped.")."<br />";
        }
        if ($var_80->var_146) {
            $var_144 .= gT("IP Addresses will be logged")."<br />";
        }
        if ($var_80->var_147) {
            $var_144 .= gT("Referrer URL will be saved.")."<br />";
        }
        if ($var_80->var_148) {
            $var_144 .= gT("It uses cookies for access control.")."<br />";
        }
        if ($var_80->var_149) {
            $var_144 .= gT("If tokens are used, the public may register for this survey")."<br />";
        }
        if ($var_80->var_150 && !$var_80->var_151) {
            $var_144 .= gT("Participants can save partially finished surveys")."<br />\n";
        }
        if ($var_80->var_152 != '') {
            $var_144 .= gT("Basic email notification is sent to:").' '.htmlspecialchars($var_141['emailnotificationto'])."<br />\n";
        }
        if ($var_80->var_153 != '') {
            $var_144 .= gT("Detailed email notification with response data is sent to:").' '.htmlspecialchars($var_141['emailresponseto'])."<br />\n";
        }

        $var_154 = getDateFormatData(Yii::app()->session['dateformat']);
        if (trim($var_80->var_107) != '') {
            Yii::import('application.libraries.Date_Time_Converter');
            $var_155 = new class_7($var_80->var_107, 'Y-m-d H:i:s');
            $var_39['startdate'] = $var_155->convert($var_154['phpdate'].' H:i');
        } else {
            $var_39['startdate'] = "-";
        }

        if (trim($var_80->var_106) != '') {
            
            Yii::import('application.libraries.Date_Time_Converter');
            $var_155 = new class_7($var_80->var_106, 'Y-m-d H:i:s');
            
            $var_39['expdate'] = $var_155->convert($var_154['phpdate'].' H:i');
        } else {
            $var_39['expdate'] = "-";
        }

        $var_39['language'] = getLanguageNameFromCode($var_80->var_85, false);

        if ($var_80->var_157->var_158 == "") {
            $var_141['surveyls_urldescription'] = htmlspecialchars($var_141['surveyls_url']);
        }

        if ($var_80->var_157->var_159 != "") {
            $var_39['endurl'] = " <a target='_blank' href=\"".htmlspecialchars($var_141['surveyls_url'])."\" title=\"".htmlspecialchars($var_141['surveyls_url'])."\">".flattenText($var_80->var_157->var_159)."</a>";
        } else {
            $var_39['endurl'] = "-";
        }

        $var_39['sumcount3'] = $var_104;
        $var_39['sumcount2'] = $var_142;

        if ($var_101 == "N") {
            $var_39['activatedlang'] = gT("No");
        } else {
            $var_39['activatedlang'] = gT("Yes");
        }

        $var_39['activated'] = $var_101;
        if ($var_80->var_108) {
            $var_39['surveydb'] = Yii::app()->var_160->var_161."survey_".$var_79;
        }

        $var_39['warnings'] = "";
        if ($var_101 == "N" && $var_104 == 0) {
            $var_39['warnings'] = gT("Survey cannot be activated yet.")."<br />\n";
            if ($var_142 == 0 && Permission::model()->hasSurveyPermission($var_79, 'surveycontent', 'create')) {
                $var_39['warnings'] .= "<span class='statusentryhighlight'>[".gT("You need to add question groups")."]</span><br />";
            }
            if ($var_104 == 0 && Permission::model()->hasSurveyPermission($var_79, 'surveycontent', 'create')) {
                $var_39['warnings'] .= "<span class='statusentryhighlight'>[".gT("You need to add questions")."]</span><br />";
            }
        }
        $var_39['hints'] = $var_144;

        
        
        
        
        

        $var_39['tableusage'] = false;
        $var_39['aAdditionalLanguages'] = $var_143;
        $var_39['groups_count'] = $var_142;

        
        
        $var_162 = SettingsUser::getUserSettingValue('quickaction_state');
        if ($var_162 === null || $var_162 === 0) {
            $var_162 = 1;
            SettingsUser::setUserSetting('quickaction_state', 1);
        }
        $var_39['quickactionstate'] = $var_162 !== null ? intval($var_162) : 1;
        $var_39['subviewData'] = $var_39;
        $var_41 = $var_9->getController()->renderPartial("/admin/survey/surveySummary_view", $var_39, true);
        $var_9->getController()->renderPartial("/admin/super/sidebody", array(
            'content' => $var_41,
            'sideMenuOpen' => true
        ));
    }

    
    public function fn_27(array $var_39)
    {
        if (!empty($var_39['display']['menu_bars']['browse']) && !empty($var_39['surveyid'])) {
            
            $var_79 = $var_39['surveyid'];
            $var_39['title'] = $var_39['display']['menu_bars']['browse'];
            $var_39['thissurvey'] = getSurveyInfo($var_79);
            $var_39['surveyid'] = $var_79;

            if (!isset($var_39['menu']['closeurl'])) {
                $var_39['menu']['closeurl'] = Yii::app()->var_3->getUrlReferrer(Yii::app()->createUrl("/admin/responses/sa/browse/surveyid/".$var_39['surveyid']));
            }

            $var_9->getController()->renderPartial("/admin/responses/browsemenubar_view", $var_39);
        }
    }

    
    public function fn_28(array $var_39)
    {
        $var_163 = (isset($var_39['ugid'])) ? $var_39['ugid'] : 0;
        if (!empty($var_39['display']['menu_bars']['user_group'])) {
            $var_35 = $var_39;
            Yii::app()->loadHelper('database');

            if (!empty($var_163)) {
                $var_165 = UserGroup::model()->findByPk($var_163);
                $var_166 = Yii::app()->session['loginID'];
                if ($var_165 && $var_165->hasUser($var_166)) {
                    $var_35['userGroup'] = $var_165;
                } else {
                    $var_35['userGroup'] = null;
                }
            }

            $var_35['imageurl'] = Yii::app()->getConfig("adminimageurl");

            if (isset($var_39['usergroupbar']['closebutton']['url'])) {
                $var_76 = $var_39['usergroupbar']['closebutton']['url'];
                $var_39['usergroupbar']['closebutton']['url'] = Yii::app()->var_3->getUrlReferrer(Yii::app()->createUrl($var_76));
            }

            $var_9->getController()->renderPartial('/admin/usergroup/usergroupbar_view', $var_35);
        }
    }

    
    protected function fn_29($var_168, $var_169)
    {
        $var_170 = array();
        $var_171 = array();

        if (!is_dir($var_168)) {
                    return array(array(), array());
        }

        if (!is_dir($var_169)) {
                    mkdir($var_169);
        }

        $var_172 = opendir($var_168);
        if (!$var_172) {
            $var_170[] = array(
                "filename" => '',
                "status" => gT("Extracted files not found - maybe a permission problem?")
            );    
            return array($var_171, $var_170);                        
        }
        while ($var_173 = readdir($var_172)) {
            if ($var_173 != "." && $var_173 != "..") {
                if (is_file($var_168."/".$var_173)) {
                    
                    $var_174 = (string) substr(strrchr($var_173, '.'), 1);
                    if (!(stripos(','.Yii::app()->getConfig('allowedresourcesuploads').',', ','.$var_174.',') === false)) {
                        
                        if (!copy($var_168."/".$var_173, $var_169."/".$var_173)) {
                            $var_170[] = array(
                            "filename" => $var_173,
                            "status" => gT("Copy failed")
                            );
                        } else {
                            $var_171[] = array(
                            "filename" => $var_173,
                            "status" => gT("OK")
                            );
                        }
                    } else {
                        
                        $var_170[] = array(
                        "filename" => $var_173,
                        "status" => gT("Forbidden Extension")
                        );
                    }
                    unlink($var_168."/".$var_173);
                }
            }
        }

        return array($var_171, $var_170);
    }

    
    protected function fn_14(array $var_39)
    {
        $var_112 = new class_5('beforeAdminMenuRender', $var_9);
        $var_112->set('data', $var_39);
        $var_59 = App()->getPluginManager()->dispatchEvent($var_112);

        $var_175 = $var_59->get('extraMenus');

        if ($var_175 === null) {
            $var_175 = array();
        }

        return $var_175;
    }

}
