<?php

function fn_0()
{
	global $var_0;
	global $var_1;
	global $var_2;
	
	$var_3 = '';
	$var_4 = new class_2();
			
	switch($var_35['act'])
	{
        case 'json':
		case 1:	
			switch($var_35['oper'])
			{
				case 'del':	
					$var_6 = $var_35['ids'];
					foreach($var_6 as $var_7)
					{
						$var_4->load($var_7);
						$var_4->delete();
					}
					
					break;
					
				default: 
					
					switch($var_35['searchField'])
					{
						case 'id':
							$var_35['searchField'] = 'b.id';
							break;

						case 'type':
							$var_35['searchField'] = 'b.type';
							break;

						case 'title':
							$var_35['searchField'] = 'd.text';
							break;

						case 'category':
							$var_35['searchField'] = 'b.category';						
							break;

						case 'dates':
							$var_35['searchField'] = 'b.date_published';
							break;

						case 'enabled':
							$var_35['searchField'] = 'b.enabled';
							break;

						case 'date_modified':
						default:
							$var_35['searchField'] = 'b.date_modified';
					}

					if($var_35['sidx']=='dates')
						$var_35['sidx'] = 'b.date_published';
				
					$var_10 = intval($var_35['page']);
					$var_11	= intval($var_35['rows']);
					$var_12 = ($var_10 - 1) * $var_11;
					$var_13= $var_35['sidx'].' '.$var_35['sord'];
					$var_14 = " 1=1 ";
					
					if($var_35['_search']=='true' || isset($var_35['quicksearch']))
					{
						if(isset($var_35['quicksearch']))
							$var_14 .= $var_4->quicksearch($var_35['quicksearch']);
						else if(isset($var_35['filters']))
                        {
							$var_14 .= class_7::jqgridsearch($var_35['filters']);
                            
                            if( strpos($var_14, 'title LIKE')!== false)
                            {
                                $var_14 = substr_replace($var_14, 'd.text', strpos($var_14, 'title LIKE'), 5);
                            }
                        }
						else	
							$var_14 .= ' AND '.class_7::jqgridcompare($var_35['searchField'], $var_35['searchOper'], $var_35['searchString']);
					}
										
					$var_16 = ' SELECT SQL_CALC_FOUND_ROWS b.*, d.text as title 
							   FROM nv_blocks b
						  LEFT JOIN nv_webdictionary d
						  		 	 ON b.id = d.node_id
								 	AND d.node_type = "block"
									AND d.subtype = "title"
									AND d.lang = "'.$var_2->var_132[0].'"
									AND d.website = '.$var_2->var_7.'
							  WHERE '.$var_14.'
							    AND b.website = '.$var_2->var_7.' 
						   ORDER BY '.$var_13.' 
							  LIMIT '.$var_11.'
							 OFFSET '.$var_12;

					if(!$var_1->query($var_16, 'array'))
					{
						throw new class_3($var_1->get_last_error());	
					}
					
					$var_20 = $var_1->result();
					$var_22 = $var_1->foundRows();

                    $var_24 = class_2::types();
                    $var_25 = array();

                    for($var_26=0; $var_26 < count($var_24); $var_26++)
                    {
	                    if(is_numeric($var_24[$var_26]['id']))
                            $var_25[$var_24[$var_26]['code']] = $var_24[$var_26]['title'];
	                    else
		                    $var_25[$var_24[$var_26]['id']] = $var_24[$var_26]['title'];
                    }

                    $var_20 = grid_notes::summary($var_20, 'block', 'id');
									
					
					$var_3 = array();								
					for($var_26=0; $var_26 < count($var_20); $var_26++)
					{
						if(empty($var_20[$var_26])) continue;
						
						$var_27 = array(
                            0 => '<img src="img/icons/silk/page_white_go.png" align="absmiddle" title="'.t(254, 'Everybody').'" />',
							1 => '<img src="img/icons/silk/lock.png" align="absmiddle" title="'.t(361, 'Web users only').'" />',
							2 => '<img src="img/icons/silk/user_gray.png" align="absmiddle" title="'.t(363, 'Users who have not yet signed up or signed in').'" />',
                            3 => '<img src="img/icons/silk/group_key.png" align="absmiddle" title="'.t(512, "Selected web user groups").'" />'
						);						
						
						if(empty($var_20[$var_26]['date_published'])) 
							$var_20[$var_26]['date_published'] = '&infin;';
						else
							$var_20[$var_26]['date_published'] = core_ts2date($var_20[$var_26]['date_published'], false);
							
						if(empty($var_20[$var_26]['date_unpublish'])) 
							$var_20[$var_26]['date_unpublish'] = '&infin;';	
						else
							$var_20[$var_26]['date_unpublish'] = core_ts2date($var_20[$var_26]['date_unpublish'], false);
							
						if($var_20[$var_26]['category'] > 0)
							$var_20[$var_26]['category'] = $var_1->query_single(
                                'text',
                                'nv_webdictionary',
                                ' 	node_type = "structure" AND
                                    node_id = "'.$var_20[$var_26]['category'].'" AND
                                    subtype = "title" AND
                                    lang = "'.$var_2->var_132[0].'"
                                '
                            );

						$var_3[$var_26] = array(
							0	=> $var_20[$var_26]['id'],
							1 	=> $var_25[$var_20[$var_26]['type']],
                            2 	=> '<div class="list-row" data-enabled="'.$var_20[$var_26]['enabled'].'">'.$var_20[$var_26]['title'].'</div>',
							3	=> $var_20[$var_26]['date_published'].' - '.$var_20[$var_26]['date_unpublish'],
							4	=> $var_27[$var_20[$var_26]['access']],
							5	=> (($var_20[$var_26]['enabled']==1)? '<img src="img/icons/silk/accept.png" />' : '<img src="img/icons/silk/cancel.png" />'),
                            6 	=> $var_20[$var_26]['_grid_notes_html']
						);
					}
									
					class_7::jqgridJson($var_3, $var_10, $var_12, $var_11, $var_22);
					break;
			}
			
			session_write_close();
			var_29;
			break;
		
		case 'load':
        case 'edit':
		case 2:
			if(!empty($var_35['id']))
			{
				$var_4->load(intval($var_35['id']));	
			}
		
			if(isset($var_35['form-sent']))
			{
				$var_4->load_from_post();
				try
				{
					$var_4->save();
                    class_5::save_properties_from_post('block', $var_4->var_7);
					$var_7 = $var_4->var_7;

					
                    if(!empty($var_4->var_32) && !empty($var_35['blocks-order']))
					    class_2::reorder($var_4->var_32, $var_35['blocks-order'], $var_35['blocks-order-fixed']);

					unset($var_4);
					$var_4 = new class_2();
					$var_4->load($var_7);
                    $var_0->navigate_notification(t(53, "Data saved successfully."), false, false, 'fa fa-check');
				}
				catch(var_18 $var_34) {}
				users_log::action($var_35['fid'], $var_4->var_7, 'save', $var_4->dictionary[$var_2->var_132[0]]['title'], json_encode($var_35));
			}
			else
				users_log::action($var_35['fid'], $var_4->var_7, 'load', $var_4->dictionary[$var_2->var_132[0]]['title']);
		
			$var_3 = blocks_form($var_4);
			break;	

        case 'delete':
		case 4: 
			if(!empty($var_35['id']))
			{
				$var_4->load(intval($var_35['id']));	
				if($var_4->delete() > 0)
				{
                    $var_0->navigate_notification(t(55, 'Item removed successfully.'), false);
                    $var_3 = blocks_list();
				}
				else
				{
					$var_0->navigate_notification(t(56, 'Unexpected error.'), false);
					$var_3 = blocks_form($var_4);
				}
				users_log::action($var_35['fid'], $var_4->var_7, 'remove', $var_4->dictionary[$var_2->var_132[0]]['title']);
			}
			break;

        case 'duplicate':
            if(!empty($var_35['id']))
            {
                $var_4->load(intval($var_35['id']));

                $var_36 = class_5::load_properties_associative(
                    'block', $var_4->var_32,
                    'block', $var_4->var_7
                );

                
                $var_4->var_7 = 0;
                $var_37 = $var_4->insert();

                if($var_37)
                {
                    
                    $var_37 = class_5::save_properties_from_array('block', $var_4->var_7, $var_4->var_32, $var_36);
                }

                if($var_37)
                {
                    $var_0->navigate_notification(t(478, 'Item duplicated successfully.'), false, false, 'fa fa-check');
                    $var_3 = blocks_form($var_4);
                }
                else
                {
                    $var_0->navigate_notification(t(56, 'Unexpected error.'), false);
                    $var_4 = new class_2();
                    $var_4->load(intval($var_35['id']));
                    $var_3 = blocks_form($var_4);
                }

                users_log::action($var_35['fid'], $var_4->var_7, 'duplicate', $var_4->dictionary[$var_2->var_132[0]]['title'], json_encode($var_35));
            }
            break;

        case 'path':
		case 5:	
			$var_1->query('SELECT path as id, path as label, path as value
						  FROM nv_paths
						 WHERE path LIKE '.protect('%'.$var_35['term'].'%').' 
						   AND website = '.$var_2->var_7.'
				      ORDER BY path ASC
					     LIMIT 10',
						'array');
						
			
							  
			core_terminate();		
			break;

        case 'block_groups_list':
            $var_3 = block_groups_list();
            break;

        case 'block_groups_json':	
			$var_10 = intval($var_35['page']);
			$var_11	= intval($var_35['rows']);
			$var_12 = ($var_10 - 1) * $var_11;

			list($var_39, $var_22) = class_4::paginated_list($var_12, $var_11, $var_35['sidx'], $var_35['sord']);

            $var_39 = grid_notes::summary($var_39, 'block_group', 'id');

            
            foreach($var_39 as $var_40)
            {
                if(substr($var_40['blocks'], 0, 2)=='a:') 
                    $var_40['blocks']	= mb_unserialize($var_40['blocks']);
                else 
                    $var_40['blocks']  = json_decode($var_40['blocks'], true);

                $var_20[] = array(
                    'id' => $var_40['id'],
                    'code' => $var_40['code'],
                    'title' => $var_40['title'],
                    'blocks' => count($var_40['blocks']),
                    'notes' => $var_40['_grid_notes_html']
                );
            }

			class_7::jqgridJson($var_20, $var_10, $var_12, $var_11, $var_22, 'id');

			session_write_close();
			var_29;
			break;

        case 'block_group_edit':
            $var_4 = new class_4();

            if(!empty($var_35['id']))
            {
                $var_4->load(intval($var_35['id']));
            }

            if(isset($var_35['form-sent']))
            {
                $var_4->load_from_post();
                try
                {
                    $var_4->save();
                    $var_0->navigate_notification(t(53, "Data saved successfully."), false, false, 'fa fa-check');
                }
                catch(var_18 $var_34) {}
                users_log::action($var_35['fid'], $var_4->var_7, 'save', $var_4->var_42, json_encode($var_35));
            }
            else if(!empty($var_35['id']))
                users_log::action($var_35['fid'], $var_4->var_7, 'edit', $var_4->var_42);

			$var_3 = block_group_form($var_4);
			break;

        case 'block_group_delete':
            $var_4 = new class_4();
            if(!empty($var_35['id']))
            {
                $var_4->load(intval($var_35['id']));
                if($var_4->delete() > 0)
                {
                    $var_0->navigate_notification(t(55, 'Item removed successfully.'), false);
                    $var_3 = block_groups_list();
                }
                else
                {
                    $var_0->navigate_notification(t(56, 'Unexpected error.'), false);
                    $var_3 = block_group_form($var_4);
                }
                users_log::action($var_35['fid'], $var_4->var_7, 'remove', $var_4->var_42);
            }
			break;

        case 'block_types_list':
			$var_3 = blocks_types_list();
			break;
			
		case 'block_types_json':	
			$var_10 = intval($var_35['page']);
			$var_11	= intval($var_35['rows']);
			$var_12 = ($var_10 - 1) * $var_11;
		
			$var_39 = class_2::types($var_35['sidx'], $var_35['sord']);

            $var_43 = class_2::modes();

            
            foreach($var_39 as $var_40)
            {
                $var_20[] = array(
                    'id' => $var_40['id'],
                    'type' => $var_43[$var_40['type']],
                    'code' => $var_40['code'],
                    'title' => $var_40['title'],
                    'width' => $var_40['width'],
                    'height' => $var_40['height']
                );
            }

			$var_22 = count($var_20);
			class_7::jqgridJson($var_20, $var_10, $var_12, $var_11, $var_22, 'id');
		
			session_write_close();
			var_29;
			break;			

        case 'block_type_edit':
		case 82: 

			$var_4 = NULL;
            $var_44 = NULL;
            $var_45 = 0;

			$var_20 = class_2::custom_types();
			for($var_26=0; $var_26 < count($var_20); $var_26++)
			{
                if($var_20[$var_26]['id'] > $var_45)
                    $var_45 = $var_20[$var_26]['id'];

				if($var_20[$var_26]['id'] == $var_35['id'])
				{
					$var_4 = $var_20[$var_26];
                    $var_44 = $var_26;
				}
			}

			if(empty($var_4))
			{
				$var_0->navigate_notification(t(599, "Sorry, can't display a theme block type info."));
				$var_3 = blocks_types_list();
			}
			else
			{
	            if(isset($var_35['form-sent']))
				{
					if(empty($var_4))
						$var_4 = array('id' => $var_45 + 1);

					$var_4['type'] = $var_35['type'];
					$var_4['title'] = $var_35['title'];
	                $var_4['code'] = $var_35['code'];
					$var_4['width'] = $var_35['width'];
					$var_4['height'] = $var_35['height'];
					$var_4['order'] = $var_35['order'];
					$var_4['maximum'] = $var_35['maximum'];
					$var_4['notes'] = pquotes($var_35['notes']);

					if(!is_null($var_44))
						$var_20[$var_44] = $var_4;
	                else
	                    $var_20[] = $var_4;

					try
					{
						
						$var_37 = class_2::types_update($var_20);
                        $var_0->navigate_notification(t(53, "Data saved successfully."), false, false, 'fa fa-check');
					}
					catch(var_18 $var_34) {}
				}

				$var_3 = blocks_type_form($var_4);
			}

			break;

        case 'block_type_delete':
		case 84: 
            $var_20 = class_2::custom_types();
			$var_4 = NULL;
			
			for($var_26=0; $var_26 < count($var_20); $var_26++)
			{
				if($var_20[$var_26]['id'] == $var_35['id'])
				{
					unset($var_20[$var_26]);
					break;
				}
			}
			
			try
			{													
				class_2::types_update($var_20);
                $var_0->navigate_notification(t(55, 'Item removed successfully.'), false);
                $var_3 = blocks_types_list();
			}
			catch(var_18 $var_34) {}
			break;

        case 'block_property_load':
            $var_46 = new class_5();

            if(!empty($var_35['id']))
            {
                if(is_numeric($var_35['id']))
                    $var_46->load(intval($var_35['id']));
                else
                    $var_46->load_from_theme($var_35['id'], null, 'block', $var_35['block']);
            }

            header('Content-type: text/json');

            $var_48 = class_5::types();
            $var_46->var_49 = $var_48[$var_46->var_32];

            

            session_write_close();
            var_29;
            break;

        case 'block_property_save': 

            $var_46 = new class_5();

            if(!empty($var_35['property-id']))
                $var_46->load(intval($var_35['property-id']));

            $var_46->load_from_post();
            $var_46->save();

            header('Content-type: text/json');

            $var_48 = class_5::types();
            $var_46->var_49 = $var_48[$var_46->var_32];

            

            session_write_close();
            var_29;
            break;

        case 'block_property_remove': 

            $var_46 = new class_5();

            if(!empty($var_35['property-id']))
                $var_46->load(intval($var_35['property-id']));

            $var_46->delete();

            session_write_close();
            var_29;
            break;

        case 'block_group_block_options':
            $var_50 = null;
            $var_41 = $var_35['block_group'];
            $var_51 = $var_35['code'];
            $var_52 = $var_35['block_uid'];

            if(isset($var_35['form-sent']))
                $var_50 = class_5::save_properties_from_post('block_group_block', $var_51, $var_41, $var_51, $var_52);

            $var_3 = fn_2($var_41, $var_51, $var_52, $var_50);

            

            core_terminate();
            break;

        case 'block_group_extension_block_options':
            $var_50 = null;
            $var_41 = $var_35['block_group'];    
            $var_53 = $var_35['block_id'];          
            $var_52 = $var_35['block_uid'];        
            $var_54 = $var_35['block_extension'];    

            if(isset($var_35['form-sent']))
                $var_50 = class_5::save_properties_from_post('extension_block', $var_41, $var_53, null, $var_52);

            $var_3 = fn_3($var_41, $var_54, $var_53, $var_52, $var_50);

            

            core_terminate();
            break;

        case 'list':
		case 0:
		default:			
			$var_3 = blocks_list();
			break;
	}
	
	return $var_3;
}

function var_55()
{
    global $var_0;
    global $var_56;
    global $var_57;

	$var_58 = new class_6();
	$var_59 = new class_7();
	
	$var_58->title(t(23, 'Blocks'));

    

    $var_60 = array();
    list($var_61, $var_62) = class_4::paginated_list(0, 10, 'title', 'desc');

    if($var_62 > 0 && $var_62 <= 10)
    {
        foreach($var_61 as $var_63)
            $var_60[] = '<a class="ui-menu-action-bigger" href="?fid=blocks&act=block_group_edit&id='.$var_63['id'].'"><i class="fa fa-fw fa-caret-right"></i> '.$var_63['title'].'</a>';

        $var_56->add_actions(
            'blocks',
            array(
                'item' => null,
                'navibars' => &$var_58
            ),
            $var_60,
            '<a class="content-actions-submenu-trigger" href="?fid=blocks&act=block_groups_list">
                <img height="16" align="absmiddle" width="16" src="img/icons/silk/bricks.png"> '.t(506, 'Groups').' &
            </a>'
        );
    }

    $var_58->add_actions(
        array(
            (!empty($var_60)? '' : '<a href="?fid=blocks&act=block_groups_list"><img height="16" align="absmiddle" width="16" src="img/icons/silk/bricks.png"> '.t(506, 'Groups').'</a>'),
            '<a href="?fid=blocks&act=block_types_list"><img height="16" align="absmiddle" width="16" src="img/icons/silk/brick_edit.png"> '.t(167, 'Types').'</a>'
        )
    );

	$var_58->add_actions(
        array(
            '<a href="?fid=blocks&act=edit"><img height="16" align="absmiddle" width="16" src="img/icons/silk/add.png"> '.t(38, 'Create').'</a>',
			'<a href="?fid=blocks&act=list"><img height="16" align="absmiddle" width="16" src="img/icons/silk/application_view_list.png"> '.t(39, 'List').'</a>',
			'search_form'
        )
    );
	
	if(@$var_35['quicksearch']=='true')
		$var_59->setInitialURL("?fid=blocks&act=json&_search=true&quicksearch=".$var_35['navigate-quicksearch']);
	
	$var_59->setURL('?fid=blocks&act=json');
	$var_59->sortBy('date_modified', 'desc');
	$var_59->setDataIndex('id');
	$var_59->setEditUrl('id', '?fid=blocks&act=edit&id=');
	$var_59->enableSearch();
	if($var_57->permission("blocks.delete") == 'true')
		$var_59->enableDelete();
	$var_59->setGridNotesObjectName("block");
	
	$var_59->addCol("ID", 'id', "40", "true", "left");	
	$var_59->addCol(t(160, 'Type'), 'type', "120", "true", "center");	
	$var_59->addCol(t(67, 'Title'), 'title', "400", "true", "left");	
	$var_59->addCol(t(85, 'Date published'), 'dates', "100", "true", "center");	
	$var_59->addCol(t(364, 'Access'), 'access', "40", "true", "center");	
	$var_59->addCol(t(65, 'Enabled'), 'enabled', "40", "true", "center");
    $var_59->addCol(t(168, 'Notes'), 'note', "50", "false", "center");

    $var_59->setLoadCallback('
        if($("
        {
            $("
            $("
            	.button()
            	.css(
            	{
                	"float": "right",
                	"margin-top": "0px",
                	"padding": "0px"
            	})
            	.on("click", function(e)
            	{
            	    e.stopPropagation();
            	    e.preventDefault();
            	    setTimeout(blocks_list_choose_types, 150);
                });

            $("
        }
    ');

    
    $var_24 = class_2::types('title');
    $var_76 = array_map(
        function($var_77) { return '<li data-value="'.$var_77['id'].'">'.$var_77['title'].'</li>';  },
        $var_24
    );
    

    $var_58->add_content('<div id="filter_types_window" style="display: none;"><ul>'.implode("\n", $var_76).'</ul></div>');
    $var_0->add_script('$("
    $layout->add_script('
        $("
            popup: false,
            absolutePosition: true,
            width: 0,
            listWidth: 300,
            listMaxHeight: 400,
            onItemClick: function(nval, li, selected_before, selected_after)
            {            
                selected_after = selected_after.join(",");
                var filters = {
                    "var_80" : "AND",
                    "rules": [
                        {
                            "field" : "type",
                            "op" : "in",
                            "data" : selected_after
                        },
                        {
                            "field" : "title",
                            "op" : "cn",
                            "data" : $("
                        }
                    ]
                };

                $("
                    "setGridParam",
                    {
                        var_81: true,
                        postData: { "filters": filters }
                    }
                ).trigger("reloadGrid");
            }
        });');

    $layout->add_script('
        function fn_1()
        {
            $("
            {
                $("
            });

            $("
            $(".var_82").var_83({"position": "absolute"});
            $(".jAutochecklist_list").css($("
            $(".var_84").hide();
            $(".jAutochecklist_list").var_83({
                "border-radius": "8px",
                "margin-left": "-150px",
                "margin-top": "16px"
            });
            $(".jAutochecklist_list").addClass("navi-ui-widget-shadow ui-menu ui-widget ui-widget-content ui-corner-all");

            return false;
        }
    ');
	
	$navibars->add_content($navitable->generate());	
	
	return $navibars->generate();
}

function blocks_form($item)
{
	global $user;
	global $DB;
	global $website;
	global $layout;
    global $events;
    global $theme;

    $current_version = $_SESSION['var_85'];
    $var_86 = array();
	
	$var_58 = new class_6();
	$var_87 = new class_8();	
	$var_0->navigate_media_browser();	
    $var_0->navigate_editorfield_link_dialog();
		
	if(empty($var_4->var_7))
		$var_58->title(t(23, 'Blocks').' / '.t(38, 'Create'));	
	else
		$var_58->title(t(23, 'Blocks').' / '.t(170, 'Edit').' ['.$var_4->var_7.']');			

		$var_58->add_actions(
		array(
			'<a href="
				<img height="16" align="absmiddle" width="16" src="img/icons/silk/images.png"> '.t(36, 'Media').'
			</a>'
		)
	);

    $var_0->add_script("
        $(document).on('keydown.ctrl_s', function (evt) { navigate_tabform_submit(1); return false; } );
        $(document).on('keydown.ctrl_m', function (evt) { navigate_media_browser(); return false; } );
    ");
	

    if(!empty($var_4->var_7))
    {
        $var_90 = grid_notes::comments('block', $var_4->var_7);
        $var_58->add_actions(
            array(
                '<a href="
            )
        );
    }

	if(empty($item->id))
	{
		$navibars->add_actions(
            array(
	            ($user->permission('var_91.var_92')=='true'?
	            '<a href="
					<img height="16" align="absmiddle" width="16" src="img/icons/silk/accept.png"> '.t(34, 'Save').'
				</a>' : "")
            )
        );
	}
	else
	{
		$var_58->add_actions(
            array(
	            (($var_57->permission('blocks.edit') == 'true') ?
	            '<a href="
					<img height="16" align="absmiddle" width="16" src="img/icons/silk/accept.png"> '.t(34, 'Save').'
				</a>' : ""),
	            ($var_57->permission("blocks.delete") == 'true' ?
                '<a href="
					<img height="16" align="absmiddle" width="16" src="img/icons/silk/cancel.png"> '.t(35, 'Delete').'
				</a>' : "")
            )
        );

        $var_0->add_script('
            function navigate_delete_dialog()
            {
                navigate_confirmation_dialog(
                    function() { window.location.href = "?fid=blocks&act=delete&id='.$var_4->var_7.'"; }, 
                    null, null, "'.t(35, 'Delete').'"
                );
            }
        ');

        if($var_57->permission("blocks.create") == 'true')
            $var_86[] = '<a href="?fid=blocks&act=duplicate&id='.$var_4->var_7.'" onclick="$(this).attr(\'
    }

    array_unshift($extra_actions, '<var_93 var_94="?fid=blocks&act=block_types_list"><var_95 var_96="16" var_97="var_98" var_99="16" var_100="var_95/var_101/var_102/var_103.var_104"> '.t(167, 'var_105').'</a>');

    $var_56->add_actions(
        'blocks',
        array(
            'item' => null,
            'navibars' => &$var_58
        ),
        $var_86
    );

    $var_60 = array();
    list($var_61, $var_62) = class_4::paginated_list(0, 10, 'title', 'desc');

    if($var_62 > 0 && $var_62 <= 10)
    {
        foreach($var_61 as $var_63)
            $var_60[] = '<a href="?fid=blocks&act=block_group_edit&id='.$var_63['id'].'"><i class="fa fa-fw fa-caret-right"></i> '.$var_63['title'].'</a>';

        $var_56->var_64(
            'blocks',
            array(
                'item' => null,
                'navibars' => &$var_58
            ),
            $var_60,
            '<a class="content-actions-submenu-trigger" href="?fid=blocks&act=block_groups_list"><img height="16" align="absmiddle" width="16" src="img/icons/silk/bricks.png"> '.t(506, 'Groups').' &
        );
    }
    else
    {
        $navibars->add_actions(
            array(
                '<var_93 var_94="?fid=blocks&act=block_groups_list"><var_95 var_96="16" var_97="var_98" var_99="16" var_100="var_95/var_101/var_102/var_106.var_104"> '.t(506, 'var_107').'</a>'
            )
        );
    }
	
	$var_58->add_actions(
		array(
			(!empty($var_4->var_7)? '<a href="?fid=blocks&act=edit"><img height="16" align="absmiddle" width="16" src="img/icons/silk/add.png"> '.t(38, 'Create').'</a>' : ''),
			'<a href="?fid=blocks&act=list"><img height="16" align="absmiddle" width="16" src="img/icons/silk/application_view_list.png"> '.t(39, 'List').'</a>',
			'search_form'
		)
	);

    if(!empty($var_4->var_7))
        $var_0->navigate_notes_dialog('block', $var_4->var_7);

	$var_58->form(NULL, '?fid=blocks&act=edit&id='.$var_4->var_7);

    $var_58->add_content('
        <script type="text/javascript" src="lib/packages/blocks/blocks.js?r='.$var_85->var_110.'"></script>
    ');

	$var_58->add_tab(t(43, "Main"));
	
	$var_58->add_tab_content($var_87->hidden('form-sent', 'true'));
	$var_58->add_tab_content($var_87->hidden('id', $var_4->var_7));
	
	$var_58->add_tab_content_row(
        array(
            '<label>ID</label>',
			'<span>'.(!empty($var_4->var_7)? $var_4->var_7 : t(52, '(new)')).'</span>'
        )
    );

	$var_24 = class_2::types();
	$var_115 = array();
	$var_116 = array();	
	
	for($var_26=0; $var_26 < count($var_24); $var_26++)
	{
        if($var_4->var_32 == $var_24[$var_26]['code'])
            $var_117 = $var_24[$var_26]['width'];

		$var_118 = '';

		if(!empty($var_24[$var_26]['width']) || !empty($var_24[$var_26]['height']))
		{
	        if(empty($var_24[$var_26]['width'])) $var_24[$var_26]['width'] = '***';
			if(empty($var_24[$var_26]['height'])) $var_24[$var_26]['height'] = '***';

			$var_118 = ' ('.$var_24[$var_26]['width'].' x '.$var_24[$var_26]['height'].' px)';
		}

		if(is_numeric($var_24[$var_26]['id']))
			$var_115[] = $var_24[$var_26]['code'];     
		else
			$var_115[] = $var_24[$var_26]['id'];       

		$var_116[] = $var_24[$var_26]['title'].$var_118;
	}

	$var_58->add_tab_content_row(
        array(
            '<label>'.t(160, 'Type').'</label>',
			$var_87->selectfield('type', $var_115, $var_116, $var_4->var_32)
        )
    );
										
	$var_58->add_tab_content_row(
        array(
            '<label>'.t(85, 'Date published').'</label>',
			$var_87->datefield('date_published', $var_4->var_121, true),
        )
    );
										
	$var_58->add_tab_content_row(
        array(
            '<label>'.t(90, 'Date unpublished').'</label>',
			$var_87->datefield('date_unpublish', $var_4->var_122, true),
        )
    );

	
	if(!empty($var_4->var_90))
	{
		$var_58->add_tab_content_row(
	        array(
	            '<label>'.t(168, 'Notes').'</label>',
				$var_87->textarea('notes', $var_4->var_90)
	        )
	    );
	}

    $var_58->add_tab_content_row(
        array(
            '<label>'.t(364, 'Access').'</label>',
            $var_87->selectfield(
                'access',
                array(
                    0 => 0,
                    1 => 2,
                    2 => 1,
                    3 => 3
                ),
                array(
                    0 => t(254, 'Everybody'),
                    1 => t(362, 'Not signed in'),
                    2 => t(361, 'Web users only'),
                    3 => t(512, 'Selected web user groups')
                ),
                $var_4->var_27,
                'navigate_webuser_groups_visibility($(this).val());',
                false,
                array(
                    1 => t(363, 'Users who have not yet signed in')
                )
            )
        )
    );


    $var_124 = webuser_group::all_in_array();

    $var_58->add_tab_content_row(
        array(
            '<label>'.t(506, "Groups").'</label>',
            $var_87->multiselect(
                'groups',
                array_keys($var_124),
                array_values($var_124),
                $var_4->var_126
            )
        ),
        'webuser-groups-field'
    );

    $var_0->add_script('
        function navigate_webuser_groups_visibility(access_value)
        {
            if(access_value==3)
                $("
            else
                $("
        }

        navigate_webuser_groups_visibility('.$var_4->var_27.');
    ');

	if(empty($var_4->var_7)) $var_4->var_127 = true;
										
	$var_58->add_tab_content_row(
        array(
            '<label>'.t(65, 'Enabled').'</label>',
		    $var_87->checkbox('enabled', $var_4->var_127),
	    )
    );

	if($var_4->var_129 > 0)
	{
		$var_58->add_tab_content_row(
			array(
				'<label>'.t(227, 'Date modified').'</label>',
				core_ts2date($var_4->var_129, true)
			)
		);
	}

	$var_58->add_tab(t(9, "Content"));

    switch($var_4->var_130)
    {
        case 'poll':
            $var_131 = array();
            foreach($var_2->var_132 as $var_133)
                $var_131[$var_133] = language::name_by_code($var_133);

            $var_58->add_tab_content_row(
                array(
                    '<label>'.t(63, 'Languages').'</label>',
                    $var_87->buttonset('language_selector', $var_131, $var_2->var_132[0], "navigate_items_select_language(this);")
                )
            );

            foreach($var_2->var_132 as $var_133)
            {
                $var_58->add_tab_content('
                    <div class="language_fields" id="language_fields_'.$var_133.'" style=" display: none; ">
                ');

                $var_58->add_tab_content_row(
                    array(
                        '<label>'.t(558, 'Question').'</label>',
                        $var_87->textfield('title-'.$var_133, @$var_4->dictionary[$var_133]['title']),
                        ''
                    )
                );

                
                $var_136 = new class_9("poll_answers_table_".$var_133);
                $var_136->setWidth("330px");
                $var_136->setHiddenInput("poll-answers-table-order-".$var_133);
                $var_58->add_tab_content(
                    $var_87->hidden("poll-answers-table-order-".$var_133, "")
                );

                $var_136->addHeaderColumn(t(67, 'Title'), 200);
                
                $var_136->addHeaderColumn(t(352, 'Votes'), 80);
                $var_136->addHeaderColumn(t(35, 'Remove'), 50);

                if(!empty($var_4->var_151[$var_133]))
                {
                    $var_140 = $var_4->var_151[$var_133];

                    foreach($var_140 as $var_141)
                    {
                        $var_142 = uniqid();
                        $var_136->addRow(
                            "poll-answers-table-row-".$var_142,
                            array(
                                array('content' => '<input type="text" name="poll-answers-table-title-'.$var_133.'['.$var_142.']" value="'.$var_141['title'].'" style="width: 200px;" />', 'align' => 'left'),
                                
                                array('content' => '<input type="text" name="poll-answers-table-votes-'.$var_133.'['.$var_142.']" value="'.intval($var_141['votes']).'" style="width: 80px;" />', 'align' => 'left'),
                                array('content' => '<img src="'.var_144.'/img/icons/silk/cancel.png" style="cursor: pointer;" onclick="navigate_blocks_poll_answers_table_row_remove(this);" />', 'align' => 'center')
                            )
                        );
                    }
                }

                $var_142 = uniqid();
                $var_136->addRow(
                    "poll-answers-table-row-model-".$var_133,
                    array(
                        array('content' => '<input type="text" name="poll-answers-table-title-'.$var_133.'['.$var_142.']" value="" style="width: 200px;" />', 'align' => 'left'),
                        
                        array('content' => '<input type="text" name="poll-answers-table-votes-'.$var_133.'['.$var_142.']" value="0" style="width: 80px;" />', 'align' => 'left'),
                        array('content' => '<img src="'.var_144.'/img/icons/silk/cancel.png" style="cursor: pointer;" onclick="navigate_blocks_poll_answers_table_row_remove(this);" />', 'align' => 'center')
                    )
                );

                $var_58->add_tab_content_row(
                    array(
                        '<label>'.t(559, "Answers").'</label>',
                        '<div id="poll-answers-'.$var_133.'">'.$var_136->generate().'</div>',
                        '<label>&nbsp;</label>',
                        '<button id="poll-answers-table-add-'.$var_133.'" data-lang="'.$var_133.'"><img src="img/icons/silk/add.png" align="absmiddle" style="cursor:pointer;" /> '.t(472, 'Add').'</button>'
                    )
                );

                $var_58->add_tab_content('
                    </div>
                ');
            }

            foreach($var_2->var_132 as $var_146)
            {
                $var_0->add_script('
                    $(window).on("load", function()
                    {
                        poll_answers_table_row_models["'.$var_146.'"] = $("
                        if($("
                            $("
                        navigate_naviorderedtable_poll_answers_table_'.$var_146.'_reorder();
                    });
                ');
            }

            $var_0->add_script('
                var active_languages = ["'.implode('", "', array_keys($var_131)).'"];
                navigate_items_select_language("'.$var_2->var_132[0].'");
            ');
            break;

        case 'block':
        case 'theme':
        default:
            $var_131 = array();
            foreach($var_2->var_132 as $var_133)
                $var_131[$var_133] = language::name_by_code($var_133);

            $var_58->add_tab_content_row(
                array(
                    '<label>'.t(63, 'Languages').'</label>',
                    $var_87->buttonset('language_selector', $var_131, $var_2->var_132[0], "navigate_items_select_language(this);")
                )
            );

            foreach($var_2->var_132 as $var_133)
            {
                $var_58->add_tab_content('<div class="language_fields" id="language_fields_'.$var_133.'" style=" display: none; ">');

                $var_58->add_tab_content_row(
                    array(
                        '<label>'.t(67, 'Title').'</label>',
                        $var_87->textfield('title-'.$var_133, @$var_4->dictionary[$var_133]['title']),
                        ''
                    )
                );

	            $var_147 = array(
		            '' => t(181, 'Hidden'),
		            'title' => t(67, 'Title'),
		            'content' => t(9, 'Content'),
                    'image' => t(157, 'Image'),
                    'rollover' => t(182, 'Rollover'),
                    'video' => t(272, 'Video'),
                    'html' => 'HTML',
		            'links' => t(549, 'Links'),
		            'flash' => 'Flash'
	            );

	            
	            if(is_array($var_148->var_91))
	            {
		            foreach($var_148->var_91 as $var_149)
		            {
                        
                        if(!isset($var_149->var_7) && isset($var_149->var_150))
                            $var_149->var_7 = $var_149->var_150;

                        if($var_149->var_7 == $var_4->var_32 && isset($var_149->var_151))
			            {
				            if(!is_array($var_149->var_151))
					            $var_149->var_151 = array($var_149->var_151);

				            foreach($var_147 as $var_152 => $var_153)
				            {
					            if(empty($var_152) || in_array($var_152, $var_149->var_151))
					                continue;

					            unset($var_147[$var_152]);
				            }

				            $var_147 = array_filter($var_147);
			            }
		            }
	            }

                $var_58->add_tab_content_row(array(
                        '<label>'.t(160, 'Type').'</label>',
                        $var_87->selectfield('trigger-type-'.$var_133,
                            array_keys($var_147),
                            array_values($var_147),
                            $var_4->var_151['trigger-type'][$var_133],
                            "navigate_blocks_trigger_change('".$var_133."', this);"
                        )
                    )
                );

                $var_58->add_tab_content_row(
                    array(
                        '<label>'.t(157, 'Image').'</label>',
                        $var_87->dropbox('trigger-image-'.$var_133, @$var_4->var_151['trigger-image'][$var_133], 'image')
                    )
                );

                $var_58->add_tab_content_row(
                    array(
                        '<label>'.t(182, 'Rollover').' (off / on)</label>',
                        $var_87->dropbox('trigger-rollover-'.$var_133, @$var_4->var_151['trigger-rollover'][$var_133], 'image'),
                        $var_87->dropbox('trigger-rollover-active-'.$var_133, @$var_4->var_151['trigger-rollover-active'][$var_133], 'image'),
                        ''
                    )
                );

                $var_58->add_tab_content_row(
                    array(
                        '<label>'.t(272, 'Video').'</label>',
                        $var_87->dropbox('trigger-video-'.$var_133, @$var_4->var_151['trigger-video'][$var_133], 'video')
                    )
                );

                $var_58->add_tab_content_row(
                    array(
                        '<label>Flash (SWF)</label>',
                        $var_87->dropbox('trigger-flash-'.$var_133, @$var_4->var_151['trigger-flash'][$var_133], 'flash'),
                        ''
                    )
                );

                

                
                $var_155 = '';
                if(!empty($var_148) && !empty($var_148->var_91))
                {
                    foreach($var_148->var_91 as $var_149)
                    {
                        if($var_4->var_32 == $var_149->var_7)
                        {
                            $var_155 = @$var_149->var_101;
                            break;
                        }
                    }
                }

                $var_136 = new class_9("trigger_links_table_".$var_133);
                $var_136->setWidth("776px");
                $var_136->setHiddenInput("trigger-links-table-order-".$var_133);
                $var_58->add_tab_content( $var_87->hidden("trigger-links-table-order-".$var_133, "") );

                $var_136->addHeaderColumn(t(242, 'Icon'), 50);
                $var_136->addHeaderColumn(t(67, 'Title'), 180);
                $var_136->addHeaderColumn(t(197, 'Link'), 390);
                $var_136->addHeaderColumn('<i class="fa fa-lg fa-fw fa-external-link" title="'.t(324, 'New window').'"></i>', 16);
                $var_136->addHeaderColumn('<i class="fa fa-lg fa-fw fa-globe" title="'.t(364, 'Access').'"></i>', 20);
                $var_136->addHeaderColumn(t(35, 'Remove'), 50);


				if(empty($var_4->var_151['trigger-links'][$var_133]['link']))
				{
					
					$var_4->var_151['trigger-links'][$var_133] = array(
						'order' => '',
						'icon' => '',
						'title' => array('0' => ''),
						'access' => array('0' => 0),
						'link' => array('0' => '')
					);
				}

                if(!empty($var_4->var_151['trigger-links'][$var_133]))
                {
                    $var_156 = $var_4->var_151['trigger-links'][$var_133];

                    foreach($var_156['link'] as $var_157 => $var_158)
                    {
                        $var_142 = uniqid();
                        $var_136->addRow(
                            uniqid('trigger-links-table-row-'),
                            array(
	                            ( empty($var_155)?
	                                array('content' => '-', 'align' => 'center') :
	                                array('content' => '<select name="trigger-links-table-icon-'.$var_133.'['.$var_142.']" data-select2-value="'.$var_156['icon'][$var_157].'"  data-role="icon" style="width: 190px;"></select>', 'align' => 'left')
                                ),
                                array('content' => '<input type="text" name="trigger-links-table-title-'.$var_133.'['.$var_142.']" value="'.$var_156['title'][$var_157].'" data-role="title" style="width: 250px;" />', 'align' => 'left'),
                                array('content' => '<input type="text" name="trigger-links-table-link-'.$var_133.'['.$var_142.']" value="'.$var_156['link'][$var_157].'" data-role="link" style="width: 260px;" />'.
                                                   '<a class="uibutton naviforms-pathfield-trigger"><i class="fa fa-sitemap"></i></a>',
                                      'align' => 'left',
                                      'style' => 'white-space: nowrap;'
                                ),
                                array('content' => '<input type="checkbox" name="trigger-links-table-new_window-'.$var_133.'['.$var_142.']" data-role="target" id="trigger-links-table-new_window-'.$var_133.'['.$var_142.']" value="1" '.($var_156['new_window'][$var_157]=='1'? 'checked="checked"' : '').' />
                                                    <label for="trigger-links-table-new_window-'.$var_133.'['.$var_142.']" />',
                                      'align' => 'left'),
                                array('content' => '<input type="hidden" name="trigger-links-table-access-'.$var_133.'['.$var_142.']" data-role="access" id="trigger-links-table-access-'.$var_133.'['.$var_142.']" value="'.value_or_default($var_156['access'][$var_157], 0).'" />
                                                    <i class="fa fa-fw fa-lg fa-eye '.($var_156['access'][$var_157]=='1'? 'hidden' : '').'" onclick="navigate_blocks_trigger_links_table_row_access(this);" data-value="0" for="trigger-links-table-access-'.$var_133.'['.$var_142.']"></i>
                                                    <i class="fa fa-fw fa-lg fa-eye-slash '.($var_156['access'][$var_157]=='1'? '' : 'hidden').'" onclick="navigate_blocks_trigger_links_table_row_access(this);" data-value="1" for="trigger-links-table-access-'.$var_133.'['.$var_142.']"></i>',
                                      'align' => 'center'),
                                array('content' => '<img src="'.var_144.'/img/icons/silk/cancel.png" style="cursor: pointer;" onclick="navigate_blocks_trigger_links_table_row_remove(this);" />', 'align' => 'center')
                            )
                        );
                    }
                }

                $var_142 = uniqid();
                $var_136->addRow(
                    "trigger-links-table-row-model-".$var_133,
                    array(
	                    ( empty($var_155)?
                            array('content' => '-', 'align' => 'center') :
                            array('content' => '<select name="trigger-links-table-icon-'.$var_133.'['.$var_142.']" data-select2-value="" data-role="icon" style="width: 190px;"></select>', 'align' => 'left')
                        ),
                        array('content' => '<input type="text" name="trigger-links-table-title-'.$var_133.'['.$var_142.']" value="" data-role="title" style="width: 250px;" />', 'align' => 'left'),
                        array('content' => '<input type="text" name="trigger-links-table-link-'.$var_133.'['.$var_142.']" value="" data-role="link" style="width: 260px;" />'.
											 '<a class="uibutton naviforms-pathfield-trigger"><i class="fa fa-sitemap"></i></a>',
                              'align' => 'left'
						),
                        array('content' => '<input type="checkbox" name="trigger-links-table-new_window-'.$var_133.'['.$var_142.']"  data-role="target" id="trigger-links-table-new_window-'.$var_133.'['.$var_142.']" value="1" />
                                            <label for="trigger-links-table-new_window-'.$var_133.'['.$var_142.']" />',
                              'align' => 'left'),
                        array('content' => '<input type="hidden" name="trigger-links-table-access-'.$var_133.'['.$var_142.']" data-role="access" id="trigger-links-table-access-'.$var_133.'['.$var_142.']" value="0" />
                                                    <i class="fa fa-fw fa-lg fa-eye" onclick="navigate_blocks_trigger_links_table_row_visibility(this);" data-value="0"  for="trigger-links-table-access-'.$var_133.'['.$var_142.']"></i>
                                                    <i class="fa fa-fw fa-lg fa-eye-slash hidden" onclick="navigate_blocks_trigger_links_table_row_visibility(this);" data-value="1"  for="trigger-links-table-access-'.$var_133.'['.$var_142.']"></i>',
                              'align' => 'center'),
                        array('content' => '<img src="'.var_144.'/img/icons/silk/cancel.png" style="cursor: pointer;" onclick="navigate_blocks_trigger_links_table_row_remove(this);" />', 'align' => 'center')
                    )
                );

                $var_58->add_tab_content_row(
                    array(
                        '<label>'.t(549, "Links").'</label>',
                        '<div id="trigger-links-'.$var_133.'">'.$var_136->generate().'</div>',
                        '<label>&nbsp;</label>',
                        '<button id="trigger-links-table-add-'.$var_133.'" data-lang="'.$var_133.'"><img src="img/icons/silk/add.png" align="absmiddle" style="cursor:pointer;" /> '.t(472, 'Add').'</button>'
                    )
                );

                $var_58->add_tab_content_row(
                    array(
                        '<label>HTML</label>',
                        $var_87->scriptarea('trigger-html-'.$var_133, @$var_4->var_151['trigger-html'][$var_133]),
                        ''
                    )
                );

				$var_160 = "";
                if(!empty($var_117))
				{
					if($var_117 > 500)
                    	$var_160 = $var_117.'px';
					else
						$var_160 = '500px';
				}

                $var_161 = '';
                if(!empty($var_162))
                {
                    $var_163 = array();
                    $var_164 = array();

                    foreach($var_162 as $var_165)
                    {
                        if($var_165['enabled']=='0') continue;
                        $var_163[] = $var_165['title'];
                        $var_164[] = 'javascript: navigate_tinymce_translate_'.$var_165['code'].'(\'trigger-content-'.$var_133.'-'.$var_133.'\', \''.$var_133.'\');';
                    }

                    if(!empty($var_164))
                    {
                        $var_161 = $var_87->splitbutton(
                            'translate_'.$var_133,
                            '<img src="img/icons/silk/comment.png" align="absmiddle"> '.t(188, 'Translate'),
                            $var_164,
                            $var_163
                        );
                    }
                }

                $var_58->add_tab_content_row(
                    array(
                        '<label>'.t(9, "Content").'
							<span class="editor_selector" for="trigger-content-'.$var_133.'">'.
								
								'<i class="fa fa-border fa-fw fa-lg fa-file-text-o active" data-action="tinymce" title="'.t(614, "Edit with TinyMCE").'"></i> '.
                                '<i class="fa fa-border fa-fw fa-lg fa-code" data-action="html" title="'.t(615, "Edit as source code").'"></i> '.
                                '<i class="fa fa-border fa-fw fa-lg fa-eraser" data-action="clear" title="'.t(208, "Remove all content").'"></i>'.
							'</span>'.
						'</label>',
                        $var_87->editorfield('trigger-content-'.$var_133, @$var_4->var_151['trigger-content'][$var_133], $var_160, $var_133),
                        '<div style="clear:both; margin-top:5px; float:left; margin-bottom: 10px;">',
                        '<label>&nbsp;</label>',
                        $var_161,
                        (!empty($var_148->var_168)? '<button onclick="navigate_properties_copy_from_theme_samples(\'trigger-content-'.$var_133.'\', \'trigger\', \''.$var_133.'\', \''."tinymce".'\'); return false;"><img src="img/icons/silk/rainbow.png" align="absmiddle"> '.t(553, 'Fragments').' | '.$var_148->var_42.'</button> ' : ''),
                        '</div>',
                        '<br />'
                    ),
					'',
					'lang="'.$var_133.'"'
                );


                $var_58->add_tab_content_row(
                    array(
                        '<label>'.t(172, 'Action').'</label>',
                        $var_87->selectfield('action-type-'.$var_133,
                            array(
                                0 => '',
                                1 => 'web',
                                2 => 'web-n',
                                3 => 'javascript',
                                4 => 'file',
                                5 => 'image'
                            ),
                            array(
                                0 => t(183, 'Do nothing'),
                                1 => t(173, 'Open URL'),
                                2 => t(174, 'Open URL (new window)'),
                                3 => 'Javascript',
                                4 => t(175, 'Download file'),
                                5 => t(176, 'View image')
                            ),
                            $var_4->action['action-type'][$var_133],
                            "navigate_blocks_action_change('".$var_133."', this);"
                        )
                    )
                );

                
                $var_169 = '';
                if(!empty($var_4->action['action-web'][$var_133]))
                {
                    $var_170 = explode('/', $var_4->action['action-web'][$var_133]);
                    if(count($var_170) > 0 && $var_170[0]=='nv:')
                    {
                        if($var_170[2]=='structure')
                        {
                            $var_171 = new class_10();
                            $var_171->load($var_170[3]);
                            $var_169 = $var_171->dictionary[$var_133]['title'];
                            $var_0->add_script('
                                $(".nv_block_nv_link_info[data-lang='.$var_133.']").find("img[data-type=structure]").removeClass("hidden");
                            ');
                        }
                        else if($var_170[2]=='element')
                        {
                            $var_171 = new class_1();
                            $var_171->load($var_170[3]);
                            $var_169 = $var_171->dictionary[$var_133]['title'];
                            $var_0->add_script('
                                $(".nv_block_nv_link_info[data-lang='.$var_133.']").find("img[data-type=element]").removeClass("hidden");
                            ');
                        }
                    }
                }

                $var_58->add_tab_content_row(
                    array(
                        '<label>'.t(184, 'Webpage').'</label>',
                        $var_87->pathfield('action-web-'.$var_133, @$var_4->action['action-web'][$var_133])
                    )
                );

                $var_0->add_script('
                    $("input[name=action-web-'.$var_133.']").on("keydown", function()
                    {
                        var div_info = $(this).parent().find(".nv_block_nv_link_info");
                        $(div_info).find("span").text("");
                        $(div_info).find("img").addClass("hidden");
                    });
                ');

	            $var_58->add_tab_content_row(
                    array(
                        '<label>Javascript</label>',
                        $var_87->textfield('action-javascript-'.$var_133, @$var_4->action['action-javascript'][$var_133], NULL, "navigate_blocks_action_javascript_clean_quotes('action-javascript-".$var_133."');"),
	                    '<div class="subcomment"><img src="img/icons/silk/information.png" align="absmiddle" /> '.t(606, 'Double quotes not allowed, use single quotes only').'</div>'
                    )
                );

	            $var_0->add_script('
					function navigate_blocks_action_javascript_clean_quotes(id)
		            {
		                var content = $("
		                content = content.replace(\'"\', "\'");
		                $("
		            }
	            ');

                $var_58->add_tab_content_row(
                    array(
                        '<label>'.t(82, 'File').'</label>',
                        $var_87->dropbox('action-file-'.$var_133, @$var_4->action['action-file'][$var_133]),
                        ''
                    )
                );

                $var_58->add_tab_content_row(
                    array(
                        '<label>'.t(157, 'Image').'</label>',
                        $var_87->dropbox('action-image-'.$var_133, @$var_4->action['action-image'][$var_133], 'image'),
                        ''
                    )
                );

	            
	            if(count($var_2->var_173) > 1)
	            {
		            $var_174 = array();
		            $var_175 = array();

		            foreach($var_2->var_173 as $var_176)
		            {
			            if($var_176['language'] == $var_133)
				            continue;

			            $var_174[] = language::name_by_code($var_176['language']);
			            $var_175[] = 'javascript: navigate_blocks_copy_from_language(\''.$var_176['language'].'\', \''.$var_133.'\');';
		            }

		            $var_177 = $var_87->splitbutton(
			            'block_copyfrom_'.$var_133,
			            '<img src="img/icons/silk/comment.png" align="absmiddle"> '.t(189, 'Copy from').'...',
			            $var_175,
			            $var_174
		            );

		            $var_58->add_tab_content_row('<label>&nbsp;</label>'.$var_177);
	            }

	            $var_58->add_tab_content('</div>');
            }

	        $var_0->add_script('
				function navigate_blocks_copy_from_language(from, to)
				{
					
					if($("
						$("

					
					$("
						.val($("
						.trigger("change");

					
					switch($("
					{
						case "image":
							navigate_dropbox_clone_value("trigger-image-" + from, "trigger-image-" + to);
							break;

						case "rollover":
							navigate_dropbox_clone_value("trigger-rollover-" + from, "trigger-rollover-" + to);
							navigate_dropbox_clone_value("trigger-rollover-active-" + from, "trigger-rollover-active-" + to);
							break;

						case "video":
							navigate_dropbox_clone_value("trigger-video-" + from, "trigger-video-" + to);
							break;

						case "flash":
							navigate_dropbox_clone_value("trigger-flash-" + from, "trigger-flash-" + to);
							break;

						case "html":
							
							
							for(ncid in navigate_codemirror_instances)
							{
								if($(navigate_codemirror_instances[ncid].getTextArea()).attr("id") == "trigger-html-" + to)
								{
									for(ncio in navigate_codemirror_instances)
									{
										if($(navigate_codemirror_instances[ncio].getTextArea()).attr("id") == "trigger-html-" + from)
										{
											navigate_codemirror_instances[ncid].setValue(navigate_codemirror_instances[ncio].getValue());
										}
									}
								}
							}
							$(navigate_codemirror_instances).each(function() { this.refresh(); } );
							break;

						case "links":
							
							$("

							
							$("
							{
								
								$("
								$(this).find("td").each(function(i)
								{
									if($(this).find(".select2-container").length > 0)
									{
										

										var input_name = $("
										var input_value = $(this).find("select").val();

										if(input_name)
											$("select[name=\""+input_name+"\"]").val(input_value).trigger("change");
									}
									else
									{
										
										$("
										if($(this).find("input").attr("checked"))
											$("
									}
								});
							});
							break;

						case "content":
							tinyMCE.get("trigger-content-" + to).setContent(
								tinyMCE.get("trigger-content-" + from).getContent()
							);
							break;

						case "title":
						case "":
						default:
							
							break;
					}

					
					$("
						.val($("
						.trigger("change");

					
					switch($("
					{
						case "web":
						case "web-n":
							$("
							break;

						case "javascript":
							$("
							break;

						case "file":
							navigate_dropbox_clone_value("action-file-" + from, "action-file-" + to);
							break;

						case "image":
							navigate_dropbox_clone_value("action-image-" + from, "action-image-" + to);
							break;

						case "":
						default:
							
							break;
					}
				}
			');

            
            $var_178 = '';
            if($var_155 == 'fontawesome')
            {
                $var_178 = class_2::fontawesome_list();
                $var_178 = array_map(
                    function($var_179)
                    {
                        $var_180 = new class_11();
                        $var_180->var_7 = $var_179;
                        if(!empty($var_179))
                            $var_180->var_181 = substr($var_179, 3);
                        return $var_180;
                    },
                    $var_178
                );
            }

            $var_0->add_script('
                var active_languages = ["'.implode('", "', array_keys($var_131)).'"];
                navigate_items_select_language("'.$var_2->var_132[0].'");
                navigate_fontawesome_classes = '.json_encode($var_178).';
            ');

            foreach($var_2->var_132 as $var_146)
            {
                $var_0->add_script('
					$(window).on("load", function()
					{
						$("
						$("
						navigate_blocks_trigger_change("'.$var_146.'", $("<input type=\"hidden\" value=\"'.$var_4->var_151['trigger-type'][$var_146].'\" />"));

						links_table_row_models["'.$var_146.'"] = $("
						if($("
							$("

						
						if('.($var_155=='fontawesome'? 'true' : 'false').')
						{
							$("[id^=trigger_links_table_").find("tr").each(function(i, tr)
							{
								
								if(!$(tr).find("select"))
									return;

								
								if($(tr).attr("id") && ($(this).attr("id")).indexOf("table-row-model") > 0)
									return;

								navigate_blocks_trigger_links_table_icon_selector(tr);
							});
						}
					});
            	');
            }
	        break;
  	}

    if(!empty($var_4->var_32))
    {
        
        foreach($var_24 as $var_77)
        {
            
            if(!isset($var_77['id']) && isset($var_77['code']))
                $var_77['id'] = $var_77['code'];

            if($var_77['id'] == $var_4->var_32)
            {
                $var_182 = $var_77['id'];
                break;
            }
        }

        $var_183 = navigate_property_layout_form('block', $var_182, 'block', $var_4->var_7);

        if(!empty($var_183))
        {
            $var_58->add_tab(t(77, "Properties"));
            $var_58->add_tab_content($var_183);
        }
        else
        {
            
            navigate_property_layout_scripts();
        }
    }

    $var_58->add_tab(t(336, "Display"));

    $var_184 = 1;
    if(!empty($var_4->var_185))
        $var_184 = 0;
    else if(!empty($var_4->var_186))
        $var_184 = 2;

    $var_58->add_tab_content_row(array(
        '<label>'.t(330, 'Categories').'</label>',
        $var_87->buttonset(
            'all_categories',
            array(
                '1' => t(396, 'All categories'),
                '0' => t(405, 'Selection'),
                '2' => t(552, 'Exclusions')
            ),
            $var_184
        )
    ));

	$var_76 = class_10::hierarchy(0);
	$var_187 = class_10::hierarchyList($var_76, $var_4->var_185);
	$var_188 = class_10::hierarchyList($var_76, $var_4->var_186);

	$var_58->add_tab_content_row(
        array(
            '<label>&nbsp;</label>',
		    '<div class="category_tree" id="category-tree-parent">
                <img src="img/icons/silk/world.png" align="absmiddle" /> '.$var_2->var_189.
                '<div class="tree_ul">'.$var_187.'</div>'.
            '</div>'
        )
    );

	$var_58->add_tab_content_row(
        array(
            '<label>&nbsp;</label>',
		    '<div class="category_tree" id="exclusions-tree-parent">
                <img src="img/icons/silk/world.png" align="absmiddle" /> '.$var_2->var_189.
                '<div class="tree_ul">'.$var_188.'</div>'.
            '</div>'
        )
    );
										
	if(!is_array($var_4->var_185))
		$var_4->var_185 = array();

    if(!is_array($var_4->var_186))
        $var_4->var_186 = array();

    $var_58->add_tab_content($var_87->hidden('categories', implode(',', $var_4->var_185)));
    $var_58->add_tab_content($var_87->hidden('exclusions', implode(',', $var_4->var_186)));

	$var_190 = "all";
	if(!empty($var_4->var_191['exclusions']))
		$var_190 = "exclusions";
	else if(!empty($var_4->var_191['selection']))
		$var_190 = "selection";

    $var_58->add_tab_content_row(array(
        '<label>'.t(22, 'Elements').' '.t(428, '(no category)').'</label>',
        $var_87->buttonset(
            'elements_display',
            array(
                'all' => t(443, 'All'),
                'selection' => t(405, 'Selection'),
                'exclusions' => t(552, 'Exclusions')
            ),
            $var_190,
            "navigate_blocks_elements_display_change(this)"
        )
    ));

	$var_0->add_script('
		function navigate_blocks_elements_display_change(el)
		{
			el = $(el).prev();
			if($(el).val()=="all")
				$("
			else
				$("
		}

		navigate_blocks_elements_display_change($("label[for=elements_display_'.$var_190.']"));
	');

	if(!is_array($var_4->var_191))
		$var_4->var_191 = array();
	$var_192 = array_values($var_4->var_191);
	$var_192 = $var_192[0];
	if(empty($var_192))
		$var_192 = array();
	$var_193 = array();
	for($var_26=0; $var_26 < count($var_192); $var_26++)
	{
		$var_194 = $var_1->query_single(
            'text',
            'nv_webdictionary',
            '   node_type = "item" AND
                website = "'.$var_2->var_7.'" AND
                node_id = "'.$var_192[$var_26].'" AND
                subtype = "title" AND
                lang = "'.$var_2->languages_published[0].'"'
        );

		$var_193[$var_26] = $var_194;
	}

	$var_58->add_tab_content_row(
        array(
            '<label>&nbsp;</label>',
	        $var_87->selectfield("elements_selection", $var_192, $var_193, $var_192, null, true, null, null, false)
        ),
		"elements_selection_wrapper"
    );

	$var_0->add_script('
		$("
			placeholder: "'.t(533, "Find element by title").'",
	        minimumInputLength: 1,
	        ajax: {
	            url: "'.var_144.'/'.var_195.'?fid=items&act=json_find_item",
	            dataType: "json",
	            delay: 100,

	            data: function(params)
	            {
	                return {
		                title: params.term,
		                
		                embedding: 0,
		                nd: new Date().getTime(),
		                page_limit: 30, 
		                page: params.page 
		            };
	            },
	            processResults: function (data, params)
		        {
		            params.page = params.page || 1;
		            return {
						results: data.items,
						pagination: { more: (params.page * 30) < data.total_count }
					};
		        }
	        },
	        templateSelection: function(row)
			{
				if(row.id)
					return row.text + " <helper style=\'opacity: .5;\'>
				else
					return row.text;
			},
			escapeMarkup: function (markup) { return markup; }, 
	        triggerChange: true
		});
		
		$("
		$("
	');

							
	if(!empty($var_4->var_32))
	{				
		$var_58->add_tab(t(171, 'Order'));	
		
		$var_1->query('SELECT b.id as id, d.text as title, b.fixed as fixed
					  FROM nv_blocks b, nv_webdictionary d
					 WHERE b.type = "'.$var_4->var_32.'"
					   AND d.node_type = "block"
					   AND d.subtype = "title"
					   AND d.lang = "'.$var_2->var_132[0].'"
					   AND d.node_id = b.id
					   AND d.website = '.$var_2->var_7.'
					   AND b.website = '.$var_2->var_7.'
					ORDER BY b.position ASC');				
										  
		$var_196 = $var_1->result('id');
		$var_91 = $var_1->result();

		$var_58->add_tab_content($var_87->hidden('blocks-order', implode('

		$table = new naviorderedtable();
		$table->setWidth("408px");
		$table->setHiddenInput("blocks-order");

		$table->addHeaderColumn('var_197', 50);			
		$var_136->addHeaderColumn(t(67, 'Title'), 350);
        $var_136->addHeaderColumn('<div style=" text-align: center; ">'.t(394, 'Fixed').'</div>', 50);

		foreach($var_91 as $var_5)
		{
			$var_136->addRow($var_5->var_7, array(
				array('content' => $var_5->var_7, 'align' => 'left'),
				array('content' => $var_5->var_42, 'align' => 'left'),
                array('content' => '<span class="checkbox-wrapper">
                                        <input type="checkbox" name="blocks-order-fixed['.$var_5->var_7.']" id="blocks-order-fixed['.$var_5->var_7.']" value="1" '.(($var_5->var_198=='1')? 'checked="checked"' : '').' />
                                        <label for="blocks-order-fixed['.$var_5->var_7.']" />
                                    </span>',
	                  'align' => 'center'
                )
			));
		}	
		
		$var_58->add_tab_content_row(
            array(
                '<label>'.t(23, 'Blocks').'</label>',
				'<div>'.$var_136->generate().'</div>',
				'<div class="subcomment"><img src="img/icons/silk/information.png" align="absmiddle" /> '.t(72, 'Drag any row to assign priorities').'</div>',
                '<div class="subcomment"><span class="ui-icon ui-icon-lightbulb" style=" float: left; margin-right: 4px; "></span> '.t(395, '"Fixed" assigns a static position when the order is random').'</div>'
            )
        );
											
	}
	return $var_58->generate();
}

function var_199()
{
	global $var_57;
	global $var_1;
	global $var_2;
    global $var_56;
	
	$var_58 = new class_6();
	$var_59 = new class_7('blocks_types_list');
	
	$var_58->title(t(23, 'Blocks').' / '.t(167, 'Types'));

    $var_60 = array();
    list($var_61, $var_62) = class_4::paginated_list(0, 10, 'title', 'desc');

    if($var_62 > 0 && $var_62 <= 10)
    {
        foreach($var_61 as $var_63)
            $var_60[] = '<a href="?fid=blocks&act=block_group_edit&id='.$var_63['id'].'"><i class="fa fa-fw fa-caret-right"></i> '.$var_63['title'].'</a>';

        $var_56->var_64(
            'blocks',
            array(
                'item' => null,
                'navibars' => &$var_58
            ),
            $var_60,
            '<a class="content-actions-submenu-trigger" href="?fid=blocks&act=block_groups_list"><img height="16" align="absmiddle" width="16" src="img/icons/silk/bricks.png"> '.t(506, 'Groups').' &
        );
    }

    $navibars->add_actions(
        array(
            '<var_93 var_94="?fid=blocks&act=list"><var_95 var_96="16" var_97="var_98" var_99="16" var_100="img/icons/silk/brick.png"> '.t(23, 'var_200').'</a>',
            (!empty($var_60)? '' : '<a href="?fid=blocks&act=block_groups_list"><img height="16" align="absmiddle" width="16" src="img/icons/silk/bricks.png"> '.t(506, 'Groups').'</a>')
        )
    );

	$var_58->add_actions(
		array(
			($var_57->permission("items.create") == 'true'?
				'<a href="?fid=blocks&act=block_type_edit"><img height="16" align="absmiddle" width="16" src="img/icons/silk/add.png"> '.t(38, 'Create').'</a>'
				: ''),
			'<a href="?fid=blocks&act=block_types_list"><img height="16" align="absmiddle" width="16" src="img/icons/silk/application_view_list.png"> '.t(39, 'List').'</a>'
		)
	);


	$var_59->setURL('?fid=blocks&act=block_types_json');
	$var_59->sortBy('id');
	$var_59->setDataIndex('id');
	$var_59->setEditUrl('id', '?fid=blocks&act=block_type_edit&id=');
	
	$var_59->addCol("ID", 'id', "80", "true", "left");
    $var_59->addCol(t(491, 'Class'), 'type', "80", "true", "left");
    $var_59->addCol(t(237, 'Code'), 'code', "120", "true", "left");
	$var_59->addCol(t(67, 'Title'), 'title', "200", "true", "left");
	$var_59->addCol(t(155, 'Width').' (px)', 'width', "80", "true", "left");	
	$var_59->addCol(t(156, 'Height').' (px)', 'height', "80", "true", "left");		
	
	$var_58->add_content($var_59->generate());
	
	return $var_58->generate();
}

function var_201($var_4)
{
	global $var_57;
	global $var_1;
	global $var_2;
	global $var_0;
    global $var_56;
	
	$var_58 = new class_6();
	$var_87 = new class_8();
	
	if(empty($var_4['id']))
		$var_58->title(t(23, 'Blocks').' / '.t(167, 'Types').' / '.t(38, 'Create'));	
	else
		$var_58->title(t(23, 'Blocks').' / '.t(167, 'Types').' / '.t(170, 'Edit').' ['.$var_4['id'].']');	

    $var_202 = false;

	if(empty($var_4['id']))
	{
		$var_58->add_actions(
            array(	'<a href="
		);
	}
    else if(!empty($item['var_7']) && !is_numeric($var_4['id']))
    {
        $var_0->navigate_notification(t(432, "Read only mode"), false, true);
        $var_202 = true;
    }
	else
	{
		$var_58->add_actions(
            array(
                '<a href="
				'<var_93 var_94="
            )
        );

        $var_0->add_script('
            function navigate_delete_dialog()
            {
                navigate_confirmation_dialog(
                    function() { window.location.href = "?fid=blocks&act=block_type_delete&id='.$var_4['id'].'"; }, 
                    null, null, "'.t(35, 'Delete').'"
                );
            }
        ');
	}

    $var_60 = array();
    list($var_61, $var_62) = class_4::paginated_list(0, 10, 'title', 'desc');

    if($var_62 > 0 && $var_62 <= 10)
    {
        foreach($var_61 as $var_63)
            $var_60[] = '<a href="?fid=blocks&act=block_group_edit&id='.$var_63['id'].'"><i class="fa fa-fw fa-caret-right"></i> '.$var_63['title'].'</a>';

        $var_56->var_64(
            'blocks',
            array(
                'item' => null,
                'navibars' => &$var_58
            ),
            $var_60,
            '<a class="content-actions-submenu-trigger" href="?fid=blocks&act=block_groups_list"><img height="16" align="absmiddle" width="16" src="img/icons/silk/bricks.png"> '.t(506, 'Groups').' &
        );
    }

    $navibars->add_actions(
        array(
            '<var_93 var_94="?fid=blocks&act=list"><var_95 var_96="16" var_97="var_98" var_99="16" var_100="var_95/var_101/var_102/var_203.var_104"> '.t(23, 'var_200').'</a>',
            (!var_204($var_60)? '' : '<a href="?fid=blocks&act=block_groups_list"><img height="16" align="absmiddle" width="16" src="img/icons/silk/bricks.png"> '.t(506, 'Groups').'</a>')
        )
    );


	$var_58->add_actions(
        array(
            (!empty($var_4->var_7)? '<a href="?fid=blocks&act=block_type_edit"><img height="16" align="absmiddle" width="16" src="img/icons/silk/add.png"> '.t(38, 'Create').'</a>' : ''),
			'<a href="?fid=blocks&act=block_types_list"><img height="16" align="absmiddle" width="16" src="img/icons/silk/application_view_list.png"> '.t(39, 'List').'</a>'
        )
    );

	$var_58->form();

	$var_58->add_tab(t(43, "Main"));
	
	$var_58->add_tab_content($var_87->hidden('form-sent', 'true'));
	$var_58->add_tab_content($var_87->hidden('id', $var_4['id']));	
	
	$var_58->add_tab_content_row(array(	'<label>ID</label>',
											'<span>'.(!empty($var_4['id'])? $var_4['id'] : t(52, '(new)')).'</span>' ));

    
    $var_43 = class_2::modes();
    $var_58->add_tab_content_row(
        array(
            '<label>'.t(491, 'Class').'</label>',
   			$var_87->selectfield('type',
                array_keys($var_43),
                array_values($var_43),
   			    $var_4['type'],
   			    '',
   			    false
            )
   		)
    );

    $var_58->add_tab_content_row(
        array(
            '<label>'.t(67, 'Title').'</label>',
   			$var_87->textfield('title', $var_4['title'])
        )
    );

    $var_58->add_tab_content_row(
        array(
            '<label>'.t(237, 'Code').'</label>',
    		$var_87->textfield('code', $var_4['code']),
            '<div class="subcomment">
            <span style=" float: left; margin-left: -3px; " class="ui-icon ui-icon-lightbulb"></span>'.
            t(436, 'Used as a class in HTML elements').
            '</div>'
        )
    );

	$var_58->add_tab_content_row(
        array(
            '<label>'.t(168, 'Notes').'</label>',
			$var_87->textarea('notes', $var_4['notes'])
        )
    );

    $var_58->add_tab(t(145, "Size").' & '.t(438, "Order"));

    $var_58->add_tab_content_row(
        array(
            '<label>'.t(155, 'Width').'<sup>*</sup></label>',
   			$var_87->textfield('width', $var_4['width']),
   			'px'
        )
    );

   	$var_58->add_tab_content_row(
        array(
            '<label>'.t(156, 'Height').'<sup>*</sup></label>',
   			$var_87->textfield('height', $var_4['height']),
   			'px'
        )
    );

    $var_58->add_tab_content_row(
        array(
            '<div class="subcomment italic">* '.t(169, 'You can leave blank a field to not limit the size').'</div>'
   		)
    );

	$var_58->add_tab_content_row(
        array(
            '<label>&nbsp;</label>',
			'<a id="wikipedia_web_banner_entry" class="italic" href="http:
        )
    );

    $navibars->add_tab_content_row(
        array(
            '<var_205>'.t(404, 'var_206 var_207').'</label>',
            $var_87->selectfield(
                'order',
                array(
                    'theme',
                    'priority',
                    'random'
                ),
                array(
                    t('368', 'Theme'),
                    t('66', 'Priority'),
                    t('399', 'Random')
                ),
                $var_4['order']
            )
        )
    );

   	$var_58->add_tab_content_row(
        array(
            '<label>'.t(397, 'Maximum').'</label>',
   			$var_87->textfield('maximum', $var_4['maximum']),
   			'<div class="subcomment"><span class="ui-icon ui-icon-lightbulb" style=" float: left; margin-left: -3px; "></span> '.t(400, 'Enter 0 to display all').'</div>'
        )
    );

    $var_0->add_script('
        function navigate_blocks_code_generate(el)
        {
            if($("
                return;
            var title = $("
			title = title.replace(/([\'"“”«»?:\+\&!¿
			title = title.replace(/[.\s]+/g, navigate["word_separator"]);
            $("
        }

        $("
        {
            if($(this).val() == "")
                navigate_blocks_code_generate();
        });
        '
    );

    if(!empty($var_4['id']))
    {
        $var_58->add_tab(t(77, "Properties"));

        $var_136 = new class_9();
        $var_136->setWidth("550px");
        $var_136->setHiddenInput("block-properties-order");
        $var_136->setDblclickCallback("navigate_block_edit_property");

        $var_58->add_tab_content( $var_87->hidden('block-properties-order', "") );

        $var_136->addHeaderColumn(t(159, 'Name'), 350, true);
        $var_136->addHeaderColumn(t(160, 'Type'), 150);
        $var_136->addHeaderColumn(t(65, 'Enabled'), 50);

        $var_36 = class_5::elements($var_4['id'], 'block');
        $var_48		= class_5::types();

        for($var_209=0; $var_209 < count($var_36); $var_209++)
        {
            $var_136->addRow($var_36[$var_209]->var_7, array(
                array('content' => $var_36[$var_209]->var_189, 'align' => 'left'),
                array('content' => $var_48[$var_36[$var_209]->var_32], 'align' => 'left'),
                array('content' => '<input type="checkbox" name="property-enabled[]" value="'.$var_36[$var_209]->var_7.'" disabled="disabled" id="block-type-property-enabled-'.$var_36[$var_209]->var_7.'" '.(($var_36[$var_209]->var_127=='1'? ' checked=checked ' : '')).' />
                                    <label for="block-type-property-enabled-'.$var_36[$var_209]->var_7.'"></label>',
	                  'align' => 'center'),
            ));
        }

        if($var_202)
        {
            $var_58->add_tab_content_row(array(	'<label>'.t(77, 'Properties').'</label>',
                '<div>'.$var_136->generate().'</div>'));
        }
        else
        {
            $var_58->add_tab_content_row(array(	'<label>'.t(77, 'Properties').'</label>',
                '<div>'.$var_136->generate().'</div>',
                '<div class="subcomment">
                    <img src="img/icons/silk/information.png" align="absmiddle" /> '.t(72, 'Drag any row to assign priorities').'.
                     '.t(192, 'Double click any row to edit').'
                </div>' ));

            $var_58->add_tab_content_row(array(	'<label>&nbsp;</label>',
                '<button id="block-properties-create"><img src="img/icons/silk/add.png" align="absmiddle" /> '.t(38, 'Create').'</button>'));
        }

        $var_58->add_content('
		<form id="block-properties-edit-dialog" style="display: none;">
			<div class="navigate-form-row">
				<label>ID</label>
				<span id="property-id-span">'.t(52, '(new)').'</span>
				'.$var_87->hidden('property-id', '').'
				'.$var_87->hidden('property-template', $var_4->var_7).'
				'.$var_87->hidden('property-element', "block").'
			</div>
			<div class="navigate-form-row">
				<label>'.t(67, 'Title').'</label>
				'.$var_87->textfield('property-name', '').'
			</div>
			<div class="navigate-form-row">
				<label>'.t(160, 'Type').'</label>
				'.$var_87->selectfield(
                    'property-type',
                    array_keys($var_48),
                    array_values($var_48),
                    'value',
                    'navigate_block_property_type_change()'
                ).'
			</div>
			<div class="navigate-form-row">
				<label>'.t(200, 'Options').'</label>
				'.$var_87->textarea('property-options', '').'
				<div class="subcomment">
					'.t(201, 'One line per option, formatted like this: value
				</div>
			</div>
			<div class="navigate-form-row">
				<label>'.t(199, 'Default value').'</label>
				'.$var_87->textfield('property-dvalue', '').'
				<div class="subcomment">
				    <span id="property-comment-boolean">'.t(426, 'Enter "1" for true, "0" for false').'</span>
					<span id="property-comment-option">'.t(202, 'Enter only the value').'</span>
					<span id="property-comment-moption">'.t(212, 'Enter the selected values separated by commas').': 3,5,8</span>
					<span id="property-comment-text">'.t(203, 'Same value for all languages').'</span>
					<span id="property-comment-rating">'.t(223, 'Default is 5 stars, if you want a different number: default_value
					<span id="property-comment-date">'.t(50, 'Date format').': '.date($var_57->var_210).'</span>
					<span id="property-comment-color">'.t(442, 'Hexadecimal color code').': 
					<span id="property-comment-country">'.t(225, 'Alpha-2 country code').' (es, us, uk...)</span>
					<span id="property-comment-file">'.t(204, 'ID of the file').'</span>
					<span id="property-comment-coordinates">'.t(298, 'Latitude').'
				</div>
			</div>
			<div class="navigate-form-row">
				<label>'.t(65, 'Enabled').'</label>
				'.$var_87->checkbox('property-enabled', 1).'
			</div>
		</form>');

        $var_0->add_script('
			$("
			{
				navigate_block_edit_property();
				return false;
			});

			function navigate_block_edit_property(el)
			{
				if(!el)	
				{
					$("
					$("
					$("
					$("
					$("
					$("
					$("
					$("
				    $("
				}
				else
				{
					$.ajax({
					   type: "GET",
					   async: false,
					   dateType: "json",
					   url: "'.var_144.'/'.var_195.'?fid=blocks&act=block_property_load&block='.$var_4->var_7.'&id=" + $(el).attr("id"),
					   success: function(data)
					   {
						   $("
						   $("
						   $("
						   $("
						   $("
						   $("
						   $("
						   $("
						   if(data.enabled=="1")
							   $("
							else
							   $("

						   var options = "";
						   for(var o in data.options)
						   {
							   options += o + "
						   }
						   $("

					   }
					 });
				}

				navigate_block_property_type_change();

				if('.($var_202? 'true' : 'false').')
				{
                    $("
                    {
                        title: \'<img src="img/icons/silk/pencil.png" align="absmiddle" /> '.t(170, 'Edit').'\',
                        resizable: true,
                        height: 360,
                        width: 650,
                        modal: true,
                    });
				}
				else 
				{
                    $("
                    {
                        title: \'<img src="img/icons/silk/pencil.png" align="absmiddle" /> '.t(170, 'Edit').'\',
                        resizable: true,
                        height: 410,
                        width: 650,
                        modal: true,
                        buttons: {
                            "'.t(58, 'Cancel').'": function() {
                                $(this).dialog("close");
                            },
                            "'.t(35, 'Delete').'": function() {
                                $.ajax({
                                   type: "POST",
                                   async: false,
                                   dateType: "text",
                                   url: "'.var_144.'/'.var_195.'?fid=blocks&act=block_property_remove",
                                   data: $("
                                   success: function(msg)
                                   {
                                     $("
                                     navigate_naviorderedtable_block_properties_table_reorder();
                                     $("
                                   }
                                 });
                            },
                            "'.t(190, 'Ok').'": function()
                            {
                                $.ajax({
                                   type: "POST",
                                   async: false,
                                   dateType: "text",
                                   url: "'.var_144.'/'.var_195.'?fid=blocks&act=block_property_save",
                                   data: $("
                                   success: function(data)
                                   {
                                       if($("
                                       {
                                           
                                           var tr = $("
                                           tr.find("td").eq(0).html(data.name);
                                           tr.find("td").eq(1).html(data.type_text);
                                           tr.find("input[type=checkbox]").attr("checked", (data.enabled==1));
                                       }
                                       else
                                       {
                                           
                                           var checked = "";

                                           if(data.enabled) checked = \' checked="checked" \';
                                           var tr = \'<tr id="\'+data.id+\'"><td>\'+data.name+\'</td><td>\'+data.type_text+\'</td><td align="center"><input name="property-enabled[]" id="block-type-property-enabled-\'+data.id+\'" type="checkbox" disabled="disabled" value="\'+data.id+\'" \'+checked+\' /><label for="block-type-property-enabled-\'+data.id+\'"></label></td></tr>\';
                                           $("
                                           $("
                                           $("
                                            {
                                                onDrop: function(table, row)
                                                {		navigate_naviorderedtable_block_properties_table_reorder();		}
                                            });
                                       }
                                       navigate_naviorderedtable_block_properties_table_reorder();
                                       $("
                                   }
                                 });
                            }
                        }
                    });
                }
			}

			function navigate_block_property_type_change()
			{
				$("
				$("

				switch($("
				{
					case "option":
						$("
						$("
						break;

					case "moption":
						$("
						$("
						break;

					case "text":
					case "textarea":
					case "link":
						$("
						break;

					case "date":
					case "datetime":
						$("
						break;

					case "image":
					case "file":
						$("
						break;

					case "rating":
						$("
						break;

                    case "color":
						$("
						break;

					case "coordinates":
						$("
						break;

					case "country":
						$("
						break;

                    case "boolean":
						$("
						break;

					case "comment":
					case "value":
					default:
				}
			}

			navigate_naviorderedtable_block_properties_table_reorder();
		');

    }

	return $var_58->generate();
}

function var_211()
{
    global $var_57;
    global $var_1;
    global $var_2;

    $var_58 = new class_6();
    $var_59 = new class_7('block_groups_list');

    $var_58->title(t(23, 'Blocks').' / '.t(506, 'Groups'));

    $var_58->add_actions(
        array(
            '<a href="?fid=blocks&act=list"><img height="16" align="absmiddle" width="16" src="img/icons/silk/brick.png"> '.t(23, 'Blocks').'</a>',
            '<a href="?fid=blocks&act=block_types_list"><img height="16" align="absmiddle" width="16" src="img/icons/silk/brick_edit.png"> '.t(167, 'Types').'</a>'
        )
    );

    $var_58->add_actions(	array(
        '<a href="?fid=blocks&act=block_group_edit"><img height="16" align="absmiddle" width="16" src="img/icons/silk/add.png"> '.t(38, 'Create').'</a>',
        '<a href="?fid=blocks&act=block_groups_list"><img height="16" align="absmiddle" width="16" src="img/icons/silk/application_view_list.png"> '.t(39, 'List').'</a>'
    ));

    $var_59->setURL('?fid=blocks&act=block_groups_json');
    $var_59->sortBy('id');
    $var_59->setDataIndex('id');
    $var_59->setEditUrl('id', '?fid=blocks&act=block_group_edit&id=');
    $var_59->setGridNotesObjectName("block_group");

    $var_59->addCol("ID", 'id', "80", "true", "left");
    $var_59->addCol(t(237, 'Code'), 'code', "120", "true", "left");
    $var_59->addCol(t(67, 'Title'), 'title', "200", "true", "left");
    $var_59->addCol(t(23, 'Blocks'), 'blocks', "80", "true", "left");
    $var_59->addCol(t(168, 'Notes'), 'note', "50", "false", "center");

    $var_58->add_content($var_59->generate());

    return $var_58->generate();
}

var_212 var_213($var_4)
{
    global $var_1;
    global $var_2;
    global $var_0;
    global $var_148;
    global $var_85;

    $var_58 = new class_6();
    $var_87 = new class_8();

    if(empty($var_4->var_7))
        $var_58->title(t(23, 'Blocks').' / '.t(506, 'Groups').' / '.t(38, 'Create'));
    else
        $var_58->title(t(23, 'Blocks').' / '.t(506, 'Groups').' / '.t(170, 'Edit').' ['.$var_4->var_7.']');

    if(empty($var_4->var_7))
    {
        $var_58->var_64(
            array(	'<a href="
        );
    }
    else
    {
        $navibars->add_actions(
            array(
                '<var_93 var_94="
                '<a href="
            )
        );

        $layout->add_script('
            var_212 navigate_delete_dialog()
            {
                navigate_confirmation_dialog(
                    function() { var_214.var_215.var_94 = "?fid=blocks&act=block_group_delete&id='.$var_4->var_7.'"; }, 
                    null, null, "'.t(35, 'Delete').'"
                );
            }
        ');
    }

    $navibars->add_actions(
        array(
            '<var_93 var_94="?fid=blocks&act=list"><var_95 var_96="16" var_97="var_98" var_99="16" var_100="img/icons/silk/brick.png"> '.t(23, 'var_200').'</a>',
            '<a href="?fid=blocks&act=block_types_list"><img height="16" align="absmiddle" width="16" src="img/icons/silk/brick_edit.png"> '.t(167, 'Types').'</a>'
        )
    );

    if(!empty($var_4->var_7))
    {
        $var_90 = grid_notes::comments('block_group', $var_4->var_7);
        $var_58->var_64(
            array(
                '<a href="
            )
        );
    }

    $navibars->add_actions(
        array(
        (!empty($item->id)? '<var_93 var_94="?fid=blocks&act=block_group_edit"><var_95 var_96="16" var_97="var_98" var_99="16" var_100="var_95/var_101/var_102/var_216.var_104"> '.t(38, 'var_217').'</a>' : ''),
        '<var_93 var_94="?var_218=var_91&var_219=var_211"><var_95 var_96="16" var_97="var_98" var_99="16" var_100="var_95/var_101/var_102/var_220.var_104"> '.t(39, 'var_221').'</a>'
    ));

    $var_58->form();

    if(!empty($var_4->var_7))
    {
        $var_58->add_tab(t(23, "Blocks"));

        $var_222 = array();
        if(!empty($var_4->var_150))
        {
            for($var_63=0; $var_63 < count($var_148->var_223); $var_63++)
            {
                if($var_148->var_223[$var_63]->var_7 == $var_4->var_150)
                {
                    if(isset($var_148->var_223[$var_63]->var_222))
                    {
                        $var_222 = $var_148->var_223[$var_63]->var_222;
                    }
                    break;
                }
            }
        }

        $var_224 = array();

        if(!is_array($var_4->var_91))
            $var_4->var_91 = array();

        $var_58->add_tab_content($var_87->hidden('blocks_group_selection', json_encode($var_4->var_91)));
        $var_58->add_tab_content( $var_87->hidden('blocks-order', "") );

        $var_24 = class_2::types();
        $var_133 = $var_2->languages_published[0];
        $var_225 = class_12::blocks();

        for($var_209=0; $var_209 < count($var_4->var_91); $var_209++)
        {
            unset($var_5);

            switch($var_4->var_91[$var_209]['type'])
            {
                case "block":
                    $var_5 = new class_2();
                    $var_5->load($var_4->var_91[$var_209]['id']);

                    if(empty($var_5) || empty($var_5->var_32))
                        continue;

                    $var_224[] = '
                        <div class="block_group_block ui-state-default" data-block-id="'.$var_5->var_7.'" data-block-type="block" data-block-uid="'.$var_4->var_91[$var_209]['uid'].'">
                            <div class="actions">
                                <a href="?fid=blocks&act=edit&id='.$var_5->var_7.'"><img src="'.var_144.'/img/icons/silk/pencil.png" /></a>
                                <a href="
                            </div>
                            <div class="title">'.$var_5->dictionary[$var_133]['title'].'</div>
                            <div class="subcomment"><span style="float: right;">ID '.$var_5->var_7.'</span><img src="img/icons/silk/brick.png" /> '.$var_148->t($var_5->var_32).'</div>
                        </div>
                    ';
                    break;

                case "block_type":
                    for($var_77=0; $var_77 < count($var_24); $var_77++)
                    {
                        if($var_24[$var_77]['id']==$var_4->var_91[$var_209]['id'])
                        {
                            $var_5 = $var_24[$var_77];
                            break;
                        }
                    }

                    $var_224[] = '
                        <div class="block_group_block ui-state-default" data-block-id="'.$var_5['code'].'" data-block-type="block_type" data-block-uid="'.$var_4->var_91[$var_209]['uid'].'">
                            <div class="actions">
                                <a href="
                                <a href="
                            </div>
                            <div class="title" title="'.$var_5['description'].'">'.$var_5['title'].'</div>
                            <div class="subcomment">
                                <span style="float: right;">ID '.$var_5['code'].'</span>
                                <img src="img/icons/silk/brick_link.png" /> '.$var_5['count'].' '.($var_5['count']==1? t(437, "Block") : t(23, "Blocks")).'
                            </div>
                        </div>
                    ';
                    break;

                case "block_group_block":
                    if(is_array($var_148->var_223))
                    {
                        foreach($var_148->var_223 as $var_157 => $var_63)
                        {
                            for($var_26=0; $var_26 < count($var_63->var_91); $var_26++)
                            {
                                if($var_63->var_91[$var_26]->var_7==$var_4->var_91[$var_209]['id'])
                                {
                                    $var_5 = array(
                                        'code' => $var_63->var_91[$var_26]->var_7,
                                        'type' => $var_63->var_91[$var_26]->var_7,
                                        'title' => $var_148->t($var_63->var_91[$var_26]->var_42),
                                        'description'  => $var_148->t($var_63->var_91[$var_26]->var_227),
                                        'properties'  => $var_63->var_91[$var_26]->var_36,
                                        'block_group' => $var_63->var_7
                                    );
                                    break;
                                }
                            }
                        }
                    }

                    $var_224[] = '
                        <div class="block_group_block ui-state-default" data-block-id="'.$var_5['code'].'" data-block-type="block_group_block"  data-block-uid="'.$var_4->var_91[$var_209]['uid'].'">
                            <div class="actions">
                                '.(empty($var_5['properties'])? '':'<a href="
                                <a href="
                            </div>
                            <div class="title" title="'.$var_5['description'].'">'.$var_5['title'].'</div>
                            <div class="subcomment"><span style="float: right;">ID '.$var_5['type'].'</span><img src="img/icons/silk/bricks.png" /> '.$var_148->t($var_5['type']).'</div>
                        </div>
                    ';
                    break;

                case "extension":
                    $var_5 = $var_4->var_91[$var_209];

                    for($var_228=0; $var_228 < count($var_225); $var_228++)
                    {
                        if($var_5['id'] == $var_225[$var_228]->var_7)
                        {
                            $var_229 = new class_12();
                            $var_229->load($var_5['extension']);

                            $var_224[] = '
                                <div class="block_group_block ui-state-default" data-block-id="'.$var_5['id'].'" data-block-type="extension" data-block-extension="'.$var_5['extension'].'"  data-block-uid="'.$var_4->var_91[$var_209]['uid'].'">
                                    <div class="actions">
                                        '.(empty($var_225[$var_228]->var_36)? '':'<a href="
                                        <a href="
                                    </div>
                                    <div class="title">'.$var_229->t($var_225[$var_228]->var_42).'</div>
                                    <div class="subcomment"><span style="float: right;">ID '.$var_5['id'].'</span><img src="img/icons/silk/plugin.png" /> '.$var_229->var_42.'</div>
                                </div>
                            ';
                            break;
                        }
                    }
                    break;
            }
        }

        $var_224 = implode("\n", $var_224);

        $var_58->add_tab_content(
            '<div id="block_group_selected_blocks" style="width: 49%; float: left; margin-right: 2%;">
                <div class="ui-accordion ui-widget ui-helper-reset">
                    <h3 class="ui-accordion-header ui-state-default ui-accordion-icons ui-accordion-header-active ui-state-active ui-corner-top">
                        <img src="img/icons/silk/bricks.png" style="vertical-align: middle;" /> '.t(405, 'Selection').'
                    </h3>
                    <div class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content-active">'.$var_224.'</div>
                </div>
                <div class="subcomment">
                    <img src="img/icons/silk/information.png" align="absmiddle" /> '.t(72, "Drag any row to assign priorities").'
                </div>
             </div>'
        );

        
        $var_16 = '
             SELECT b.type, b.id, d.text as title
               FROM nv_blocks b
          LEFT JOIN nv_webdictionary d
                     ON b.id = d.node_id
                    AND d.node_type = "block"
                    AND d.subtype = "title"
                    AND d.lang = "'.$var_2->var_132[0].'"
                    AND d.website = '.$var_2->var_7.'
              WHERE b.website = '.$var_2->var_7.'
           ORDER BY b.id DESC';

        $var_1->query($var_16);
        $var_230 = $var_1->result();

        $var_231 = array();
        for($var_63=0; $var_63 < count($var_148->var_223); $var_63++)
        {
            if($var_148->var_223[$var_63]->var_7 == $var_4->var_150)
                $var_231 = $var_148->var_223[$var_63]->var_91;
        }

        
        $var_58->add_tab_content(
            '<div id="blocks_available_wrapper" style="float: left; width: 49%; ">
                <div id="blocks_available_accordion">
                    <h3><i class="fa fa-fw fa-cube"></i> '.t(437, 'Block').'</h3>
                    <div>
                    '.implode(
                        "\n",
                        array_map(
                            function($var_232) use ($var_222)
                            {
                                global $var_148;

                                $var_233 = 'block_group_block ui-state-default';
                                if(!empty($var_222) && !in_array($var_232->var_32, $var_222))
                                    $var_233 .= ' ui-state-disabled hidden';

                                $var_234 = '<div class="'.$var_233.'" data-block-id="'.$var_232->var_7.'" data-block-type="block">'.
                                            '<div class="actions">
                                                <a href="?fid=blocks&act=edit&id='.$var_232->var_7.'"><img src="'.var_144.'/img/icons/silk/pencil.png" /></a>
                                                <a href="
                                            </div>'.
                                            '<div class="title">'.$var_232->var_42.'</div>'.
                                            '<div class="subcomment"><span style="float: right;">ID '.$var_232->var_7.'</span><img src="img/icons/silk/brick.png" /> '.$var_148->t($var_232->var_32).'</div>'.
                                        '</div>';
                                return $var_234;
                            },
                            $var_230
                        )
                    ).'
                        <div class="navigate-block_group-accordion-info-link hidden"><i class="fa fa-eye-slash"></i>&nbsp;&nbsp;<a href="
                    </div>
                    <h3><i class="fa fa-fw fa-cubes"></i> '.t(543, 'Block type').'</h3>
                    <div>
                    '.implode(
                        "\n",
                        array_map(
                            function($var_232) use ($var_222)
                            {
                                $var_233 = 'block_group_block ui-state-default';
                                if(!empty($var_222) && !in_array($var_232['id'], $var_222))
                                    $var_233 .= ' ui-state-disabled';

                                $var_234 = '<div class="'.$var_233.'" data-block-id="'.$var_232['id'].'" data-block-type="block_type">'.
                                    '<div class="actions">
                                        <a href="
                                        <a href="
                                    </div>'.
                                    '<div class="title">'.$var_232['title'].'</div>'.
                                    '<div class="subcomment">
                                        <span style="float: right;">'.$var_232['count'].' '.($var_232['count']==1? t(437, "Block") : t(23, "Blocks")).'</span>
                                        <img src="img/icons/silk/brick_link.png" /> ID '.$var_232['id'].'</div>'.
                                    '</div>';
                                return $var_234;
                            },
                            $var_24
                        )
                    ).'
                    </div>
                    <h3><i class="fa fa-fw fa-plus-square-o"></i> '.t(556, 'Block from group').' ['.$var_148->t($var_4->var_150).']</h3>
                    <div>                    
                        '.implode(
                            "\n",
                            array_map(
                                function($var_232) use ($var_4)
                                {
                                    global $var_148;

                                    $var_234 = '<div class="block_group_block ui-state-default" data-block-id="'.$var_232->var_7.'" data-block-type="block_group_block" title="'.$var_148->t(@$var_232->var_227).'">'.
                                                '<div class="actions">
                                                    '.(empty($var_232->var_36)? '':'<a href="
                                                    <a href="
                                                </div>'.
                                                '<div class="title">'.$var_148->t($var_232->var_42).'</div>'.
                                                '<div class="subcomment">
                                                    <span style="float: right;">ID '.$var_232->var_7.'</span>
                                                    <img src="img/icons/silk/bricks.png" />'.
                                                '</div>'.
                                            '</div>';
                                    return $var_234;
                                },
                                $var_231
                            )
                        ).'
                    </div>
                    <h3><i class="fa fa-fw fa-puzzle-piece"></i> '.t(327, 'Extensions').'</h3>
                    <div>
                        '.implode(
                            "\n",
                            array_map(
                                function($var_232) use ($var_222, $var_4)
                                {
                                    $var_233 = 'block_group_block ui-state-default';
                                    $var_229 = new class_12();
                                    $var_229->load($var_232->var_235);

                                    $var_234 = '<div class="'.$var_233.'" data-block-id="'.$var_232->var_7.'" data-block-type="extension" data-block-extension="'.$var_232->var_235.'">'.
                                        '<div class="actions">
                                            '.(empty($var_232->var_36)? '':'<a href="
                                            <a href="
                                        </div>'.
                                        '<div class="title">'.$var_229->t($var_232->var_42).'</div>'.
                                        '<div class="subcomment"><span style="float: right;">ID '.$var_232->var_7.'</span><img src="img/icons/silk/plugin.png" /> '.$var_229->var_42.'</div>'.
                                        '</div>';
                                    return $var_234;
                                },
                                $var_225
                            )
                        ).'
                    </div>
                </div>
                <div class="subcomment">
                    <img src="img/icons/silk/information.png" align="absmiddle" /> '.t(638, "Disabled blocks are not compatible with the current block group type").'
                </div>
            </div>'
        );


        $var_236 = "";
        foreach($var_2->var_132 as $var_133)
        {
            $var_236 .= ' 
                <div data-lang="'.$var_133.'" class="navigate-form-row">
                    <label style="width: 48px; "><span title="'.language::name_by_code($var_133).'" class="navigate-form-row-language-info"><img align="absmiddle" src="img/icons/silk/comment.png">'.$var_133.'</span></label>
                    <input type="text" style=" width: 340px;" name="block_type_title_value['.$var_133.']" value="">
                </div>
            ';
        }
        $var_58->add_tab_content('
            <div id="navigate-block-groups-block-type-title" class="hidden">
                '.$var_236.'
                <div class="subcomment" style="margin-left: 0;"><img src="img/icons/silk/information.png" /> '.t(641, "It will only be shown if the template supports it").'</div>
            </div>
        ');

        $var_0->add_script('                       
            function navigate_blocks_block_type_title(el)
            {
                var title = $(el).find("span").text();
                
                try 
                {
                   title = jQuery.parseJSON(title);
                } 
                catch(e) 
                {
                    
                }                    
                
                $("
                {                     
                    if(typeof(title)=="object")
                        $(this).val(title[$(this).parent().data("lang")]);
                    else
                        $(this).val(title);
                });
                
                $("
                $("
                    title: navigate_t(67, "Title"),
                    modal: true,
                    width: 428,
                    buttons: [
                        {
                            text: navigate_t(190, "Ok"),
                            icons: {
                                primary: "ui-icon-check"
                            },
                            click: function()
                            {
                                var new_value = {};
                                
                                $("
                                    .find(\'input[type="text"]\').each(
                                        function()
                                        {
                                            new_value[$(this).parent().data("lang")] = $(this).val(); 
                                        }
                                    );
                                
                                $(el).find("span").text(JSON.stringify(new_value));
                                                            
                                blocks_selection_update();
                                
                                $( this ).dialog( "close" );
                            }
                        },
                        {
                            text: navigate_t(58, "Cancel"),
                            icons: {
                                primary: "ui-icon-close"
                            },
                            click: function()
                            {
                                $( this ).dialog( "close" );
                            }
                        }
                    ]
                });
            }
        ');
    }

    $var_58->add_tab(t(457, "Information"));

    $var_58->add_tab_content($var_87->hidden('form-sent', 'true'));
    $var_58->add_tab_content($var_87->hidden('id', $var_4->var_7));

    $var_58->add_tab_content_row(array(
            '<label>ID</label>',
            '<span>'.(!empty($var_4->var_7)? $var_4->var_7 : t(52, '(new)')).'</span>' )
    );

    $var_58->add_tab_content_row(array(
        '<label>'.t(67, 'Title').'</label>',
        $var_87->textfield('title', $var_4->var_42)
    ));

    $var_237 = array();
    for($var_238=0; $var_238 < count($var_148->var_223); $var_238++)
    {
        $var_237[$var_148->var_223[$var_238]->var_7] = '';
        if(!empty($var_148->var_223[$var_238]->var_227))
            $var_237[$var_148->var_223[$var_238]->var_7] = $var_148->t($var_148->var_223[$var_238]->var_227);
    }

    if(!in_array($var_4->var_150, $var_237))
        $var_237[$var_4->var_150] = $var_4->var_150;

    $var_58->add_tab_content_row(array(
        '<label>'.t(237, 'Code').'</label>',
        $var_87->selectfield(
            'code',
            array_keys($var_237),
            array_keys($var_237),
            $var_4->var_150,
            NULL,
            NULL,
            array_values($var_237),
            "",
            true,
            true
        )
    ));

    
    if(!empty($var_4->var_90))
    {
        $var_58->add_tab_content_row(array(
            '<label>'.t(168, 'Notes').'</label>',
            $var_87->textarea('notes', $var_4->var_90)
        ));
    }

    if(!empty($var_4->var_7))
        $var_0->navigate_notes_dialog('block_group', $var_4->var_7);

    $var_0->add_script('
	    $.ajax({
	        type: "GET",
	        dataType: "script",
	        cache: true,
	        url: "lib/packages/blocks/blocks.js?r='.$var_85->var_110.'",
	        complete: function()
	        {
                block_groups_onload();
	        }
	    });
	');

    return $var_58->generate();
}

function fn_2($var_41, $var_150, $var_52, $var_50)
{
    global $var_0;
    global $var_2;
    global $var_148;

    $var_5 = class_2::block_group_block($var_41, $var_150);
    $var_36 = $var_5->var_36;

    if(empty($var_36))
        return;

    $var_0 = null;
    $var_0 = new class_0('navigate');

    if($var_50!==null)
    {
        if($var_50)
            $var_0->navigate_notification(t(53, "Data saved successfully."), false, false, 'fa fa-check');
        else
            $var_0->navigate_notification(t(56, "Unexpected error"), true, true);
    }

    $var_58 = new class_6();
    $var_87 = new class_8();

    $var_58->title(t(556, 'Block from group').' ['.$var_148->t($var_41).']');

    $var_0->navigate_media_browser();	

    $var_58->add_actions(
        array(
            '<a href="
                <img height="16" align="absmiddle" width="16" src="img/icons/silk/images.png"> '.t(36, 'Media').
            '</a>'
        )
    );

    $var_58->add_actions(
        array(
            '<a href="
                <img height="16" align="absmiddle" width="16" src="img/icons/silk/accept.png"> '.t(34, 'Save').
            '</a>'
        )
    );

    $var_58->form();

    $var_58->add_tab(t(200, 'Options'));

    $var_58->add_tab_content($var_87->hidden('form-sent', 'true'));

    
    if(count($var_2->var_173) > 1)
    {
        $var_239 = $var_2->languages();
        $var_239 = array_merge(array('' => '('.t(443, 'All').')'), $var_239);

        $var_58->add_tab_content_row(
            array(
                '<label>'.t(63, 'Languages').'</label>',
                $var_87->buttonset('language_selector', $var_239, '', "navigate_tabform_language_selector(this);")
            )
        );
    }

    $var_240 = class_5::load_properties($var_150, $var_41, 'block_group_block', $var_150, $var_52);

    foreach($var_36 as $var_241)
    {
        $var_46 = new class_5();
        $var_242 = '';

        foreach($var_240 as $var_243)
        {
            if($var_243->var_7 == $var_241->var_7)
                $var_242 = $var_243->var_244;
        }

        $var_46->load_from_object($var_241, $var_242, $var_148);

        if($var_46->var_32 == 'tab')
        {
            $var_58->add_tab($var_46->var_189);
            if(count($var_2->var_173) > 1)
            {
                $var_239 = $var_2->languages();
                $var_239 = array_merge(array('' => '('.t(443, 'All').')'), $var_239);

                $var_58->add_tab_content_row(
                    array(
                        '<label>'.t(63, 'Languages').'</label>',
                        $var_87->buttonset('language_selector', $var_239, '', "navigate_tabform_language_selector(this);")
                    )
                );
            }
        }

        $var_58->add_tab_content(navigate_property_layout_field($var_46));
    }

    $var_0->add_content('<div id="navigate-content" class="navigate-content ui-corner-all">'.$var_58->generate().'</div>');
    navigate_property_layout_scripts();
    $var_0->navigate_additional_scripts();
    $var_0->add_script('
        $("html").css("background", "transparent");
    ');

    $var_3 = $var_0->generate();

    return $var_3;
}

function fn_3($var_41, $var_54, $var_53, $var_52, $var_50)
{
    global $var_0;
    global $var_2;
    global $var_148;

    if(empty($var_54))
        throw new class_3("Unknown extension: {".$var_54."} for block with uid:".$var_52);

    $var_229 = new class_12();
    $var_229->load($var_54);

    $var_5 = class_2::extension_block($var_229, $var_53);
    $var_36 = $var_5->var_36;

    if(empty($var_36))
        return;

    $var_0 = null;
    $var_0 = new class_0('navigate');

    if($var_50!==null)
    {
        if($var_50)
            $var_0->navigate_notification(t(53, "Data saved successfully."), false, false, 'fa fa-check');
        else
            $var_0->navigate_notification(t(56, "Unexpected error"), true, true);
    }

    $var_58 = new class_6();
    $var_87 = new class_8();

    $var_58->title(t(437, 'Block').' ['.$var_54.' / '.$var_53.']');

    $var_0->navigate_media_browser();	

    $var_58->add_actions(
        array(
            '<a href="
                <img height="16" align="absmiddle" width="16" src="img/icons/silk/images.png"> '.t(36, 'Media').
            '</a>'
        )
    );

    $var_58->add_actions(
        array(
            '<a href="
                <img height="16" align="absmiddle" width="16" src="img/icons/silk/accept.png"> '.t(34, 'Save').
            '</a>'
        )
    );

    $var_58->form();

    $var_58->add_tab(t(200, 'Options'));

    $var_58->add_tab_content($var_87->hidden('form-sent', 'true'));

    
    if(count($var_2->var_173) > 1)
    {
        $var_239 = $var_2->languages();
        $var_239 = array_merge(array('' => '('.t(443, 'All').')'), $var_239);

        $var_58->add_tab_content_row(
            array(
                '<label>'.t(63, 'Languages').'</label>',
                $var_87->buttonset('language_selector', $var_239, '', "navigate_tabform_language_selector(this);")
            )
        );
    }

    $var_240 = class_5::load_properties(NULL, $var_53, "extension_block", $var_41, $var_52);

    foreach($var_36 as $var_241)
    {
        $var_46 = new class_5();
        $var_242 = '';

        foreach($var_240 as $var_243)
        {
            if($var_243->var_7 == $var_241->var_7)
                $var_242 = $var_243->var_244;
        }

        $var_46->load_from_object($var_241, $var_242, $var_229);

        if($var_46->var_32 == 'tab')
        {
            $var_58->add_tab($var_46->var_189);
            if(count($var_2->var_173) > 1)
            {
                $var_239 = $var_2->languages();
                $var_239 = array_merge(array('' => '('.t(443, 'All').')'), $var_239);

                $var_58->add_tab_content_row(
                    array(
                        '<label>'.t(63, 'Languages').'</label>',
                        $var_87->buttonset('language_selector', $var_239, '', "navigate_tabform_language_selector(this);")
                    )
                );
            }
        }

        $var_58->add_tab_content(
            navigate_property_layout_field($var_46, $var_229)
        );
    }

    $var_0->add_content('<div id="navigate-content" class="navigate-content ui-corner-all">'.$var_58->generate().'</div>');
    navigate_property_layout_scripts();
    $var_0->navigate_additional_scripts();
    $var_0->add_script('
        $("html").css("background", "transparent");
    ');

    $var_3 = $var_0->generate();

    return $var_3;
}

?>