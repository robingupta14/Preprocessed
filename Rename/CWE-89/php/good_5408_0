<?php

















class var_0 extends var_1 {
    public $var_2 = 'section';
    public $var_3 = array(
        'showall' => 'Show Navigation',
        'breadcrumb' => 'Breadcrumb',
    );






    protected $var_4 = array(
        'manage'    => 'Manage',
        'view'      => "View Page"
    );
    protected $var_5 = array(
        'move'      => 'Move Page',
        'remove'    => 'Remove Page',
        'reparent'    => 'Reparent Page',
        'dragndroprerank'    => 'Rerank Page',
        'dragndroprerank2'    => 'Rerank Page',
    );
    public $var_6 = array(
        'aggregation',
        'categories',
        'comments',
        'ealerts',
        'facebook',
        'files',
        'pagination',
        'rss',
        'tags',
        'twitter',
    );  

    static function fn_0() { return gt("Navigation"); }

    static function fn_1() { return gt("Places navigation links/menus on the page."); }

    static function fn_2() { return true; }

    function fn_3() { return gt('Webpage'); }

    
    function fn_4($var_9 = null, $var_10 = array())
    {
        parent::fn_4($var_9, $var_10);
        if (!empty($var_10['id']))  
            $var_11->var_12 = expCore::makeLocation($var_11->var_13, $var_9, $var_10['id']);
    }

    public function fn_5() {
        global $var_14, $var_15, $var_16;

        expHistory::set('viewable', $var_11->var_10);
        $var_17      = $var_15->var_17;
        $var_18 = null;
        
        $var_19 = $var_16;
        if ($var_15->var_20 == -1) {
            $var_18 = $var_15;
        } else {
            foreach ($var_19 as $var_21) {
                if ($var_21->var_17 == $var_17) {
                    $var_18 = $var_21;
                    break;
                }
            }
        }
        assign_to_template(array(
            'sections'     => $var_19,
            'current'      => $var_18,
            'canManage'    => ((isset($var_14->var_22) && $var_14->var_22 == 1) ? 1 : 0),
        ));
    }

    public function fn_6() {
        global $var_15;

        expHistory::set('viewable', $var_11->var_10);
        $var_17      = $var_15->var_17;
        $var_18 = null;
        
        $var_18 = new class_0($var_17);
        if ($var_18->var_20 == -1) {  
            $var_19 = class_0::levelTemplate(-1, 0);
            foreach ($var_19 as $var_21) {
                if ($var_21->var_17 == $var_17) {
                    $var_18 = $var_21;
                    break;
                }
            }
        } else {
            $var_19 = class_0::levelTemplate(0, 0);
            foreach ($var_19 as $var_21) {
                if ($var_21->var_17 == $var_17) {
                    $var_18 = $var_21;
                    break;
                }
            }
        }
        assign_to_template(array(
            'sections'     => $var_19,
            'current'      => $var_18,
        ));
    }

    
    public static function var_23($var_24=false) {
        global $var_16;

        $var_25 = array();
        for ($var_26 = 0, $var_27 = count($var_16); $var_26 < $var_27; $var_26++) {
            if ($var_16[$var_26]->var_28 == 0) {
                $var_29 = new class_1();

                $var_29->var_17   = $var_16[$var_26]->var_17;
                $var_29->var_30 = $var_16[$var_26]->var_31;
                $var_29->var_32 = $var_16[$var_26]->var_33;
                $var_29->var_7 = $var_16[$var_26]->var_7;
                $var_29->var_34 = $var_16[$var_26]->var_34;
                $var_29->var_35 = $var_16[$var_26]->var_35;
                $var_29->var_36 = $var_16[$var_26]->var_36;
                $var_29->var_37 = $var_16[$var_26]->var_37;
                $var_29->var_38 = $var_16[$var_26]->var_39;
                if ($var_16[$var_26]->var_40 == 1) {
                    $var_29->var_41 = $var_16[$var_26]->var_42;
                    if ($var_29->var_38 == 1 && substr($var_29->var_41, 0, 4) != 'http') {
                        $var_29->var_41 = 'http:
                    }
                } else {
                    $obj->url     = "
                    $obj->onclick = "onclick: { fn: return false }";
                }
                if ($obj->type == 3) {  
                    $obj->width = $sections[$i]->internal_id;
                    $obj->class = $sections[$i]->external_link;
                }
                
                
                $obj->itemdata = self::getChildren($i,$notyui);
                $obj->maxitems = count($obj->itemdata);
                $obj->maxdepth = 0;
                foreach ($obj->itemdata as $menu) {
                    if ($menu->maxdepth > $obj->maxdepth) $obj->maxdepth = $menu->maxdepth;
                }
            }
            $json_array[] = $obj;
        }
        return $json_array;
    }

    
    public static function navtojson() {
        return json_encode(self::navhierarchy());
    }

    
    public static function getChildren(&$i, $notyui=false) {
        global $sections;

        
        if ($i + 1 == count($sections)) { 
            return array();
        } elseif ($sections[$i]->depth == $sections[$i + 1]->depth) {
            return array();
        } else {
            $ret_depth = $sections[$i]->depth;
            $i++;
            $ret_array = array();
            for ($iMax = count($sections); $i < $iMax; $i++) {
                
                $obj       = new stdClass();
                $obj->id   = $sections[$i]->id;
                $obj->text = $sections[$i]->name;
                $obj->title = $sections[$i]->page_title;
                $obj->description = $sections[$i]->description;
                $obj->new_window = $sections[$i]->new_window;
                $obj->expFile = $sections[$i]->expFile;
                $obj->glyph = $sections[$i]->glyph;
                $obj->glyph_only = $sections[$i]->glyph_only;
                $obj->depth = $sections[$i]->depth;
                if ($sections[$i]->active == 1) {
                    $obj->url = $sections[$i]->link;
                    if ($sections[$i]->alias_type == 1 && substr($obj->url, 0, 4) != 'http') {
                        $var_29->var_41 = 'http:
                    }
                } else {
                    $obj->url     = "
                    $obj->onclick = "onclick: { fn: return false }";
                }
                
                if (self::hasChildren($i)) {
                    if ($notyui) {
                        $obj->itemdata = self::getChildren($i,$notyui);
                        $obj->maxitems = count($obj->itemdata);
                        $obj->maxdepth = 0;
                        foreach ($obj->itemdata as $menu) {
                            if (!empty($menu->maxdepth)) {
                                if ($menu->maxdepth > $obj->maxdepth) $obj->maxdepth = $menu->maxdepth;
                            } else {
                                if ($menu->depth > $obj->maxdepth) $obj->maxdepth = $menu->depth;
                            }
                        }
                    } else {
                        $obj->submenu     = new stdClass();
                        $obj->submenu->id = $sections[$i]->name . $sections[$i]->id;
                        
                        $obj->submenu->itemdata = self::getChildren($i,$notyui);
                        $obj->maxitems = count($obj->submenu->itemdata);
                        $obj->maxdepth = 0;
                        foreach ($obj->submenu->itemdata as $menu) {
                            if (!empty($menu->maxdepth)) {
                                if ($menu->maxdepth > $obj->maxdepth) $obj->maxdepth = $menu->maxdepth;
                            } else {
                                if ($menu->depth > $obj->maxdepth) $obj->maxdepth = $menu->depth;
                            }
                        }
                    }
                    $ret_array[]            = $obj;
                } else {
                    $obj->maxdepth = $obj->depth;
                    $ret_array[] = $obj;
                }
                if (($i + 1) >= count($sections) || $sections[$i + 1]->depth <= $ret_depth) {
                    return $ret_array;
                }
            }
            return array();
        }
    }

    
    public static function hasChildren($i) {
        global $sections;

        if (($i + 1) >= count($sections)) return false;
        return ($sections[$i]->depth < $sections[$i + 1]->depth) ? true : false;
    }

    
    public static function initializeNavigation() {
        $sections = section::levelTemplate(0, 0);
        return $sections;
    }

    
    public static function levelTemplate($parent, $depth = 0, $parents = array()) {
        global $user;

        if ($parent != 0) $parents[] = $parent;
        $nodes = array();
        $cache = expSession::getCacheValue('var_43');
        $var_44 = new var_21();
        if (!isset($var_47['kids'][$var_20])) {
            $var_45 = $var_44->find('all','parent=' . $var_20);
            $var_47['kids'][$var_20] = $var_45;
            expSession::setCacheValue('navigation', $var_47);
        } else {
            $var_45 = $var_47['kids'][$var_20];
        }
        $var_45 = expSorter::sort(array('array' => $var_45, 'sortby' => 'rank', 'order' => 'ASC'));
        for ($var_26 = 0, $var_27 = count($var_45); $var_26 < $var_27; $var_26++) {
            $var_48 = $var_45[$var_26];
            
            if ($var_48->var_49 == 1 || expPermissions::check('view', expCore::makeLocation('navigation', '', $var_48->var_17))) {
                $var_48->var_50    = count($var_51);
                $var_48->var_28         = $var_28;
                $var_48->var_52         = ($var_26 == 0 ? 1 : 0);
                $var_48->var_53          = ($var_26 == count($var_45) - 1 ? 1 : 0);
                $var_48->var_51       = $var_51;
                $var_48->var_54     = (isset($var_14->var_22) && $var_14->var_22 == 1 ? 1 : 0);
                $var_48->var_55 = $var_48->var_54;
                if (!isset($var_48->var_56)) {
                    $var_48->var_56 = '';
                }
                
                if ($var_48->var_39 == 1) {
                    
                    
                    
                    $var_48->var_42 = $var_48->var_57;
                } else if ($var_48->var_39 == 2) {
                    
                    

                    $var_58 = $var_44->find('first','id=' . $var_48->var_59);
                    if (!empty($var_58->var_39) && $var_58->var_39 == 1) {
                        
                        
                        $var_48->var_42 = $var_58->var_57;
                    } else {
                        
                        
                        
                        
                        
                        
                        $var_48->var_7 = !empty($var_58->var_7) ? $var_58->var_7 : '';
                        $var_48->var_42        = expCore::makeLink(array('section' => $var_48->var_59));
                    }
                } else {
                    
                    $var_48->var_42 = expCore::makeLink(array('section' => $var_48->var_17), '', $var_48->var_56);
                }
                
                $var_60[] = $var_48;
                $var_60   = array_merge($var_60, class_0::levelTemplate($var_48->var_17, $var_28 + 1, $var_51));
            }
        }
        return $var_60;
    }

    
    public static function fn_7($var_20, $var_28 = 0, $var_61 = array(), $var_62 = false, $var_63 = 'view', $var_64 = false, $var_65 = true) {
        global $var_66;

        $var_67 = array();
        if ($var_20 == 0 && $var_62) {
            $var_67[0] = '&lt;' . gt('Top of Hierarchy') . '&gt;';
        }
        if ($var_65) {
            $var_68 = '';
        } else {
            $var_68 = ' AND alias_type != 2';
        }
        $var_60 = $var_66->selectObjects('section', 'parent=' . $var_20 . $var_68, 'rank');
        foreach ($var_60 as $var_70) {
            if ((($var_63 == 'view' && $var_70->var_49 == 1) || expPermissions::check($var_63, expCore::makeLocation('navigation', '', $var_70->var_17))) && !in_array($var_70->var_17, $var_61)) {
                if ($var_70->var_40 == 1) {
                    $var_30 = str_pad('', ($var_28 + ($var_62 ? 1 : 0)) * 3, '.', var_71) . $var_70->var_31;
                } else {
                    $var_30 = str_pad('', ($var_28 + ($var_62 ? 1 : 0)) * 3, '.', var_71) . '(' . $var_70->var_31 . ')';
                }
                $var_67[$var_70->var_17] = $var_30;
                foreach (self::fn_7($var_70->var_17, $var_28 + 1, $var_61, $var_62, $var_63, $var_64, $var_65) as $var_17 => $var_30) {
                    $var_67[$var_17] = $var_30;
                }
            }
        }
        if ($var_64 && $var_20 == 0) {
            $var_16 = $var_66->selectObjects('section', 'parent=-1');
            foreach ($var_16 as $var_70) {
                if ((($var_63 == 'view' && $var_70->var_49 == 1) || expPermissions::check($var_63, expCore::makeLocation('navigation', '', $var_70->var_17))) && !in_array($var_70->var_17, $var_61)) {
                    if ($var_70->var_40 == 1) {
                        $var_30 = str_pad('', ($var_28 + ($var_62 ? 1 : 0)) * 3, '.', var_71) . $var_70->var_31;
                    } else {
                        $var_30 = str_pad('', ($var_28 + ($var_62 ? 1 : 0)) * 3, '.', var_71) . '(' . $var_70->var_31 . ')';
                    }
                    $var_67[$var_70->var_17] = '(' . gt('Standalone') . ') ' . $var_30;
                }
            }

        }
        return $var_67;
    }

    
    function fn_8() {
        global $var_66;

        
        

        $var_66->delete('search', "ref_module='".$var_11->var_13."' AND ref_type='section'");
        
        $var_16 = $var_66->selectObjects('section', 'active=1');
        foreach ($var_16 as $var_21) {
            $var_73 = new class_1();




            $var_73->var_74  = $var_11->var_13;
            $var_73->var_75    = $var_11->fn_3();
            $var_73->var_76    = $var_11->searchCategory();
            $var_73->var_78 = $var_21->var_17;
            $var_73->var_32       = $var_21->var_31;
            
            $var_42 = str_replace(var_79, '', makeLink(array('section' => $var_21->var_17)));
            if ($var_42 . '/' == var_79) $var_42 = '';
            $var_73->var_80 = $var_42;
            $var_73->var_81      = $var_21->var_7;
            $var_73->var_82  = $var_21->var_82;
            
            
            $var_12 = expCore::makeLocation('text');
            $var_83 = 'text';
            foreach ($var_66->selectObjects('sectionref', "module='" . $var_83 . "' AND section=" . $var_21->var_17) as $var_84) {
                $var_12->var_9   = $var_84->var_85;

                $var_86 = expModules::getController($var_83);
                $var_87  = $var_66->selectObjects($var_86->var_88, "location_data='" . serialize($var_12) . "'");
                foreach ($var_87 as $var_89) {
                    if (!empty($var_89)) {
                        $var_73->var_81 .= ' ' . search::removeHTML($var_89->var_81) . ' ';
                        $var_73->var_82 .= " " . $var_89->var_32;
                    }
                }
            }
            $var_66->insertObject($var_73, 'search');
        }
        return count($var_16);
    }

    
    function fn_9($var_20, $var_28 = 0, $var_91 = 0, $var_61 = array()) {
        global $var_66;

        $var_92 = '';
        $var_60 = $var_66->selectObjects('section', 'parent=' . $var_20, 'rank');

        foreach ($var_60 as $var_70) {
            if (($var_70->var_49 == 1 || expPermissions::check('view', expCore::makeLocation('navigation', '', $var_70->var_17))) && !in_array($var_70->var_17, $var_61)) {
                $var_92 .= '<option value="' . $var_70->var_17 . '" ';
                if ($var_91 == $var_70->var_17) $var_92 .= 'selected';
                $var_92 .= '>';
                if ($var_70->var_40 == 1) {
                    $var_92 .= str_pad('', $var_28 * 3, '.', var_71) . $var_70->var_31;
                } else {
                    $var_92 .= str_pad('', $var_28 * 3, '.', var_71) . '(' . $var_70->var_31 . ')';
                }
                $var_92 .= '</option>';
                $var_92 .= self::fn_9($var_70->var_17, $var_28 + 1, $var_91, $var_61);
            }
        }
        return $var_92;
    }

    
    public static function fn_10($var_20, $var_28 = 1) {
        global $var_66;

        $var_93  = array();
        $var_45 = $var_66->selectObjects('section_template', 'parent=' . $var_20, 'rank');

        for ($var_26 = 0, $var_27 = count($var_45); $var_26 < $var_27; $var_26++) {
            $var_94        = $var_45[$var_26];
            $var_94->var_28 = $var_28;
            $var_94->var_52 = ($var_26 == 0 ? 1 : 0);
            $var_94->var_53  = ($var_26 == count($var_45) - 1 ? 1 : 0);
            $var_93[]       = $var_94;
            $var_93         = array_merge($var_93, self::fn_10($var_94->var_17, $var_28 + 1));
        }
        return $var_93;
    }

    
    public static function fn_11($var_21, $var_95) {
        global $var_66;

        if (!is_object($var_95)) {
            $var_95          = $var_66->selectObject('section_template', 'id=' . $var_95);
            $var_21->var_97 = $var_95->var_97;
            $var_66->updateObject($var_21, 'section');
        }
        $var_99 = '@st' . $var_95->var_17;
        $var_100   = $var_66->selectObjects('sectionref', "source LIKE '$var_99%'");
        
        foreach ($var_100 as $var_101) {
            $var_9 = substr($var_101->var_85, strlen($var_99)) . $var_21->var_17;
            if (call_user_func(array($var_101->var_84, 'hasContent'))) {
                $var_102 = expCore::makeLocation($var_101->var_84, $var_101->var_85);
                $var_103 = expCore::makeLocation($var_101->var_84, $var_9);
                if ($var_101->var_84 != "container") {
                    call_user_func(array($var_101->var_84, 'copyContent'), $var_102, $var_103);
                } else {
                    call_user_func(array($var_101->var_84, 'copyContent'), $var_102, $var_103, $var_21->var_17);
                }
            }
        }
        
        foreach ($var_66->selectObjects('section_template', 'parent=' . $var_95->var_17) as $var_104) {
            self::fn_12($var_21, $var_104);
        }

    }

    
    function fn_12($var_105, $var_106) {
        global $var_66, $var_107;

        $var_21              = new class_1();
        $var_21->var_20      = $var_105->var_17;
        $var_21->var_31        = $var_106->var_31;
        $var_21->var_56    = $var_107->encode($var_21->var_31);
        $var_21->var_97    = $var_106->var_97;
        $var_21->var_40      = $var_106->var_40;
        $var_21->var_49      = $var_106->var_49;
        $var_21->var_109        = $var_106->var_109;
        $var_21->var_33  = $var_106->var_33;
        $var_21->var_82    = $var_106->var_82;
        $var_21->var_7 = $var_106->var_7;
        $var_21->var_17          = $var_66->insertObject($var_21, 'section');
        self::fn_11($var_21, $var_106);
    }

    
    public static function fn_13($var_20) {
        global $var_66;

        $var_45 = $var_66->selectObjects('section', 'parent=' . $var_20);
        foreach ($var_45 as $var_110) {
            self::fn_13($var_110->var_17);
        }
        $var_111 = $var_66->selectObjects('sectionref', 'section=' . $var_20);
        foreach ($var_111 as $var_112) {
            $var_12 = expCore::makeLocation($var_112->var_84, $var_112->var_85, $var_112->var_113);
            recyclebin::sendToRecycleBin($var_12, $var_20);
            












        }

        $var_66->delete('section', 'parent=' . $var_20);
    }

    
    public static function fn_14($var_20) {
        global $var_66;

        $var_45 = $var_66->selectObjects('section', 'parent=' . $var_20);
        foreach ($var_45 as $var_110) {
            $var_110->var_20 = -1;
            $var_66->updateObject($var_110, 'section');
            self::fn_14($var_110->var_17);
        }
    }

    
    public static function fn_15($var_21) {
        global $var_66;

        if ($var_21 == null) {
            return false;
        }
        if ($var_21->var_49 == 0) {
            
            return expPermissions::check('view', expCore::makeLocation('navigation', '', $var_21->var_17));
        } else { 
            if ($var_21->var_20 <= 0) {
                
                return true;
            } else {
                $var_114 = $var_66->selectObject('section', 'id=' . $var_21->var_20);
                return self::fn_15($var_114);
            }
        }
    }

    
    public static function fn_16($var_114) {
        if ($var_114 == null) {
            return false;
        }
        while ($var_114->var_49 && $var_114->var_20 > 0) {
            $var_114 = new class_0($var_114->var_20);
        }
        $var_115 = (($var_114->var_49) ? 1 : 0);
        return $var_115;
    }

    public static function fn_17() {
        global $var_14;

        if ($var_14->isAdmin()) return true;
        $var_117 = class_0::levelTemplate(-1, 0);
        
        foreach ($var_117 as $var_118) {
            $var_12 = expCore::makeLocation('navigation', '', $var_118->var_17);
            if (expPermissions::check('manage', $var_12)) return true;
        }
        return false;
    }

    
    public static function fn_18($var_17) {
        global $var_66;

        $var_21 = $var_66->selectObject('section', 'id=' . $var_17);
        $var_119  = class_0::levelTemplate($var_17, 0);
        array_unshift($var_119, $var_21);
        $var_120  = array();
        $var_121 = array();
        while ($var_21->var_20 > 0) {
            
            $var_120  = array_merge($var_120, $var_66->selectColumn('userpermission', 'uid', "permission='manage' AND module='navigation' AND internal=" . $var_21->var_20));
            $var_121 = array_merge($var_121, $var_66->selectColumn('grouppermission', 'gid', "permission='manage' AND module='navigation' AND internal=" . $var_21->var_20));
            $var_21   = $var_66->selectObject('section', 'id=' . $var_21->var_20);
        }
        foreach ($var_119 as $var_21) {
            $var_123 = expCore::makeLocation('navigation', null, $var_21->var_17);
            
            
            
            foreach ($var_120 as $var_124) {
                $var_125 = user::getUserById($var_124);
                expPermissions::grant($var_125, 'manage', $var_123);
            }
            foreach ($var_121 as $var_126) {
                $var_127 = group::getGroupById($var_126);
                expPermissions::grantGroup($var_127, 'manage', $var_123);
            }
        }
    }

    function fn_19() {
        global $var_66, $var_107, $var_14;

        expHistory::set('manageable', $var_107->var_10);
        assign_to_template(array(
            'canManageStandalones' => self::fn_17(),
            'sasections'           => $var_66->selectObjects('section', 'parent=-1'),
            'user'                 => $var_14,


        ));
    }

    public function fn_20() {
        global $var_66, $var_14, $var_15, $var_16;

        expHistory::set('viewable', $var_11->var_10);
        $var_17      = $var_15->var_17;
        $var_18 = null;
        
        $var_19 = $var_16;
        if ($var_15->var_20 == -1) {
            $var_18 = $var_15;
        } else {
            foreach ($var_19 as $var_21) {
                if ($var_21->var_17 == $var_17) {
                    $var_18 = $var_21;
                    break;
                }
            }
        }
        assign_to_template(array(
            'sasections'   => $var_66->selectObjects('section', 'parent=-1'),
            'sections'     => $var_19,
            'current'      => $var_18,
            'canManage'    => ((isset($var_14->var_22) && $var_14->var_22 == 1) ? 1 : 0),
        ));
    }

    
    public static function fn_21() {
        global $var_66;

        
        $var_17         = isset($_REQUEST['id']) ? intval($_REQUEST['id']) : 0;
        $var_129        = $var_66->selectObjects('section', 'parent=' . $var_17, 'rank');
        
        $var_130 = false;
        if (expPermissions::check('manage', expCore::makeLocation('navigation', '', $var_17))) {
            $var_130 = true;
        }
        
        $var_131 = count($var_129);
        for ($var_26 = 0; $var_26 < $var_131; $var_26++) {
            if ($var_130 || expPermissions::check('manage', expCore::makeLocation('navigation', '', $var_129[$var_26]->var_17))) {
                $var_129[$var_26]->var_128 = 1;
                $var_132 = true;
            } else {
                $var_129[$var_26]->var_128 = 0;
                $var_132 = $var_129[$var_26]->var_49 ? true : expPermissions::check('view', expCore::makeLocation('navigation', '', $var_129[$var_26]->var_17));
            }
            $var_129[$var_26]->var_42 = expCore::makeLink(array('section' => $var_129[$var_26]->var_17), '', $var_129[$var_26]->var_56);
            if (!$var_132) unset($var_129[$var_26]);
        }
        $var_129= array_values($var_129);

        if (count($var_129)) $var_129[count($var_129) - 1]->var_53 = true;

        $var_67 = new class_2(201, '', $var_129);
        $var_67->send();
    }

    
    public static function fn_22() {
        global $var_66;

        $var_134 = array(
            0 => 'addpage',
            1 => 'addextpage',
            2 => 'addintpage',
            3 => 'addfreeform',
        );

        $var_135        = $var_66->selectObjects('section', 'parent!=-1', 'rank');
        foreach ($var_135 as $var_26=>$var_129) {
            $var_135[$var_26]->var_20 = $var_129->var_20?$var_129->var_20:'
            $navs[$i]->text = $nav->name;
            $navs[$i]->icon = $icons[$nav->alias_type];
            if (!$nav->active) {
                $navs[$i]->icon .= ' var_136';
                $var_137 = new class_1();
                $var_137->var_138 = 'inactive';  
                $var_135[$var_26]->var_139 = $var_137;
            }
            if (expPermissions::check('manage', expCore::makeLocation('navigation', '', $var_135[$var_26]->var_17))) {
                $var_135[$var_26]->var_128 = 1;
                $var_132 = true;
            } else {
                $var_135[$var_26]->var_128 = 0;
                $var_135[$var_26]->var_140->var_141 = true;
                $var_132 = $var_135[$var_26]->var_49 ? true : expPermissions::check('view', expCore::makeLocation('navigation', '', $var_135[$var_26]->var_17));
            }
            $var_135[$var_26]->var_42 = expCore::makeLink(array('section' => $var_135[$var_26]->var_17), '', $var_135[$var_26]->var_56);
            if (!$var_132) {

                $var_137 = new class_1();
                $var_137->var_138 = 'hidden';  
                $var_135[$var_26]->var_142 = $var_137;
            }
        }
        $var_135= array_values($var_135);

		

        var_143;
    }

    
    public static function fn_23() {
        global $var_66, $var_107;

        $var_144   = intval($var_107->var_10['move']);
        $var_145 = intval($var_107->var_10['target']);
        $var_38   = $var_107->var_10['type'];
        $var_146 = $var_66->selectObject("section","id=".$var_145);

        $var_147 = $var_146->var_20;
        $var_148 = $var_66->selectObject("section","id=".$var_144);


        
        if ($var_38 == "append") {
            
            $var_149 = $var_148->var_20;
            
            $var_148->var_20 = $var_146->var_17;
            
            $var_148->var_109 = 1;
            
            $var_150 = $var_66->selectObjects("section", "parent=" . $var_146->var_17 . " ORDER BY rank");
            
            $var_151 = 1;
            foreach ($var_150 as $var_152) {
                if ($var_152->var_17 != $var_148->var_17) {
                    $var_152->var_109 = $var_151;
                    $var_66->updateObject($var_152, 'section');
                    $var_151++;
                }
            }
            $var_66->updateObject($var_148, 'section');
            if ($var_149 != $var_148->var_20) {
                
                $var_153 = $var_66->selectObjects("section", "parent=" . $var_149 . " ORDER BY rank");
                for ($var_26 = 0, $var_27 = count($var_153); $var_26 < $var_27; $var_26++) {
                    $var_153[$var_26]->var_109 = $var_26;
                    $var_66->updateObject($var_153[$var_26], 'section');
                }

            }


        } elseif ($var_38 == "after") {  
            if ($var_146->var_20 == $var_148->var_20) {
                
                if ($var_146->var_109 < $var_148->var_109) {
                    $var_148->var_109    = $var_146->var_109 + 1;
                    $var_154 = $var_66->selectObjects("section", "id!=" . $var_148->var_17 . " AND parent=" . $var_146->var_20 . " AND rank>" . $var_146->var_109 . " ORDER BY rank");
                    $var_155           = $var_148->var_109 + 1;
                    foreach ($var_154 as $var_152) {
                        if ($var_152->var_17 != $var_148->var_17) {
                            $var_152->var_109 = $var_155;
                            $var_66->updateObject($var_152, 'section');
                            $var_155++;
                        }
                    }
                    $var_66->updateObject($var_146, 'section');

                    $var_66->updateObject($var_148, 'section');

                    
                } else {
                    $var_146->var_109        = $var_146->var_109 - 1;
                    $var_148->var_109        = $var_146->var_109 + 1;
                    $var_156 = $var_66->selectObjects("section", "id!=" . $var_148->var_17 . " AND parent=" . $var_146->var_20 . " AND rank<=" . $var_146->var_109 . " ORDER BY rank");
                    $var_155               = 1;
                    foreach ($var_156 as $var_152) {
                        if ($var_152->var_17 != $var_148->var_17) {
                            $var_152->var_109 = $var_155;
                            $var_66->updateObject($var_152, 'section');
                            $var_155++;
                        }
                    }
                    $var_66->updateObject($var_146, 'section');

                    $var_66->updateObject($var_148, 'section');

                }
            } else {  
                
                $var_157   = $var_148->var_109;
                $var_149 = $var_148->var_20;
                
                $var_154 = $var_66->selectObjects("section", "parent=" . $var_146->var_20 . " AND rank>" . $var_146->var_109 . " ORDER BY rank");
                
                $var_148->var_109   = $var_146->var_109 + 1;
                $var_148->var_20 = $var_146->var_20;
                
                foreach ($var_154 as $var_152) {
                    $var_152->var_109 = $var_152->var_109 + 1;
                    $var_66->updateObject($var_152, 'section');
                }
                $var_66->updateObject($var_148, 'section');
                
                $var_158 = $var_66->selectObjects("section", "parent=" . $var_149 . " AND rank>" . $var_157 . " ORDER BY rank");
                $var_155      = 1;
                foreach ($var_158 as $var_152) {
                    if ($var_152->var_17 != $var_148->var_17) {
                        $var_152->var_109 = $var_155;
                        $var_66->updateObject($var_152, 'section');
                        $var_155++;
                    }
                }
                if ($var_149 != $var_148->var_20) {
                    
                    $var_153 = $var_66->selectObjects("section", "parent=" . $var_149 . " ORDER BY rank");
                    for ($var_26 = 0, $var_27 = count($var_153); $var_26 < $var_27; $var_26++) {
                        $var_153[$var_26]->var_109 = $var_26;
                        $var_66->updateObject($var_153[$var_26], 'section');
                    }
                }
            }
        }
        self::fn_18($var_144);
        expSession::clearAllUsersSessionCache('navigation');
    }

    
    public static function fn_24() {
        global $var_107, $var_66;

        $var_17 = $var_107->var_10['id'];
        $var_94 = new class_0($var_17);
        $var_159 = $var_94->var_109;
        $var_160 = $var_94->var_20;
        $var_161 = $var_107->var_10['position'] + 1;  
        $var_162 = intval($var_107->var_10['parent']);

        $var_66->decrement($var_94->var_164, 'rank', 1, 'rank>' . $var_159 . ' AND parent=' . $var_160);  
        $var_66->increment($var_94->var_164, 'rank', 1, 'rank>=' . $var_161 . ' AND parent=' . $var_162);  

        $var_10 = array();
        $var_10['parent'] = $var_162;
        $var_10['rank'] = $var_161;
        $var_94->fn_25($var_10);

        self::fn_18($var_17);
        expSession::clearAllUsersSessionCache('navigation');
    }

    function fn_26() {
        global $var_66, $var_14;

        $var_20 = new class_0($var_11->var_10['parent']);
        if (empty($var_20->var_17)) $var_20->var_17 = 0;
        assign_to_template(array(
            'haveStandalone'  => ($var_66->countObjects('section', 'parent=-1') && $var_20->var_17 >= 0),
            'parent'          => $var_20,
            'isAdministrator' => $var_14->isAdmin(),
        ));
    }

    function fn_27() {
        
        
        

        $var_21 = new class_1();
        if (isset($var_11->var_10['id'])) {
            
            
            $var_21  = $var_11->var_21->find($var_11->var_10['id']);
        } elseif (isset($var_11->var_10['parent'])) {
            
            
            $var_21  = new class_0($var_11->var_10);
        } else {
            notfoundController::handle_not_found();
            var_143;
        }
        if (!empty($var_21->var_17)) {
            $var_147 = $var_21->var_17;
        } else {
            $var_147 = $var_21->var_20;
        }
        if (expPermissions::check('manage', expCore::makeLocation('navigation', '', $var_147))) {
            if (empty($var_21->var_17)) {
                $var_21->var_40 = 1;
                $var_21->var_49 = 1;
                if (!isset($var_21->var_20)) {
                    
                    
                    
                    notfoundController::handle_not_authorized();
                    var_143;
                    
                }
            }
            assign_to_template(array(
                'section' => $var_21,
                'glyphs' => self::fn_28(),
            ));
        } else {  
            notfoundController::handle_not_authorized();
        }
    }

    private static function fn_28() {
        if (bs()) {
            $var_168 = new class_3;
            if (bs3()) {
                $var_134 = $var_168->getArray(var_170 . 'external/font-awesome4/css/font-awesome.css');
                $var_134 = $var_168->sortByName($var_134);
                return $var_168->nameGlyph($var_134);
            } elseif (bs2()) {
                expCSS::auto_compile_less(
                    'external/font-awesome/less/font-awesome.less',
                    'external/font-awesome/css/font-awesome.css'
                ); 
                $var_134 = $var_168->getArray(var_170 . 'external/font-awesome/css/font-awesome.css', 'icon-');
                return $var_168->nameGlyph($var_134, 'icon-');
            }
        } else {
            return array();
        }
    }

    function fn_29() {
        $var_21 = isset($var_11->var_10['id']) ? $var_11->var_21->find($var_11->var_10['id']) : new class_0($var_11->var_10);
        if ($var_21->var_20 == -1) {
            notfoundController::handle_not_found();
            var_143;
        } 
        if (empty($var_21->var_17)) {
            $var_21->var_49 = 1;
            if (!isset($var_21->var_20)) {
                
                
                
                notfoundController::handle_not_authorized();
                var_143;
                
            }
        }
        assign_to_template(array(
            'section' => $var_21,
            'glyphs' => self::fn_28(),
        ));
    }

    function fn_30() {
        $var_21 = isset($var_11->var_10['id']) ? $var_11->var_21->find($var_11->var_10['id']) : new class_0($var_11->var_10);
        if ($var_21->var_20 == -1) {
            notfoundController::handle_not_found();
            var_143;
        } 
        if (empty($var_21->var_17)) {
            $var_21->var_49 = 1;
            if (!isset($var_21->var_20)) {
                
                
                
                notfoundController::handle_not_authorized();
                var_143;
                
            }
        }
        assign_to_template(array(
            'section' => $var_21,
            'glyphs' => self::fn_28(),
        ));
    }

    function fn_31() {
        $var_21 = isset($var_11->var_10['id']) ? $var_11->var_21->find($var_11->var_10['id']) : new class_0($var_11->var_10);
        if ($var_21->var_20 == -1) {
            notfoundController::handle_not_found();
            var_143;
        } 
        if (empty($var_21->var_17)) {
            $var_21->var_49 = 1;
            if (!isset($var_21->var_20)) {
                
                
                
                notfoundController::handle_not_authorized();
                var_143;
                
            }
        }
        assign_to_template(array(
            'section' => $var_21,
            'glyphs' => self::fn_28(),
        ));
    }

    function fn_25() {
        parent::fn_25();
        expSession::clearAllUsersSessionCache('navigation');
    }

    function fn_32() {
        expSession::clearAllUsersSessionCache('navigation');
        assign_to_template(array(
            'parent' => $var_11->var_10['parent'],
        ));
    }

    
    function fn_33() {
        $var_118 = $var_11->var_21->find($var_11->var_10['page']);
        if ($var_118) {
            $var_118->var_20 = $var_11->var_10['parent'];
            $var_118->fn_25();
            expSession::clearAllUsersSessionCache('navigation');
            expHistory::back();
        } else {
            notfoundController::handle_not_found();
        }
    }

    
    function fn_34() {
        global $var_66;

        $var_21 = $var_66->selectObject('section', 'id=' . $var_11->var_10['id']);
        if ($var_21) {
            class_0::fn_14($var_21->var_17);
            $var_66->decrement('section', 'rank', 1, 'rank > ' . $var_21->var_109 . ' AND parent=' . $var_21->var_20);
            $var_21->var_20 = -1;
            $var_66->updateObject($var_21, 'section');
            expSession::clearAllUsersSessionCache('navigation');
            expHistory::back();
        } else {
            notfoundController::handle_not_authorized();
        }
    }

    function fn_35() {
        if (!empty($var_11->var_10['deleteit'])) {
            foreach ($var_11->var_10['deleteit'] as $var_94) {
                $var_21 = new class_0(intval($var_94));
                if ($var_21) {

                    $var_21->delete();
                }
            }
        }
        expSession::clearAllUsersSessionCache('navigation');
        expHistory::back();
    }

    
    public function fn_36() {
        
        return $var_11->var_4;
    }

    
    public static function fn_37($var_173,$var_174) {
        global $var_175, $var_107;

        
        if (empty($var_174->var_9) && empty($var_174->var_176) && ((!empty($var_107->var_10['action']) && $var_107->var_10['action'] == 'manage') || strpos($var_107->var_177, 'action=manage') !== false)) {
            if (!empty($var_175['navigation'])) foreach ($var_175['navigation'] as $var_94) {
                foreach ($var_94 as $var_178) {
                    if (!empty($var_178['manage'])) return true;
                }
            }
        }
        return false;
    }

    
    public static function fn_38() {
        global $var_66;

        
        function fn_39($var_179, $var_180) {
            global $var_66;

            $var_181 = $var_66->selectObjects('container',"external='" . $var_179 . "'");
            $var_182 = '';
            foreach ($var_181 as $var_183) {
                $var_184 = expUnserialize($var_183->var_113);
                $var_185 = recyclebin::restoreFromRecycleBin($var_184, $var_180);
                if (!empty($var_185)) $var_182 .= $var_185 . '<br>';
                if ($var_184->var_186 == 'container') {
                    $var_182 .= fn_39($var_183->var_113, $var_180);
                }
            }
            return $var_182;
        }

        
        function fn_40($var_187) {
            global $var_66;

            $var_16 = $var_66->selectObjects('section','parent=' . $var_187);
            $var_182 = '';
            foreach ($var_16 as $var_94) {
                $var_188 = serialize(expCore::makeLocation('container','@section' . $var_94->var_17));
                $var_182 .= fn_39($var_188, $var_94->var_17);
                $var_182 .= fn_40($var_94->var_17);
            }
            return $var_182;
        }

        
        $var_66->sql('DELETE FROM ' . $var_66->var_99 . 'sectionref WHERE id NOT IN (SELECT * FROM (SELECT MIN(n.id) FROM ' . $var_66->var_99 . 'sectionref n GROUP BY n.module, n.source) x)');
        $var_182 = fn_40(0);  
        $var_182 .= fn_40(-1);  

        
        $var_190 = $var_66->selectObjects('sectionref',"refcount=1000 AND source NOT LIKE '%@section%' AND source NOT LIKE '%@random%'");
        foreach ($var_190 as $var_191) {
            if ($var_191->var_84 == 'container') {
                $var_180 = intval(preg_replace('/\D/', '', $var_191->var_85));
                if (empty($var_180)) {
                    $var_180 = var_192;  
                }
                $var_182 .= fn_39(serialize(expCore::makeLocation($var_191->var_84, $var_191->var_85)), $var_180);
            } else {
                $var_191->var_21 = 0;  
                $var_66->updateObject($var_191, 'sectionref');
            }
        }

        
        $var_66->columnUpdate('sectionref', 'section', 0, "refcount=0");





        return $var_182;
    }

}

?>
